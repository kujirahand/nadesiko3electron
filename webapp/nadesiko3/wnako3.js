"use strict";(()=>{var K={and:1,or:1,eq:2,noteq:2,"===":2,"!==":2,gt:2,gteq:2,lt:2,lteq:2,"&":3,"+":4,"-":4,shift_l:4,shift_r:4,shift_r0:4,"*":5,"/":5,"\xF7":5,"\xF7\xF7":5,"%":5,"^":6,"**":6},ae=["\u3044\u3066","\u3048\u3066","\u304D\u3066","\u3051\u3066","\u3057\u3066","\u3063\u3066","\u306B\u3066","\u307F\u3066","\u3081\u3066","\u306D\u3066","\u306B\u306F","\u3093\u3067"],Ee=[];for(let t in K)Ee.push(t);function M(t="?",e="",n=-1,r=0,o="main.nako3"){return{type:t,value:e,indent:n,line:r,column:0,file:o,josi:""}}var Ne=class{constructor(e){this.logger=e,this.stackList=[],this.tokens=[],this.usedFuncs=new Set,this.stack=[],this.index=0,this.y=[],this.modName="inline",this.namespaceStack=[],this.modList=[],this.funclist=new Map,this.funcLevel=0,this.usedAsyncFn=!1,this.localvars=new Map([["\u305D\u308C",{type:"var",value:""}]]),this.genMode="sync",this.arrayIndexFrom=0,this.flagReverseArrayIndex=!1,this.flagCheckArrayInit=!1,this.recentlyCalledFunc=[],this.isReadingCalc=!1,this.isExportDefault=!0,this.isExportStack=[],this.moduleExport=new Map,this.isModifiedNodes=!1,this.init()}init(){this.funclist=new Map,this.moduleExport=new Map,this.reset()}reset(){this.tokens=[],this.index=0,this.stack=[],this.y=[],this.genMode="sync"}setFuncList(e){this.funclist=e}setModuleExport(e){this.moduleExport=e}popStack(e=void 0){if(!e){let n=this.stack.pop();return n||null}for(let n=this.stack.length-1;n>=0;n--){let r=this.stack[n];if(e.length===0||e.indexOf(r.josi)>=0)return this.stack.splice(n,1),this.logger.trace("POP :"+JSON.stringify(r)),r}return null}saveStack(){this.stackList.push(this.stack),this.stack=[]}loadStack(){this.stack=this.stackList.pop()}findVar(e){if(this.localvars.get(e))return{name:e,scope:"local",info:this.localvars.get(e)};if(e.indexOf("__")>=0)return this.funclist.get(e)?{name:e,scope:"global",info:this.funclist.get(e)}:void 0;let n=`${this.modName}__${e}`;if(this.funclist.get(n))return{name:n,scope:"global",info:this.funclist.get(n)};for(let r of this.modList){let o=`${r}__${e}`,s=this.moduleExport.get(r),u=this.funclist.get(o);if(u&&(u.isExport===!0||u.isExport!==!1&&s!==!1))return{name:o,scope:"global",info:this.funclist.get(o)}}if(this.funclist.get(e))return{name:e,scope:"system",info:this.funclist.get(e)}}pushStack(e){this.logger.trace("PUSH:"+JSON.stringify(e)),this.stack.push(e)}isEOF(){return this.index>=this.tokens.length}getIndex(){return this.index}check(e){return this.tokens[this.index].type===e}check2(e){for(let n=0;n<e.length;n++){let r=n+this.index;if(this.tokens.length<=r)return!1;if(e[n]==="*")continue;let o=this.tokens[r];if(e[n]instanceof Array){if(e[n].indexOf(o.type)<0)return!1;continue}if(o.type!==e[n])return!1}return!0}checkTypes(e){let n=this.tokens[this.index].type;return e.indexOf(n)>=0}accept(e){let n=[],r=this.index,o=()=>(this.index=r,!1);for(let s=0;s<e.length;s++){if(this.isEOF())return o();let u=e[s];if(u==null)return o();if(typeof u=="string"){let i=this.get();if(i&&i.type!==u)return o();n[s]=i;continue}if(typeof u=="function"){let c=u.bind(this)(n);if(c===null)return o();n[s]=c;continue}if(u instanceof Array){if(!this.checkTypes(u))return o();n[s]=this.get();continue}throw new Error("System Error : accept broken : "+typeof u)}return this.y=n,!0}get(){return this.isEOF()?null:this.tokens[this.index++]}getCur(){if(this.isEOF())throw new Error("\u30C8\u30FC\u30AF\u30F3\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3002");let e=this.tokens[this.index++];if(!e)throw new Error("\u30C8\u30FC\u30AF\u30F3\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3002");return e}unget(){this.index>0&&this.index--}peek(e=0){return this.isEOF()?null:this.tokens[this.index+e]}peekDef(e=null){return this.isEOF()?(e||(e=M()),e):this.tokens[this.index]}peekSourceMap(e=void 0){let n=e===void 0?this.peek():e;return n===null?{startOffset:void 0,endOffset:void 0,file:void 0,line:0,column:0}:{startOffset:n.startOffset,endOffset:n.endOffset,file:n.file,line:n.line,column:n.column}}nodeToStr(e,n,r){let o=n.depth-1,s=i=>n.typeName!==void 0?n.typeName:i,u=r?" debug: "+JSON.stringify(e,null,2):"";if(!e)return"(NULL)";switch(e.type){case"not":if(o>=0){let i=e.blocks[0];return`${s("")}\u300E${this.nodeToStr(i,{depth:o},r)}\u306B\u6F14\u7B97\u5B50\u300Enot\u300F\u3092\u9069\u7528\u3057\u305F\u5F0F${u}\u300F`}else return`${s("\u6F14\u7B97\u5B50")}\u300Enot\u300F`;case"op":{let i=e,c=i.operator||"",a={eq:"\uFF1D",not:"!",gt:">",lt:"<",and:"\u304B\u3064",or:"\u307E\u305F\u306F"};if(c in a&&(c=a[c]),o>=0){let f=this.nodeToStr(i.blocks[0],{depth:o},r),l=this.nodeToStr(i.blocks[1],{depth:o},r);return i.operator==="eq"?`${s("")}\u300E${f}\u3068${l}\u304C\u7B49\u3057\u3044\u304B\u3069\u3046\u304B\u306E\u6BD4\u8F03${u}\u300F`:`${s("")}\u300E${f}\u3068${l}\u306B\u6F14\u7B97\u5B50\u300E${c}\u300F\u3092\u9069\u7528\u3057\u305F\u5F0F${u}\u300F`}else return`${s("\u6F14\u7B97\u5B50")}\u300E${c}${u}\u300F`}case"number":return`${s("\u6570\u5024")}${e.value}`;case"bigint":return`${s("\u5DE8\u5927\u6574\u6570")}${e.value}`;case"string":return`${s("\u6587\u5B57\u5217")}\u300E${e.value}${u}\u300F`;case"word":return`${s("\u5358\u8A9E")}\u300E${e.value}${u}\u300F`;case"func":return`${s("\u95A2\u6570")}\u300E${e.name||e.value}${u}\u300F`;case"eol":return"\u884C\u306E\u672B\u5C3E";case"eof":return"\u30D5\u30A1\u30A4\u30EB\u306E\u672B\u5C3E";default:{let i=e.name;return i&&(i=e.value),typeof i!="string"&&(i=e.type),`${s("")}\u300E${i}${u}\u300F`}}}};var P=class extends Error{constructor(e,n,r=void 0,o=void 0){let s=`${r||""}${o===void 0?"":`(${o+1}\u884C\u76EE): `}`;n=n.replace(/『main__(.+?)』/g,"\u300E$1\u300F"),super(`[${e}]${s}${n}`),this.name="NakoError",this.type="NakoError",this.tag="["+e+"]",this.positionJa=s,this.msg=n}},fe=class extends P{constructor(e,n,r){super("\u30A4\u30F3\u30C7\u30F3\u30C8\u30A8\u30E9\u30FC",e,r,n),this.type="NakoIndentError",this.line=n,this.file=r}},X=class extends P{constructor(e,n,r,o,s){super("\u5B57\u53E5\u89E3\u6790\u30A8\u30E9\u30FC\uFF08\u5185\u90E8\u30A8\u30E9\u30FC\uFF09",e,s,o),this.type="InternalLexerError",this.preprocessedCodeStartOffset=n,this.preprocessedCodeEndOffset=r,this.line=o,this.file=s}},oe=class extends P{constructor(e,n,r,o,s){super("\u5B57\u53E5\u89E3\u6790\u30A8\u30E9\u30FC",e,s,o),this.type="NakoLexerError",this.startOffset=n,this.endOffset=r,this.line=o,this.file=s}},y=class t extends P{static fromNode(e,n,r=void 0){if(!n)return new t(e,void 0,void 0,void 0,void 0);let o=typeof n.startOffset=="number"?n.startOffset:void 0,s=r&&typeof r.endOffset=="number"?r.endOffset:typeof n.endOffset=="number"?n.endOffset:void 0;return new t(e,n.line,o,s,n.file)}constructor(e,n,r,o,s){super("\u6587\u6CD5\u30A8\u30E9\u30FC",e,s,n),this.type="NakoSyntaxError",this.file=s,this.line=n,this.startOffset=r,this.endOffset=o}},se=class t extends P{constructor(e,n){let r="unknown";typeof e=="string"?r=e:e instanceof t||e instanceof P?r=e.msg:e instanceof Error&&(e.name==="Error"?r=e.message:r=`${e.name}: ${e.message}`);let o,s,u;n===void 0?(o=void 0,s=void 0):(u=/^l(-?\d+):(.*)$/.exec(n))?(o=parseInt(u[1]),s=u[2]):(u=/^l(-?\d+)$/.exec(n))?(o=parseInt(u[1]),s="main.nako3"):(o=0,s=n),super("\u5B9F\u884C\u6642\u30A8\u30E9\u30FC",r,s,o),this.type="NakoRuntimeError",this.lineNo=n,this.line=o,this.file=s}},q=class extends P{constructor(e,n,r){super("\u53D6\u308A\u8FBC\u307F\u30A8\u30E9\u30FC",e,n,r),this.file=n,this.line=r}};var Nn=new Map([["\u3082\u3057","\u3082\u3057"],["\u56DE","\u56DE"],["\u56DE\u7E70\u8FD4","\u56DE"],["\u9593","\u9593"],["\u9593\u7E70\u8FD4","\u9593"],["\u7E70\u8FD4","\u7E70\u8FD4"],["\u5897\u7E70\u8FD4","\u5897\u7E70\u8FD4"],["\u6E1B\u7E70\u8FD4","\u6E1B\u7E70\u8FD4"],["\u5F8C\u5224\u5B9A","\u5F8C\u5224\u5B9A"],["\u53CD\u5FA9","\u53CD\u5FA9"],["\u629C","\u629C\u3051\u308B"],["\u7D9A","\u7D9A\u3051\u308B"],["\u623B","\u623B\u308B"],["\u5148","\u5148\u306B"],["\u6B21","\u6B21\u306B"],["\u4EE3\u5165","\u4EE3\u5165"],["\u5B9F\u884C\u901F\u5EA6\u512A\u5148","\u5B9F\u884C\u901F\u5EA6\u512A\u5148"],["\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528","\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528"],["\u5B9A","\u5B9A\u3081\u308B"],["\u9010\u6B21\u5B9F\u884C","\u9010\u6B21\u5B9F\u884C"],["\u6761\u4EF6\u5206\u5C90","\u6761\u4EF6\u5206\u5C90"],["\u5897","\u5897"],["\u6E1B","\u6E1B"],["\u5909\u6570","\u5909\u6570"],["\u5B9A\u6570","\u5B9A\u6570"],["\u30A8\u30E9\u30FC\u76E3\u8996","\u30A8\u30E9\u30FC\u76E3\u8996"],["\u30A8\u30E9\u30FC","\u30A8\u30E9\u30FC"],["\u305D\u308C","word"],["\u305D\u3046","word"],["\u95A2\u6570","def_func"],["\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587"],["\u975E\u540C\u671F\u30E2\u30FC\u30C9","\u975E\u540C\u671F\u30E2\u30FC\u30C9"],["DNCL\u30E2\u30FC\u30C9","DNCL\u30E2\u30FC\u30C9"],["DNCL2\u30E2\u30FC\u30C9","DNCL2\u30E2\u30FC\u30C9"],["\u30E2\u30FC\u30C9\u8A2D\u5B9A","\u30E2\u30FC\u30C9\u8A2D\u5B9A"],["\u53D6\u8FBC","\u53D6\u8FBC"],["\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024","\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024"],["\u53B3\u30C1\u30A7\u30C3\u30AF","\u53B3\u30C1\u30A7\u30C3\u30AF"]]),Ze=Nn;function St(t){let e=t.charCodeAt(0);return t==="	"?4:t===" "||t==="|"?1:t==="\u30FB"||t==="\u3000"||t==="\u23CB"||t==="\u23CC"||e>=9472&&e<=9599||e>=9120&&e<=9135||e>=9144&&e<=9151?2:0}var Te=["\u306B\u3064\u3044\u3066","\u304F\u3089\u3044","\u306A\u306E\u304B","\u307E\u3067\u3092","\u307E\u3067\u306E","\u306B\u3088\u308B","\u3068\u306F","\u304B\u3089","\u307E\u3067","\u3060\u3051","\u3088\u308A","\u307B\u3069","\u306A\u3069","\u3044\u3066","\u3048\u3066","\u304D\u3066","\u3051\u3066","\u3057\u3066","\u3063\u3066","\u306B\u3066","\u307F\u3066","\u3081\u3066","\u306D\u3066","\u3067\u306F","\u306B\u306F","\u3093\u3067","\u305A\u3064","\u306F","\u3092","\u306B","\u3078","\u3067","\u3068","\u304C","\u306E"],Fn=["\u3067\u306A\u3051\u308C\u3070","\u306A\u3051\u308C\u3070","\u306A\u3089\u3070","\u306A\u3089","\u305F\u3089","\u308C\u3070"],Tn=["\u3053\u3068","\u3067\u3042\u308B","\u3067\u3059","\u3057\u307E\u3059","\u3067\u3057\u305F"],Qe={};Fn.forEach(t=>{Te.push(t),Qe[t]=!0});var le={};Tn.forEach(t=>{Te.push(t),le[t]=!0});var Fe=[];for(let t of Te)Fe.push("\u3082\u306E"+t),Fe.push(t);Fe.sort((t,e)=>e.length-t.length);var Cn="^[\\t ]*("+Fe.join("|")+")",pe=new RegExp(Cn),jt=Te;var Ln=/^[\u3005\u4E00-\u9FCF_a-zA-Z0-9ァ-ヶー\u2460-\u24FF\u2776-\u277F\u3251-\u32BF]+/,Ot=/^[ぁ-ん]/,Vn=/^[ぁ-ん]+$/,Dn=/^.+(以上|以下|超|未満)$/,In=/^(かつ|または)/,xt=t=>function(){throw new Error("\u7A81\u7136\u306E\u300E"+t+"\u300F\u304C\u3042\u308A\u307E\u3059\u3002")},$t=/^(円|ドル|元|歩|㎡|坪|度|℃|°|個|つ|本|冊|才|歳|匹|枚|皿|セット|羽|人|件|行|列|機|品|m|mm|cm|km|g|kg|t|b|mb|kb|gb)/,At=/^(px|em|ex|rem|vw|vh|vmin|vmax)/,Mt=[{name:"\u3053\u3053\u307E\u3067",pattern:/^;;;/},{name:"eol",pattern:/^\n/},{name:"eol",pattern:/^;/},{name:"space",pattern:/^(\x20|\x09|・|⎿ |└|｜)+/},{name:"comma",pattern:/^,/},{name:"line_comment",pattern:/^#[^\n]*/},{name:"line_comment",pattern:/^\/\/[^\n]*/},{name:"range_comment",pattern:/^\/\*/,cbParser:Rn},{name:"def_test",pattern:/^●テスト:/},{name:"def_func",pattern:/^●/},{name:"\u2026",pattern:/^…/},{name:"\u2026",pattern:/^\.{2,3}/},{name:"bigint",pattern:/^0[xX][0-9a-fA-F]+(_[0-9a-fA-F]+)*n/,readJosi:!0},{name:"bigint",pattern:/^0[oO][0-7]+(_[0-7]+)*n/,readJosi:!0},{name:"bigint",pattern:/^0[bB][0-1]+(_[0-1]+)*n/,readJosi:!0},{name:"bigint",pattern:/^\d+(_\d+)*?n/,readJosi:!0},{name:"number",pattern:/^0[xX][0-9a-fA-F]+(_[0-9a-fA-F]+)*/,readJosi:!0,cb:he},{name:"number",pattern:/^0[oO][0-7]+(_[0-7]+)*/,readJosi:!0,cb:he},{name:"number",pattern:/^0[bB][0-1]+(_[0-1]+)*/,readJosi:!0,cb:he},{name:"number",pattern:/^\d+(_\d+)*\.(\d+(_\d+)*)?([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:he},{name:"number",pattern:/^\.\d+(_\d+)*([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:he},{name:"number",pattern:/^\d+(_\d+)*([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:he},{name:"\u3053\u3053\u304B\u3089",pattern:/^(ここから),?/},{name:"\u3053\u3053\u307E\u3067",pattern:/^(ここまで|💧)/},{name:"\u3082\u3057",pattern:/^もしも?/},{name:"\u9055\u3048\u3070",pattern:/^違(えば)?/},{name:"shift_r0",pattern:/^>>>/},{name:"shift_r",pattern:/^>>/},{name:"shift_l",pattern:/^<</},{name:"===",pattern:/^===/},{name:"!==",pattern:/^!==/},{name:"gteq",pattern:/^(≧|>=|=>)/},{name:"lteq",pattern:/^(≦|<=|=<)/},{name:"noteq",pattern:/^(≠|<>|!=)/},{name:"\u2190",pattern:/^(←|<--)/},{name:"eq",pattern:/^(==|🟰🟰)/},{name:"eq",pattern:/^(=|🟰)/},{name:"line_comment",pattern:/^(!|💡)(インデント構文|ここまでだるい|DNCLモード|DNCL2モード|DNCL2)[^\n]*/},{name:"not",pattern:/^(!|💡)/},{name:"gt",pattern:/^>/},{name:"lt",pattern:/^</},{name:"and",pattern:/^(かつ|&&|and\s)/},{name:"or",pattern:/^(または|或いは|あるいは|or\s|\|\|)/},{name:"@",pattern:/^@/},{name:"+",pattern:/^\+/},{name:"-",pattern:/^-/},{name:"**",pattern:/^(××|\*\*)/},{name:"*",pattern:/^(×|\*)/},{name:"\xF7\xF7",pattern:/^÷÷/},{name:"\xF7",pattern:/^(÷|\/)/},{name:"%",pattern:/^%/},{name:"^",pattern:/^\^/},{name:"&",pattern:/^&/},{name:"[",pattern:/^\[/},{name:"]",pattern:/^]/,readJosi:!0},{name:"(",pattern:/^\(/},{name:")",pattern:/^\)/,readJosi:!0},{name:"|",pattern:/^\|/},{name:"??",pattern:/^\?\?/},{name:"word",pattern:/^\$\{.+?\}/,cbParser:t=>Bn(t)},{name:"$",pattern:/^(\$|\.)/},{name:"string",pattern:/^🌿/,cbParser:t=>ie("\u{1F33F}","\u{1F33F}",t)},{name:"string_ex",pattern:/^🌴/,cbParser:t=>ie("\u{1F334}","\u{1F334}",t)},{name:"string_ex",pattern:/^「/,cbParser:t=>ie("\u300C","\u300D",t)},{name:"string",pattern:/^『/,cbParser:t=>ie("\u300E","\u300F",t)},{name:"string_ex",pattern:/^“/,cbParser:t=>ie("\u201C","\u201D",t)},{name:"string_ex",pattern:/^"/,cbParser:t=>ie('"','"',t)},{name:"string",pattern:/^'/,cbParser:t=>ie("'","'",t)},{name:"\u300D",pattern:/^」/,cbParser:xt("\u300D")},{name:"\u300F",pattern:/^』/,cbParser:xt("\u300F")},{name:"func",pattern:/^\{関数\},?/},{name:"{",pattern:/^\{/},{name:"}",pattern:/^\}/,readJosi:!0},{name:":",pattern:/^:/},{name:"_eol",pattern:/^_\s*\n/},{name:"dec_lineno",pattern:/^‰/},{name:"word",pattern:/^[\uD800-\uDBFF][\uDC00-\uDFFF][_a-zA-Z0-9]*/,readJosi:!0},{name:"word",pattern:/^[\u1F60-\u1F6F][_a-zA-Z0-9]*/,readJosi:!0},{name:"word",pattern:/^《.+?》/,readJosi:!0},{name:"word",pattern:/^[_a-zA-Z\u3005\u4E00-\u9FCFぁ-んァ-ヶ\u2460-\u24FF\u2776-\u277F\u3251-\u32BF]/,cbParser:Jn}];function Pn(t){return Ot.test(t)?Vn.test(t)?t:t.replace(/[ぁ-ん]+$/g,""):t.replace(/[ぁ-ん]+/g,"")}function Rn(t){let e="",n="",r=0;t=t.substring(2);let o=t.indexOf("*/");o<0?(e=t,t=""):(e=t.substring(0,o),t=t.substring(o+2));for(let s=0;s<e.length;s++)e.charAt(s)===`
`&&r++;return e=e.replace(/(^\s+|\s+$)/,""),{src:t,res:e,josi:n,numEOL:r}}function Jn(t,e=!0){let n="",r="";for(;t!=="";){if(n.length>0){if(In.exec(t))break;let c=pe.exec(t);if(c){r=c[0].replace(/^\s+/,""),t=t.substring(c[0].length),t.charAt(0)===","&&(t=t.substring(1));break}}let s=Ln.exec(t);if(s){n+=s[0],t=t.substring(s[0].length);continue}if(Ot.test(t)){n+=t.charAt(0),t=t.substring(1);continue}break}/[ぁ-ん]間$/.test(n)&&(t=n.charAt(n.length-1)+t,n=n.slice(0,-1));let o=Dn.exec(n);return o&&(t=o[1]+r+t,r="",n=n.substring(0,n.length-o[1].length)),r.substring(0,2)==="\u3082\u306E"&&(r=r.substring(2)),le[r]&&(r=""),e&&(n=Pn(n)),n===""&&r!==""&&(n=r,r=""),{src:t,res:n,josi:r,numEOL:0}}function ie(t,e,n){let r="",o="",s=0;n=n.substring(t.length);let u=n.indexOf(e);if(u<0)throw r=n,n="",new Error(`\u300E${t}\u300F\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u7D42\u7AEF\u8A18\u53F7\u300E${e}\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002`);if(r=n.substring(0,u),n=n.substring(u+e.length),r.indexOf(t)>=0)throw t==="\u300E"?new Error("\u300C\u300E\u300D\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u4E2D\u306B\u300C\u300E\u300D\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002"):new Error(`\u300E${t}\u300F\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u4E2D\u306B\u300E${t}\u300F\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002`);let i=pe.exec(n);i&&(o=i[0].replace(/^\s+/,""),n=n.substring(i[0].length),n.charAt(0)===","&&(n=n.substring(1))),le[o]&&(o=""),o.substring(0,2)==="\u3082\u306E"&&(o=o.substring(2));for(let c=0;c<r.length;c++)r.charAt(c)===`
`&&s++;return{src:n,res:r,josi:o,numEOL:s}}function Bn(t){let e="",n="",r=0;t=t.substring(2);let o=t.indexOf("}");if(o<0)throw new Error("\u5909\u6570\u540D\u306E\u7D42\u308F\u308A\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002");e=t.substring(0,o),t=t.substring(o+1);let s=pe.exec(t);s&&(n=s[0].replace(/^\s+/,""),t=t.substring(s[0].length),t.charAt(0)===","&&(t=t.substring(1)));for(let u=0;u<e.length;u++)e.charAt(u)===`
`&&r++;if(r>0)throw new Error("\u5909\u6570\u540D\u306B\u6539\u884C\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002");return{src:t,res:e,josi:n,numEOL:r}}function he(t){return Number(t.replace(/_/g,""))}var G=class t{constructor(e){this.logger=e,this.funclist=new Map,this.modList=[],this.result=[],this.modName="main.nako3",this.moduleExport=new Map,this.reservedWords=Array.from(Ze.keys()),this.josiList=jt}setFuncList(e){this.funclist=e}setModuleExport(e){this.moduleExport=e}replaceTokens(e,n,r){if(this.result=e,this.modName=t.filenameToModName(r),t.preDefineFunc(e,this.logger,this.funclist,this.moduleExport),this._replaceWord(this.result),n)if(this.result.length>0){let o=this.result[this.result.length-1];this.result.push({type:"eol",line:o.line,column:0,indent:-1,file:o.file,josi:"",value:"---",startOffset:o.startOffset,endOffset:o.endOffset,rawJosi:""}),this.result.push({type:"eof",line:o.line,indent:-1,column:0,file:o.file,josi:"",value:"",startOffset:o.startOffset,endOffset:o.endOffset,rawJosi:""})}else this.result.push({type:"eol",line:0,column:0,indent:-1,file:"",josi:"",value:"---",startOffset:0,endOffset:0,rawJosi:""}),this.result.push({type:"eof",line:0,column:0,indent:-1,file:"",josi:"",value:"",startOffset:0,endOffset:0,rawJosi:""});return this.result}static preDefineFunc(e,n,r,o){let s=0,u=!1,i=()=>{let c=[],a={};if(e[s].type!=="(")return[];for(s++;e[s];){let _=e[s];if(s++,_.type===")")break;_.type==="func"?u=!0:_.type!=="|"&&_.type!=="comma"&&(u&&(_.funcPointer=!0,u=!1),c.push(_),a[_.value]||(a[_.value]=[]),a[_.value].push(_.josi))}let f=[],l=[],p=[],h={};for(let _ of c)if(!h[_.value]){let g=a[_.value];p.push(g),f.push(_.value),_.funcPointer?l.push(_.value):l.push(null),h[_.value]=!0}return[p,f,l]};for(;s<e.length;){let c=e[s];if(c.type==="not"&&e.length-s>3){let m={type:"eol"};if(s>=1&&(m=e[s-1]),m.type==="eol"){let k=e[s+1];if(k.type==="word"&&k.value==="\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024"){if(k.type="\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024",k=e[s+2],k.type==="string"&&k.value==="\u975E\u516C\u958B"){let A=t.filenameToModName(c.file);o.set(A,!1),s+=3;continue}else if(k.type==="string"&&k.value==="\u516C\u958B"){let A=t.filenameToModName(c.file);o.set(A,!0),s+=3;continue}}}}if(c.type==="word"&&c.josi==="\u306B\u306F"){c.josi="\u306B\u306F",e.splice(s+1,0,{type:"def_func",value:"\u95A2\u6570",indent:c.indent,line:c.line,column:c.column,file:c.file,josi:"",startOffset:c.endOffset,endOffset:c.endOffset,rawJosi:"",tag:"\u7121\u540D\u95A2\u6570"}),s++;continue}if(c.type==="word"&&c.value==="\u6C38\u9060"&&c.josi==="\u306B"){let m=e[s+1];m.value==="\u7E70\u8FD4"&&(m.value="\u9593",m.josi="\u306E"),s++;continue}if(c.type==="word"&&c.josi===""&&c.value.length>=2&&c.value.match(/回$/)){c.value=c.value.substring(0,c.value.length-1),c.endOffset||(c.endOffset=1);let m={type:"\u56DE",value:"\u56DE",indent:c.indent,line:c.line,column:c.column,file:c.file,josi:"",startOffset:c.endOffset-1,endOffset:c.endOffset,rawJosi:""};e.splice(s+1,0,m),c.endOffset--,s++}if(c.type==="word"){let m=Ze.get(c.value);m&&(c.type=m),c.value==="\u305D\u3046"&&(c.value="\u305D\u308C")}if(c.type!=="def_test"&&c.type!=="def_func"){s++;continue}let a=!0,f={type:"eol"};s>=1&&(f=e[s-1]),f.type==="eol"&&(a=!1);let l=c;s++;let p=[],h=[],_=[],g="",b=null,w=null;if(e[s]&&e[s].type==="{"){s++;let m=e[s]&&e[s].type==="word"?e[s].value:"";m==="\u516C\u958B"?w=!0:m==="\u975E\u516C\u958B"?w=!1:m==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?w=!0:n.warn(`\u4E0D\u660E\u306A\u95A2\u6570\u5C5E\u6027\u300E${m}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),s++,e[s]&&e[s].type==="}"&&s++}if(e[s]&&e[s].type==="("&&([p,h,_]=i()),!a&&e[s]&&e[s].type==="word"&&(b=e[s++],g=b.value),p.length===0&&e[s]&&e[s].type==="("&&([p,h,_]=i()),g!==""&&b){if(g=t.filenameToModName(c.file)+"__"+g,r.has(g)){let k=g.replace(/^main__/,"");n.warn(`\u95A2\u6570\u300E${k}\u300F\u306F\u65E2\u306B\u5B9A\u7FA9\u3055\u308C\u3066\u3044\u307E\u3059\u3002`,l)}b.value=g,r.set(g,{type:"func",josi:p,fn:null,asyncFn:!1,isExport:w,varnames:h,funcPointers:_})}let d={type:"func",josi:p,varnames:h,funcPointers:_};l.meta=d}}splitStringEx(e){let n=[],r=e.split(/[{｛]/);n.push(r[0]);for(let o of r.slice(1)){let s=o.replace("\uFF5D","}").indexOf("}");if(s===-1)return null;n.push(o.slice(0,s),o.slice(s+1))}return n}_replaceWord(e){let n=[],r=0,o=!1,s=[],u=()=>r<=0?"eol":e[r-1].type,i=e.length>0?t.filenameToModName(e[0].file):"main";for(;r<e.length;){let c=e[r];if((c.type==="word"||c.type==="func")&&c.value==="\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A"){if(o)throw new X("\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A\u306E\u95A2\u6570\u53C2\u7167\u3092\u53D6\u5F97\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.startOffset===void 0?0:c.startOffset,c.endOffset===void 0?0:c.endOffset,c.line,c.file);s.push(i),i=e[r-1].value}if((c.type==="word"||c.type==="func")&&c.value==="\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7"){if(o)throw new X("\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7\u306E\u95A2\u6570\u53C2\u7167\u3092\u53D6\u5F97\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.startOffset===void 0?0:c.startOffset,c.endOffset===void 0?0:c.endOffset,c.line,c.file);let a=s.pop();a&&(i=a)}if(c.type==="word"&&c.value!=="\u305D\u308C"){let a=c.value;if(a.indexOf("__")<0){let l=`${i}__${a}`,p=this.funclist.get(l);if(p&&p.type==="func"){let h=c;h.type=o?"func_pointer":"func",h.meta=p,h.value=l,o&&(o=!1,e.splice(r-1,1));continue}for(let h of this.modList){let _=`${h}__${a}`,g=this.funclist.get(_),b=this.moduleExport.get(h);if(g&&g.type==="func"&&(g.isExport===!0||g.isExport!==!1&&b!==!1)){let w=c;w.type=o?"func_pointer":"func",w.meta=g,w.value=_,o&&(o=!1,e.splice(r-1,1));break}}}let f=this.funclist.get(a);if(f&&f.type==="func"){let l=c;if(l.type=o?"func_pointer":"func",l.meta=f,o){o=!1,e.splice(r-1,1);continue}}}if(o=!1,c.type==="func"&&c.value==="{\u95A2\u6570}"){r++,o=!0;continue}if(c.type==="-"&&e[r+1]){let a=e[r+1].type;if(a==="number"||a==="bigint"){let f=u();(f==="eol"||K[f]||e[r-1].josi!=="")&&(e.splice(r,1),a==="number"?e[r].value*=-1:e[r].value="-"+e[r].value)}}if(c.josi===void 0&&(c.josi=""),c.josi==="\u306F"){c.rawJosi||(c.rawJosi=c.josi);let a=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"eq",indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:a,endOffset:c.endOffset,josi:"",rawJosi:"",value:void 0}),r+=2,c.josi=c.rawJosi="",c.endOffset=a;continue}if(c.josi==="\u3068\u306F"){c.rawJosi||(c.rawJosi=c.josi);let a=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"\u3068\u306F",indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:a,endOffset:c.endOffset,josi:"",rawJosi:"",value:void 0}),c.josi=c.rawJosi="",c.endOffset=a,r+=2;continue}if(Qe[c.josi]){let a=c.josi==="\u3067\u306A\u3051\u308C\u3070"||c.josi==="\u306A\u3051\u308C\u3070"?"\u3067\u306A\u3051\u308C\u3070":"\u306A\u3089\u3070";c.rawJosi||(c.rawJosi=a);let f=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"\u306A\u3089\u3070",value:a,indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:f,endOffset:c.endOffset,josi:"",rawJosi:""}),c.josi=c.rawJosi="",c.endOffset=f,r+=2;continue}if(c.type==="_eol"){e.splice(r,1);continue}if(c.type==="line_comment"||c.type==="range_comment"){n.push(c.value),e.splice(r,1);continue}c.type==="eol"&&(c.value=n.join("/"),n=[]),r++}}countIndent(e){let n=0;for(let r=0;r<e.length;r++){let o=e.charAt(r),s=St(o);if(s===0)return[n,r];n+=s}return[n,e.length]}tokenize(e,n,r){let o=e.length,s=[],u,i,c=1,a=!1,f=0,l=this.countIndent(e);for(f=l[0],e=e.substring(l[1]),c+=l[1];e!=="";){let p=!1;for(let h of Mt){let _=h.pattern.exec(e);if(!_)continue;let g=h.name;if(p=!0,h.name==="space"){c+=_[0].length,e=e.substring(_[0].length);continue}if(h.cbParser){let m;if(a&&h.name==="word")m=h.cbParser(e,!1);else try{m=h.cbParser(e)}catch(k){throw new oe(k.message,o-e.length,o-e.length+1,n,r)}if(h.name==="string_ex"){let k=this.splitStringEx(m.res);if(k===null)throw new X("\u5C55\u958B\u3042\u308A\u6587\u5B57\u5217\u3067\u5024\u306E\u57CB\u3081\u8FBC\u307F{...}\u304C\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093\u3002",o-e.length,o-m.src.length,n,r);let A=0;for(let N=0;N<k.length;N++){let D=N===k.length-1?m.josi:"";N%2===0?(s.push({type:"string",value:k[N],file:r,josi:D,indent:f,line:n,column:c,preprocessedCodeOffset:o-e.length+A,preprocessedCodeLength:k[N].length+2+D.length}),A+=k[N].length+2):(s.push({type:"&",value:"&",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:o-e.length+A,preprocessedCodeLength:0}),s.push({type:"(",value:"(",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:o-e.length+A,preprocessedCodeLength:0}),s.push({type:"code",value:k[N],josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:o-e.length+A,preprocessedCodeLength:k[N].length}),s.push({type:")",value:")",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:o-e.length+A+k[N].length,preprocessedCodeLength:0}),s.push({type:"&",value:"&",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:o-e.length+A+k[N].length,preprocessedCodeLength:0}),A+=k[N].length)}n+=m.numEOL,c+=e.length-m.src.length,e=m.src,m.numEOL>0&&(c=1);break}u=c,c+=e.length-m.src.length,s.push({type:h.name,value:m.res,josi:m.josi,indent:f,line:n,column:u,file:r,preprocessedCodeOffset:o-e.length,preprocessedCodeLength:e.length-m.src.length}),e=m.src,n+=m.numEOL,m.numEOL>0&&(c=1);break}let b=o-e.length,w=_[0];if(h.cb&&(w=h.cb(w)),u=c,i=n,c+=_[0].length,e=e.substring(_[0].length),(h.name==="eol"&&w===`
`||h.name==="_eol")&&(w=n++,c=1),h.name==="number"){let m=$t.exec(e);m&&(e=e.substring(m[0].length),c+=_[0].length);let k=At.exec(e);k&&(g="string",e=e.substring(k[0].length),c+=_[0].length,w+=k[0])}let d="";if(h.readJosi){let m=pe.exec(e);m&&(c+=m[0].length,d=m[0].replace(/^\s+/,""),e=e.substring(m[0].length),e.charAt(0)===","&&(e=e.substring(1)),le[d]&&(d=""),d.substring(0,2)==="\u3082\u306E"&&(d=d.substring(2)))}switch(g){case"def_test":{a=!0;break}case"eol":{a=!1;break}default:break}if(g==="dec_lineno"){n--;continue}if(s.push({type:g,value:w,indent:f,line:i,column:u,file:r,josi:d,preprocessedCodeOffset:b,preprocessedCodeLength:o-e.length-b}),g==="eol"&&c===1){let m=this.countIndent(e);f=m[0],c+=m[1],e=e.substring(m[1])}break}if(!p)throw new X("\u672A\u77E5\u306E\u8A9E\u53E5: "+e.substring(0,3)+"...",o-e.length,o-o+3,n,r)}return s}static tokensToTypeStr(e,n){return e.map(o=>o.type).join(n)}static filenameToModName(e){if(!e)return"main";if(e=e.replace(/[\\:]/g,"/"),e.indexOf("/")>=0){let n=e.split("/");e=n[n.length-1]}return e=e.replace(/\.nako3?$/,""),e}};var Ce=class extends Ne{parse(e,n){this.reset(),this.tokens=e,this.modName=G.filenameToModName(n),this.modList.push(this.modName);let r=this.startParser();for(this.isModifiedNodes=!1,this._checkAsyncFn(r);this.isModifiedNodes;)this.isModifiedNodes=!1,this._checkAsyncFn(r);return r}startParser(){let e=this.ySentenceList(),n=this.get();if(n&&n.type!=="eof")throw this.logger.debug(`\u69CB\u6587\u89E3\u6790\u3067\u30A8\u30E9\u30FC\u3002${this.nodeToStr(n,{depth:1},!0)}\u306E\u4F7F\u3044\u65B9\u304C\u9593\u9055\u3063\u3066\u3044\u307E\u3059\u3002`,n),y.fromNode(`\u69CB\u6587\u89E3\u6790\u3067\u30A8\u30E9\u30FC\u3002${this.nodeToStr(n,{depth:1},!1)}\u306E\u4F7F\u3044\u65B9\u304C\u9593\u9055\u3063\u3066\u3044\u307E\u3059\u3002`,n);return e}yNop(){return{type:"nop",josi:"",...this.peekSourceMap(),end:this.peekSourceMap()}}ySentenceList(){let e=[],n=-1,r=this.peekSourceMap();for(;!this.isEOF();){let o=this.ySentence();if(!o)break;e.push(o),n<0&&(n=o.line)}if(e.length===0){let o=this.peek()||this.tokens[0];throw this.logger.debug("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557:"+this.nodeToStr(this.peek(),{depth:1},!0),o),y.fromNode("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557:"+this.nodeToStr(this.peek(),{depth:1},!1),o)}return{type:"block",blocks:e,josi:"",...r,end:this.peekSourceMap()}}makeStackBalanceReport(){let e=[];this.stack.forEach(s=>{let u=this.nodeToStr(s,{depth:1},!1);s.josi&&(u+=s.josi),e.push(u)});let n=e.join(","),r="",o=65;for(let s of this.recentlyCalledFunc){r+=" - ";let u=0,i=s.josi;if(i)for(let c of i){let a=String.fromCharCode(o+u);r+=a,c.length===1?r+=c[0]:r+=`(${c.join("|")})`,u++}r+=s.name+`
`}return this.recentlyCalledFunc=[],`\u672A\u89E3\u6C7A\u306E\u5358\u8A9E\u304C\u3042\u308A\u307E\u3059: [${n}]
\u6B21\u306E\u547D\u4EE4\u306E\u53EF\u80FD\u6027\u304C\u3042\u308A\u307E\u3059:
${r}`}yEOL(){let e=this.get();if(!e)return null;if(this.stack.length>0){let n=this.makeStackBalanceReport();throw y.fromNode(n,e)}return this.recentlyCalledFunc=[],{type:"eol",comment:e.value,line:e.line,column:e.column,file:e.file}}ySentence(){let e=this.peekSourceMap();if(this.check("eol"))return this.yEOL();if(this.check("\u3082\u3057"))return this.yIF();if(this.check("\u5F8C\u5224\u5B9A"))return this.yAtohantei();if(this.check("\u30A8\u30E9\u30FC\u76E3\u8996"))return this.yTryExcept();if(this.accept(["\u629C\u3051\u308B"]))return{type:"break",josi:"",...e,end:this.peekSourceMap()};if(this.accept(["\u7D9A\u3051\u308B"]))return{type:"continue",josi:"",...e,end:this.peekSourceMap()};if(this.check("??"))return this.yDebugPrint();if(this.accept(["DNCL\u30E2\u30FC\u30C9"]))return this.yDNCLMode(1);if(this.accept(["DNCL2\u30E2\u30FC\u30C9"]))return this.yDNCLMode(2);if(this.accept(["not","string","\u30E2\u30FC\u30C9\u8A2D\u5B9A"]))return this.ySetGenMode(this.y[1].value);if(this.accept(["not","\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024","eq","string"]))return this.yExportDefault(this.y[3].value);if(this.accept(["not","\u53B3\u30C1\u30A7\u30C3\u30AF"]))return this.ySetMode("\u53B3\u3057\u304F\u30C1\u30A7\u30C3\u30AF");if(this.check("\u9010\u6B21\u5B9F\u884C"))return this.yTikuji();if(this.accept(["not","\u975E\u540C\u671F\u30E2\u30FC\u30C9"]))return this.yASyncMode();if(this.check2(["func","eq"])){let n=this.get()||M();throw y.fromNode(`\u95A2\u6570\u300E${n.value}\u300F\u306B\u4EE3\u5165\u3067\u304D\u307E\u305B\u3093\u3002`,n)}if(this.accept([this.ySpeedMode]))return this.y[0];if(this.accept([this.yPerformanceMonitor]))return this.y[0];if(this.accept([this.yLet]))return this.y[0];if(this.accept([this.yDefTest]))return this.y[0];if(this.accept([this.yDefFunc]))return this.y[0];if(this.accept([this.yCall])){let n=this.y[0],r=this.peek();if(r&&r.type==="\u306A\u3089\u3070"){let o=this.peekSourceMap(),s=n;return this.get(),this.yIfThen(s,o)}else if(ae.indexOf(n.josi||"")>=0){if(this.stack.length>=1){let s=this.makeStackBalanceReport();throw y.fromNode(s,n)}let o=this.ySentence();if(o!==null)return{type:"block",blocks:[n,o],josi:o.josi,...e,end:this.peekSourceMap()}}return n}return null}yASyncMode(){return this.logger.error("\u300E\u975E\u540C\u671F\u30E2\u30FC\u30C9\u300F\u69CB\u6587\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F(https://nadesi.com/v3/doc/go.php?1028)\u3002",this.peek()),{type:"eol",...this.peekSourceMap(),end:this.peekSourceMap()}}yDNCLMode(e){let n=this.peekSourceMap();return e===1&&(this.arrayIndexFrom=1,this.flagReverseArrayIndex=!0),this.flagCheckArrayInit=!0,{type:"eol",...n,end:this.peekSourceMap()}}ySetGenMode(e){let n=this.peekSourceMap();return this.genMode=e,{type:"eol",...n,end:this.peekSourceMap()}}yExportDefault(e){let n=this.peekSourceMap();return this.isExportDefault=e==="\u516C\u958B",this.moduleExport.set(this.modName,this.isExportDefault),{type:"eol",...n,end:this.peekSourceMap()}}ySetMode(e){let n=this.peekSourceMap();return{type:"run_mode",value:e,...n,end:this.peekSourceMap()}}yBlock(){let e=this.peekSourceMap(),n=[];for(this.check("\u3053\u3053\u304B\u3089")&&this.get();!this.isEOF()&&!(this.checkTypes(["\u9055\u3048\u3070","\u3053\u3053\u307E\u3067","\u30A8\u30E9\u30FC"])||!this.accept([this.ySentence]));)n.push(this.y[0]);return{type:"block",blocks:n,josi:"",...e,end:this.peekSourceMap()}}yDefFuncReadArgs(){if(!this.check("("))return null;let e=[];for(this.get();!this.isEOF();){if(this.check(")")){this.get();break}let n=this.get();n&&e.push(n),this.check("comma")&&this.get()}return e}yDefTest(){return this.yDefFuncCommon("def_test")}yDefFunc(){return this.yDefFuncCommon("def_func")}yDefFuncCommon(e){if(!this.check(e))return null;let n=this.peekSourceMap(),r=this.get();if(!r)return null;let o=r,s=this.isExportDefault;if(this.check("{")){this.get();let p=this.get();if(this.check("}"))this.get();else throw y.fromNode("\u95A2\u6570\u306E\u5C5E\u6027\u306E\u6307\u5B9A\u304C\u6B63\u3057\u304F\u3042\u308A\u307E\u305B\u3093\u3002\u300E{\u300F\u3068\u300E}\u300F\u3067\u56F2\u3080\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002",o);p!=null&&(p.value==="\u516C\u958B"&&(s=!0),p.value==="\u975E\u516C\u958B"&&(s=!1),p.value==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"&&(s=!0))}let u=[];this.check("(")&&(u=this.yDefFuncReadArgs()||[]);let i=this.get();if(!i||i.type!=="func")throw this.logger.debug(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!0)+"\u306E\u5BA3\u8A00\u3067\u30A8\u30E9\u30FC\u3002",i),y.fromNode(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!1)+"\u306E\u5BA3\u8A00\u3067\u30A8\u30E9\u30FC\u3002",o);if(this.check("(")){if(u.length>0)throw this.logger.debug(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!0)+"\u306E\u5BA3\u8A00\u3067\u3001\u5F15\u6570\u5B9A\u7FA9\u306F\u540D\u524D\u306E\u524D\u304B\u5F8C\u306B\u4E00\u5EA6\u3060\u3051\u53EF\u80FD\u3067\u3059\u3002",i),y.fromNode(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!1)+"\u306E\u5BA3\u8A00\u3067\u3001\u5F15\u6570\u5B9A\u7FA9\u306F\u540D\u524D\u306E\u524D\u304B\u5F8C\u306B\u4E00\u5EA6\u3060\u3051\u53EF\u80FD\u3067\u3059\u3002",i);u=this.yDefFuncReadArgs()||[]}this.check("\u3068\u306F")&&this.get();let c=this.yNop(),a=!1,f=!1;this.check("\u3053\u3053\u304B\u3089")&&(a=!0),this.check("eol")&&(a=!0);try{this.funcLevel++,this.usedAsyncFn=!1;let p=this.localvars;if(this.localvars=new Map([["\u305D\u308C",{type:"var",value:""}]]),a){this.saveStack();for(let h of u){if(!h||!h.value)continue;let _=h.value;this.localvars.set(_,{type:"var",value:""})}if(c=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u95A2\u6570\u5B9A\u7FA9\u306E\u672B\u5C3E\u306B\u5FC5\u8981\u3067\u3059\u3002",o);this.loadStack()}else this.saveStack(),c=this.ySentence()||this.yNop(),this.loadStack();this.funcLevel--,f=this.usedAsyncFn,this.localvars=p}catch(p){throw this.logger.debug(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!0)+`\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3057\u305F\u3002
`+p.message,o),y.fromNode(this.nodeToStr(i,{depth:0,typeName:"\u95A2\u6570"},!1)+`\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3057\u305F\u3002
`+p.message,o)}let l=this.funclist.get(i.value);return l&&!l.asyncFn&&f&&(l.asyncFn=f),{type:e,name:i.value,args:u,blocks:[c],asyncFn:f,isExport:s,josi:"",meta:o.meta,...n,end:this.peekSourceMap()}}yIFCond(){let e=this.peekSourceMap(),n=this.yGetArg();if(!n)throw y.fromNode("\u300C\u3082\u3057\u300D\u6587\u306E\u6761\u4EF6\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);if(n.josi==="\u306A\u3089\u3070")return n;if(n.josi==="\u3067\u306A\u3051\u308C\u3070")return n={type:"not",operator:"not",blocks:[n],josi:"",...e,end:this.peekSourceMap()},n;if(n.josi!==""&&this.check("func"))this.stack.push(n),n=this.yCall();else if(n.josi==="\u304C"){let o=this.index,s=this.yGetArg();if(!s)throw y.fromNode("\u3082\u3057\u6587\u306E\u6761\u4EF6\u300CA\u304CB\u306A\u3089\u3070\u300D\u3067B\u304C\u306A\u3044\u304B\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);if(this.check("\u306A\u3089\u3070")){let u=this.get()||{value:"\u306A\u3089\u3070"};s.josi=u.value}if(s&&(s.josi==="\u306A\u3089\u3070"||s.josi==="\u3067\u306A\u3051\u308C\u3070"))return{type:"op",operator:s.josi==="\u3067\u306A\u3051\u308C\u3070"?"noteq":"eq",blocks:[n,s],josi:"",...e,end:this.peekSourceMap()};this.index=o}if(this.check("\u306A\u3089\u3070")||(this.stack.push(n),n=this.yCall()),!this.check("\u306A\u3089\u3070")){let o=n||this.yNop();throw this.logger.debug("\u3082\u3057\u6587\u3067\u300E\u306A\u3089\u3070\u300F\u304C\u306A\u3044\u304B\u3001\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1)+"\u306E\u76F4\u524D\u306B\u300E\u306A\u3089\u3070\u300F\u3092\u66F8\u3044\u3066\u304F\u3060\u3055\u3044\u3002",o),y.fromNode("\u3082\u3057\u6587\u3067\u300E\u306A\u3089\u3070\u300F\u304C\u306A\u3044\u304B\u3001\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1)+"\u306E\u76F4\u524D\u306B\u300E\u306A\u3089\u3070\u300F\u3092\u66F8\u3044\u3066\u304F\u3060\u3055\u3044\u3002",o)}let r=this.get();if(r&&r.value==="\u3067\u306A\u3051\u308C\u3070"&&(n={type:"not",operator:"not",blocks:[n],josi:"",...e,end:this.peekSourceMap()}),!n)throw y.fromNode("\u300C\u3082\u3057\u300D\u6587\u306E\u6761\u4EF6\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);return n}yIF(){let e=this.peekSourceMap();if(!this.check("\u3082\u3057"))return null;let n=this.get();if(n==null)return null;for(;this.check("comma");)this.get();let r=null;try{r=this.yIFCond()}catch(o){throw y.fromNode(`\u300E\u3082\u3057\u300F\u6587\u306E\u6761\u4EF6\u3067\u6B21\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3059\u3002
`+o.message,n)}return this.yIfThen(r,e)}yIfThen(e,n){let r=this.yNop(),o=this.yNop(),s=!1;if(this.check("eol"))r=this.yBlock();else{let u=this.ySentence();u&&(r=u),s=!0}for(;this.check("eol");)this.get();if(this.check("\u9055\u3048\u3070")){for(this.get();this.check("comma");)this.get();if(this.check("eol"))o=this.yBlock();else{let u=this.ySentence();u&&(o=u),s=!0}}if(s===!1)if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3082\u3057\u300F\u6587\u3067\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n);return{type:"if",blocks:[e,r,o],josi:"",...n,end:this.peekSourceMap()}}ySpeedMode(){let e=this.peekSourceMap();if(!this.check2(["string","\u5B9F\u884C\u901F\u5EA6\u512A\u5148"]))return null;let n=this.get();this.get();let r="";if(n&&n.value)r=n.value;else return null;let o={\u884C\u756A\u53F7\u7121\u3057:!1,\u6697\u9ED9\u306E\u578B\u5909\u63DB\u7121\u3057:!1,\u5F37\u5236\u30D4\u30E5\u30A2:!1,\u305D\u308C\u7121\u52B9:!1};for(let i of r.split("/")){if(i==="\u5168\u3066"){for(let c of Object.keys(o))o[c]=!0;break}Object.keys(o).includes(i)?o[i]=!0:this.logger.warn(`\u5B9F\u884C\u901F\u5EA6\u512A\u5148\u6587\u306E\u30AA\u30D7\u30B7\u30E7\u30F3\u300E${i}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,n)}let s=!1;this.check("\u3053\u3053\u304B\u3089")?(this.get(),s=!0):this.check("eol")&&(s=!0);let u=this.yNop();return s?(u=this.yBlock(),this.check("\u3053\u3053\u307E\u3067")&&this.get()):u=this.ySentence()||u,{type:"speed_mode",options:o,blocks:[u],josi:"",...e}}yPerformanceMonitor(){let e=this.peekSourceMap();if(!this.check2(["string","\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528"]))return null;let n=this.get();if(!n)return null;this.get();let r={\u30E6\u30FC\u30B6\u95A2\u6570:!1,\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u672C\u4F53:!1,\u30B7\u30B9\u30C6\u30E0\u95A2\u6570:!1};for(let u of n.value.split("/")){if(u==="\u5168\u3066"){for(let i of Object.keys(r))r[i]=!0;break}Object.keys(r).includes(u)?r[u]=!0:this.logger.warn(`\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528\u6587\u306E\u30AA\u30D7\u30B7\u30E7\u30F3\u300E${u}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,n)}let o=!1;this.check("\u3053\u3053\u304B\u3089")?(this.get(),o=!0):this.check("eol")&&(o=!0);let s=this.yNop();return o?(s=this.yBlock(),this.check("\u3053\u3053\u307E\u3067")&&this.get()):s=this.ySentence()||s,{type:"performance_monitor",options:r,blocks:[s],josi:"",...e}}yTikuji(){if(!this.check("\u9010\u6B21\u5B9F\u884C"))return null;let e=this.getCur();return this.logger.error("\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F(https://nadesi.com/v3/doc/go.php?944)\u3002",e),{type:"eol",...this.peekSourceMap(),end:this.peekSourceMap()}}yGetArgOperator(e){let n=[e];for(;!this.isEOF();){let r=this.peek();if(r&&K[r.type]){r=this.getCur(),n.push(r);let o=this.yValue();if(o===null)throw y.fromNode(`\u8A08\u7B97\u5F0F\u3067\u6F14\u7B97\u5B50\u300E${r.value}\u300F\u5F8C\u306B\u5024\u304C\u3042\u308A\u307E\u305B\u3093`,e);n.push(o);continue}break}return n.length===0?null:n.length===1?n[0]:this.infixToAST(n)}yRange(e){if(!this.check("\u2026"))return null;let n=this.peekSourceMap();this.get();let r=this.yValue();if(!e||!r)throw y.fromNode("\u7BC4\u56F2\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u6307\u5B9A\u30A8\u30E9\u30FC\u3002\u300EA\u2026B\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let o=this.funclist.get("\u7BC4\u56F2");if(!o)throw new Error("\u95A2\u6570\u300E\u7BC4\u56F2\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002plugin_system\u3092\u30B7\u30B9\u30C6\u30E0\u306B\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return{type:"func",name:"\u7BC4\u56F2",blocks:[e,r],josi:r.josi,meta:o,asyncFn:!1,...n,end:this.peekSourceMap()}}yDebugPrint(){let e=this.peekSourceMap(),n=this.get();if(!n||n.value!=="??")throw y.fromNode("\u300E??\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);let r=this.yGetArg();if(!r)throw y.fromNode("\u300E??(\u8A08\u7B97\u5F0F)\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);let o=this.funclist.get("\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C");if(!o)throw new Error("\u95A2\u6570\u300E\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002plugin_system\u3092\u30B7\u30B9\u30C6\u30E0\u306B\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return{type:"func",name:"\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C",blocks:[r],josi:"",meta:o,asyncFn:!1,...e,end:this.peekSourceMap()}}yGetArg(){let e=this.yValue();return e===null?null:this.check("\u2026")?this.yRange(e):this.yGetArgOperator(e)}infixToPolish(e){let n=s=>K[s.type]?K[s.type]:10,r=[],o=[];for(;e.length>0;){let s=e.shift();if(!s)break;for(;r.length>0;){let u=r[r.length-1];if(n(s)>n(u))break;let i=r.pop();if(!i){this.logger.error("\u8A08\u7B97\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002",s);break}o.push(i)}r.push(s)}for(;r.length>0;){let s=r.pop();s&&o.push(s)}return o}infixToAST(e){if(e.length===0)return null;let n=e[e.length-1].josi,r=e[e.length-1],o=this.infixToPolish(e),s=[];for(let i of o){if(!K[i.type]){s.push(i);continue}let c=s.pop(),a=s.pop();if(a===void 0||c===void 0)throw this.logger.debug(`--- \u8A08\u7B97\u5F0F(\u9006\u30DD\u30FC\u30E9\u30F3\u30C9) ---
`+JSON.stringify(o)),y.fromNode("\u8A08\u7B97\u5F0F\u3067\u30A8\u30E9\u30FC",r);let f={type:"op",operator:i.type,blocks:[a,c],josi:n,startOffset:a.startOffset,endOffset:a.endOffset,line:a.line,column:a.column,file:a.file};s.push(f)}let u=s.pop();return u||null}yGetArgParen(e){let n=!1,r=this.stack.length;for(;!this.isEOF();){if(this.check(")")){n=!0;break}let s=this.yGetArg();if(s){this.pushStack(s),this.check("comma")&&this.get();continue}break}if(!n)throw y.fromNode(`C\u98A8\u95A2\u6570\u300E${e[0].value}\u300F\u3067\u30AB\u30C3\u30B3\u304C\u9589\u3058\u3066\u3044\u307E\u305B\u3093`,e[0]);let o=[];for(;r<this.stack.length;){let s=this.popStack();s&&o.unshift(s)}return o}yRepeatTime(){let e=this.peekSourceMap();if(!this.check("\u56DE"))return null;this.get(),this.check("comma")&&this.get(),this.check("\u7E70\u8FD4")&&this.get();let n=this.popStack([])||{type:"word",value:"\u305D\u308C",josi:"",...e,end:this.peekSourceMap()},r=!1,o=this.yNop();if(this.check("comma")&&this.get(),this.check("\u3053\u3053\u304B\u3089")?(this.get(),r=!0):this.check("eol")&&(r=!0),r)if(o=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u56DE\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);else{let s=this.ySentence();s&&(o=s)}return{type:"repeat_times",blocks:[n,o],josi:"",...e,end:this.peekSourceMap()}}yWhile(){let e=this.peekSourceMap();if(!this.check("\u9593"))return null;for(this.get();this.check("comma");)this.get();this.check("\u7E70\u8FD4")&&this.get();let n=this.popStack();if(n===null)throw y.fromNode("\u300E\u9593\u300F\u3067\u6761\u4EF6\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);if(this.check("comma")&&this.get(),!this.checkTypes(["\u3053\u3053\u304B\u3089","eol"]))throw y.fromNode("\u300E\u9593\u300F\u306E\u76F4\u5F8C\u306F\u6539\u884C\u304C\u5FC5\u8981\u3067\u3059",e);let r=this.yBlock();if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u9593\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"while",blocks:[n,r],josi:"",...e,end:this.peekSourceMap()}}yAtohantei(){let e=this.peekSourceMap();this.check("\u5F8C\u5224\u5B9A")&&this.get(),this.check("\u7E70\u8FD4")&&this.get(),this.check("\u3053\u3053\u304B\u3089")&&this.get();let n=this.yBlock();this.check("\u3053\u3053\u307E\u3067")&&this.get(),this.check("comma")&&this.get();let r=this.yGetArg(),o=!1,s=this.peek();return s&&s.value==="\u306A\u308B"&&(s.josi==="\u307E\u3067"||s.josi==="\u307E\u3067\u306E")&&(this.get(),o=!0),this.check("\u9593")&&this.get(),o&&(r={type:"not",operator:"not",blocks:[r],josi:"",...e,end:this.peekSourceMap()}),r||(r={type:"number",value:1,josi:"",...e,end:this.peekSourceMap()}),{type:"atohantei",blocks:[r,n],josi:"",...e,end:this.peekSourceMap()}}yFor(){let e="\u300E\u7E70\u308A\u8FD4\u3059\u300F\u6587\u3067A\u304B\u3089B\u307E\u3067\u306E\u6307\u5B9A\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n=!0,r=!0,o=null,s=this.peekSourceMap();if(!(this.check("\u7E70\u8FD4")||this.check("\u5897\u7E70\u8FD4")||this.check("\u6E1B\u7E70\u8FD4")))return null;let u=this.getCur(),i=this.stack.pop();if(i)if(i.type==="word"&&(i.value==="\u5897"||i.value==="\u6E1B")){i.value==="\u5897"?n=!1:r=!1;let g=i.value+u.type;if(g=="\u5897\u7E70\u8FD4")u.type="\u5897\u7E70\u8FD4";else if(g=="\u6E1B\u7E70\u8FD4")u.type="\u6E1B\u7E70\u8FD4";else throw Error("[System Error] \u5897\u7E70\u308A\u8FD4\u3057 | \u6E1B\u7E70\u308A\u8FD4\u3057\u306E\u30A8\u30E9\u30FC\u3002")}else this.stack.push(i);let c=this.yNop();(u.type==="\u5897\u7E70\u8FD4"||u.type==="\u6E1B\u7E70\u8FD4")&&(c=this.popStack(["\u305A\u3064"])||this.yNop(),u.type==="\u5897\u7E70\u8FD4"?n=!1:r=!1,o=u.type==="\u5897\u7E70\u8FD4"?"up":"down");let a=this.popStack(["\u307E\u3067","\u3092"]),f=this.popStack(["\u304B\u3089"])||this.yNop(),l=this.popStack(["\u3092","\u3067"]),p="";if(l!==null){if(l.type!=="word")throw y.fromNode("\u300E(\u5909\u6570\u540D)\u3092A\u304B\u3089B\u307E\u3067\u7E70\u308A\u8FD4\u3059\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",l);p=l.value}if((f===null||a===null)&&!(f==null&&a&&a.type==="func"&&a.name==="\u7BC4\u56F2"))throw y.fromNode(e,u);this.check("comma")&&this.get();let h=!1;this.check("\u3053\u3053\u304B\u3089")?(h=!0,this.get()):this.check("eol")&&(h=!0,this.get());let _=this.yNop();if(h)if(_=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u7E70\u308A\u8FD4\u3059\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",s);else{let g=this.ySentence();g&&(_=g)}return _||(_=this.yNop()),{type:"for",blocks:[f,a,c,_],flagDown:n,flagUp:r,loopDirection:o,word:p,josi:"",...s,end:this.peekSourceMap()}}yReturn(){let e=this.peekSourceMap();if(!this.check("\u623B\u308B"))return null;this.get();let n=this.popStack(["\u3067","\u3092"])||this.yNop();if(this.stack.length>0)throw y.fromNode("\u300E\u623B\u300F\u6587\u306E\u76F4\u524D\u306B\u672A\u89E3\u6C7A\u306E\u5F15\u6570\u304C\u3042\u308A\u307E\u3059\u3002\u300E(\u5F0F)\u3092\u623B\u3059\u300F\u306E\u3088\u3046\u306B\u5F0F\u3092\u30AB\u30C3\u30B3\u3067\u62EC\u3063\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"return",blocks:[n],josi:"",...e,end:this.peekSourceMap()}}yForEach(){let e=this.peekSourceMap();if(!this.check("\u53CD\u5FA9"))return null;for(this.get();this.check("comma");)this.get();let n=this.popStack(["\u3092"])||this.yNop(),r=this.popStack(["\u3067"]),o="";if(r!==null){if(r.type!=="word")throw y.fromNode("\u300E(\u5909\u6570\u540D)\u3067(\u914D\u5217)\u3092\u53CD\u5FA9\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);o=r.value}let s=this.yNop(),u=!1;if(this.check("\u3053\u3053\u304B\u3089")?(u=!0,this.get()):this.check("eol")&&(u=!0),u)if(s=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u53CD\u5FA9\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);else{let i=this.ySentence();i&&(s=i)}return{type:"foreach",word:o,blocks:[n,s],josi:"",...e,end:this.peekSourceMap()}}ySwitch(){let e=this.peekSourceMap();if(!this.check("\u6761\u4EF6\u5206\u5C90"))return null;let n=this.get();if(!n)return null;let r=this.get();if(!r)return null;let o=this.popStack(["\u3067"]);if(!o)throw y.fromNode("\u300E(\u5024)\u3067\u6761\u4EF6\u5206\u5C90\u300F\u306E\u3088\u3046\u306B\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);if(r.type!=="eol")throw y.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u306E\u76F4\u5F8C\u306F\u6539\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let s=[];for(s[0]=o,s[1]=this.yNop();!this.isEOF();){if(this.check("eol")){this.get();continue}if(this.check("\u3053\u3053\u307E\u3067")){this.get();break}let i=this.peek();if(i&&i.type==="\u9055\u3048\u3070"){this.get(),this.check("comma")&&this.get();let p=this.yBlock();for(this.check("\u3053\u3053\u307E\u3067")&&this.get();this.check("eol");)this.get();this.check("\u3053\u3053\u307E\u3067")&&this.get(),s[1]=p;break}let c=this.yValue();if(!c)throw y.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u306F\u300E(\u6761\u4EF6)\u306A\u3089\u3070\u301C\u3053\u3053\u307E\u3067\u300F\u3068\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let a=this.get();if(!a||a.type!=="\u306A\u3089\u3070")throw y.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u3067\u6761\u4EF6\u306F\uFF0A\uFF0A\u306A\u3089\u3070\u3068\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);this.check("comma")&&this.get();let f=this.yBlock(),l=this.peek();l&&l.type==="\u3053\u3053\u307E\u3067"&&this.get(),s.push(c),s.push(f)}return{type:"switch",blocks:s,case_count:s.length/2-1,josi:"",...e,end:this.peekSourceMap()}}yMumeiFunc(){let e=this.peekSourceMap();if(!this.check("def_func"))return null;let n=this.get();if(!n)return null;let r=n,o=[];this.check("comma")&&this.get(),this.check("(")&&(o=this.yDefFuncReadArgs()||[]),this.check("comma")&&this.get(),this.funcLevel++,this.saveStack();let s=this.usedAsyncFn;this.usedAsyncFn=!1;let u=this.yBlock(),i=this.usedAsyncFn;if(!this.check("\u3053\u3053\u307E\u3067"))throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u306B\u306F\u300F\u69CB\u6587\u304B\u7121\u540D\u95A2\u6570\u306E\u672B\u5C3E\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u5FC5\u8981\u3067\u3059\u3002",e);return this.get(),this.loadStack(),this.usedAsyncFn=s,this.funcLevel--,{type:"func_obj",name:"",args:o,blocks:[u],meta:r.meta,josi:"",isExport:!1,asyncFn:i,...e,end:this.peekSourceMap()}}yDainyu(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;let r=this.popStack(["\u3092"])||{type:"word",value:"\u305D\u308C",josi:"\u3092",...e},o=this.popStack(["\u3078","\u306B"]);if(!o||o.type!=="word"&&o.type!=="func"&&o.type!=="ref_array")throw y.fromNode("\u4EE3\u5165\u6587\u3067\u4EE3\u5165\u5148\u306E\u5909\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5909\u6570\u540D)\u306B(\u5024)\u3092\u4EE3\u5165\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002",n);if(o.type==="ref_array"){let u=o.index||[],i=[r,...u];return{type:"let_array",name:o.name.value,indexes:o.index,blocks:i,josi:"",checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return{type:"let",name:this.getVarName(o).value,blocks:[r],josi:"",...e,end:this.peekSourceMap()}}ySadameru(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;let r=this.popStack(["\u3092"])||{type:"word",value:"\u305D\u308C",josi:"\u3092",...e,end:this.peekSourceMap()};if(!r||r.type!=="word"&&r.type!=="func"&&r.type!=="ref_array")throw y.fromNode("\u300E\u5B9A\u3081\u308B\u300F\u6587\u3067\u5B9A\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5B9A\u6570\u540D)\u3092(\u5024)\u306B\u5B9A\u3081\u308B\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002",n);let o=this.popStack(["\u3078","\u306B","\u3068"])||this.yNop(),s=this.isExportDefault;if(this.check2(["{","word","}"])){this.get();let i=this.get();if(i===null)throw y.fromNode("\u5B9A\u3081\u308B\u300E"+r.value+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",r);let c=i.value;c==="\u516C\u958B"?s=!0:c==="\u975E\u516C\u958B"?s=!1:c==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?s=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${c}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),this.get()}return{type:"def_local_var",name:this.createVar(r,!0,s).value,vartype:"\u5B9A\u6570",isExport:s,blocks:[o],josi:"",...e,end:this.peekSourceMap()}}yIncDec(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;if(this.check("\u7E70\u8FD4"))return this.pushStack({type:"word",value:n.value,josi:n.josi,...e,end:this.peekSourceMap()}),this.yFor();let r=this.popStack(["\u3060\u3051",""]);r||(r={type:"number",value:1,josi:"\u3060\u3051",...e,end:this.peekSourceMap()});let o=this.popStack(["\u3092"]);if(!o||o.type!=="word"&&o.type!=="ref_array")throw y.fromNode(`\u300E${n.type}\u300F\u6587\u3067\u5B9A\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5909\u6570\u540D)\u3092(\u5024)\u3060\u3051${n.type}\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002`,n);if(n.value==="\u6E1B"){let s={type:"number",value:-1,line:n.line};r={type:"op",operator:"*",blocks:[r,s],josi:"",...e}}return{type:"inc",name:o,blocks:[r],josi:n.josi,...e,end:this.peekSourceMap()}}yCall(){if(this.isEOF())return null;for(;!this.isEOF();){if(this.check("\u3053\u3053\u304B\u3089")&&this.get(),this.check("\u4EE3\u5165"))return this.yDainyu();if(this.check("\u5B9A\u3081\u308B"))return this.ySadameru();if(this.check("\u56DE"))return this.yRepeatTime();if(this.check("\u9593"))return this.yWhile();if(this.check("\u7E70\u8FD4")||this.check("\u5897\u7E70\u8FD4")||this.check("\u6E1B\u7E70\u8FD4"))return this.yFor();if(this.check("\u53CD\u5FA9"))return this.yForEach();if(this.check("\u6761\u4EF6\u5206\u5C90"))return this.ySwitch();if(this.check("\u623B\u308B"))return this.yReturn();if(this.check("\u5897")||this.check("\u6E1B"))return this.yIncDec();if(this.check2([["func","word"],"("])){let n=this.peek();if(n&&n.josi===""){let r=this.yValue();if(r){let o=r.josi||"";if(r.type==="func"&&(r.josi===""||ae.indexOf(o)>=0))return r.josi="",r;this.pushStack(r)}this.check("comma")&&this.get();continue}}if(this.check("func")){let n=this.yCallFunc();if(n===null)continue;if(this.check("\u9593")){this.pushStack(n);continue}if(!this.checkTypes(Ee))return n;let r=this.yGetArgOperator(n);this.pushStack(r);continue}let e=this.yGetArg();if(e){this.pushStack(e);continue}break}if(this.stack.length>0){if(this.isReadingCalc)return this.popStack();this.logger.debug(`--- stack dump ---
`+JSON.stringify(this.stack,null,2)+`
peek: `+JSON.stringify(this.peek(),null,2));let e=`\u4E0D\u5B8C\u5168\u306A\u6587\u3067\u3059\u3002${this.stack.map(s=>this.nodeToStr(s,{depth:0},!0)).join("\u3001")}\u304C\u89E3\u6C7A\u3057\u3066\u3044\u307E\u305B\u3093\u3002`,n=`\u4E0D\u5B8C\u5168\u306A\u6587\u3067\u3059\u3002${this.stack.map(s=>this.nodeToStr(s,{depth:0},!1)).join("\u3001")}\u304C\u89E3\u6C7A\u3057\u3066\u3044\u307E\u305B\u3093\u3002`;for(let s of this.stack){let u=this.nodeToStr(s,{depth:0},!1),i=this.nodeToStr(s,{depth:1},!1);u!==i&&(e+=`${this.nodeToStr(s,{depth:0},!0)}\u306F${this.nodeToStr(s,{depth:1},!0)}\u3068\u3057\u3066\u4F7F\u308F\u308C\u3066\u3044\u307E\u3059\u3002`,n+=`${u}\u306F${i}\u3068\u3057\u3066\u4F7F\u308F\u308C\u3066\u3044\u307E\u3059\u3002`)}let r=this.stack[0],o=this.stack[this.stack.length-1];throw this.logger.debug(e,r),y.fromNode(n,r,o)}return this.popStack([])}yCallFunc(){let e=this.peekSourceMap(),n=this.get();if(!n)return null;let r=n,o=r.meta,s=r.value,u=null;if(r.josi==="\u306B\u306F"){try{u=this.yMumeiFunc()}catch(l){throw y.fromNode(`\u300E${r.value}\u306B\u306F...\u300F\u3067\u7121\u540D\u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${l.message}`,r)}if(u===null)throw y.fromNode("\u300EF\u306B\u306F\u300F\u69CB\u6587\u304C\u3042\u308A\u307E\u3057\u305F\u304C\u3001\u95A2\u6570\u5B9A\u7FA9\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002",r)}if(!o||typeof o.josi>"u")throw y.fromNode("\u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30A8\u30E9\u30FC\u3002",r);this.recentlyCalledFunc.push({name:s,...o}),o&&o.asyncFn&&(this.usedAsyncFn=!0);let i=[],c=0,a=0;for(let l=o.josi.length-1;l>=0;l--)for(;;){let p=this.popStack(o.josi[l]);if(p!==null)a++;else if(l<o.josi.length-1||!o.isVariableJosi)c++,p=u;else break;if(p!==null&&o.funcPointers!==void 0&&o.funcPointers[l]!==null)if(p.type==="func")p.type="func_pointer";else{let h=o.varnames?o.varnames[l]:`${l+1}\u756A\u76EE\u306E\u5F15\u6570`;throw y.fromNode(`\u95A2\u6570\u300E${r.value}\u300F\u306E\u5F15\u6570\u300E${h}\u300F\u306B\u306F\u95A2\u6570\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304C\u5FC5\u8981\u3067\u3059\u3002`,r)}if(p===null&&(p={type:"word",value:"\u305D\u308C",josi:"",...e,end:e}),i.unshift(p),l<o.josi.length-1||!o.isVariableJosi)break}if(c>=2&&(a>0||r.josi===""||ae.indexOf(r.josi)>=0))throw y.fromNode(`\u95A2\u6570\u300E${r.value}\u300F\u306E\u5F15\u6570\u304C\u4E0D\u8DB3\u3057\u3066\u3044\u307E\u3059\u3002`,r);this.usedFuncs.add(r.value);let f={type:"func",name:r.value,blocks:i,meta:o,josi:r.josi,asyncFn:!!o.asyncFn,...e,end:this.peekSourceMap()};if(f.name==="\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A"){if(i.length>0&&i[0]){let l=""+i[0].value;l==="\u30E1\u30A4\u30F3"&&(l=""+i[0].file),this.namespaceStack.push(this.modName),this.isExportStack.push(this.isExportDefault),this.modName=G.filenameToModName(l),this.modList.push(this.modName)}}else if(f.name==="\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7"){let l=this.namespaceStack.pop();l&&(this.modName=l);let p=this.isExportStack.pop();p!=null&&(this.isExportDefault=p)}return r.josi===""?f:ae.indexOf(r.josi)>=0?(f.josi="\u3057\u3066",f):(f.meta=o,this.pushStack(f),null)}yLet(){let e=this.peekSourceMap();if(this.check2(["word","eq"])){let n=this.peek(),r=!1;try{if(this.accept(["word","eq",this.yCalc])||this.accept(["word","eq",this.ySentence])){if(this.y[2].type==="eol")throw new Error("\u5024\u304C\u7A7A\u3067\u3059\u3002");this.check("comma")&&this.get();let o=this.getVarName(this.y[0]),s=this.y[2];return{type:"let",name:o.value,blocks:[s],josi:"",...e,end:this.peekSourceMap()}}else throw r=!0,this.logger.debug(`${this.nodeToStr(n,{depth:1},!0)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,n),y.fromNode(`${this.nodeToStr(n,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,e)}catch(o){throw r?o:(this.logger.debug(`${this.nodeToStr(n,{depth:1},!0)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u4EE5\u4E0B\u306E\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${o.message}`,n),y.fromNode(`${this.nodeToStr(n,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u4EE5\u4E0B\u306E\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${o.message}`,e))}}if(this.check2(["word","$","*","$","*","$","*","$","*","eq"])||this.check2(["word","$","*","$","*","$","*","eq"])||this.check2(["word","$","*","$","*","eq"])||this.check2(["word","$","*","eq"])){let n=[],r=this.getVarName(this.get());for(;;){let s=this.peek();if(s===null||s.type!=="$")break;this.get(),n.push(this.get())}this.get();let o=this.yCalc();if(o===null)throw y.fromNode(`${this.nodeToStr(r,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u306E\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,e);return{type:"let_prop",name:r.value,index:n,blocks:[o],josi:"",...e,end:this.peekSourceMap()}}if(this.check2(["word","@"])){let n=this.yLetArrayAt(e);if(this.check("comma")&&this.get(),n)return n.checkInit=this.flagCheckArrayInit,n}if(this.check2(["word","["])){let n=this.yLetArrayBracket(e);if(this.check("comma")&&this.get(),n)return n.checkInit=this.flagCheckArrayInit,n}if(this.accept(["word","\u3068\u306F"])){let n=this.y[0];if(!this.checkTypes(["\u5909\u6570","\u5B9A\u6570"]))throw y.fromNode("\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u300E"+n.value+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",n);let r=this.getCur(),o=this.isExportDefault;if(this.check2(["{","word","}"])){this.get();let i=this.get();if(i===null)throw y.fromNode("\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u300E"+n.value+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",n);let c=i.value;c==="\u516C\u958B"?o=!0:c==="\u975E\u516C\u958B"?o=!1:c==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?o=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${c}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),this.get()}let s=this.createVar(n,r.type==="\u5B9A\u6570",o),u=this.yNop();return this.check("eq")&&(this.get(),u=this.yCalc()||u),this.check("comma")&&this.get(),{type:"def_local_var",name:s.value,vartype:r.type,isExport:o,blocks:[u],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570","word"])){let n=this.y[1];if(this.index-=2,this.accept(["\u5909\u6570","word","eq",this.yCalc])){let r=this.createVar(this.y[1],!1,this.isExportDefault),o=this.y[3]||this.yNop();return{type:"def_local_var",name:r.value,vartype:"\u5909\u6570",blocks:[o],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570","word","{","word","}","eq",this.yCalc])){let r=this.isExportDefault,o=this.y[3].value;o==="\u516C\u958B"?r=!0:o==="\u975E\u516C\u958B"?r=!1:o==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?r=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${o}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`);let s=this.createVar(this.y[1],!1,r),u=this.y[6]||this.yNop();return{type:"def_local_var",name:s.value,vartype:"\u5909\u6570",isExport:r,blocks:[u],...e,end:this.peekSourceMap()}}return this.index+=2,{type:"def_local_var",name:this.createVar(n,!1,this.isExportDefault).value,vartype:"\u5909\u6570",blocks:[this.yNop()],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570","word","eq",this.yCalc])){let n=this.createVar(this.y[1],!0,this.isExportDefault),r=this.y[3]||this.yNop();return{type:"def_local_var",name:n.value,vartype:"\u5B9A\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570","word","{","word","}","eq",this.yCalc])){let n=this.isExportDefault,r=this.y[3].value;r==="\u516C\u958B"?n=!0:r==="\u975E\u516C\u958B"?n=!1:r==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?n=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5B9A\u6570\u5C5E\u6027\u300E${r}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`);let o=this.createVar(this.y[1],!0,n),s=this.y[6]||this.yNop();return{type:"def_local_var",name:o.value,vartype:"\u5B9A\u6570",isExport:n,blocks:[s],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570",this.yJSONArray,"eq",this.yCalc])){let n=this.y[1];if(n&&n.blocks instanceof Array){for(let s in n.blocks)if(n.blocks[s].type!=="word")throw y.fromNode(`\u8907\u6570\u5B9A\u6570\u306E\u4EE3\u5165\u6587${s+1}\u756A\u76EE\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5B9A\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,this.y[0])}else throw y.fromNode("\u8907\u6570\u5B9A\u6570\u306E\u4EE3\u5165\u6587\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5B9A\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",this.y[0]);let r=this._tokensToNodes(this.createVarList(n.blocks,!0,this.isExportDefault)),o=this.y[3]||this.yNop();return{type:"def_local_varlist",names:r,vartype:"\u5B9A\u6570",blocks:[o],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570",this.yJSONArray,"eq",this.yCalc])){let n=this.y[1];if(n&&n.blocks instanceof Array){for(let s in n.blocks)if(n.blocks[s].type!=="word")throw y.fromNode(`\u8907\u6570\u5909\u6570\u306E\u4EE3\u5165\u6587${s+1}\u756A\u76EE\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5909\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,this.y[0])}else throw y.fromNode("\u8907\u6570\u5909\u6570\u306E\u4EE3\u5165\u6587\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5909\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",this.y[0]);let r=this._tokensToNodes(this.createVarList(n.blocks,!1,this.isExportDefault)),o=this.y[3]||this.yNop();return{type:"def_local_varlist",names:r,vartype:"\u5909\u6570",blocks:[o],...e,end:this.peekSourceMap()}}if(this.check2(["word","comma","word"])){if(this.accept(["word","comma","word","eq",this.yCalc])){let n=[this.y[0],this.y[2]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.y[4]||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","eq",this.yCalc])){let n=[this.y[0],this.y[2],this.y[4]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.y[6]||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","comma","word","eq",this.yCalc])){let n=[this.y[0],this.y[2],this.y[4],this.y[6]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.y[8]||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","comma","word","comma","word","eq",this.yCalc])){let n=[this.y[0],this.y[2],this.y[4],this.y[6],this.y[8]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.y[10]||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}}return null}checkArrayIndex(e){if(this.arrayIndexFrom===0)return e;let n={...e,type:"number",value:this.arrayIndexFrom};return{...e,type:"op",operator:"-",blocks:[e,n]}}checkArrayReverse(e){return e?!this.flagReverseArrayIndex||e.length<=1?e:e.reverse():[]}yLetArrayAt(e){if(this.accept(["word","@",this.yValue,"eq",this.yCalc])){let n=this.y[4];return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,this.checkArrayIndex(this.y[2])],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"@",this.yValue,"eq",this.yCalc])){let n=this.y[6],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"@",this.yValue,"@",this.yValue,"eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"comma",this.yValue,"eq",this.yCalc])){let n=this.y[6],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"comma",this.yValue,"comma",this.yValue,"eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return null}yLetArrayBracket(e){if(this.accept(["word","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[5],r=[this.checkArrayIndex(this.y[2])];return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"]","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[5])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],tag:"2",checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"comma",this.yCalc,"]","eq",this.yCalc])){let n=this.y[7],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,tag:"2",...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"]","[",this.yCalc,"]","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[11],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[5]),this.checkArrayIndex(this.y[8])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"comma",this.yCalc,"comma",this.yCalc,"]","eq",this.yCalc])){let n=this.y[9],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,index:this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]),blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return null}yCalc(){let e=this.peekSourceMap();if(this.check("eol"))return null;let n=this.yGetArg();if(!n)return null;if(n.josi==="")return n;let r=this.isReadingCalc;this.isReadingCalc=!0,this.pushStack(n);let o=this.yCall();if(this.isReadingCalc=r,!o)return this.popStack();let s=o;if(ae.indexOf(o.josi||"")>=0){let i=this.yCalc();i&&(s={type:"renbun",operator:"renbun",blocks:[o,i],josi:i.josi,...e,end:this.peekSourceMap()})}let u=this.peek();return u&&K[u.type]?this.yGetArgOperator(s):s}yValueKakko(){if(!this.check("("))return null;let e=this.get();if(!e)throw new Error("[System Error] check \u3057\u305F\u306E\u306B get \u3067\u304D\u306A\u3044");this.saveStack();let n=this.yCalc()||this.ySentence();if(n===null){let o=this.get();throw this.logger.debug("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(o,{depth:1},!0)+"\u306E\u8FD1\u304F",e),y.fromNode("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(o,{depth:1},!1)+"\u306E\u8FD1\u304F",e)}if(!this.check(")"))throw this.logger.debug("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(n,{depth:1},!0)+"\u306E\u8FD1\u304F",e),y.fromNode("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(n,{depth:1},!1)+"\u306E\u8FD1\u304F",e);let r=this.get();return this.loadStack(),r&&(n.josi=r.josi),n}yConst(e,n){return{type:e.type,value:e.value,josi:e.josi,...n}}yValue(){let e=this.peekSourceMap();if(this.check("comma")&&this.get(),this.checkTypes(["number","bigint","string"]))return this.yConst(this.getCur(),e);if(this.check("("))return this.yValueKakko();if(this.check2(["-","number"])||this.check2(["-","word"])||this.check2(["-","func"])){let i=this.get(),c=this.yValue(),a=c&&c.josi?c.josi:"",l={type:"number",value:-1,line:i&&i.line?i.line:0},p=c||this.yNop();return{type:"op",operator:"*",blocks:[l,p],josi:a,...e,end:this.peekSourceMap()}}if(this.check("not")){this.get();let i=this.yValue(),c=i&&i.josi?i.josi:"";return{type:"not",operator:"not",blocks:[i],josi:c,...e,end:this.peekSourceMap()}}let n=this.yJSONArray();if(n)return n;let r=this.yJSONObject();if(r)return r;let o=Ee.concat(["eol",")","]","\u306A\u3089\u3070","\u56DE","\u9593","\u53CD\u5FA9","\u6761\u4EF6\u5206\u5C90"]);if(this.check2(["func",o])){let i=this.get();if(!i)throw new Error("[System Error] \u6B63\u3057\u304F\u5024\u304C\u53D6\u308C\u307E\u305B\u3093\u3067\u3057\u305F\u3002");let c=i,a=this.getVarNameRef(c);this.usedFuncs.add(a.value);let f=c.meta,l=[];if(!f)throw y.fromNode(`\u4E00\u8A9E\u95A2\u6570\u300E${a.value}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,c);if(f.josi&&f.josi.length===1)l.push({type:"word",value:"\u305D\u308C"});else if(f.josi&&f.josi.length>=2)throw y.fromNode(`\u95A2\u6570\u300E${a.value}\u300F\u3067\u5F15\u6570\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002${f.josi.length}\u500B\u306E\u5F15\u6570\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,c);return{type:"func",name:a.value,blocks:l,josi:a.josi,meta:f,asyncFn:!!f.asyncFn,...e,end:this.peekSourceMap()}}if(this.check2([["func","word"],"("])&&this.peekDef().josi===""){let i=this.peek();if(this.accept([["func","word"],"(",this.yGetArgParen,")"])){let c=this.getVarNameRef(this.y[0]),a=c.meta,f=this.y[2],l=c.value,p=!1;if(this.usedFuncs.add(l),a&&a.josi){if(a.josi.length!==f.length){if(!a.isVariableJosi)throw y.fromNode(`\u95A2\u6570\u300E${c.value}\u300F\u3067\u5F15\u6570${f.length}\u500B\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u304C\u3001${a.josi.length}\u500B\u306E\u5F15\u6570\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,c)}p=!!a.asyncFn}return{type:"func",name:l,blocks:f,josi:this.y[3].josi,meta:a,asyncFn:p,...e,end:this.peekSourceMap()}}throw y.fromNode("C\u98A8\u95A2\u6570\u547C\u3073\u51FA\u3057\u306E\u30A8\u30E9\u30FC",i||M())}if(this.check("def_func"))return this.yMumeiFunc();let s=this.yValueWord();if(s)return s;let u=this.yValueFuncPointer();return u||null}yValueWordGetIndex(e){if(e.index||(e.index=[]),this.check("@")){if(this.accept(["@",this.yValue,"comma",this.yValue,"comma",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.index.push(this.checkArrayIndex(this.y[3])),e.index.push(this.checkArrayIndex(this.y[5])),e.index=this.checkArrayReverse(e.index),e.josi=this.y[5].josi,!0;if(this.accept(["@",this.yValue,"comma",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.index.push(this.checkArrayIndex(this.y[3])),e.index=this.checkArrayReverse(e.index),e.josi=this.y[3].josi,!0;if(this.accept(["@",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.josi=this.y[1].josi,!0;throw y.fromNode("\u5909\u6570\u306E\u5F8C\u308D\u306E\u300E@\u8981\u7D20\u300F\u306E\u6307\u5B9A\u304C\u4E0D\u6B63\u3067\u3059\u3002",e)}if(this.check("[")&&this.accept(["[",this.yCalc,"]"]))return e.index.push(this.checkArrayIndex(this.y[1])),e.josi=this.y[2].josi,this.y[2].josi==="";if(this.check("[")&&this.accept(["[",this.yCalc,"comma",this.yCalc,"]"])){let n=[this.checkArrayIndex(this.y[1]),this.checkArrayIndex(this.y[3])],r=e.index.pop();return e.index=this.checkArrayReverse(n),r&&e.index.unshift(r),e.josi=this.y[4].josi,this.y[4].josi===""}if(this.check("[")&&this.accept(["[",this.yCalc,"comma",this.yCalc,"comma",this.yCalc,"]"])){let n=[this.checkArrayIndex(this.y[1]),this.checkArrayIndex(this.y[3]),this.checkArrayIndex(this.y[5])],r=e.index.pop();return e.index=this.checkArrayReverse(n),r&&e.index.unshift(r),e.josi=this.y[6].josi,this.y[6].josi===""}return!1}yValueFuncPointer(){let e=this.peekSourceMap();if(this.check("func_pointer")){let n=this.getCur();return{type:"func_pointer",name:n.value,josi:n.josi,...e,end:this.peekSourceMap()}}return null}yValueWord(){let e=this.peekSourceMap();if(this.check("word")){let n=this.getCur(),r=this.getVarNameRef(n);if(r.josi===""&&this.checkTypes(["[","@"])){let o={type:"ref_array",name:r,index:[],josi:"",...e,end:this.peekSourceMap()};for(;!this.isEOF()&&this.yValueWordGetIndex(o););if(o.index&&o.index.length===0)throw y.fromNode(`\u914D\u5217\u300E${r.value}\u300F\u30A2\u30AF\u30BB\u30B9\u3067\u6307\u5B9A\u30DF\u30B9`,r);return o}if(r.josi===""&&(this.check2(["$","word"])||this.check2(["$","string"]))){let o=[],s="";for(;this.check("$");){this.get();let u=this.get();o.push(u),s=u.josi}return{type:"ref_prop",name:r,index:o,josi:s,...e,end:this.peekSourceMap()}}return r}return null}createVar(e,n,r){let o=e.value,s=n?"const":"var";if(this.funcLevel===0){o.indexOf("__")<0&&(o=this.modName+"__"+o);let u={type:s,value:"",isExport:r};this.funclist.set(o,u);let i=e;return i.value=o,e}else return this.localvars.set(o,{type:s,value:""}),e}getVarName(e){let n=this.findVar(e.value);return n?(n&&n.scope==="global"&&(e.value=n.name),e):(this.createVar(e,!1,this.isExportDefault),e)}getVarNameRef(e){let n=this.findVar(e.value);return n?n&&n.scope==="global"&&(e.value=n.name):this.funcLevel===0&&e.value.indexOf("__")<0&&(e.value=this.modName+"__"+e.value),e}createVarList(e,n,r){for(let o=0;o<e.length;o++)e[o]=this.createVar(e[o],n,r);return e}yJSONObjectValue(){let e=[],n=this.peek();if(!n)return[];for(;!this.isEOF();){for(;this.check("eol");)this.get();if(this.check("}"))break;if(this.accept(["word",":",this.yCalc]))this.y[0].type="string",e.push(this.y[0]),e.push(this.y[2]);else if(this.accept(["string",":",this.yCalc]))e.push(this.y[0]),e.push(this.y[2]);else if(this.accept(["word"])){let r=this.y[0],o=JSON.parse(JSON.stringify(r));r.type="string",e.push(r),e.push(o)}else if(this.checkTypes(["string","number"])){let r=this.getCur();e.push(r),e.push(r)}else throw y.fromNode("\u8F9E\u66F8\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u5BA3\u8A00\u3067\u672B\u5C3E\u306E\u300E}\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n);this.check("comma")&&this.get()}return e}yJSONObject(){let e=this.yJSONObjectRaw();if(!e)return null;if(e.josi===""&&this.checkTypes(["@","["])){let n={type:"ref_array",name:"__ARRAY__",index:[e],josi:"",line:e.line,end:this.peekSourceMap()};return this.yValueWordGetIndex(n),n}return e}yJSONObjectRaw(){let e=this.peekSourceMap();if(this.accept(["{","}"]))return{type:"json_obj",blocks:[],josi:this.y[1].josi,...e,end:this.peekSourceMap()};if(this.accept(["{",this.yJSONObjectValue,"}"]))return{type:"json_obj",blocks:this.y[1],josi:this.y[2].josi,...e,end:this.peekSourceMap()};if(this.accept(["{",this.yJSONObjectValue]))throw y.fromNode("\u8F9E\u66F8\u578B\u5909\u6570\u306E\u521D\u671F\u5316\u304C\u300E}\u300F\u3067\u9589\u3058\u3089\u308C\u3066\u3044\u307E\u305B\u3093\u3002",this.y[1]);return null}yJSONArrayValue(){this.check("eol")&&this.get();let e=this.yCalc();if(e===null)return[];this.check("comma")&&this.get();let n=[e];for(;!this.isEOF()&&(this.check("eol")&&this.get(),!this.check("]"));){let r=this.yCalc();if(r===null)break;this.check("comma")&&this.get(),n.push(r)}return n}yJSONArray(){let e=this.yJSONArrayRaw();if(!e)return null;if(e.josi===""&&this.checkTypes(["@","["])){let n={type:"ref_array",name:"__ARRAY__",index:[e],josi:"",line:e.line,end:this.peekSourceMap()};return this.yValueWordGetIndex(n),n}return e}yJSONArrayRaw(){let e=this.peekSourceMap();if(this.accept(["[","]"]))return{type:"json_array",blocks:[],josi:this.y[1].josi,...e,end:this.peekSourceMap()};if(this.accept(["[",this.yJSONArrayValue,"]"]))return{type:"json_array",blocks:this.y[1],josi:this.y[2].josi,...e,end:this.peekSourceMap()};if(this.accept(["[",this.yJSONArrayValue]))throw y.fromNode("\u914D\u5217\u5909\u6570\u306E\u521D\u671F\u5316\u304C\u300E]\u300F\u3067\u9589\u3058\u3089\u308C\u3066\u3044\u307E\u305B\u3093\u3002",this.y[1]);return null}yTryExcept(){let e=this.peekSourceMap();if(!this.check("\u30A8\u30E9\u30FC\u76E3\u8996"))return null;let n=this.getCur(),r=this.yBlock();if(!this.check2(["\u30A8\u30E9\u30FC","\u306A\u3089\u3070"]))throw y.fromNode("\u30A8\u30E9\u30FC\u69CB\u6587\u3067\u300E\u30A8\u30E9\u30FC\u306A\u3089\u3070\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u30A8\u30E9\u30FC\u76E3\u8996..\u30A8\u30E9\u30FC\u306A\u3089\u3070..\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u3067\u8A18\u8FF0\u3057\u307E\u3059\u3002",n);this.get(),this.get();let o=this.yBlock();if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw y.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u30A8\u30E9\u30FC\u76E3\u8996\u300F...\u300E\u30A8\u30E9\u30FC\u306A\u3089\u3070\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"try_except",blocks:[r,o],josi:"",...e,end:this.peekSourceMap()}}_checkAsyncFn(e){if(!e)return!1;if(e.type=="def_func"||e.type=="def_test"||e.type=="func_obj"){let n=e;if(n.asyncFn)return!0;let r=!1;for(let o of n.blocks)if(this._checkAsyncFn(o))return r=!0,n.asyncFn=r,n.meta.asyncFn=r,this.isModifiedNodes=!0,!0}if(e.type=="func"){let n=e;if(n.asyncFn)return!0;if(n.blocks){for(let o of n.blocks)if(this._checkAsyncFn(o))return n.asyncFn=!0,this.isModifiedNodes=!0,!0}let r=this.funclist.get(n.name);return r&&r.asyncFn?(n.asyncFn=!0,this.isModifiedNodes=!0,!0):!1}if(e.type=="renbun")return!0;if(e.blocks){for(let n of e.blocks)if(this._checkAsyncFn(n))return!0}return!1}_tokensToNodes(e){let n=[];for(let r of e)n.push(this._tokenToNode(r));return n}_tokenToNode(e){let n=this.peekSourceMap(e);if(e.type==="string"||e.type=="number"||e.type=="bigint")return this.yConst(e,n);if(e.type==="word")return{type:"word",value:e.value,josi:e.josi,...n};if(e.type==="eol"||e.type==="_eol")return{type:"eol",...n};throw new Error("[System Error] \u672A\u77E5\u306E\u30C8\u30FC\u30AF\u30F3\u304CAst\u306B\u5909\u63DB\u3055\u308C\u307E\u3057\u305F\u3002")}};var et=class{constructor(e,n,r){this.from=e,this.to=n,this.index=r}},I=class{constructor(e,n){this.text=e,this.sourcePosition=n}},tt=class{constructor(e){this.history=[],this.code=e}getText(){return this.code}replaceAll(e,n){for(;;){let r=this.getText().indexOf(e);if(r===-1)break;e.length!==n.length&&this.history.unshift(new et(e.length,n.length,r)),this.code=this.code.replace(e,n)}}getSourcePosition(e){for(let n of this.history)e>=n.index+n.to?e+=n.from-n.to:n.index<=e&&e<n.index+n.to&&(n.to>=2&&e===n.index+n.to-1?e=n.index+n.from-1:e=n.index);return e}},Y=class t{static getInstance(){return t._instance||(t._instance=new t),t._instance}constructor(){this.convertTable=new Map([[8208,"-"],[8209,"-"],[8211,"-"],[8212,"-"],[8213,"-"],[8722,"-"],[732,"~"],[759,"~"],[8275,"~"],[8764,"~"],[12316,"~"],[65374,"~"],[8192," "],[8194," "],[8195," "],[8196," "],[8197," "],[8198," "],[8199," "],[8201," "],[8202," "],[8203," "],[8239," "],[8287," "],[12288," "],[12644," "],[8251,"#"],[12290,";"],[12304,"["],[12305,"]"],[12289,","],[65292,","],[10005,"*"],[10006,"*"],[10007,"*"],[10008,"*"],[10060,"*"],[10133,"+"],[10134,"-"],[10135,"\xF7"],[129008,"="]])}convert1ch(e){if(!e)return"";let n=e.codePointAt(0)||0,r=this.convertTable.get(n)||"";if(r)return r;if(n<127)return e;if(n>=65281&&n<=65374){let o=n-65248;return String.fromCodePoint(o)}return e}convert(e){if(!e)return[];let n=new tt(e);n.replaceAll(`\r
`,`
`),n.replaceAll("\r",`
`);let r=!1,o=!1,s="",u=[],i=0,c="",a=0;for(;a<n.getText().length;){let f=n.getText().charAt(a),l=n.getText().substring(a,a+2);if(r){if(f===s){r=!1,u.push(new I(c+s,n.getSourcePosition(i))),a++,i=a;continue}c+=f,a++;continue}if(o){if(l===s){o=!1,s==="\uFF0A\uFF0F"&&(s="*/"),u.push(new I(c+s,n.getSourcePosition(i))),a+=2,i=a;continue}c+=f,a++;continue}if(f==="\u300C"){u.push(new I(f,n.getSourcePosition(i))),a++,i=a,r=!0,s="\u300D",c="";continue}if(f==="\u300E"){u.push(new I(f,n.getSourcePosition(i))),a++,i=a,r=!0,s="\u300F",c="";continue}if(f==="\u201C"){u.push(new I(f,n.getSourcePosition(i))),a++,i=a,r=!0,s="\u201D",c="";continue}if(l==="\u{1F334}"||l==="\u{1F33F}"){u.push(new I(l,n.getSourcePosition(i))),a+=2,i=a,o=!0,s=l,c="";continue}let p=this.convert1ch(f);if(p==='"'||p==="'"){u.push(new I(p,n.getSourcePosition(i))),a++,i=a,r=!0,s=f,c="";continue}if(p==="#"){u.push(new I(p,n.getSourcePosition(i))),a++,i=a,r=!0,s=`
`,c="";continue}if(l==="//"||l==="\uFF0F\uFF0F"){u.push(new I("//",n.getSourcePosition(i))),a+=2,i=a,r=!0,s=`
`,c="";continue}if(l==="\uFF0F\uFF0A"){u.push(new I("/*",n.getSourcePosition(i))),a+=2,i=a,o=!0,s="\uFF0A\uFF0F",c="";continue}if(l==="/*"){u.push(new I(l,n.getSourcePosition(i))),a+=2,i=a,o=!0,s="*/",c="";continue}u.push(new I(p,n.getSourcePosition(i))),a++,i=a}return(r||o)&&(s==='"'||s==="'"||s==="\u300D"||s==="\u300F"||u.push(new I(c+s,n.getSourcePosition(i)))),u}};function nt(t,e){t=t.substring(0,256),t=t.replace(/(！|💡)/,"!"),t=t.replace(/\/\*.*?\*\//g,"");let n=t.split(/[;。\n]/,30);for(let r of n)if(r=r.replace(/^\s+/,"").replace(/\s+$/,""),e.indexOf(r)>=0)return!0;return!1}var qn=`(function(){
`,Gn="})",Un=`(async function(){
`,me=class{constructor(e=!1,n=[],r="",o=""){this.isTest=e,this.codeStandalone=r,this.codeEnv=o,this.importFiles=["plugin_system.mjs","plugin_math.mjs","plugin_csv.mjs","plugin_promise.mjs","plugin_test.mjs"];for(let s of n)this.importFiles.push(s)}},rt=class t{constructor(e){this.nakoFuncList=new Map(e.getNakoFuncList()),this.nakoTestFuncs=new Map,this.usedFuncSet=new Set,this.loopId=1,this.numAsyncFn=0,this.usedAsyncFn=!1,this.flagLoop=!1,this.__self=e,this.genMode="sync",this.lastLineNo=null,this.varslistSet=this.setVarslistSet(e.__varslist),this.varsSet={isFunction:!1,names:new Set,readonly:new Set},this.varslistSet[2]=this.varsSet,this.defFuncName="",this.speedMode={lineNumbers:0,implicitTypeCasting:0,invalidSore:0,forcePure:0},this.performanceMonitor={userFunction:0,systemFunction:0,systemFunctionBody:0,mumeiId:0},this.constPools=[],this.constPoolsTemplate=[],this.warnUndefinedVar=!1,this.warnUndefinedReturnUserFunc=!1,this.warnUndefinedCallingUserFunc=!1,this.warnUndefinedCallingSystemFunc=!1,this.warnUndefinedCalledUserFuncArgs=!1,this.debugOption=e.debugOption}static isValidIdentifier(e){return/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[$A-Z_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc][$A-Z_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]*$/.test(e)}setVarslistSet(e){let n=[];for(let r=0;r<=1;r++){let o=e[r],s=new Set(o.keys());s.delete("meta"),n[r]={isFunction:!1,names:s,readonly:new Set}}return n}convLineno(e,n=!1,r=0){if(this.speedMode.lineNumbers>0)return"";let o=e.line+r,s;if(typeof e.line!="number"?s="unknown":typeof e.file!="string"?s=`l${o}`:s=`l${o}:${e.file}`,!n){if(s===this.lastLineNo)return"";this.lastLineNo=s}let u=JSON.stringify(s),i="";return this.debugOption.useDebug&&(this.debugOption.messageAction&&(i+=`window.postMessage({action:'${this.debugOption.messageAction}',line: ${u}});`),o>=1&&(this.debugOption.waitTime>0&&(i+=`await __v0.get('\u79D2\u5F85')(${this.debugOption.waitTime},__self);`),this.numAsyncFn+=1,this.usedAsyncFn=!0,i+=`await __v0.get('__DEBUG_BP_WAIT')(${o}, __self);`),i+="if (__v0.get('__forceClose')) { return -1 };"),`__line(${u});`+i}varname_get(e){return this.varslistSet.length===3?`__self.__varslist[2].get(${JSON.stringify(e)})`:`__self.__vars.get(${JSON.stringify(e)})`}varname_set(e,n){return this.varslistSet.length===3?`__self.__varslist[2].set(${JSON.stringify(e)}, (${n}))`:`__self.__vars.set(${JSON.stringify(e)}, (${n}))`}varname_set_sys(e,n){return`__self.__setSysVar(${JSON.stringify(e)}, (${n}))`}static getFuncName(e){if(e.indexOf("__")>=0){let r=e.split("__"),o=r[0],s=t.getFuncName(r[1]);return`${o}__${s}`}let n=e.replace(/[ぁ-ん]+$/,"");return n===""&&(n=e),n}static convPrint(e){return`__print(${e});`}convRequire(e){let n=e.value;return this.convLineno(e,!1)+`__module['${n}'] = require('${n}');
`}getDefFuncCode(e,n){let r="";r+=`const nakoVersion = { version: ${JSON.stringify(e.version)} }
`,r+=`const __self = self;
`,r+=`__self.__self = __self;
`,r+=`const __varslist = __self.__varslist;
`,r+=`const __module = __self.__module;
`,r+=`const __v0 = __self.__v0 = __self.__varslist[0];
`,r+=`const __v1 = __self.__v1 = __self.__varslist[1];
`,r+=`const __vars = __self.__vars = __self.__varslist[2];
`,r+=`const __modList = __self.__modList = ${JSON.stringify(e.getModList())}
`,r+=`const __line = (lineno) => { __self.__v0.set('__line', lineno); }
`,r+=`__v0.set('__line', 'l0:__getDefFuncCode');
`,r+=`__v0.set('__forceClose', false);
`,r+=`__v0.set('__useDebug', ${this.debugOption.useDebug});
`,r+="__self.constPools = "+JSON.stringify(this.constPools)+`;
`,r+="__self.constPoolsTemplate = "+JSON.stringify(this.constPoolsTemplate)+`;
`,r+=`__self.__propAccessor = [];
`;let o="";if(this.nakoFuncList.forEach((s,u)=>{let i=Z(ne(String(s.fn),1)),c=s.asyncFn?"true":"false";o+=`//[DEF_FUNC name='${u}' asyncFn=${c}]
__self.__varslist[1].set("${u}", ${i});
//[/DEF_FUNC name='${u}']
`}),o!==""&&(r+=`__v0.set('__line', '\u95A2\u6570\u306E\u5B9A\u7FA9');
`+o),n.isTest){let s=`const __tests = [];
`;this.nakoTestFuncs.forEach(u=>{let i=u.fn;s+=`${i};
`}),s!==""&&(r+=`__v0.set('__line', '\u30C6\u30B9\u30C8\u306E\u5B9A\u7FA9');
`,r+=s+`
`)}return r}addPlugin(e){return this.__self.addPlugin(e)}addPluginObject(e,n){this.__self.addPluginObject(e,n)}addPluginFile(e,n,r){this.__self.addPluginFile(e,n,r)}addFunc(e,n,r){this.__self.addFunc(e,n,r)}getFunc(e){return this.__self.getFunc(e)}registerFunction(e){if(e.type!=="block")throw y.fromNode("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557\u3057\u3066\u3044\u307E\u3059\u3002\u69CB\u6587\u306F\u5FC5\u305Ablock\u304C\u5148\u982D\u306B\u306A\u308A\u307E\u3059",e);let n=[],r=u=>{if(!u.name)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u95A2\u6570\u540D\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");let i=u.name;this.usedFuncSet.add(i),this.__self.__varslist[1].set(i,()=>{}),this.varslistSet[1].names.add(i);let c=u.meta;if(!c)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u95A2\u6570\u540D\u306E\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");this.nakoFuncList.set(i,{josi:c.josi,fn:()=>{},type:"func",asyncFn:!!u.asyncFn,isExport:u.isExport}),n.push({name:i,node:u})},o=u=>{if(u.blocks)for(let i of u.blocks)i.type=="def_func"?r(i):o(i)};o(e);let s=new Set;this.speedMode.invalidSore===0&&s.add("\u305D\u308C"),this.varsSet={isFunction:!1,names:s,readonly:new Set},this.varslistSet=this.setVarslistSet(this.__self.__varslist),this.varslistSet[2]=this.varsSet}convGen(e,n){let r=this.convLineno(e,!1)+this._convGen(e,!0);return n.isTest?"":r}_convGen(e,n){if(!e)return"";let r="";if(e instanceof Array){for(let o=0;o<e.length;o++){let s=e[o];r+=this._convGen(s,n)}return r}if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e!="object")return""+e;switch(e.type){case"nop":break;case"block":r+=this.convBlock(e);break;case"comment":case"eol":r+=this.convComment(e);break;case"run_mode":r+=this.convRunMode(e);break;case"break":r+=this.convCheckLoop(e,"break");break;case"continue":r+=this.convCheckLoop(e,"continue");break;case"end":r+="__v0.get('\u7D42')(__self);";break;case"number":r+=e.value;break;case"bigint":r+=e.value;break;case"string":r+=this.convString(e);break;case"def_local_var":r+=this.convDefLocalVar(e);break;case"def_local_varlist":r+=this.convDefLocalVarlist(e);break;case"let":r+=this.convLet(e);break;case"let_prop":r+=this.convLetProp(e);break;case"ref_prop":r+=this.convRefProp(e);break;case"inc":r+=this.convInc(e);break;case"word":case"variable":r+=this.convGetVar(e);break;case"op":case"calc":r+=this.convOp(e);break;case"renbun":r+=this.convRenbun(e);break;case"not":r+="(("+this._convGen(e.blocks[0],!0)+")?false:true)";break;case"func":case"func_pointer":case"calc_func":r+=this.convCallFunc(e,n);break;case"if":r+=this.convIf(e);break;case"for":r+=this.convFor(e);break;case"foreach":r+=this.convForeach(e);break;case"repeat_times":r+=this.convRepeatTimes(e);break;case"speed_mode":r+=this.convSpeedMode(e,n);break;case"performance_monitor":r+=this.convPerformanceMonitor(e,n);break;case"while":r+=this.convWhile(e);break;case"atohantei":r+=this.convAtohantei(e);break;case"switch":r+=this.convSwitch(e);break;case"let_array":r+=this.convLetArray(e);break;case"ref_array":r+=this.convRefArray(e);break;case"json_array":r+=this.convJsonArray(e);break;case"json_obj":r+=this.convJsonObj(e);break;case"bool":r+=e.value?"true":"false";break;case"null":r+="null";break;case"def_test":r+=this.convDefTest(e);break;case"def_func":r+=this.convDefFunc(e);break;case"func_obj":r+=this.convFuncObj(e);break;case"return":r+=this.convReturn(e);break;case"try_except":r+=this.convTryExcept(e);break;case"require":r+=this.convRequire(e);break;default:throw new Error("System Error: unknown_type="+e.type)}return r}findVar(e,n=null){if(this.varslistSet.length>3&&this.varsSet.names.has(e))return{i:this.varslistSet.length-1,name:e,isTop:!0,js:this.varname_get(e),js_set:this.varname_set(e,String(n))};for(let r=2;r>=0;r--)if(this.varslistSet[r].names.has(e))return{i:r,name:e,isTop:!1,js:`__self.__varslist[${r}].get(${JSON.stringify(e)})`,js_set:`__self.__varslist[${r}].set(${JSON.stringify(e)}, ${n})`};return null}genVar(e,n){let r=this.findVar(e),o=n.line;if(r===null){if(!(e==="\u5F15\u6570"||e==="\u305D\u308C"||e==="\u5BFE\u8C61"||e==="\u5BFE\u8C61\u30AD\u30FC")){if(this.warnUndefinedVar){let u=e.replace(/^main__(.+)$/,"$1");this.__self.getLogger().warn(`\u5909\u6570\u300E${u}\u300F\u306F\u5B9A\u7FA9\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002`,n)}}return this.varsSet.names.add(e),this.varname_get(e)}if(r.i===0){let u=this.__self.getNakoFunc(e);if(!u)return`${r.js}/*[link_error]l${o}:${n.file}*/`;if(u.type==="const"||u.type==="var")return r.js;if(u.type==="func"){if(!u.josi||u.josi.length===0)return`(${r.js}())`;throw y.fromNode(`\u300E${e}\u300F\u304C\u8907\u6587\u3067\u4F7F\u308F\u308C\u307E\u3057\u305F\u3002\u5358\u6587\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002(v1\u975E\u4E92\u63DB)`,n)}throw y.fromNode(`\u300E${e}\u300F\u306F\u95A2\u6570\u3067\u3042\u308A\u53C2\u7167\u3067\u304D\u307E\u305B\u3093\u3002`,n)}return r.js}convGetVar(e){let n=e.value;return this.genVar(n,e)}convBlock(e){let n="";for(let r of e.blocks)n+=this._convGen(r,!1);return n}convComment(e){let n=String(e.comment);n=n.replace(/\n/g,"\xB6");let r=this.convLineno(e,!1);return n===""&&r===""?";":n===""?";"+r+`
`:";"+r+"//"+n+`
`}convRunMode(e){let n=e.value,r=!1;return n==="\u53B3\u3057\u304F\u30C1\u30A7\u30C3\u30AF"&&(r=!0),this.warnUndefinedVar=r,this.warnUndefinedReturnUserFunc=r,this.warnUndefinedCallingUserFunc=r,this.warnUndefinedCallingSystemFunc=r,this.warnUndefinedCalledUserFuncArgs=r,`/* \u5B9F\u884C\u30E2\u30FC\u30C9: ${n} */`}convReturn(e){if(this.varsSet.names.has("!\u95A2\u6570"))throw y.fromNode("\u300E\u623B\u308B\u300F\u304C\u3042\u308A\u307E\u3059\u304C\u3001\u95A2\u6570\u5B9A\u7FA9\u5185\u306E\u307F\u3067\u4F7F\u7528\u53EF\u80FD\u3067\u3059\u3002",e);let n=e.blocks[0],r=this.convLineno(e,!1),o="";if(n.type!=="nop"?o=this._convGen(n,!0):this.speedMode.invalidSore===0&&(o=this.varname_get("\u305D\u308C")),o==="")return r+"return;";if(this.warnUndefinedReturnUserFunc){let s=this.defFuncName?this.defFuncName:"\u7121\u540D\u95A2\u6570",u=this.addConstPool(`\u30E6\u30FC\u30B6\u95A2\u6570\u300E${s}\u300F\u304B\u3089undefined\u304C\u8FD4\u3055\u308C\u3066\u3044\u307E\u3059`,[],e.file,e.line);return r+`return (__self.chk(${o}, ${u}));`}else return r+`return ${o};`}getConstPoolsTemplateId(e){let n=this.constPoolsTemplate.indexOf(e);return n<0&&(n=this.constPoolsTemplate.length,this.constPoolsTemplate[n]=e),n}addConstPool(e,n,r,o){r=""+r;let s=this.getConstPoolsTemplateId(r),u=this.getConstPoolsTemplateId(e),i=[];for(let a in n){let f=""+n[a],l=this.getConstPoolsTemplateId(f);i.push(l)}let c=this.constPools.length;return this.constPools.push([u,i,s,o]),c}convCheckLoop(e,n){if(!this.flagLoop){let r=n==="continue"?"\u7D9A\u3051\u308B":"\u629C\u3051\u308B";throw y.fromNode(`\u300E${r}\u300F\u6587\u304C\u3042\u308A\u307E\u3059\u304C\u3001\u305D\u308C\u306F\u7E70\u308A\u8FD4\u3057\u306E\u4E2D\u3067\u5229\u7528\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,e)}return this.convLineno(e)+n+";"}convDefFuncCommon(e,n){this.defFuncName=n;let r=!1,o="",s="";if(this.performanceMonitor.userFunction!==0){let d=n;d||(typeof this.performanceMonitor.mumeiId>"u"&&(this.performanceMonitor.mumeiId=0),this.performanceMonitor.mumeiId++,d=`anous_${this.performanceMonitor.mumeiId}`),o=`const performanceMonitorEnd = (function (key, type) {
const uf_start = performance.now() * 1000;
return function () {
const el_time = performance.now() * 1000 - uf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: el_time, min_usec: el_time, max_usec: el_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: el_time, min_usec: el_time, max_usec: el_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=el_time;
if(__self.__performance_monitor[key].min_usec>el_time){__self.__performance_monitor[key].min_usec=el_time;}
if(__self.__performance_monitor[key].max_usec<el_time){__self.__performance_monitor[key].max_usec=el_time;}
}};})('${d}', 'user');try {
`,s=`} finally { performanceMonitorEnd(); }
`}let u="",i="    ",c="",a="",f=new Set;this.speedMode.invalidSore===0&&f.add("\u305D\u308C"),this.varsSet={isFunction:!0,names:f,readonly:new Set},this.varslistSet.push(this.varsSet),r?u+=i+`var \u5F15\u6570 = arguments;
`:u+=i+`__self.__vars.set('\u5F15\u6570', arguments);
`,c+=`
// PUSH STACK
`,c+=`const __localvars = __self.__vars;
`,c+=`__self.__vars = new Map();
`,c+=`try {
`,a+=`} finally {
`,a+=i+`// POP STACK
`,a+=i+`self.__vars = __localvars;
`,a+=`}
`;let l=Array.from(this.varsSet.names.values()),p="",h=e.meta;if(!h)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");h.varnames||(h.varnames=[]);for(let d=0;d<h.varnames.length;d++){let m=h.varnames[d];if(m!=="\u5F15\u6570"){if(!this.warnUndefinedCalledUserFuncArgs)p+=i+this.varname_set(m,`arguments[${d}]`)+`;
`;else{let k=`\u533F\u540D\u95A2\u6570\u306E\u5F15\u6570\u300E${m}\u300F\u306Bundefined\u304C\u6E21\u3055\u308C\u307E\u3057\u305F`;n&&(k=`\u30E6\u30FC\u30B6\u95A2\u6570\u300E${n}\u300F\u306E\u5F15\u6570\u300E${m}\u300F\u306Bundefined\u304C\u6E21\u3055\u308C\u307E\u3057\u305F`);let D=`${`((a) => { if (a === undefined) { ${`__self.logger.warn('${k}', {line: ${e.line}, file: ${JSON.stringify(e.file)}});`} }; return a; })`}(arguments[${d}])`;p+=i+this.varname_set(m,D)+`;
`}this.varsSet.names.add(m)}}if(n&&(this.usedFuncSet.add(n),this.varslistSet[1].names.add(n),this.nakoFuncList.get(n)===void 0)){if(!e.meta)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");this.nakoFuncList.set(n,{josi:e.meta.josi,fn:()=>{},type:"func",asyncFn:!1,isExport:null}),this.__self.getLogger().warn(`generate\u3067\u672A\u5B9A\u7FA9\u306E\u72B6\u614B\u306E\u95A2\u6570\u300E${n}\u300F\u304C\u52D5\u7684\u306B\u767B\u9332\u3055\u308C\u3066\u3044\u307E\u3059\u3002`)}let _=this.usedAsyncFn;this.usedAsyncFn=!1,this.debugOption.useDebug&&(this.usedAsyncFn=!0);let g=this._convGen(e.blocks[0],!1);if(p+=g.split(`
`).map(d=>"  "+d).join(`
`)+`
`,this.speedMode.invalidSore===0&&(p+=`  return (${this.varname_get("\u305D\u308C")});
`),p+=s,n&&this.usedAsyncFn){let d=this.nakoFuncList.get(n);d&&(d.asyncFn=!0)}if(r){for(let d of Array.from(this.varsSet.names.values()))l.includes(d)||t.isValidIdentifier(d)&&(u+=`  var ${d};
`);this.speedMode.invalidSore===0&&(t.isValidIdentifier("\u305D\u308C")?u+=`  var \u305D\u308C = '';
`:u+=`  ${this.varname_get("\u305D\u308C")} = '';`)}let b=this.usedAsyncFn?Un:qn,w="  "+this.convLineno(e,!0,1)+`
`;if(p=b+o+c+u+w+p+a,p+=Gn,n){let d=this.nakoFuncList.get(n);d&&(d.fn=p,d.asyncFn=this.usedAsyncFn,h.asyncFn=this.usedAsyncFn)}return this.usedAsyncFn=_,this.varslistSet.pop(),this.varsSet=this.varslistSet[this.varslistSet.length-1],n&&this.__self.__varslist[1].set(n,p),this.defFuncName="",p}convDefTest(e){let n=e.name,r=`__tests.push({ name: '${n}', f: () => {
`,o=this._convGen(e.blocks[0],!1);if(r+=`   ${o}
}});`,!e.meta)throw new Error("[System Error] \u30C6\u30B9\u30C8\u306E\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");return this.nakoTestFuncs.set(n,{josi:e.meta.josi,fn:r,type:"test_func"}),""}convDefFunc(e){if(!e.name)return"";let n=t.getFuncName(e.name);return this.convDefFuncCommon(e,n),""}convFuncObj(e){return"/*convFuncObj*/"+this.convDefFuncCommon(e,"")}convJsonObj(e){let n=[],r=e.blocks;for(let o=0;o<r.length/2;o++){let s=o*2,u=r[s+0],i=r[s+1],c=this._convGen(u,!0),a=this._convGen(i,!0);n.push(`${c}: ${a}`)}return"{"+n.join(", ")+"}"}convJsonArray(e){return"["+e.blocks.map(o=>this._convGen(o,!0)).join(",")+"]"}convRefArray(e){let n="";if(e.name==="__ARRAY__"){let o=e.index?.shift();o?n=this._convGen(o,!0):n="[]"}else n=this._convGen(e.name,!0);let r=e.index;if(!r)return n;for(let o=0;o<r.length;o++){let s=this._convGen(r[o],!0);n+="["+s+"]"}return n}convLetArray(e){let n=this.loopId++,r=e.blocks[0],o=e.blocks.slice(1),s=this.genVar(e.name,e),u="",i=s,c="";if(e.checkInit){let l="[0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0]";if(e.name){let p=e.name,h=`$nako_tmp_a${n}`,_=this.varname_set(p,l);u+=`
/*\u914D\u5217\u521D\u671F\u5316*/if (!(${s} instanceof Array)) { ${_} };
`,u+=`${h} = ${s};
`;for(let g=0;g<o.length-1;g++){let b=this._convGen(o[g],!0);c+=`[${b}]`,u+=`
/*\u914D\u5217\u521D\u671F\u5316${g}*/if (!(${h}${c} instanceof Array)) { ${h}${c} = ${l}; };`}u+=`
`}}for(let l=0;l<o.length;l++){let p=this._convGen(o[l],!0);i+="["+p+"]"}let a=null;if(this.speedMode.invalidSore===0&&(a=this.varname_get("\u305D\u308C")),r.type!=="nop"&&(a=this._convGen(r,!0)),a==null)throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u5909\u6570\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);return i+=" = "+a+`;
`,this.convLineno(e,!1)+u+i}convGenLoop(e){let n=this.flagLoop;this.flagLoop=!0;try{return this._convGen(e,!1)}finally{this.flagLoop=n}}convFor(e){let n=e.blocks[0],r=e.blocks[1],o=e.blocks[2],s=e.blocks[3],u=this.loopId++,i=`$nako_i${u}`,c="";if(e.word!==""){let A=e.word;this.varsSet.names.add(A),c=this.varname_set(A,i)}let a=`$nako_from${u}`,f=`$nako_to${u}`,l=`$nako_temp${u}`,p="";this.speedMode.invalidSore===0&&(p=this.varname_set("\u305D\u308C",i));let h="0",_="0",g="0";r&&r.type==="func"&&r.name==="\u7BC4\u56F2"?(g=this._convGen(r,!0),h=`${l}['\u5148\u982D'] || 0`,_=`${l}['\u672B\u5C3E'] || 0`):(h=this._convGen(n,!0),_=this._convGen(r,!0));let b=e.flagDown,w=e.flagUp,d="1";o.type!=="nop"&&(d=this._convGen(o,!0));let m=this.convGenLoop(s);return this.convLineno(e,!1)+`
/*[convFor id=${u}]*/
const ${l} = ${g};
const ${a} = ${h};
const ${f} = ${_};
if (${a} <= ${f}) { // up
  if (${w}) {    for (let ${i} = ${a}; ${i} <= ${f}; ${i}+= ${d}) {
      ${p};${c}
      // for block begin
      ${m}
      // for block end
    };
  };
} else { // down
  if (${b}) {    for (let ${i} = ${a}; ${i} >= ${f}; ${i}-= ${d}) {
      ${p};${c}
      // for block begin
      ${m}
      // for block end
    }
  };
};
//[/convFor id=${u}]
`}convForeach(e){let n=e.blocks[0],r=e.blocks[1],o=this.loopId++,s=`$nako_i${o}`,u=`$nako_foreach_value${o}`,i=`$nako_foreach_data${o}`,c=`$nako_taisyou_temp${o}`,a=`$nako_taisyou_key_temp${o}`,f=`$nako_foreach_sore_temp${o}`,l=this.varname_set_sys("\u5BFE\u8C61",u);if(e.word!==""){let k=e.word;this.varsSet.names.add(k),l=this.varname_set(k,u)}let h=this.varname_set_sys("\u5BFE\u8C61\u30AD\u30FC",s),_="",g="",b="";this.speedMode.invalidSore===0&&(_=this.varname_set("\u305D\u308C",u),g=this.varname_set("\u305D\u308C",f),b=`let ${f} = `+this.varname_get("\u305D\u308C")+";");let w="";if(n.type==="nop")if(this.speedMode.invalidSore===0)w=this.varname_get("\u305D\u308C");else throw y.fromNode("\u300E\u53CD\u5FA9\u300F\u306E\u5BFE\u8C61\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);else w=this._convGen(n,!0);let d=Z(ne(this.convGenLoop(r),1));return this.convLineno(e,!1)+`
// [convForeach id=${o}]
const ${c} = __self.__getSysVar('\u5BFE\u8C61'); ${b}; const ${a} = __self.__getSysVar('\u5BFE\u8C61\u30AD\u30FC');
let ${i} = ${w};
// foreach Map?
if (${i} instanceof Map) { // Object\u306B\u5F37\u5236\u5909\u63DB
  let tmp = {}; for (let tmpKey of ${i}.keys()) { tmp[tmpKey] = ${i}.get(tmpKey); }; 
  ${i} = tmp;
}
for (let ${s} in ${i}) {
  if (!${i}.hasOwnProperty(${s})) { continue }
  // \u5BFE\u8C61\u30AD\u30FC\u306E\u8A2D\u5B9A
  ${h}
  // \u5BFE\u8C61\u306E\u8A2D\u5B9A
  let ${u} = $nako_foreach_data${o}[${s}]
  ${_};
  ${l};
  // [convForeach::block]
  ${d}
  // [/convForeach::block]
}
__self.__setSysVar('\u5BFE\u8C61', ${c});${g};__self.__setSysVar('\u5BFE\u8C61\u30AD\u30FC', ${a});// [/convForeach id=${o}]
`}convRepeatTimes(e){let n=this.loopId++,r=`$nako_i${n}`,o=`$nako_times_data${n}`,s=`$nako_kaisu_temp${n}`,u=this._convGen(e.blocks[0],!0),i=Z(ne(this.convGenLoop(e.blocks[1]),1)),c="",a="";return this.speedMode.invalidSore===0&&(c=this.varname_set("\u305D\u308C",r),a=this.varname_set("\u305D\u308C",s)),c+=`;__self.__setSysVar('\u56DE\u6570', ${r});`,a+=`;__self.__setSysVar('\u56DE\u6570', ${s});`,this.convLineno(e,!1)+`
// [convRepeatTimes id=${n}] // \u300En\u56DE\u300F\u69CB\u6587
let ${s} = __self.__getSysVar('\u56DE\u6570')
let ${o} = ${u};
for (let ${r} = 1; ${r} <= ${o}; ${r}++) {
  ${c}
  ${i}
}
${a}
// [/convRepeatTimes id=${n}]
`}convSpeedMode(e,n){if(!e.options)return"";let r={...this.speedMode};e.options.\u884C\u756A\u53F7\u7121\u3057&&this.speedMode.lineNumbers++,e.options.\u6697\u9ED9\u306E\u578B\u5909\u63DB\u7121\u3057&&this.speedMode.implicitTypeCasting++,e.options.\u5F37\u5236\u30D4\u30E5\u30A2&&this.speedMode.forcePure++,e.options.\u305D\u308C\u7121\u52B9&&this.speedMode.invalidSore++;try{return this._convGen(e.blocks[0],n)}finally{this.speedMode=r}}convPerformanceMonitor(e,n){let r={...this.performanceMonitor};if(!e.options)return"";e.options.\u30E6\u30FC\u30B6\u95A2\u6570&&this.performanceMonitor.userFunction++,e.options.\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u672C\u4F53&&this.performanceMonitor.systemFunctionBody++,e.options.\u30B7\u30B9\u30C6\u30E0\u95A2\u6570&&this.performanceMonitor.systemFunction++;try{return this._convGen(e.blocks[0],n)}finally{this.performanceMonitor=r}}convWhile(e){let n=e.blocks[0],r=e.blocks[1],o=this._convGen(n,!0),s=Z(ne(this.convGenLoop(r),1));return`// [convWhile]
`+this.convLineno(e,!1)+`
while (${o}){
  ${s}
}
// [convWhile]
`}convAtohantei(e){let r=`$nako_i${this.loopId++}`,o=this._convGen(e.blocks[0],!0),u=`while (true) {
  ${this.convGenLoop(e.blocks[1])}
  let ${r} = ${o};
  if (${r}) { continue } else { break }
}

`;return this.convLineno(e,!1)+u}convSwitch(e){let n=this._convGen(e.blocks[0],!0),r=this._convGen(e.blocks[1],!1),o="";for(let u=0;u<e.case_count;u++){let i=u*2+2,c=this._convGen(e.blocks[i+0],!0),a=this.convGenLoop(e.blocks[i+1]);o+=`  case ${c}:
`,o+=`    ${a}
    break
`}let s=`// [switch]
switch (${n}){
${o}
  default:
    ${r}
}
// [/switch]
`;return this.convLineno(e,!1)+s}convIf(e){let n=e.blocks[0],r=e.blocks[1],o=e.blocks[2],s=this._convGen(n,!0),u=Z(ne(this._convGen(r,!1),1)),i=Z(ne(this._convGen(o,!1),1)),c=`// [convIf]
`+this.convLineno(e,!1)+`
if (${s}) {
  ${u}
}`;return Z(i)!==""&&(c+=`  else {
  ${i}
}
`),c+=`
// [/convIf]
`,c}convFuncGetArgsCalcType(e,n,r){let o=[],s={},u=r.blocks?r.blocks:[];for(let i=0;i<u.length;i++){let c=u[i];if(i===0&&c===null&&this.speedMode.invalidSore===0)o.push(this.varname_get("\u305D\u308C")),s.sore=!0;else{let a=this._convGen(c,!0);a===""&&(a="undefined"),typeof a!="string"&&(a="undefined"),o.push(`/*arg${i}*/${a}`)}}return[o,s]}getPluginList(){let e=[];for(let n in this.__self.__module)e.push(n);return e}convCallFunc(e,n){let r=t.getFuncName(e.name),o=this.findVar(r);if(o===null)throw y.fromNode(`\u95A2\u6570\u300E${r}\u300F\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u6709\u52B9\u30D7\u30E9\u30B0\u30A4\u30F3=[`+this.getPluginList().join(", ")+"]",e);let s;if(o.i===0){if(s=this.__self.getFunc(r),!s)throw new Error(`[System Error] \u95A2\u6570\u300C${r}\u300DNakoCompiler.nakoFuncList \u306E\u4E0D\u6574\u5408\u304C\u3042\u308A\u307E\u3059\u3002`);if(s.type!=="func")throw y.fromNode(`\u300E${r}\u300F\u306F\u95A2\u6570\u3067\u306F\u3042\u308A\u307E\u305B\u3093\u3002`,e)}else s=this.nakoFuncList.get(r),s===void 0&&(s={return_none:!1,asyncFn:!!e.asyncFn});if(e.type==="func_pointer")return o.js;let u=this.convFuncGetArgsCalcType(r,s,e),i=u[0],c=u[1];if(this.usedFuncSet.add(r),r==="\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A")return`
// --- \u540D\u524D\u7A7A\u9593(${i[0]}) ---
__self.__varslist[0].get('\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A')(${i[0]}, __self);__self.__modName=${i[0]};
`;if(r==="\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A")return`
__self.__varslist[0].get('\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A')(${i[0]}, __self);
`;i.push("__self");let a="function",f="",l="";if(e.setter&&(f+=`;__self.isSetter = true;
`,l+=`;__self.isSetter = false;
`),o.i===0&&this.varslistSet.length>3&&s.pure!==!0&&this.speedMode.forcePure===0){let w=[];for(let d of Array.from(this.varsSet.names.values()))t.isValidIdentifier(d)&&w.push({str:JSON.stringify(d),js:this.varname_get(d)});if(f+=`__self.__locals = __vars;
`,w.length>0){f+=`/* \u5168\u3066\u306E\u5C55\u958B\u3055\u308C\u305F\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u3092 __self.__locals \u306B\u4FDD\u5B58 */
`;for(let d of w)f+=`__self.__locals.set(${d.str}, ${d.js});
`}if(w.length>0){l+=`/* \u5168\u3066\u306E\u5C55\u958B\u3055\u308C\u305F\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u3092 __self.__locals \u304B\u3089\u53D7\u3051\u53D6\u308B */
`;for(let d of w)d.js!=="\u305D\u308C"&&(l+=`__self.__varslist[2].set(${d.str}, __self.__locals[${d.str}]);
`)}}c.sore&&(f+="/*[sore]*/");let p=(w,d)=>{let m="";for(let k of w.split(`
`))k!==""&&(m+="  ".repeat(d)+k+`
`);return m},h={TYPEOF:!0,\u5909\u6570\u578B\u78BA\u8A8D:!0},_;if(!this.warnUndefinedCallingUserFunc&&o.i!==0||!this.warnUndefinedCallingSystemFunc&&o.i===0)_=i.join(",");else{let w=[];i.forEach(d=>{if(d==="__self"||h[r]===!0)w.push(`${d}`);else{let m=o.i===0?"\u547D\u4EE4\u300E$0\u300F\u306E\u5F15\u6570\u306Bundefined\u3092\u6E21\u3057\u3066\u3044\u307E\u3059\u3002":"\u30E6\u30FC\u30B6\u547D\u4EE4\u300E$0\u300F\u306E\u5F15\u6570\u306Bundefined\u3092\u6E21\u3057\u3066\u3044\u307E\u3059\u3002",k=this.addConstPool(m,[r],e.file,e.line),A=d===""?'""':d;w.push(`(__self.chk(${A}, ${k}))`)}}),_=w.join(", ")}let g=`${o.js}(${_})`;if(s.asyncFn){a=`async ${a}`,g=`await ${g}`,this.numAsyncFn++,this.usedAsyncFn=!0;let w=`$nako_i${this.loopId}`;this.loopId++,f+=`const __local_async${w} = __self.__vars;
`,l+=`__self.__vars = __local_async${w};
`}if(o.i===0&&this.performanceMonitor.systemFunctionBody!==0){let w=r;w||(typeof this.performanceMonitor.mumeiId>"u"&&(this.performanceMonitor.mumeiId=0),this.performanceMonitor.mumeiId++,w=`anous_${this.performanceMonitor.mumeiId}`),g=`(${a} (key, type) {
const sbf_start = performance.now() * 1000;
try {
return `+g+`;
} finally {
const sbl_time = performance.now() * 1000 - sbf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: sbl_time, min_usec: sbl_time, max_usec: sbl_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: sbl_time, min_usec: sbl_time, max_usec: sbl_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=sbl_time;
if(__self.__performance_monitor[key].min_usec>sbl_time){__self.__performance_monitor[key].min_usec=sbl_time;}
if(__self.__performance_monitor[key].max_usec<sbl_time){__self.__performance_monitor[key].max_usec=sbl_time;}
}}})('${r}_body', 'sysbody')
`}let b="";if(s.return_none)l===""?b=`/*VOID\u95A2\u6570\u547C\u51FA*/${f}${g}
`:b=`/*VOID\u95A2\u6570\u547C\u51FA(\u524D\u5F8C\u51E6\u7406\u4ED8)*/${f}try {
${p(g,1)};
} finally {
${p(l,1)}}
`;else{let w="",d="";if(this.speedMode.invalidSore===0&&(w="__self.__setSore(",d=")"),f===""&&l==="")b=`${w}${g}${d}`;else if(l===""){let m=`${w}${g}${d}`;b=`/* funcCallThis1 */${`(${`${a}(){ return ${m} }`}).call(this)`}`}else{let m=`$nako_i${this.loopId}`;this.loopId++,b=`/* funcCallThis2 */(${a}(){
`+p(f,1)+`
`+p("try {",1)+`
`+p(`let ${m} = ${g};`,2)+`
`+p(`return ${m};`,2)+`
`+p("} finally {",2)+`
`+p(l,1)+`
`+p("}",1)+`
}).call(this)`,s.asyncFn&&(b=`await (${b})`),b=`${w}${b}${d}`}(e.josi==="\u3057\u3066"||e.josi===""&&!n)&&(b+=`;
`)}return o.i===0&&this.performanceMonitor.systemFunction!==0&&(b=`(function (key, type) {
const sf_start = performance.now() * 1000;
try {
return `+b+`;
} finally {
const sl_time = performance.now() * 1000 - sf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: sl_time, min_usec: sl_time, max_usec: sl_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: sl_time, min_usec: sl_time, max_usec: sl_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=sl_time;
if(__self.__performance_monitor[key].min_usec>sl_time){__self.__performance_monitor[key].min_usec=sl_time;}
if(__self.__performance_monitor[key].max_usec<sl_time){__self.__performance_monitor[key].max_usec=sl_time;}
}}})('${r}_sys', 'system')
`),b}convRenbun(e){let n=this._convGen(e.blocks[1],!0),r=this._convGen(e.blocks[0],!1);return this.numAsyncFn++,this.usedAsyncFn=!0,`/*[\u9023\u6587]*/await (async function(){ ${r}; return ${n} }).call(this)/*[/\u9023\u6587]*/`}convOp(e){let n={"&":'+""+',eq:"==",noteq:"!=","===":"===","!==":"!==",gt:">",lt:"<",gteq:">=",lteq:"<=",and:"&&",or:"||",shift_l:"<<",shift_r:">>",shift_r0:">>>","\xF7":"/"},r=e.operator||"",o=this._convGen(e.blocks[1],!0),s=this._convGen(e.blocks[0],!0);return r==="+"&&this.speedMode.implicitTypeCasting===0&&(e.blocks[0]&&e.blocks[0].type!=="number"&&e.blocks[0].type!=="bigint"&&(s=`self.__parseFloatOrBigint(${s})`),e.blocks[1]&&e.blocks[1].type!=="number"&&e.blocks[1].type!=="bigint"&&(o=`self.__parseFloatOrBigint(${o})`)),r==="^"||r==="**"?`((${s}) ** (${o}))`:r==="\xF7\xF7"?`(Math.floor(${s} / ${o}))`:(n[r]&&(r=n[r]),`(${s} ${r} ${o})`)}convInc(e){let r=`$nako_v${this.loopId++}`,o="1";this.speedMode.invalidSore===0&&(o=this.varname_get("\u305D\u308C"));let s=e.blocks[0];s.type!=="nop"&&(o=this._convGen(s,!0));let u="",i="",c="",a="",f=e.name;if(f.type==="ref_array")i=this.convRefArray(f),c=`${i} = ${r}`,a=`${i} = 0`;else{let l=f.value,p=this.findVar(l,r);if(p===null&&(this.varsSet.names.add(l),p=this.findVar(l,r),!p))throw new Error("\u300E\u5897\u300F\u307E\u305F\u306F\u300E\u6E1B\u300F\u3067\u5909\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002");i=p.js,c=p.js_set,p=this.findVar(l,"0"),p!==null&&(a=p.js_set)}return u+=`
/*[convInc]*/
`,u+=this.convLineno(e,!1)+`
`,u+=`let ${r} = ${i}
`,u+=`if (typeof ${r} === 'undefined') { ${a}; }
`,u+=`${r} = Number(${i}) + Number(${o});
`,u+=`${c}
`,u+=`/*[/convInc]*/
`,u}convLet(e){let n=e.blocks[0],r=null;if(this.speedMode.invalidSore===0&&(r=this.varname_get("\u305D\u308C")),n){if(n.type==="func"&&n.name!==void 0){let i=n,c=this.__self.getFunc(i.name);if(c&&c.return_none)throw y.fromNode(`\u95A2\u6570\u300E${n.name}\u300F\u306F\u623B\u308A\u5024\u304C\u306A\u3044\u306E\u3067\u7D50\u679C\u3092\u4EE3\u5165\u3067\u304D\u307E\u305B\u3093\u3002`,e)}r=this._convGen(n,!0)}if(r==null)throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u5909\u6570\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let o=e.name,s=this.findVar(o,r),u="/*[convLet]*/";if(s===null)this.varsSet.names.add(o),u=`${this.varname_set(o,r)};`;else{if(this.varslistSet[s.i].readonly.has(o))throw y.fromNode(`\u5B9A\u6570\u300E${o}\u300F\u306F\u65E2\u306B\u5B9A\u7FA9\u6E08\u307F\u306A\u306E\u3067\u3001\u5024\u3092\u4EE3\u5165\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002`,e);u=`${s.js_set};`}return";"+this.convLineno(e,!1)+u+`
`}convLetProp(e){if(!e.index||e.index.length==0)throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);if(!e.blocks||e.blocks.length==0)throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5024\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let n=e.index,r=n.pop();if(r===void 0)throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let o=typeof r.value=="string"?r.value:"",s=e.blocks[0],u=null;if(s)u=this._convGen(s,!0);else throw y.fromNode("\u4EE3\u5165\u3059\u308B\u5024\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let i=e.name,c=this.findVar(i,u),a="/*[convLetProp]*/";if(c===null)throw y.fromNode(`\u5909\u6570\u300E${i}\u300F\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002`,e);let f=c.js;if(n.length>0)for(let l of n)if(typeof l.value=="string")f+=`['${l.value}']`;else throw y.fromNode(`\u5909\u6570\u300E${f}\u300F\u4EE5\u4E0B\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u306B\u30A2\u30AF\u30BB\u30B9\u3067\u304D\u307E\u305B\u3093\u3002`,e);return a+=`if (typeof ${f}.__setProp === 'function') { ${f}.__setProp('${o}', ${u}, __self); } else {`,a+=`__self.__checkPropAccessor('set', ${f});`,a+=`if (typeof ${f}.__setProp === 'function') { ${f}.__setProp('${o}', ${u}, __self); } else {`,a+=`${f}['${o}'] = ${u} }};`,";"+this.convLineno(e,!1)+a+`
`}convRefProp(e){let n=this._convGen(e.name,!0),r=e.index;if(!r||r.length<=0)throw y.fromNode("\u30D7\u30ED\u30D1\u30C6\u30A3\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let o,s=r;if(s.length<=1){let u=s[0].value,i=`${n}.__getProp('${u}', __self)`,c=`${n}['${u}']`,a=`__self.__checkPropAccessor('get', ${n});
if (typeof ${n}.__getProp === 'function') { return ${i} }
return ${c}
`;o=`( (()=>{ ${`if (${n}.__getProp) { return ${i} } else { ${a} }`} })() )`}else{let u=[],i=[];for(let _=0;_<s.length;_++){let g=s[_].value;i.push(`['${g}']`),u.push(`'${g}'`)}let c=i.join(""),a="["+u.join(",")+"]",f=`${n}.__getProp(${a}, __self)`,l=`${n}${c}`,p=`__self.__checkPropAccessor('get', ${n});
if (${n}.__getProp) { return ${f} }
return ${l}
`;o=`( (()=>{ ${`if (${n}.__getProp) { return ${f} } else { ${p} }`} })() )`}return o}convDefLocalVar(e){let n=e.blocks[0],r="0";n.type!=="nop"&&(r=this._convGen(n,!0));let o=e.name,s=e.vartype;if(this.varsSet.names.has(o))throw y.fromNode(`${s}\u300E${o}\u300F\u306E\u4E8C\u91CD\u5B9A\u7FA9\u306F\u3067\u304D\u307E\u305B\u3093\u3002`,e);this.varsSet.names.add(o),s==="\u5B9A\u6570"&&this.varsSet.readonly.add(o);let u=`/*${s}*/${this.varname_set(o,r)};
`;return this.convLineno(e,!1)+u}convDefLocalVarlist(e){let n="",r=e.vartype,o="0";if(e.blocks.length>0){let c=e.blocks[0];c.type!=="nop"&&(o=this._convGen(c,!0))}let u=`$nako_i${this.loopId++}`;n+=`let ${u} = ${o}
`,n+=`if (!(${u} instanceof Array)) { ${u}=[${u}] }
`;let i=e.names?e.names:[];for(let c=0;c<i.length;c++){let f=i[c].value;this.varsSet.names.has(f),this.varsSet.names.add(f),r==="\u5B9A\u6570"&&this.varsSet.readonly.add(f),n+=this.varname_set(f,`${u}[${c}]`)+`;
`}return this.convLineno(e,!1)+`/*[convDefLocalVarlist]*/
`+n+`/*[/convDefLocalVarlist]*/
`}convString(e){let n=""+e.value;return n=n.replace(/\\/g,"\\\\"),n=n.replace(/"/g,'\\"'),n=n.replace(/\r/g,"\\r"),n=n.replace(/\n/g,"\\n"),'"'+n+'"'}convTryExcept(e){let n=this._convGen(e.blocks[0],!1),r=this._convGen(e.blocks[1],!1);return this.convLineno(e,!1)+`try {
${n}
} catch (e) {
  __self.__setSysVar("\u30A8\u30E9\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8", e.message);
;
${r}}
`}getUsedFuncSet(){return this.usedFuncSet}getPluginInitCode(){let e="",n="";for(let r in this.__self.__module){let o=`!${r}:\u521D\u671F\u5316`;this.varslistSet[0].names.has(o)&&(this.usedFuncSet.add(`!${r}:\u521D\u671F\u5316`),n+=`__v0.get('!${r}:\u521D\u671F\u5316')(__self);
`)}return n!==""&&(e+=`__v0.set('__line', 'l0:\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316');
`+n),e}},Hn=`
// === generated by nadesiko3 v__version__(core:__coreVersion__) ===
// -----------------------------------------------------------------
// <nadesiko3standalone>
// -----------------------------------------------------------------
// --- import
import path from 'path'
import { NakoRuntimeError } from './nako3runtime/nako_errors.mjs'
__codeImportFiles__
// --- init global self
const self = {
  newVariables: () => {
    const map = new Map()
    return map
  }
}
self.coreVersion = '__coreVersion__'
self.version = '__version__'
self.logger = {
  error: (message) => { console.error(message) },
  warn: (message) => { console.warn(message) },
  send: (level, message) => { console.log(message) },
  runtimeError: (message, lineInfo) => { console.error(message, lineInfo) }
};
self.__varslist = [self.newVariables(), self.newVariables(), self.newVariables()]
self.__v0 = self.__varslist[0]
self.initFuncList = []
self.clearFuncList = []
self.__propAccessor = []
// --- jsInit ---
__jsInit__
// --- Copy module functions ---
for (const mod of __importNames__) {
  for (const funcName in mod) {
    // \u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316\u3068\u30AF\u30EA\u30A2\u95A2\u6570\u3092\u767B\u9332
    if (funcName === '\u521D\u671F\u5316') {
      __self.initFuncList.push(mod[funcName].fn)
      continue
    }
    if (funcName === '!\u30AF\u30EA\u30A2') {
      __self.clearFuncList.push(mod[funcName].fn)
      continue
    }
    // \u95A2\u6570\u3084\u5B9A\u6570\u3092\u767B\u9332
    const f = mod[funcName]
    if (f.type === 'func') { // \u95A2\u6570
      __self.__varslist[0].set(funcName, f.fn)
    } else { // \u5B9A\u6570
      __self.__varslist[0].set(funcName, f.value)
    }
  }
}
__self.__vars = __self.__varslist[2];
__self.__module = {};
__self.__locals = __self.newVariables();
__self.__genMode = 'sync';
// \u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316\u30B3\u30FC\u30C9\u3092\u5B9F\u884C
__self.initFuncList.map(f => f(self))
// standalone
__self.__v0.set('__standalone', true)
// -----------------------------------------------------------------
try {
  try {
// -----------------------------------------------------------------
// <prepareMainCode>
__codeStandalone__
// </prepareMainCode>
// -----------------------------------------------------------------
// <mainCode>
// -----------------------------------------------------------------
__codeJS__
// -----------------------------------------------------------------
// </mainCode>
// -----------------------------------------------------------------
  } catch (err) {
    __self.logger.error(err);
    throw err;
  }
} finally {
  // standaloneCode\u3067\u306F\u3001\u5373\u6642\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u30AF\u30EA\u30A2\u30B3\u30FC\u30C9\u3092\u5B9F\u884C
  __self.clearFuncList.map(f => f(__self))
}
// -----------------------------------------------------------------
// </nadesiko3standalone>
// -----------------------------------------------------------------
`;function Et(t,e,n){let r=new rt(t);r.registerFunction(e);let o=Z(ne(r.convGen(e,n),1)),s=r.getDefFuncCode(t,n),u=""+new Date().getTime()+"_"+Math.floor(4294967295*Math.random());if(o&&n.isTest&&(o+=`
__self._runTests(__tests);
`),r.numAsyncFn>0||r.debugOption.useDebug){let l="__eval_nako3async_"+u+"__";o=`
// ------------------------------------------------------------------
// <nadesiko3::gen::async id="${u}" times="${r.numAsyncFn}">
// ------------------------------------------------------------------
async function ${l}(__self) {
  // --- code_begin ---
  ${o}
  // --- code_end ---
  // __\u51E6\u7406\u672B\u5C3E__ // \u2190 \u30C6\u30B9\u30C8\u306A\u3069\u3067\u5FC5\u8981\u306A\u306E\u3067\u6D88\u3055\u306A\u3044
} // end of ${l}
// ------------------------------------------------------------------
// call ${l}
(async () => {
  if (__self.__v0.get('__standalone')) {
    await ${l}(self);
  } else {
    ${l}.call(self, self)
    .then(() => { /* __async_ok__ */ })
    .catch(err => {
      if (err.message === '__\u7D42\u308F\u308B__') { return }
      __self.numFailures++
      // send errors to logger
      let rterr = __self.logger.runtimeError(err, __self.__v0.get('__line'))
      __self.logger.error(rterr)
    })
  }
})();
// ------------------------------------------------------------------
// </nadesiko3::gen::async id="${u}">
// ------------------------------------------------------------------
`}else{let l="__eval_nako3sync_"+u+"__";o=`
// ------------------------------------------------------------------
// <nadesiko3::gen::syncMode>
// ------------------------------------------------------------------
function ${l}(__self) {
try {
  ${o}
  // __\u51E6\u7406\u672B\u5C3E__ // \u2190 \u30C6\u30B9\u30C8\u306A\u3069\u3067\u5FC5\u8981\u306A\u306E\u3067\u6D88\u3055\u306A\u3044
} catch (err) {
  if (err.message === '__\u7D42\u308F\u308B__') { return }
  __self.numFailures++
  throw __self.logger.runtimeError(err, __self.__v0.get('__line'))
}
} // end of ${l}
${l}(__self)
// ------------------------------------------------------------------
// </nadesiko3::gen::syncMode>
// ------------------------------------------------------------------
`}o=ne(o);let i="",c=[];for(let l of n.importFiles){if(l==="nako_errors.mjs")continue;let p="nako3runtime_"+l.replace(/\.(js|mjs)$/,"").replace(/[^a-zA-Z0-9_]/g,"_");c.push(p),i+=`import ${p} from './nako3runtime/${l}'
`}let a=r.getPluginInitCode(),f=`
// <runtimeEnvCode>
const self = this
${n.codeEnv}
${s}
${a}
${o}
// </runtimeEnvCode>
`;return t.getLogger().trace(`--- generate::jsInit ---
`+s),t.getLogger().trace(`--- generate::js ---
`+o),{runtimeEnv:f,standalone:Wn(Hn,{codeImportFiles:i,coreVersion:t.coreVersion,version:t.version,importNames:"["+c.join(", ")+"]",codeStandalone:n.codeStandalone,codeJS:o,jsInit:s}),gen:r}}function Wn(t,e){for(let n in e){let r=`__${n}__`,o=e[n];t=t.split(r).join(o)}return t}function ne(t,e=0){t=t.replace(/;{2,}/g,";"),t=t.replace(/\n{2,}/g,`
`);let n="";for(let s=0;s<e;s++)n+="  ";let r=[],o=t.split(`
`);for(let s=0;s<o.length;s++){let u=o[s];u=u.replace(/^(\s*);/,"$1"),Z(u)!==""&&r.push(n+u)}return t=r.join(`
`),t}function Z(t){return t=String(t),t.replace(/^\s+|\s+$/g,"")}function Ve(t){let e=[];for(let n=0;n<t.length;n++){let r=t[n],o=r.type,s=r.value,u=`[${o}:${s}]`;o===s&&(u=o),o==="comma"&&(u=","),o==="string"&&(u=`"${s}"`),o==="number"&&(u=`(${s})`),o==="word"&&(u=`[word:${s}]`),e[r.line]||(e[r.line]=zn(r.indent)),e[r.line]+=u+r.josi+"|"}return e.join(`
`)}function zn(t){let e="";for(let n=0;n<t;n++)e+=" ";return e}var Le=M();function S(t,e,n=void 0){return n&&(Le=n),M(t,e,Le.indent,Le.line,Le.file)}var Kn=!1;function Nt(t){return t.type==="\u9055\u3048\u3070"||t.type==="word"&&t.value==="\u30A8\u30E9\u30FC"&&t.josi==="\u306A\u3089\u3070"}function Ft(t){let e=_e(t,"eol"),n=[],r=-1,o=0,s=0,u=c=>{c.forEach(a=>{a.type==="{"&&o++,a.type==="}"&&o--,a.type==="["&&s++,a.type==="]"&&s--})};for(let c=0;c<e.length;c++){let a=e[c];if(Tt(a))continue;let f=Ct(a);if(o>0||s>0){u(a);continue}if(r>=0){let p=f.indent;for(;r>=p;){let h=f;if(Nt(h)&&r===p||(e[c-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",h)),e[c-1].push(S("eol",`
`,h))),n.pop(),n.length>0)r=n[n.length-1];else{r=-1;break}}}if(u(a),o>0||s>0)continue;let l=Xn(a);l.type===":"&&(e[c]=e[c].filter(p=>p!==l),r=l.indent,n.push(r))}if(e.length>0&&n.length>0){let c=t[0];for(let a=e.length-1;a>=0;a--){let f=e[a];if(f.length>0){c=f[f.length-1];break}}for(let a=0;a<n.length;a++)e[e.length-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",c)),e[e.length-1].push(S("eol",`
`,c))}let i=de(e);return Kn&&console.log("###",Ve(i)),i}function de(t){let e=[];for(let n of t)for(let r of n)e.push(r);return e}function Xn(t){let e=t.length;if(e===0)return M("?");let n=t[e-1];return n.type==="eol"&&e>=2&&(n=t[e-2]),n}function _e(t,e){let n=[],r=[],o=0;for(let s of t)r.push(s),s.type==="{"?o++:s.type==="}"?o--:o===0&&s.type===e&&(n.push(r),r=[]);return r.length>0&&n.push(r),n}function Tt(t){if(t.length===0)return!0;for(let e=0;e<t.length;e++){let n=t[e].type;if(!(n==="eol"||n==="line_comment"||n==="range_comment"))return!1}return!0}function Ct(t){for(let e=0;e<t.length;e++){let n=t[e].type;if(!(n==="eol"||n==="line_comment"||n==="range_comment"))return t[e]}return t[0]}var Yn=["!\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","!\u3053\u3053\u307E\u3067\u3060\u308B\u3044","\u{1F4A1}\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","\u{1F4A1}\u3053\u3053\u307E\u3067\u3060\u308B\u3044"];function Lt(t){if(!Zn(t))return t;for(let c of t)if(c.type==="\u3053\u3053\u307E\u3067")throw new fe("\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587\u304C\u6709\u52B9\u5316\u3055\u308C\u3066\u3044\u308B\u3068\u304D\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u4F7F\u3046\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.line,c.file);let e=0,n=0,r=c=>{c.forEach(a=>{a.type==="{"&&e++,a.type==="}"&&e--,a.type==="["&&n++,a.type==="]"&&n--})},o=[],s=_e(t,"eol"),u=0;for(let c=0;c<s.length;c++){let a=s[c];if(Tt(a))continue;if(n>0||e>0){r(a);continue}let f=Ct(a),l=f.indent;if(l!==u){if(u>=0)for(;u>l;){let p=o[o.length-1][1];if(!(Nt(f)&&p===l)){let h=s[c-1][0];s[c-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",h)),s[c-1].push(S("eol",`
`,h))}if(o.pop(),o.length>0)u=o[o.length-1][0];else{u=0;break}}if(!(n>0||e>0)&&(r(a),l>u)){o.push([l,u]),u=l;continue}}}for(let c=0;c<o.length;c++){let a=t[0];for(let f=s.length-1;f>=0;f--){let l=s[f];if(l.length>0){a=l[l.length-1];break}}s[s.length-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",a)),s[s.length-1].push(S("eol",`
`,a))}return de(s)}function Zn(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&Yn.indexOf(n.value)>=0)return!0}return!1}var Qn=["!DNCL\u30E2\u30FC\u30C9","\u{1F4A1}DNCL\u30E2\u30FC\u30C9"],er={"\u2190:\u2190":["eq","="],"\xF7:\xF7":["\xF7\xF7","\xF7\xF7"],"{:{":["[","["],"}:}":["]","]"],"word:\u3092\u5B9F\u884C":["\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067"],"word:\u4E71\u6570":["word","\u4E71\u6570\u7BC4\u56F2"],"word:\u8868\u793A":["word","\u9023\u7D9A\u8868\u793A"]};function It(t){if(!tr(t))return t;let e=_e(t,"eol");for(let n=0;n<e.length;n++){let r=e[n];if(r.length<=1)continue;for(let a=0;a<r.length;a++){if(r[a].type==="|"){r[a].type="range_comment";continue}break}let o=r[0];o.type==="word"&&o.value==="\u7E70\u8FD4"&&r.splice(0,r.length,M("word","\u5F8C\u5224\u5B9A",o.indent,o.line,o.file),M("word","\u7E70\u8FD4",o.indent,o.line,o.file));let s=J(r,["word:\u306A\u308B","word:\u7E70\u8FD4"]);s>0&&Dt(r,s);let u=J(r,["word:\u306A\u308B","word:\u5B9F\u884C"]);u>0&&Dt(r,u);let i=J(r,["word:\u306A\u3044"]);for(i>=1&&r[i].josi==="\u306A\u3089\u3070"&&(r[i-1].josi="\u3067\u306A\u3051\u308C\u3070",r.splice(i,1));;){let a=J(r,["word:\u4E8C\u9032","word:\u8868\u793A"]);if(a<0)break;r[a].value="\u4E8C\u9032\u8868\u793A",r[a].josi="",r.splice(a+1,1)}for(;;){let a=J(r,["word:\u6539\u884C","word:\u8868\u793A"]);if(a<0)break;let f=r[a];f.value="\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A",f.josi="",r.splice(a+1,1)}for(;;){let a=J(r,["word:\u3092\u5B9F\u884C","comma:,","word:\u305D\u3046"]);if(a<0)break;let f=r[a+2];if(f.josi==="\u3067\u306A\u3051\u308C\u3070"){f.type="\u9055\u3048\u3070",f.value="\u9055\u3048\u3070",f.josi="",r.splice(a,3,f);continue}else if(f.josi==="\u3067"){let l=r[a+3];if(l.value.substring(0,4)==="\u306A\u304F\u3082\u3057"){if(f.type="\u9055\u3048\u3070",f.value="\u9055\u3048\u3070",f.josi="",r.splice(a,3,f),l.value.length>4){let p=l.value.substring(4),h=M("word",p,l.indent,l.line,l.file);p.match(/^\d/)&&(h.type="number"),r.splice(a+2,0,h),l.value=l.value.substring(0,4)}l.type="\u3082\u3057",l.value="\u3082\u3057",l.josi="";continue}}break}for(;;){let a=J(r,["word:\u5897","word:\u3089"]);if(a<0)break;let f=r[a];f.type="word",f.value="\u5897\u7E70\u8FD4",f.josi="",r.splice(a,2,f)}for(;;){let a=J(r,["word:\u6E1B","word:\u3089"]);if(a<0)break;let f=r[a];f.type="word",f.value="\u6E1B\u7E70\u8FD4",f.josi="",r.splice(a,2,f)}for(;;){let a=J(r,["word:\u3092\u7E70\u308A\u8FD4"]);if(a<0)break;let f=r[a];f.type="\u3053\u3053\u307E\u3067",f.value="\u3053\u3053\u307E\u3067",f.josi=""}for(;;){let a=J(r,["word:\u3059\u3079\u3066","word:\u8981\u7D20"]);if(a>=1)Vt(r,a);else break}for(;;){let a=J(r,["word:\u3059\u3079\u3066","word:\u5024"]);if(a>=1)Vt(r,a);else break}let c=0;for(;c<r.length;){let a=r[c];if(a.type==="word"&&a.value.length>=2){let f=a.value.charAt(a.value.length-1);(f==="\u6E1B"||f==="\u5897")&&(a.value=a.value.substring(0,a.value.length-1),a.josi="\u3060\u3051",r.splice(c+1,0,M("word",f,a.indent,a.line,a.file))),c++;continue}c++}}for(let n=0;n<t.length;n++){let r=t[n],o=er[r.type+":"+r.value];o!==void 0&&(r.type=o[0],r.value=o[1])}return t=de(e),t}function Vt(t,e){let n=t[e];t[e-1].josi="";let r=M("eq","=",n.indent,n.line,n.file),o=M("[","[",n.indent,n.line,n.file),s=M("]","]",n.indent,n.line,n.file);s.josi="\u306B";let u=t[e+2];u.josi="";let i=M("number",100,n.indent,n.line,n.file);i.josi="\u3092";let c=M("word","\u639B",n.indent,n.line,n.file);t.splice(e,4,r,o,u,s,i,c)}function Dt(t,e){let n=J(t,["word:\u3092"]);n>=0&&(t[n].type="\u3053\u3053\u307E\u3067",t[n].value="\u3053\u3053\u307E\u3067");let r=J(t,["word:\u304C"]);r>=0&&(t[r].type="\u3053\u3053\u307E\u3067",t[r].value="\u3053\u3053\u307E\u3067"),t[e+1].value="\u9593"}function J(t,e){let n=e.map(r=>r.split(":"));for(let r=0;r<t.length;r++){let o=!0;for(let s=0;s<n.length;s++){let u=n[s],i=r+s;if(i>=t.length)return-1;if(!(t[i].type===u[0]&&t[i].value===u[1])){o=!1;break}}if(o)return r}return-1}function tr(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&Qn.indexOf(n.value)>=0)return n.type="DNCL\u30E2\u30FC\u30C9",!0}return!1}var nr=!1,ot=30,rr=["!DNCL2\u30E2\u30FC\u30C9","\u{1F4A1}DNCL2\u30E2\u30FC\u30C9","!DNCL2","\u{1F4A1}DNCL2"],or={"\u2190:\u2190":["eq","="],"\xF7:\xF7":["\xF7\xF7","\xF7\xF7"],"{:{":["[","["],"}:}":["]","]"],"word:not":["not","!"],"word:\u4E71\u6570":["word","\u4E71\u6570\u7BC4\u56F2"],"word:\u8868\u793A":["word","\u9023\u7D9A\u8868\u793A"],"word:\u3068\u5B9A\u7FA9":["\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067"]};function Pt(t){if(!sr(t))return t;let e=_e(t,"eol");for(let n=0;n<e.length;n++){let r=e[n];if(r.length<=1)continue;let o=W(r,["word:\u306A\u3044"]);o>=1&&r[o].josi==="\u306A\u3089\u3070"&&(r[o-1].josi="\u3067\u306A\u3051\u308C\u3070",r.splice(o,1));for(let u=0;u<r.length;u++){let i=r[u];(i.value==="\u305D\u3046"||i.value==="\u305D\u308C")&&(i.josi==="\u3067\u306A\u3051\u308C\u3070"||i.josi==="\u3067\u306A\u304F")&&(i.type="\u9055\u3048\u3070",i.value="\u9055\u3048\u3070",i.josi="")}for(;;){let u=W(r,["word:\u3092\u5B9F\u884C","comma:,","word:\u305D\u3046"]);if(u<0)break;let i=r[u+2];if(i.josi==="\u3067\u306A\u3051\u308C\u3070"){i.type="\u9055\u3048\u3070",i.value="\u9055\u3048\u3070",i.josi="",r.splice(u,3,i);continue}else if(i.josi==="\u3067"){let c=r[u+3];if(c.value.substring(0,4)==="\u306A\u304F\u3082\u3057"){if(i.type="\u9055\u3048\u3070",i.value="\u9055\u3048\u3070",i.josi="",r.splice(u,3,i),c.value.length>4){let a=c.value.substring(4),f=M("word",a,c.indent,c.line,c.file);a.match(/^\d/)&&(f.type="number"),r.splice(u+2,0,f),c.value=c.value.substring(0,4)}c.type="\u3082\u3057",c.value="\u3082\u3057",c.josi="";continue}}break}for(;;){let u=W(r,["word:\u305D\u3046","word:\u306A\u304F"]);if(u<0)break;let i=r[u];if(i.josi==="\u3067"){i.type="\u9055\u3048\u3070",i.value="\u9055\u3048\u3070",i.josi="",r.splice(u+1,1);continue}break}for(;;){let u=W(r,["word:\u305D\u3046","word:\u306A\u304F\u3082\u3057"]);if(u<0)break;let i=r[u],c=r[u+1];i.type="\u9055\u3048\u3070",i.value="\u9055\u3048\u3070",i.josi="",c.type="\u3082\u3057",c.value="\u3082\u3057",c.josi=""}for(;;){let u=W(r,["word:\u5897","word:\u3089"]);if(u<0)break;let i=r[u];i.type="word",i.value="\u5897\u7E70\u8FD4",i.josi="",r.splice(u,2,i)}for(;;){let u=W(r,["word:\u6E1B","word:\u3089"]);if(u<0)break;let i=r[u];i.type="word",i.value="\u6E1B\u7E70\u8FD4",i.josi="",r.splice(u,2,i)}for(;;){let u=W(r,["word:\u5897","word:\u3089\u7E70\u308A\u8FD4"]);if(u<0)break;let i=r[u];i.type="word",i.value="\u5897\u7E70\u8FD4",i.josi="",r.splice(u,2,i)}for(;;){let u=W(r,["word:\u6E1B","word:\u3089\u7E70\u308A\u8FD4"]);if(u<0)break;let i=r[u];i.type="word",i.value="\u6E1B\u7E70\u8FD4",i.josi="",r.splice(u,2,i)}for(let u=0;u<r.length;u++){if(st([["word:\u914D\u5217","word:\u914D\u5217\u5909\u6570"],"word","word:\u3059\u3079\u3066",["word:\u8981\u7D20","word:\u5024"],"*","word:\u4EE3\u5165"],r,u)){let i=r[u+1];i.josi="";let c=r[u+4];c.josi="",r.splice(u,6,i,S("eq","=",i),S("word","\u639B"),S("(","("),S("[","["),c,S("]","]"),S("comma",","),S("number",ot),S(")",")")),u+=6}if(st(["word","word:\u3059\u3079\u3066",["word:\u8981\u7D20","word:\u5024"],["number","string","word"],"word:\u3059\u308B"],r,u)){let i=r[u];i.josi="";let c=r[u+3];c.josi="",r.splice(u,5,i,S("eq","=",i),S("word","\u639B"),S("(","("),S("[","["),c,S("]","]"),S("comma",","),S("number",ot),S(")",")"))}if(st([["word:\u914D\u5217\u5909\u6570","word:\u914D\u5217"],"word","word:\u521D\u671F\u5316"],r,u)){let i=r[u+1];i.josi="",r.splice(u,3,i,S("eq","=",i),S("word","\u639B"),S("(","("),S("[","["),S("number",0),S("]","]"),S("comma",","),S("number",ot),S(")",")"))}}for(;;){let u=W(r,["word:\u4E8C\u9032","word:\u8868\u793A"]);if(u<0)break;r[u].value="\u4E8C\u9032\u8868\u793A",r[u].josi="",r.splice(u+1,1)}for(;;){let u=W(r,["word:\u6539\u884C","word:\u8868\u793A"]);if(u<0)break;let i=r[u];i.value="\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A",i.josi="",r.splice(u+1,1)}let s=0;for(;s<r.length;){let u=r[s];if(u.type==="word"&&u.value.length>=2){let i=u.value.charAt(u.value.length-1);(i==="\u6E1B"||i==="\u5897")&&(u.value=u.value.substring(0,u.value.length-1),u.josi="\u3060\u3051",r.splice(s+1,0,M("word",i,u.indent,u.line,u.file))),s++;continue}s++}}for(let n=0;n<t.length;n++){let r=t[n],o=or[r.type+":"+r.value];o!==void 0&&(r.type=o[0],r.value=o[1])}return t=de(e),nr&&(console.log("// DEBUG---DNCL:tokens---BEGIN"),console.log(Ve(t)),console.log("// DEBUG---DNCL:tokens---END")),t}function st(t,e,n){let r=(o,s)=>{if(o instanceof Array){for(let i=0;i<o.length;i++)if(r(o[i],s))return!0;return!1}if(o==="*")return!0;if(o.indexOf(":")<0)return o===s.type;let u=`${s.type}:${s.value}`;return o===u};for(let o=0;o<t.length;o++){let s=o+n;if(s>=e.length)return!1;let u=t[o],i=e[s];if(!r(u,i))return!1}return!0}function W(t,e){let n=e.map(r=>r.split(":"));for(let r=0;r<t.length;r++){let o=!0;for(let s=0;s<n.length;s++){let u=n[s],i=r+s;if(i>=t.length)return-1;if(!(t[i].type===u[0]&&t[i].value===u[1])){o=!1;break}}if(o)return r}return-1}function sr(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&rr.indexOf(n.value)>=0)return n.type="DNCL2\u30E2\u30FC\u30C9",!0}return!1}var De=class{constructor(e,n){this.sourceCodeLength=e,this.preprocessed=n;let r=0;this.cumulativeSum=[];for(let o of n)this.cumulativeSum.push(r),r+=o.text.length;this.lastIndex=0,this.lastPreprocessedCodePosition=0}map(e){let n=this.findIndex(e);return Math.min(this.preprocessed[n].sourcePosition+(e-this.cumulativeSum[n]),n===this.preprocessed.length-1?this.sourceCodeLength:this.preprocessed[n+1].sourcePosition-1)}findIndex(e){e<this.lastPreprocessedCodePosition&&(this.lastIndex=0),this.lastPreprocessedCodePosition=e;for(let n=this.lastIndex;n<this.preprocessed.length-1;n++)if(e<this.cumulativeSum[n+1])return this.lastIndex=n,n;return this.lastIndex=this.preprocessed.length-1,this.preprocessed.length-1}},Ie=class{constructor(e,n,r){this.lines=[],this.linesInsertedByIndentationSyntax=n,this.linesDeletedByIndentationSyntax=r;let o=0;for(let s of e.split(`
`))this.lines.push({offset:o,len:s.length}),o+=s.length+1;this.lastLineNumber=0,this.lastOffset=0}map(e,n){if(e===null)return{startOffset:e,endOffset:n};let r=this.getLineNumber(e);for(let o of this.linesInsertedByIndentationSyntax){if(r===o){e=null,n=null;break}r>o&&(e-=this.lines[o].len+1,n!==null&&(n-=this.lines[o].len+1))}for(let o of this.linesDeletedByIndentationSyntax)r>=o.lineNumber&&(e!==null&&(e+=o.len+1),n!==null&&(n+=o.len+1));return{startOffset:e,endOffset:n}}getLineNumber(e){e<this.lastOffset&&(this.lastLineNumber=0),this.lastOffset=e;for(let n=this.lastLineNumber;n<this.lines.length-1;n++)if(e<this.lines[n+1].offset)return this.lastLineNumber=n,n;return this.lastLineNumber=this.lines.length-1,this.lines.length-1}},ye=class{constructor(e){this.lineOffsets=[];let n=0;for(let r of e.split(`
`))this.lineOffsets.push(n),n+=r.length+1;this.lastLineNumber=0,this.lastOffset=0}map(e,n){e<this.lastOffset&&(this.lastLineNumber=0),this.lastOffset=e;for(let r=this.lastLineNumber;r<this.lineOffsets.length-1;r++)if(e<this.lineOffsets[r+1])return this.lastLineNumber=r,{line:r+(n?1:0),column:e-this.lineOffsets[r]};return this.lastLineNumber=this.lineOffsets.length-1,{line:this.lineOffsets.length-1+(n?1:0),column:e-this.lineOffsets[this.lineOffsets.length-1]}}};function it(t,e){if(typeof t.startOffset=="number"&&(t.startOffset-=e.length),typeof t.endOffset=="number"&&(t.endOffset-=e.length),e!==""){let n=e.split(`
`);typeof t.line=="number"&&(t.line-=n.length-1),t.line===0&&typeof t.column=="number"&&(t.column-=n[n.length-1].length)}return t}var ir={reset:"\x1B[0m",bold:"\x1B[1m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},ut=["black","red","green","yellow","blue","magenta","cyan","white"],ur=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),cr=t=>{let e=t.replace(/\x1b\[\d+m/g,""),n=[],r="inherit",o="inherit",s=t===e?e:t.replace(/\x1b\[(\d+)m/g,(a,f)=>{let l=+f;return l===0&&(r="inherit",o="inherit"),l===1&&(o="bold"),l>=30&&l<=37&&(r=ut[l-30]),n.push(`color: ${r}; font-weight: ${o};`),"%c"}),u="inherit",i="inherit",c=t===e?e:"<span>"+ur(t).replace(/\x1b\[(\d+)m/g,(a,f)=>{let l=+f;return l===0&&(u="inherit",i="inherit"),l===1&&(i="bold"),l>=30&&l<=37&&(u=ut[l-30]),`</span><span style="color: ${u}; font-weight: ${i};">`})+"</span>";return{noColor:e,nodeConsole:t===e?e:t+"\x1B[0m",html:c,browserConsole:[s,...n]}},O={convertColorTextFormat:cr,colorNames:ut,color:ir};var T=class t{static fromS(e){let n=t.trace;switch(e){case"all":n=t.all;break;case"trace":n=t.trace;break;case"debug":n=t.debug;break;case"info":n=t.info;break;case"warn":n=t.warn;break;case"error":n=t.error;break;case"stdout":n=t.stdout;break;default:throw new Error("[NakoLogger] unknown logger level:"+e)}return n}static toString(e){return["all","trace","debug","info","warn","error","stdout"][e]}};T.all=0;T.trace=1;T.debug=2;T.info=3;T.warn=4;T.error=5;T.stdout=6;function be(t){return t?`${t.file||""}${t.line===void 0?"":`(${t.line+1}\u884C\u76EE): `}`:""}var we=class{constructor(){this.listeners=[],this.logs="",this.position=""}getErrorLogs(){return[this.logs.replace(/\s+$/,""),this.position]}clear(){this.logs="",this.position=""}addListener(e,n){let r=T.fromS(e);this.listeners.push({level:r,callback:n})}removeListener(e){this.listeners=this.listeners.filter(n=>n.callback!==e)}trace(e,n=null){this.sendI(T.trace,`${O.color.bold}[\u30C7\u30D0\u30C3\u30B0\u60C5\u5831\uFF08\u8A73\u7D30\uFF09]${O.color.reset}${be(n)}${e}`,n)}debug(e,n=null){this.sendI(T.debug,`${O.color.bold}[\u30C7\u30D0\u30C3\u30B0\u60C5\u5831]${O.color.reset}${be(n)}${e}`,n)}info(e,n=null){this.sendI(T.info,`${O.color.bold}${O.color.blue}[\u60C5\u5831]${O.color.reset}${be(n)}${e}`,n)}warn(e,n=null){this.sendI(T.warn,`${O.color.bold}${O.color.green}[\u8B66\u544A]${O.color.reset}${be(n)}${e}`,n)}error(e,n=null){if(e instanceof Error&&typeof e.type=="string")switch(e.type){case"NakoRuntimeError":case"NakoError":if(e instanceof P){let o=e,s=n;s==null&&(s={file:o.file,line:o.line||0,startOffset:0,endOffset:0}),this.sendI(T.error,o.message,s);return}}e instanceof Error&&(e=e.message),this.sendI(T.error,`${O.color.bold}${O.color.red}[\u30A8\u30E9\u30FC]${O.color.reset}${be(n)}${e}`,n)}runtimeError(e,n){return new se(e,n)}stdout(e,n=null){this.sendI(T.stdout,`${e}`,n)}send(e,n,r,o=null,s=null){let u=T.fromS(e);this.sendI(u,n,r,o,s)}sendI(e,n,r,o=null,s=null){let u=()=>{let i=O.convertColorTextFormat(n),c="";return n.includes(`
`)&&(c+="border-top: 1px solid #8080806b; border-bottom: 1px solid #8080806b;"),{noColor:i.noColor,nodeConsole:i.nodeConsole,browserConsole:s||i.browserConsole,html:`<div style="${c}">`+(o||i.html)+"</div>",level:T.toString(e),position:r}};if(e===T.error){let i=u();this.logs+=i.noColor+`
`,r&&this.position!==null&&(this.position=`l${r.line}:${r.file}`)}for(let i of this.listeners)if(i.level<=e){let c=u();i.callback(c)}}};var Pe=class{constructor(e,n,r=0){this.guid=r,this.lastJSCode="",this.__locals=new Map,this.__varslist=[e.newVaiables(e.__varslist[0]),e.newVaiables(e.__varslist[1]),e.newVaiables(e.__varslist[2])],this.numFailures=0,this.index=0,this.nextIndex=-1,this.__code=[],this.__callstack=[],this.__stack=[],this.__labels=[],this.__genMode=n.genMode,this.version=e.version,this.coreVersion=e.coreVersion,this.__module={...e.__module},this.pluginfiles={...e.getPluginfiles()},this.gen=n,this.logger=e.getLogger(),this.compiler=e,this.josiList=e.josiList,this.reservedWords=e.reservedWords}clearLog(){this.__varslist[0].set("\u8868\u793A\u30ED\u30B0","")}get log(){let e=this.__varslist[0].get("\u8868\u793A\u30ED\u30B0");return e=e.replace(/\s+$/,""),e}__setSysVar(e,n){this.__varslist[0].set(e,n)}__getSysVar(e){return this.__varslist[0].get(e)}runEx(e,n,r,o=""){return r.preCode=o,r.nakoGlobal=this,this.compiler.runSync(e,n,r)}async runAsync(e,n,r,o=""){return r.preCode=o,r.nakoGlobal=this,await this.compiler.runAsync(e,n,r)}_runTests(e){let n=`${O.color.bold}\u30C6\u30B9\u30C8\u306E\u5B9F\u884C\u7D50\u679C${O.color.reset}
`,r=0,o=0;for(let s of e)try{s.f(),n+=`${O.color.green}\u2714${O.color.reset} ${s.name}
`,r++}catch(u){n+=`${O.color.red}\u2613${O.color.reset} ${s.name}: ${u.message}
`,o++}o>0?n+=`${O.color.green}\u6210\u529F ${r}\u4EF6 ${O.color.red}\u5931\u6557 ${o}\u4EF6`:n+=`${O.color.green}\u6210\u529F ${r}\u4EF6`,this.numFailures=o,this.logger.stdout(n)}clearPlugins(){let e="!\u30AF\u30EA\u30A2";for(let n in this.pluginfiles){let r=this.__module[n];if(r[e]&&r[e].fn)try{r[e].fn(this)}catch(o){this.logger.error(`\u30D7\u30E9\u30B0\u30A4\u30F3\u300E${n}\u300F\u306E\u30AF\u30EA\u30A2\u95A2\u6570\u3067\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F:`+o.message)}}}reset(){this.clearPlugins()}destroy(){this.reset()}};var ar={version:"3.7.2",major:3,minor:7,patch:2},ct=ar;var Rt={meta:{type:"const",value:{pluginName:"plugin_system",description:"\u30B7\u30B9\u30C6\u30E0\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!1,fn:function(sys){let system=sys;sys.isDebug=!1,sys.__setSysVar=(t,e)=>system.__v0.set(t,e),sys.__getSysVar=(t,e=void 0)=>{let n=system.__v0.get(t);return n===void 0?e:n},sys.__setSore=t=>(sys.__vars.set("\u305D\u308C",t),t),sys.__getSore=()=>sys.__vars.get("\u305D\u308C"),sys.tags={},sys.__setSysVar("\u30CA\u30C7\u30B7\u30B3\u30D0\u30FC\u30B8\u30E7\u30F3",sys.version),sys.__setSysVar("\u30CA\u30C7\u30B7\u30B3\u8A00\u8A9E\u30D0\u30FC\u30B8\u30E7\u30F3",sys.coreVersion),system.__namespaceList||(system.__namespaceList=[]),sys.__findVar=function(t,e){if(typeof t=="function")return t;let n=system.__locals.get(t);if(n)return n;if(t.indexOf("__")>=0){for(let o=2;o>=0;o--){let u=system.__varslist[o].get(t);if(u)return u}return e}let r=system.__modList?system.__modList:[system.__modName];for(let o of r){let s=o+"__"+t;for(let u=2;u>=0;u--){let c=system.__varslist[u].get(s);if(c)return c}}return e},sys.__findFunc=function(t,e){let n=sys.__findVar(t);if(typeof n=="function")return n;throw new Error(`\u300E${e}\u300F\u306B\u5B9F\u884C\u3067\u304D\u306A\u3044\u95A2\u6570\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002`)},sys.__exec=function(t,e){let n=sys.__getSysVar(t);if(n)return n.apply(this,e);let r=sys.__findVar(t);if(!r)throw new Error("\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u3067\u30A8\u30A4\u30EA\u30A2\u30B9\u306E\u6307\u5B9A\u30DF\u30B9:"+t);return r.apply(this,e)},sys.__timeout=[],sys.__interval=[];let z2=sys.__zero2=t=>(t="00"+t,t.substring(t.length-2));sys.__zero=(t,e)=>{let n="";for(let r=0;r<e;r++)n+="0";return t=n+t,t.substring(t.length-e)},sys.__formatDate=t=>t.getFullYear()+"/"+z2(t.getMonth()+1)+"/"+z2(t.getDate()),sys.__formatTime=t=>z2(t.getHours())+":"+z2(t.getSeconds())+":"+z2(t.getMinutes()),sys.__formatDateTime=(t,e)=>{let n=t.getFullYear()+"/"+z2(t.getMonth()+1)+"/"+z2(t.getDate()),r=z2(t.getHours())+":"+z2(t.getMinutes())+":"+z2(t.getSeconds());return e.match(/^\d+\/\d+\/\d+\s+\d+:\d+:\d+$/)?n+" "+r:e.match(/^\d+\/\d+\/\d+$/)?n:e.match(/^\d+:\d+:\d+$/)?r:n+" "+r},sys.__str2date=t=>{if(t=(""+t).replace(/(^\s+|\s+$)/,""),t.match(/^(\d+|\d+\.\d+)$/))return new Date(parseFloat(t)*1e3);if(t.match(/^\d+:\d+(:\d+)?$/)){let n=new Date,r=(t+":0").split(":");return new Date(n.getFullYear(),n.getMonth(),n.getDate(),parseInt(r[0]),parseInt(r[1]),parseInt(r[2]))}t=t.replace(/[\s:\-T]/g,"/"),t+="/0/0/0";let e=t.split("/");return new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),parseInt(e[3]),parseInt(e[4]),parseInt(e[5]))},sys.__printPool="",sys.__parseFloatOrBigint=t=>typeof t=="bigint"?t:parseFloat(t),system.chk=(t,e)=>{if(typeof t>"u"){let n=system.constPools[e],[r,o,s,u]=n,i=system.constPoolsTemplate[r];for(let a in o){let f=system.constPoolsTemplate[o[a]];i=i.split(`$${a}`).join(f)}let c=system.constPoolsTemplate[s];sys.logger.warn(i,{file:c,line:u})}return t},sys.__evalSafe=t=>{let e=eval;try{return e(t)}catch(n){return console.warn("[eval]",n),null}},sys.__evalJS=(src,sys)=>{try{return eval(src)}catch(t){return console.warn("[eval]",t),null}},sys.__registPropAccessor=(t,e,n)=>{system.__propAccessor.push({target:t,getProp:e,setProp:n})},sys.__checkPropAccessor=(t,e)=>{if(t==="get"&&e.__getProp===void 0||t==="set"&&e.__setProp===void 0){for(let n=0;n<system.__propAccessor.length;n++){let r=system.__propAccessor[n];if(r.target[Symbol.hasInstance](e)){r.getProp?e.__getProp=r.getProp:e.__getProp=null,r.setProp?e.__setProp=r.setProp:e.__setProp=null;return}}e.__getProp=e.__setProp=null}},sys.__hatena=sys.__getSysVar("\u30C7\u30D0\u30C3\u30B0\u8868\u793A")}},"!\u30AF\u30EA\u30A2":{type:"func",josi:[],fn:function(t){t.__exec&&t.__exec("\u5168\u30BF\u30A4\u30DE\u30FC\u505C\u6B62",[t]),t.__setSysVar("\u8868\u793A\u30ED\u30B0","")}},\u30CA\u30C7\u30B7\u30B3\u30D0\u30FC\u30B8\u30E7\u30F3:{type:"const",value:"?"},\u30CA\u30C7\u30B7\u30B3\u8A00\u8A9E\u30D0\u30FC\u30B8\u30E7\u30F3:{type:"const",value:"?"},\u30CA\u30C7\u30B7\u30B3\u30A8\u30F3\u30B8\u30F3:{type:"const",value:"nadesi.com/v3"},\u30CA\u30C7\u30B7\u30B3\u7A2E\u985E:{type:"const",value:"?"},\u306F\u3044:{type:"const",value:!0},\u3044\u3044\u3048:{type:"const",value:!1},\u771F:{type:"const",value:!0},\u507D:{type:"const",value:!1},\u6C38\u9060:{type:"const",value:!0},\u30AA\u30F3:{type:"const",value:!0},\u30AA\u30D5:{type:"const",value:!1},\u6539\u884C:{type:"const",value:`
`},\u30BF\u30D6:{type:"const",value:"	"},\u30AB\u30C3\u30B3:{type:"const",value:"\u300C"},\u30AB\u30C3\u30B3\u9589:{type:"const",value:"\u300D"},\u6CE2\u30AB\u30C3\u30B3:{type:"const",value:"{"},\u6CE2\u30AB\u30C3\u30B3\u9589:{type:"const",value:"}"},OK:{type:"const",value:!0},NG:{type:"const",value:!1},\u30AD\u30E3\u30F3\u30BB\u30EB:{type:"const",value:0},TRUE:{type:"const",value:!0},FALSE:{type:"const",value:!1},true:{type:"const",value:!0},false:{type:"const",value:!1},PI:{type:"const",value:Math.PI},\u7A7A:{type:"const",value:""},NULL:{type:"const",value:null},undefined:{type:"const",value:void 0},\u672A\u5B9A\u7FA9:{type:"const",value:void 0},\u30A8\u30E9\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8:{type:"const",value:""},\u5BFE\u8C61:{type:"const",value:""},\u5BFE\u8C61\u30AD\u30FC:{type:"const",value:""},\u56DE\u6570:{type:"const",value:""},CR:{type:"const",value:"\r"},LF:{type:"const",value:`
`},\u975E\u6570:{type:"const",value:NaN},\u7121\u9650\u5927:{type:"const",value:1/0},\u623B\u5024\u7121:{type:"const",value:0},\u623B\u5024\u6709:{type:"const",value:1},\u7A7A\u914D\u5217:{type:"func",josi:[],pure:!0,fn:function(){return[]}},\u7A7A\u8F9E\u66F8:{type:"func",josi:[],pure:!0,fn:function(){return{}}},\u7A7A\u30CF\u30C3\u30B7\u30E5:{type:"func",josi:[],pure:!0,fn:function(){return{}}},\u7A7A\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8:{type:"func",josi:[],pure:!1,fn:function(t){return t.__exec("\u7A7A\u30CF\u30C3\u30B7\u30E5",[t])}},\u771F\u507D\u5224\u5B9A:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return t?"\u771F":"\u507D"}},\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){t=e.__printPool+t,e.__printPool="",e.__setSysVar("\u8868\u793A\u30ED\u30B0",e.__getSysVar("\u8868\u793A\u30ED\u30B0")+t+`
`),e.logger.send("stdout",t+"")},return_none:!0},\u7D99\u7D9A\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__printPool+=t},return_none:!0},\u9023\u7D9A\u8868\u793A:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){let e=t.pop(),n=t.join("");e.__exec("\u8868\u793A",[n,e])},return_none:!0},\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){let e=t.pop(),n=t.join("");e.__exec("\u7D99\u7D9A\u8868\u793A",[n,e])},return_none:!0},\u8868\u793A\u30ED\u30B0:{type:"const",value:""},\u8868\u793A\u30ED\u30B0\u30AF\u30EA\u30A2:{type:"func",josi:[],pure:!0,fn:function(t){t.__setSysVar("\u8868\u793A\u30ED\u30B0","")},return_none:!0},\u8A00:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.logger.send("stdout",t+"")},return_none:!0},\u30B3\u30F3\u30BD\u30FC\u30EB\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t){console.log(t)},return_none:!0},\u8DB3:{type:"func",josi:[["\u306B","\u3068"],["\u3092"]],isVariableJosi:!1,pure:!0,fn:function(t,e){return t+e}},\u5F15:{type:"func",josi:[["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){return t-e}},\u639B:{type:"func",josi:[["\u306B","\u3068"],["\u3092"]],pure:!0,fn:function(t,e){if(typeof t=="number")return t*e;if(typeof t=="string"){let n="";for(let r=0;r<parseInt(e);r++)n+=t;return n}if(t instanceof Array){let n=[];for(let r=0;r<parseInt(e);r++)n.push(...t);return n}return t*e}},\u500D:{type:"func",josi:[["\u306E","\u3092"],[""]],pure:!0,fn:function(t,e){return t*e}},\u5272:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t/e}},\u5272\u4F59:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t%e}},\u5076\u6570:{type:"func",josi:[["\u304C"]],pure:!0,fn:function(t){return parseInt(t)%2===0}},\u5947\u6570:{type:"func",josi:[["\u304C"]],pure:!0,fn:function(t){return parseInt(t)%2===1}},\u4E8C\u4E57:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return t*t}},\u3079\u304D\u4E57:{type:"func",josi:[["\u306E"],["\u306E"]],pure:!0,fn:function(t,e){return Math.pow(t,e)}},\u4EE5\u4E0A:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t>=e}},\u4EE5\u4E0B:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t<=e}},\u672A\u6E80:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t<e}},\u8D85:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t>e}},\u7B49:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){return t===e}},\u7B49\u7121:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){return t!==e}},\u4E00\u81F4:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){if(typeof t=="object"){let n=JSON.stringify(t),r=JSON.stringify(e);return n===r}return t===e}},\u4E0D\u4E00\u81F4:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){if(typeof t=="object"){let n=JSON.stringify(t),r=JSON.stringify(e);return n!==r}return t!==e}},\u7BC4\u56F2\u5185:{type:"func",josi:[["\u304C"],["\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){return e<=t&&t<=n}},\u7BC4\u56F2:{type:"func",josi:[["\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e){return{\u5148\u982D:t,\u672B\u5C3E:e}}},\u9023\u7D9A\u52A0\u7B97:{type:"func",josi:[["\u3092"],["\u306B","\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>n+r)}},MAX:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){let n=e.pop();return n.__exec("\u6700\u5927\u5024",[t,...e,n])}},\u6700\u5927\u5024:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>Math.max(n,r))}},MIN:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){let n=e.pop();return n.__exec("\u6700\u5C0F\u5024",[t,...e,n])}},\u6700\u5C0F\u5024:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>Math.min(n,r))}},CLAMP:{type:"func",josi:[["\u306E","\u3092"],["\u304B\u3089"],["\u307E\u3067\u306E","\u3067"]],pure:!0,fn:function(t,e,n){return Math.min(Math.max(t,e),n)}},\u304F\u3060\u3055\u3044:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u304A\u9858:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u3067\u3059:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u62DD\u5553:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu=0},return_none:!0},\u656C\u5177:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu+=100},return_none:!0},\u793C\u7BC0\u30EC\u30D9\u30EB\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){return t.__reisetu||(t.__reisetu=0),t.__reisetu}},JS\u5B9F\u884C:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){return e.__evalJS(t,e)}},JS\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){return e.__findVar(t,null)}},JS\u95A2\u6570\u5B9F\u884C:{type:"func",josi:[["\u3092"],["\u3067"]],fn:function(t,e,n){if(typeof t=="string"&&(t=n.__evalJS(t,n)),typeof t!="function")throw new Error("JS\u95A2\u6570\u53D6\u5F97\u3067\u5B9F\u884C\u3067\u304D\u307E\u305B\u3093\u3002");return e instanceof Array||(e=[e]),t.apply(null,e)}},ASYNC:{type:"func",josi:[],asyncFn:!0,pure:!0,fn:async function(){},return_none:!0},AWAIT\u5B9F\u884C:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,asyncFn:!0,fn:async function(t,e,n){if(typeof t=="string"&&(t=n.__findFunc(t,"AWAIT\u5B9F\u884C")),!(t instanceof Function))throw new Error("\u300EAWAIT\u5B9F\u884C\u300F\u306E\u7B2C\u4E00\u5F15\u6570\u306F\u306A\u3067\u3057\u3053\u95A2\u6570\u540D\u304BFunction\u578B\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return await t(...e)}},JS\u30E1\u30BD\u30C3\u30C9\u5B9F\u884C:{type:"func",josi:[["\u306E"],["\u3092"],["\u3067"]],fn:function(t,e,n,r){if(typeof t=="string"&&(t=r.__evalJS(t,r)),typeof t!="object")throw new Error("JS\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002");return typeof e!="function"&&(e=t[e]),n instanceof Array||(n=[n]),e.apply(t,n)}},\u30CA\u30C7\u30B7\u30B3:{type:"func",josi:[["\u3092","\u3067"]],pure:!1,fn:function(t,e){e.__setSysVar("\u8868\u793A\u30ED\u30B0",""),e.__self.runEx(t,e.__modName,{resetEnv:!1,resetLog:!0});let n=e.__getSysVar("\u8868\u793A\u30ED\u30B0")+"";return n&&e.logger.trace(n),n}},\u30CA\u30C7\u30B7\u30B3\u7D9A:{type:"func",josi:[["\u3092","\u3067"]],fn:function(t,e){e.__self.runEx(t,e.__modName,{resetEnv:!1,resetAll:!1});let n=e.__getSysVar("\u8868\u793A\u30ED\u30B0")+"";return n&&e.logger.trace(n),n}},\u5B9F\u884C:{type:"func",josi:[["\u3092","\u306B","\u3067"]],pure:!1,fn:function(t,e){if(typeof t=="function")return t(e);if(typeof t=="string"){let n=e.__findFunc(t,"\u5B9F\u884C");if(typeof n=="function")return n(e)}return t}},\u5B9F\u884C\u6642\u9593\u8A08\u6E2C:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){if(typeof t=="string"&&(t=e.__findFunc(t,"\u5B9F\u884C\u6642\u9593\u8A08\u6E2C")),performance&&performance.now){let n=performance.now();return t(e),performance.now()-n}else{let n=Date.now();return t(e),Date.now()-n}}},\u7D42:{type:"func",josi:[],pure:!0,fn:function(t){if(t.__setSysVar("__forceClose",!0),!t.__getSysVar("__useDebug"))throw new Error("__\u7D42\u308F\u308B__")}},\u5909\u6570\u578B\u78BA\u8A8D:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return typeof t}},TYPEOF:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return typeof t}},\u6587\u5B57\u5217\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t)}},TOSTR:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t)}},\u6574\u6570\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseInt(t)}},TOINT:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseInt(t)}},\u5B9F\u6570\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseFloat(t)}},TOFLOAT:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseFloat(t)}},INT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseInt(t)}},FLOAT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseFloat(t)}},NAN\u5224\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return isNaN(t)}},\u975E\u6570\u5224\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Number.isNaN(t)}},HEX:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseInt(t).toString(16)}},\u9032\u6570\u5909\u63DB:{type:"func",josi:[["\u3092","\u306E"],[""]],pure:!0,fn:function(t,e){return parseInt(t).toString(e)}},\u4E8C\u9032:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return parseInt(t).toString(2)}},\u4E8C\u9032\u8868\u793A:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=parseInt(t).toString(2);e.__exec("\u8868\u793A",[n,e])}},RGB:{type:"func",josi:[["\u3068"],["\u306E"],["\u3067"]],pure:!0,fn:function(t,e,n){let r=o=>{let s="00"+parseInt(""+o).toString(16);return s.substring(s.length-2,s.length)};return"#"+r(t)+r(e)+r(n)}},\u8AD6\u7406OR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t||e}},\u8AD6\u7406AND:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t&&e}},\u8AD6\u7406NOT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return!t}},OR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t|e}},AND:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t&e}},XOR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t^e}},NOT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return~t}},SHIFT_L:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t<<e}},SHIFT_R:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t>>e}},SHIFT_UR:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t>>>e}},\u6587\u5B57\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Array.from?Array.from(t).length:String(t).length}},\u4F55\u6587\u5B57\u76EE:{type:"func",josi:[["\u3067","\u306E"],["\u304C"]],pure:!0,fn:function(t,e){let n=Array.from(t),r=Array.from(e);for(let o=0;o<n.length;o++)if(n.slice(o,o+r.length).join("")===r.join(""))return o+1;return 0}},CHR:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="number")return String.fromCodePoint?String.fromCodePoint(t):String.fromCharCode(t);let e=[];for(let n of t)String.fromCodePoint||e.push(String.fromCharCode(n)),e.push(String.fromCodePoint(n));return e}},ASC:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="string")return String.prototype.codePointAt?String(t).codePointAt(0)||0:String(t).charCodeAt(0);let e=[];for(let n of t)String.prototype.codePointAt||e.push(String(n).charCodeAt(0)),e.push(String(n).codePointAt(0)||0);return e}},\u6587\u5B57\u633F\u5165:{type:"func",josi:[["\u3067","\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){e<=0&&(e=1);let r=Array.from(t);return r.splice(e-1,0,n),r.join("")}},\u6587\u5B57\u691C\u7D22:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){e<=0&&(e=1);let r=Array.from(t),o=Array.from(n);for(let s=e-1;s<r.length;s++)if(r.slice(s,s+o.length).join("")===o.join(""))return s+1;return 0}},\u8FFD\u52A0:{type:"func",josi:[["\u3067","\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?(t.push(e),t):String(t)+String(e)}},\u4E00\u884C\u8FFD\u52A0:{type:"func",josi:[["\u3067","\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?(t.push(e),t):String(t)+String(e)+`
`}},\u9023\u7D50:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,isVariableJosi:!0,fn:function(...t){return t.pop(),t.join("")}},\u6587\u5B57\u5217\u5206\u89E3:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return Array.from?Array.from(t):String(t).split("")}},\u30EA\u30D5\u30EC\u30A4\u30F3:{type:"func",josi:[["\u3092","\u306E"],["\u3067"]],pure:!0,fn:function(t,e){let n="";for(let r=0;r<e;r++)n+=String(t);return n}},\u51FA\u73FE\u56DE\u6570:{type:"func",josi:[["\u3067"],["\u306E"]],pure:!0,fn:function(t,e){return t=""+t,e=""+e,t.split(e).length-1}},MID:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n,r){return r.__exec("\u6587\u5B57\u629C\u51FA",[t,e,n])}},\u6587\u5B57\u629C\u51FA:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092",""]],pure:!0,fn:function(t,e,n){return n=n||1,Array.from(t).slice(e-1,e+n-1).join("")}},LEFT:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051"]],pure:!0,fn:function(t,e,n){return n.__exec("\u6587\u5B57\u5DE6\u90E8\u5206",[t,e])}},\u6587\u5B57\u5DE6\u90E8\u5206:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051",""]],pure:!0,fn:function(t,e){return Array.from(t).slice(0,e).join("")}},RIGHT:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051"]],pure:!0,fn:function(t,e,n){return n.__exec("\u6587\u5B57\u53F3\u90E8\u5206",[t,e])}},\u6587\u5B57\u53F3\u90E8\u5206:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051",""]],pure:!0,fn:function(t,e){let n=Array.from(t);return n.slice(n.length-e,n.length).join("")}},\u533A\u5207:{type:"func",josi:[["\u306E","\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return(""+t).split(""+e)}},\u6587\u5B57\u5217\u5206\u5272:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=""+t,e=""+e;let n=t.indexOf(e);return n<0?[t]:[t.substring(0,n),t.substring(n+e.length)]}},\u5207\u53D6:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u307E\u3067","\u3092"]],pure:!0,fn:function(t,e,n){t=String(t);let r=t.indexOf(e);return r<0?(n.__setSysVar("\u5BFE\u8C61",""),t):(n.__setSysVar("\u5BFE\u8C61",t.substring(r+e.length)),t.substring(0,r))}},\u7BC4\u56F2\u5207\u53D6:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u307E\u3067","\u3092"]],pure:!0,fn:function(t,e,n,r){t=String(t);let o="",s="",u=t.indexOf(e);if(u<0)return r.__setSysVar("\u5BFE\u8C61",t),"";o=t.substring(0,u);let i=t.substring(u+e.length),c=i.indexOf(n);if(c<0)return r.__setSysVar("\u5BFE\u8C61",o),i;let a=i.substring(0,c);return s=i.substring(c+n.length),r.__setSysVar("\u5BFE\u8C61",o+s),a}},\u6587\u5B57\u524A\u9664:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3060\u3051","\u3092",""]],pure:!0,fn:function(t,e,n){let r=Array.from(t);return r.splice(e-1,n),r.join("")}},\u7F6E\u63DB:{type:"func",josi:[["\u306E","\u3067"],["\u3092","\u304B\u3089"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){return String(t).split(e).join(n)}},\u5358\u7F6E\u63DB:{type:"func",josi:[["\u306E","\u3067"],["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){return String(t).replace(e,n)}},\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"").replace(/\s+$/,"")}},\u7A7A\u767D\u9664\u53BB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"").replace(/\s+$/,"")}},\u53F3\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/\s+$/,"")}},\u5DE6\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"")}},\u672B\u5C3E\u7A7A\u767D\u9664\u53BB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/\s+$/,"")}},\u5927\u6587\u5B57\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).toUpperCase()}},\u5C0F\u6587\u5B57\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).toLowerCase()}},\u5E73\u4EEE\u540D\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return(n=>String(n).replace(/[\u30a1-\u30f6]/g,function(r){let o=r.charCodeAt(0)-96;return String.fromCharCode(o)}))(""+t)}},\u30AB\u30BF\u30AB\u30CA\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return(n=>String(n).replace(/[\u3041-\u3096]/g,function(r){let o=r.charCodeAt(0)+96;return String.fromCharCode(o)}))(""+t)}},\u82F1\u6570\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[A-Za-z0-9]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})}},\u82F1\u6570\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[Ａ-Ｚａ-ｚ０-９]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}},\u82F1\u6570\u8A18\u53F7\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[\x20-\x7F]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})}},\u82F1\u6570\u8A18\u53F7\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[\uFF00-\uFF5F]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}},\u30AB\u30BF\u30AB\u30CA\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u4E00\u89A7"),r=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u4E00\u89A7"),o=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),s=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),u="",i=0;for(;i<t.length;){let c=t.substring(i,i+2),a=s.indexOf(c);if(a>=0){u+=o.charAt(a/2),i+=2;continue}let f=t.charAt(i),l=r.indexOf(f);if(l>=0){u+=n.charAt(l),i++;continue}u+=f,i++}return u}},\u30AB\u30BF\u30AB\u30CA\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u4E00\u89A7"),r=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u4E00\u89A7"),o=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),s=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7");return t.split("").map(u=>{let i=n.indexOf(u);if(i>=0)return r.charAt(i);let c=o.indexOf(u);return c>=0?s.substring(c*2,c*2+2):u}).join("")}},\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!1,fn:function(t,e){let n=t;return n=e.__exec("\u30AB\u30BF\u30AB\u30CA\u5168\u89D2\u5909\u63DB",[n,e]),n=e.__exec("\u82F1\u6570\u8A18\u53F7\u5168\u89D2\u5909\u63DB",[n,e]),n}},\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!1,fn:function(t,e){let n=t;return n=e.__exec("\u30AB\u30BF\u30AB\u30CA\u534A\u89D2\u5909\u63DB",[n,e]),n=e.__exec("\u82F1\u6570\u8A18\u53F7\u534A\u89D2\u5909\u63DB",[n,e]),n}},\u5168\u89D2\u30AB\u30CA\u4E00\u89A7:{type:"const",value:"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F2\u30F3\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u3001\u3002\u30FC\u300C\u300D"},\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7:{type:"const",value:"\u30AC\u30AE\u30B0\u30B2\u30B4\u30B6\u30B8\u30BA\u30BC\u30BE\u30C0\u30C2\u30C5\u30C7\u30C9\u30D0\u30D3\u30D6\u30D9\u30DC\u30D1\u30D4\u30D7\u30DA\u30DD"},\u534A\u89D2\u30AB\u30CA\u4E00\u89A7:{type:"const",value:"\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF66\uFF9D\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF64\uFF61\uFF70\uFF62\uFF63\uFF9E\uFF9F"},\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7:{type:"const",value:"\uFF76\uFF9E\uFF77\uFF9E\uFF78\uFF9E\uFF79\uFF9E\uFF7A\uFF9E\uFF7B\uFF9E\uFF7C\uFF9E\uFF7D\uFF9E\uFF7E\uFF9E\uFF7F\uFF9E\uFF80\uFF9E\uFF81\uFF9E\uFF82\uFF9E\uFF83\uFF9E\uFF84\uFF9E\uFF8A\uFF9E\uFF8B\uFF9E\uFF8C\uFF9E\uFF8D\uFF9E\uFF8E\uFF9E\uFF8A\uFF9F\uFF8B\uFF9F\uFF8C\uFF9F\uFF8D\uFF9F\uFF8E\uFF9F"},JSON\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t)}},JSON\u30A8\u30F3\u30B3\u30FC\u30C9\u6574\u5F62:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t,null,2)}},JSON\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return JSON.parse(t)}},JSON_E:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t)}},JSON_ES:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t,null,2)}},JSON_D:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return JSON.parse(t)}},\u6B63\u898F\u8868\u73FE\u30DE\u30C3\u30C1:{type:"func",josi:[["\u3092","\u304C"],["\u3067","\u306B"]],pure:!0,fn:function(t,e,n){let r,o=(""+e).match(/^\/(.+)\/([a-zA-Z]*)$/);o===null?r=new RegExp(e,"g"):r=new RegExp(o[1],o[2]);let s=n.__getSysVar("\u62BD\u51FA\u6587\u5B57\u5217");s.splice(0,s.length);let u=String(t).match(r),i=u;if(!r.global){if(u&&u.length>0){i=u[0];for(let c=1;c<u.length;c++)s[c-1]=u[c]}}return i}},\u62BD\u51FA\u6587\u5B57\u5217:{type:"const",value:[]},\u6B63\u898F\u8868\u73FE\u7F6E\u63DB:{type:"func",josi:[["\u306E"],["\u3092","\u304B\u3089"],["\u3067","\u306B","\u3078"]],pure:!0,fn:function(t,e,n){let r,o=e.match(/^\/(.+)\/([a-zA-Z]*)/);return o===null?r=new RegExp(e,"g"):r=new RegExp(o[1],o[2]),String(t).replace(r,n)}},\u6B63\u898F\u8868\u73FE\u533A\u5207:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n,r=e.match(/^\/(.+)\/([a-zA-Z]*)/);return r===null?n=new RegExp(e,"g"):n=new RegExp(r[1],r[2]),String(t).split(n)}},\u901A\u8CA8\u5F62\u5F0F:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return String(t).replace(/(?<!\.\d*?)(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},\u30BC\u30ED\u57CB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=String(t);let n="0";for(let o=0;o<e;o++)n+="0";e=parseInt(e),e<t.length&&(e=t.length);let r=n+String(t);return r.substring(r.length-e,r.length)}},\u7A7A\u767D\u57CB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=String(t);let n=" ";for(let o=0;o<e;o++)n+=" ";e=parseInt(e),e<t.length&&(e=t.length);let r=n+String(t);return r.substring(r.length-e,r.length)}},\u304B\u306A\u304B\u5224\u5B9A:{type:"func",josi:[["\u3092","\u306E","\u304C"]],pure:!0,fn:function(t){let e=String(t).charCodeAt(0);return e>=12353&&e<=12447}},\u30AB\u30BF\u30AB\u30CA\u5224\u5B9A:{type:"func",josi:[["\u3092","\u306E","\u304C"]],pure:!0,fn:function(t){let e=String(t).charCodeAt(0);return e>=12449&&e<=12538}},\u6570\u5B57\u5224\u5B9A:{type:"func",josi:[["\u3092","\u304C"]],pure:!0,fn:function(t){let e=String(t).charAt(0);return e>="0"&&e<="9"||e>="\uFF10"&&e<="\uFF19"}},\u6570\u5217\u5224\u5B9A:{type:"func",josi:[["\u3092","\u304C"]],pure:!0,fn:function(t){let e=/^[+\-＋－]?([0-9０-９]*)(([.．][0-9０-９]+)?|([.．][0-9０-９]+[eEｅＥ][+\-＋－]?[0-9０-９]+)?)$/;return String(t).match(e)!==null}},\u914D\u5217\u7D50\u5408:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t instanceof Array?t.join(""+e):String(t).split(`
`).join(""+e)}},\u914D\u5217\u53EA\u7D50\u5408:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t instanceof Array?t.join(""):String(t).split(`
`).join("")}},\u914D\u5217\u691C\u7D22:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?t.indexOf(e):-1}},\u914D\u5217\u8981\u7D20\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t instanceof Array?t.length:t instanceof Object?Object.keys(t).length:typeof t=="string"?String(t).length:1}},\u8981\u7D20\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u914D\u5217\u8981\u7D20\u6570",[t])}},LEN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u914D\u5217\u8981\u7D20\u6570",[t])}},\u914D\u5217\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array)return t.splice(e,0,n);throw new Error("\u300E\u914D\u5217\u633F\u5165\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u8981\u7D20\u3078\u306E\u633F\u5165\u3002")}},\u914D\u5217\u4E00\u62EC\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array&&n instanceof Array){for(let r=0;r<n.length;r++)t.splice(e+r,0,n[r]);return t}throw new Error("\u300E\u914D\u5217\u4E00\u62EC\u633F\u5165\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u8981\u7D20\u3078\u306E\u633F\u5165\u3002")}},\u914D\u5217\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.sort();throw new Error("\u300E\u914D\u5217\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u6570\u5024\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array){for(let e=0;e<t.length;e++)t[e]=parseFloat(t[e]);return t}throw new Error("\u300E\u914D\u5217\u6570\u5024\u5909\u63DB\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u6570\u5024\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.sort((e,n)=>parseFloat(e)-parseFloat(n));throw new Error("\u300E\u914D\u5217\u6570\u5024\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8:{type:"func",josi:[["\u3067"],["\u306E","\u3092"]],pure:!1,fn:function(t,e,n){let r=t;if(typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8")),e instanceof Array)return e.sort(r);throw new Error("\u300E\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u9006\u9806:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.reverse();throw new Error("\u300E\u914D\u5217\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u30B7\u30E3\u30C3\u30D5\u30EB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array){for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t}throw new Error("\u300E\u914D\u5217\u30B7\u30E3\u30C3\u30D5\u30EB\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u524A\u9664:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u5207\u53D6",[t,e,n])}},\u914D\u5217\u5207\u53D6:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Array){if(typeof e=="number"){let n=t.splice(e,1);if(n instanceof Array)return n[0]}if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let n=e.\u5148\u982D,r=e.\u672B\u5C3E-e.\u5148\u982D+1;return t.splice(n,r)}return null}if(t instanceof Object&&typeof e=="string"){if(t[e]){let n=t[e];return delete t[e],n}return}throw new Error("\u300E\u914D\u5217\u5207\u53D6\u300F\u3067\u914D\u5217\u4EE5\u5916\u3092\u6307\u5B9A\u3002")}},\u914D\u5217\u53D6\u51FA:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array)return t.splice(e,n);throw new Error("\u300E\u914D\u5217\u53D6\u51FA\u300F\u3067\u914D\u5217\u4EE5\u5916\u3092\u6307\u5B9A\u3002")}},\u914D\u5217\u30DD\u30C3\u30D7:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t){if(t instanceof Array)return t.pop();throw new Error("\u300E\u914D\u5217\u30DD\u30C3\u30D7\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u51E6\u7406\u3002")}},\u914D\u5217\u30D7\u30C3\u30B7\u30E5:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u8FFD\u52A0",[t,e,n])}},\u914D\u5217\u8FFD\u52A0:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Array)return t.push(e),t;throw new Error("\u300E\u914D\u5217\u8FFD\u52A0\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u51E6\u7406\u3002")}},\u914D\u5217\u8907\u88FD:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return JSON.parse(JSON.stringify(t))}},\u914D\u5217\u7BC4\u56F2\u30B3\u30D4\u30FC:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){if(!Array.isArray(t))throw new Error("\u300E\u914D\u5217\u7BC4\u56F2\u30B3\u30D4\u30FC\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002");if(typeof e=="number")return typeof t[e]=="object"?JSON.parse(JSON.stringify(t[e])):t[e];if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let n=e.\u5148\u982D,r=e.\u672B\u5C3E+1;return JSON.parse(JSON.stringify(t.slice(n,r)))}}},\u53C2\u7167:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){if(typeof t=="string"){if(typeof e=="number")return t.charAt(e);if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let r=e.\u5148\u982D,o=e.\u672B\u5C3E+1;return t.substring(r,o)}throw new Error(`\u300E\u53C2\u7167\u300F\u3067\u6587\u5B57\u5217\u578B\u306E\u7BC4\u56F2\u6307\u5B9A(${JSON.stringify(e)})\u304C\u4E0D\u6B63\u3067\u3059\u3002`)}if(Array.isArray(t)){if(typeof e=="number")return t[e];if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let r=e.\u5148\u982D,o=e.\u672B\u5C3E+1;return t.slice(r,o)}}if(typeof t=="object")return t[e];throw new Error("\u300E\u53C2\u7167\u300F\u3067\u6587\u5B57\u5217/\u914D\u5217/\u8F9E\u66F8\u578B\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u53C2\u7167:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u53C2\u7167",[t,e,n])}},\u914D\u5217\u8DB3:{type:"func",josi:[["\u306B","\u3078","\u3068"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?t.concat(e):JSON.parse(JSON.stringify(t))}},\u914D\u5217\u6700\u5927\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t.reduce((e,n)=>Math.max(e,n))}},\u914D\u5217\u6700\u5C0F\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t.reduce((e,n)=>Math.min(e,n))}},\u914D\u5217\u5408\u8A08:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(t instanceof Array){let e=0;return t.forEach(n=>{let r=parseFloat(n);isNaN(r)||(e+=r)}),e}throw new Error("\u300E\u914D\u5217\u5408\u8A08\u300F\u3067\u914D\u5217\u5909\u6570\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u5165\u66FF:{type:"func",josi:[["\u306E"],["\u3068"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u914D\u5217\u5165\u66FF\u300F\u306E\u7B2C1\u5F15\u6570\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002");let r=t[e];return t[e]=t[n],t[n]=r,t}},\u914D\u5217\u9023\u756A\u4F5C\u6210:{type:"func",josi:[["\u304B\u3089"],["\u307E\u3067\u306E","\u307E\u3067","\u306E"]],pure:!0,fn:function(t,e){let n=[];for(let r=t;r<=e;r++)n.push(r);return n}},\u914D\u5217\u8981\u7D20\u4F5C\u6210:{type:"func",josi:[["\u3092"],["\u3060\u3051"]],pure:!0,fn:function(t,e){let n=[];for(let r=0;r<e;r++)n.push(t);return n}},\u914D\u5217\u95A2\u6570\u9069\u7528:{type:"func",josi:[["\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n){let r=t;typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u95A2\u6570\u9069\u7528"));let o=[];for(let s of e)o.push(r(s));return o}},\u914D\u5217\u30DE\u30C3\u30D7:{type:"func",josi:[["\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u95A2\u6570\u9069\u7528",[t,e,n])}},\u914D\u5217\u30D5\u30A3\u30EB\u30BF:{type:"func",josi:[["\u3067","\u306E"],["\u3092","\u306B\u3064\u3044\u3066"]],pure:!0,fn:function(t,e,n){let r=t;typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u30D5\u30A3\u30EB\u30BF"));let o=[];for(let s of e)r(s)&&o.push(s);return o}},\u8868\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u30BD\u30FC\u30C8\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.sort((n,r)=>{let o=n[e],s=r[e];return o===s?0:o<s?-1:1}),t}},\u8868\u6570\u5024\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u6570\u5024\u30BD\u30FC\u30C8\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.sort((n,r)=>{let o=n[e],s=r[e];return o-s}),t}},\u8868\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092","\u3067"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.filter(r=>String(r[e]).indexOf(n)>=0)}},\u8868\u5B8C\u5168\u4E00\u81F4\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092","\u3067"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5B8C\u5168\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.filter(r=>r[e]===n)}},\u8868\u691C\u7D22:{type:"func",josi:[["\u306E"],["\u3067","\u306B"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n,r){if(!(t instanceof Array))throw new Error("\u300E\u8868\u691C\u7D22\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");for(let o=n;o<t.length;o++)if(t[o][e]===r)return o;return-1}},\u8868\u5217\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u6570\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let e=1;for(let n=0;n<t.length;n++)t[n].length>e&&(e=t[n].length);return e}},\u8868\u884C\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(!(t instanceof Array))throw new Error("\u300E\u8868\u884C\u6570\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.length}},\u8868\u884C\u5217\u4EA4\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u884C\u5217\u4EA4\u63DB\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=e.__exec("\u8868\u5217\u6570",[t]),r=t.length,o=[];for(let s=0;s<n;s++){let u=[];o.push(u);for(let i=0;i<r;i++)u[i]=t[i][s]!==void 0?t[i][s]:""}return o}},\u8868\u53F3\u56DE\u8EE2:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u53F3\u56DE\u8EE2\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=e.__exec("\u8868\u5217\u6570",[t]),r=t.length,o=[];for(let s=0;s<n;s++){let u=[];o.push(u);for(let i=0;i<r;i++)u[i]=t[r-i-1][s]}return o}},\u8868\u91CD\u8907\u524A\u9664:{type:"func",josi:[["\u306E"],["\u3092","\u3067"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u91CD\u8907\u524A\u9664\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=[],r={};for(let o=0;o<t.length;o++){let s=t[o][e];r[s]===void 0&&(r[s]=!0,n.push(t[o]))}return n}},\u8868\u5217\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u53D6\u5F97\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.map(r=>r[e])}},\u8868\u5217\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u633F\u5165\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let r=[];return t.forEach((o,s)=>{let u=[];e>0&&(u=u.concat(o.slice(0,e))),u.push(n[s]),u=u.concat(o.slice(e)),r.push(u)}),r}},\u8868\u5217\u524A\u9664:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u524A\u9664\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=[];return t.forEach(r=>{let o=r.slice(0);o.splice(e,1),n.push(o)}),n}},\u8868\u5217\u5408\u8A08:{type:"func",josi:[["\u306E"],["\u3092","\u3067"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u5408\u8A08\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=0;return t.forEach(r=>{n+=r[e]}),n}},\u8868\u66D6\u6627\u691C\u7D22:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3067"],["\u3092"]],pure:!0,fn:function(t,e,n,r){if(!(t instanceof Array))throw new Error("\u300E\u8868\u66D6\u6627\u691C\u7D22\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let o=new RegExp(r);for(let s=e;s<t.length;s++){let u=t[s];if(o.test(u[n]))return s}return-1}},\u8868\u6B63\u898F\u8868\u73FE\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E","\u3067"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u6B63\u898F\u8868\u73FE\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let r=new RegExp(n),o=[];for(let s=0;s<t.length;s++){let u=t[s];r.test(u[e])&&o.push(u.slice(0))}return o}},\u8F9E\u66F8\u30AD\u30FC\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=[];if(t instanceof Object){for(let n in t)e.push(n);return e}if(t instanceof Array){for(let n=0;n<t.length;n++)e.push(n);return e}throw new Error("\u300E\u8F9E\u66F8\u30AD\u30FC\u5217\u6319\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u8F9E\u66F8\u30AD\u30FC\u524A\u9664:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Object)return e in t&&delete t[e],t;throw new Error("\u300E\u8F9E\u66F8\u30AD\u30FC\u524A\u9664\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u8F9E\u66F8\u30AD\u30FC\u5B58\u5728:{type:"func",josi:[["\u306E","\u306B"],["\u304C"]],pure:!0,fn:function(t,e){return e in t}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u8F9E\u66F8\u30AD\u30FC\u5217\u6319",[t,e])}},\u30CF\u30C3\u30B7\u30E5\u5185\u5BB9\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=[];if(t instanceof Object){for(let n in t)e.push(t[n]);return e}throw new Error("\u300E\u30CF\u30C3\u30B7\u30E5\u5185\u5BB9\u5217\u6319\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u524A\u9664:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u8F9E\u66F8\u30AD\u30FC\u524A\u9664",[t,e,n])}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u5B58\u5728:{type:"func",josi:[["\u306E","\u306B"],["\u304C"]],pure:!0,fn:function(t,e){return e in t}},\u79D2\u5F85:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:function(t,e){return new Promise((n,r)=>{try{let o=setTimeout(()=>{let s=e.__timeout.indexOf(o);s>=0&&e.__timeout.splice(s,1),n()},parseFloat(t)*1e3);e.__timeout.push(o)}catch(o){r(o)}})},return_none:!0},\u79D2\u5F85\u6A5F:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:async function(t,e){return await e.__exec("\u79D2\u5F85",[t,e])},return_none:!0},\u79D2\u9010\u6B21\u5F85\u6A5F:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:async function(t,e){return await e.__exec("\u79D2\u5F85",[t,e])},return_none:!0},\u79D2\u5F8C:{type:"func",josi:[["\u3092"],[""]],pure:!0,fn:function(t,e,n){typeof t=="string"&&(t=n.__findFunc(t,"\u79D2\u5F8C"));let r=setTimeout(()=>{let o=n.__timeout.indexOf(r);o>=0&&n.__timeout.splice(o,1);try{t(r,n)}catch(s){let u=s;s instanceof se||(u=new se(s,n.__getSysVar("__line"))),n.logger.error(u)}},parseFloat(e)*1e3);return n.__timeout.unshift(r),n.__setSysVar("\u5BFE\u8C61",r),r}},\u79D2\u6BCE:{type:"func",josi:[["\u3092"],[""]],pure:!1,fn:function(t,e,n){typeof t=="string"&&(t=n.__findFunc(t,"\u79D2\u6BCE"));let r=setInterval(()=>{t(r,n)},parseFloat(e)*1e3);return n.__interval.unshift(r),n.__setSysVar("\u5BFE\u8C61",r),r}},\u79D2\u30BF\u30A4\u30DE\u30FC\u958B\u59CB\u6642:{type:"func",josi:[["\u3092"],[""]],pure:!1,fn:function(t,e,n){return n.__exec("\u79D2\u6BCE",[t,e,n])}},\u30BF\u30A4\u30DE\u30FC\u505C\u6B62:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t,e){let n=e.__interval.indexOf(t);if(n>=0)return e.__interval.splice(n,1),clearInterval(t),!0;let r=e.__timeout.indexOf(t);return r>=0?(e.__timeout.splice(r,1),clearTimeout(t),!0):!1},return_none:!1},\u5168\u30BF\u30A4\u30DE\u30FC\u505C\u6B62:{type:"func",josi:[],pure:!0,fn:function(t){for(let e=0;e<t.__interval.length;e++){let n=t.__interval[e];clearInterval(n)}t.__interval=[];for(let e=0;e<t.__timeout.length;e++){let n=t.__timeout[e];clearTimeout(n)}t.__timeout=[]},return_none:!0},\u5143\u53F7\u30C7\u30FC\u30BF:{type:"const",value:[{\u5143\u53F7:"\u4EE4\u548C",\u6539\u5143\u65E5:"2019/05/01"},{\u5143\u53F7:"\u5E73\u6210",\u6539\u5143\u65E5:"1989/01/08"},{\u5143\u53F7:"\u662D\u548C",\u6539\u5143\u65E5:"1926/12/25"},{\u5143\u53F7:"\u5927\u6B63",\u6539\u5143\u65E5:"1912/07/30"},{\u5143\u53F7:"\u660E\u6CBB",\u6539\u5143\u65E5:"1868/10/23"}]},\u4ECA:{type:"func",josi:[],pure:!0,fn:function(){let t=n=>(n="00"+n,n.substring(n.length-2,n.length)),e=new Date;return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())}},\u30B7\u30B9\u30C6\u30E0\u6642\u9593:{type:"func",josi:[],pure:!0,fn:function(){return Math.floor(new Date().getTime()/1e3)}},\u30B7\u30B9\u30C6\u30E0\u6642\u9593\u30DF\u30EA\u79D2:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getTime()}},\u4ECA\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){return t.__formatDate(new Date)}},\u660E\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){let e=Date.now()+864e5;return t.__formatDate(new Date(e))}},\u6628\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){let e=Date.now()-864e5;return t.__formatDate(new Date(e))}},\u4ECA\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()}},\u6765\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()+1}},\u53BB\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()-1}},\u4ECA\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()+1}},\u6765\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()+2}},\u5148\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()}},\u66DC\u65E5:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__str2date(t);return"\u65E5\u6708\u706B\u6C34\u6728\u91D1\u571F".charAt(n.getDay()%7)}},\u66DC\u65E5\u756A\u53F7\u53D6\u5F97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=t.split("/");return new Date(e[0],e[1]-1,e[2]).getDay()}},UNIXTIME\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__str2date(t).getTime()/1e3}},UNIX\u6642\u9593\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__str2date(t).getTime()/1e3}},\u65E5\u6642\u5909\u63DB:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=t*1e3;return e.__formatDateTime(new Date(n),"2022/01/01 00:00:00")}},\u65E5\u6642\u66F8\u5F0F\u5909\u63DB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t);return e=e.replace(/(YYYY|ccc|WWW|MMM|YY|MM|DD|HH|mm|ss|[MDHmsW])/g,o=>{switch(o){case"YYYY":return r.getFullYear();case"YY":return(""+r.getFullYear()).substring(2);case"MM":return n.__zero2(r.getMonth()+1);case"DD":return n.__zero2(r.getDate());case"M":return r.getMonth()+1;case"D":return r.getDate();case"HH":return n.__zero2(r.getHours());case"mm":return n.__zero2(r.getMinutes());case"ss":return n.__zero2(r.getSeconds());case"ccc":return n.__zero(r.getMilliseconds(),3);case"H":return r.getHours();case"m":return r.getMinutes();case"s":return r.getSeconds();case"W":return"\u65E5\u6708\u706B\u6C34\u6728\u91D1\u571F".charAt(r.getDay()%7);case"WWW":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][r.getDay()%7];case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getMonth()]}return o}),e}},\u548C\u66A6\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){let n=e.__str2date(t),r=n.getTime();for(let o of e.__getSysVar("\u5143\u53F7\u30C7\u30FC\u30BF")){let s=o.\u5143\u53F7,u=e.__str2date(o.\u6539\u5143\u65E5);if(u.getTime()<=r){let c=n.getFullYear()-u.getFullYear()+1;return c===1&&(c="\u5143"),s+c+"\u5E74"+e.__zero2(n.getMonth()+1)+"\u6708"+e.__zero2(n.getDate())+"\u65E5"}}throw new Error("\u300E\u548C\u66A6\u5909\u63DB\u300F\u306F\u660E\u793A\u4EE5\u524D\u306E\u65E5\u4ED8\u306B\u306F\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093\u3002")}},\u5E74\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t);return n.__str2date(e).getFullYear()-r.getFullYear()}},\u6708\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t),o=n.__str2date(e);return o.getFullYear()*12+o.getMonth()-(r.getFullYear()*12+r.getMonth())}},\u65E5\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),o=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((o-r)/(60*60*24))}},\u6642\u9593\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),o=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((o-r)/(60*60))}},\u5206\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),o=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((o-r)/60)}},\u79D2\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),o=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil(o-r)}},\u65E5\u6642\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"],["\u306B\u3088\u308B"]],pure:!0,fn:function(t,e,n,r){switch(n){case"\u5E74":return r.__exec("\u5E74\u6570\u5DEE",[t,e,r]);case"\u6708":return r.__exec("\u6708\u6570\u5DEE",[t,e,r]);case"\u65E5":return r.__exec("\u65E5\u6570\u5DEE",[t,e,r]);case"\u6642\u9593":return r.__exec("\u6642\u9593\u5DEE",[t,e,r]);case"\u5206":return r.__exec("\u5206\u5DEE",[t,e,r]);case"\u79D2":return r.__exec("\u79D2\u5DEE",[t,e,r])}throw new Error("\u300E\u65E5\u6642\u5DEE\u300F\u3067\u4E0D\u660E\u306A\u5358\u4F4D\u3067\u3059\u3002")}},\u6642\u9593\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=e.charAt(0);(r==="-"||r==="+")&&(e=e.substring(1));let o=n.__str2date(t),s=(e+":0:0").split(":"),u=parseInt(s[0])*60*60+parseInt(s[1])*60+parseInt(s[2]);r==="-"&&(u*=-1);let i=new Date(o.getTime()+u*1e3);return n.__formatDateTime(i,t)}},\u65E5\u4ED8\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=1,o=e.charAt(0);(o==="-"||o==="+")&&(e=e.substring(1),o==="-"&&(r*=-1));let s=n.__str2date(t),u=(e+"/0/0").split("/"),i=parseInt(u[0])*r,c=parseInt(u[1])*r,a=parseInt(u[2])*r;return s.setFullYear(s.getFullYear()+i),s.setMonth(s.getMonth()+c),s.setDate(s.getDate()+a),n.__formatDateTime(s,t)}},\u65E5\u6642\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=(""+e).match(/([+|-]?)(\d+)(年|ヶ月|日|週間|時間|分|秒)$/);if(!r)throw new Error("\u300E\u65E5\u4ED8\u52A0\u7B97\u300F\u306F\u300E(+\uFF5C-)1(\u5E74|\u30F6\u6708|\u65E5|\u6642\u9593|\u5206|\u79D2)\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002");switch(r[3]){case"\u5E74":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}${r[2]}/0/0`,n]);case"\u30F6\u6708":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/${r[2]}/0`,n]);case"\u9031\u9593":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/0/${parseInt(r[2])*7}`,n]);case"\u65E5":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/0/${r[2]}`,n]);case"\u6642\u9593":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}${r[2]}:0:0`,n]);case"\u5206":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}0:${r[2]}:0`,n]);case"\u79D2":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}0:0:${r[2]}`,n])}}},\u6642\u9593\u30DF\u30EA\u79D2\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(){return performance&&performance.now?performance.now():Date.now?Date.now():new Date().getTime()}},\u30C7\u30D0\u30C3\u30B0\u8868\u793A:{type:"func",josi:[["\u3068","\u3092","\u306E"]],pure:!0,fn:function(t,e){let r=(e.__getSysVar("__line",0)+"::").split(":",2),o=parseInt(String(r[0]).replace("l",""))+1,s=r[1];typeof t=="object"&&(t=JSON.stringify(t)),t=`${s}(${o}): ${t}`,e.__exec("\u8868\u793A",[t,e])},return_none:!0},\u30CF\u30C6\u30CA\u95A2\u6570\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t,e){if(typeof t=="function"){e.__hatena=t;return}if(typeof t=="string"){e.__hatena=e.__getSysVar(t,"\u30C7\u30D0\u30C3\u30B0\u8868\u793A");return}if(t instanceof Array){let n=t.map(r=>{if(r.substring(0,3)==="JS:"){let o=r.substring(3);return e.__evalJS(o,e)}else return e.__getSysVar(r,"\u30C7\u30D0\u30C3\u30B0\u8868\u793A")});e.__hatena=(r,o)=>{let s=r;for(let u of n)s=u(s,o)};return}e.__hatena=e.__getSysVar("\u30C7\u30D0\u30C3\u30B0\u8868\u793A")},return_none:!0},\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C:{type:"func",josi:[["\u306E","\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__hatena(t,e)},return_none:!0},\u30A8\u30E9\u30FC\u767A\u751F:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t){throw new Error(t)},return_none:!0},__DEBUG:{type:"func",josi:[],pure:!0,fn:function(t){t.isDebug=!0,console.log(t)}},__DEBUG\u5F37\u5236\u5F85\u6A5F:{type:"const",value:0},__DEBUG\u30D6\u30EC\u30A4\u30AF\u30DD\u30A4\u30F3\u30C8\u4E00\u89A7:{type:"const",value:[]},__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0:{type:"const",value:0},__DEBUG_BP_WAIT:{type:"func",josi:[["\u3067"]],pure:!0,asyncFn:!0,fn:function(t,e){return new Promise(n=>{let r=e.__getSysVar("__DEBUG\u30D6\u30EC\u30A4\u30AF\u30DD\u30A4\u30F3\u30C8\u4E00\u89A7"),o=e.__getSysVar("__DEBUG\u5F37\u5236\u5F85\u6A5F");if(e.__setSysVar("__DEBUG\u5F37\u5236\u5F85\u6A5F",0),r.indexOf(t)>=0||o){if(e.__getSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D")!=="\u30E1\u30A4\u30F3")return;console.log(`@__DEBUG_BP_WAIT(${t})`);let s=setInterval(()=>{e.__getSysVar("__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0")===1&&(e.__setSysVar("__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0",0),clearInterval(s),n(t))},500)}else n(t)})}},\u30B0\u30ED\u30FC\u30D0\u30EB\u95A2\u6570\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__varslist[1],n=[];for(let r of e.keys())n.push(r);return n}},\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__v0,n=[];for(let r of e.keys())r.startsWith("__")||r.startsWith("!")||r==="meta"||n.push(r);return n}},\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u5B58\u5728:{type:"func",josi:[["\u304C","\u306E"]],pure:!0,fn:function(t,e){return typeof e.__getSysVar(t)<"u"}},\u30D7\u30E9\u30B0\u30A4\u30F3\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=[];for(let n in t.pluginfiles)e.push(n);return e}},\u30E2\u30B8\u30E5\u30FC\u30EB\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=[];for(let n in t.__module)e.push(n);return e}},\u52A9\u8A5E\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!1,fn:function(t){return t.josiList}},\u4E88\u7D04\u8A9E\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!1,fn:function(t){return t.reservedWords}},\u30D7\u30E9\u30B0\u30A4\u30F3\u540D:{type:"const",value:"\u30E1\u30A4\u30F3"},\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){e.__setSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D",t)},return_none:!0},\u540D\u524D\u7A7A\u9593:{type:"const",value:""},\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){e.__namespaceList.push([e.__getSysVar("\u540D\u524D\u7A7A\u9593"),e.__getSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D")]),e.__setSysVar("\u540D\u524D\u7A7A\u9593",t)},return_none:!0},\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__namespaceList.pop();e&&(t.__setSysVar("\u540D\u524D\u7A7A\u9593",e[0]),t.__setSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D",e[1]))},return_none:!0},URL\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t){return encodeURIComponent(t)}},URL\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u3078","\u306B"]],pure:!0,fn:function(t){return decodeURIComponent(t)}},URL\u30D1\u30E9\u30E1\u30FC\u30BF\u89E3\u6790:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n={};if(typeof t!="string")return n;let r=t.split("?");if(r.length<=1)return n;let o=r[1].split("&");for(let s of o){let i=(s+"=").split("="),c=e.__exec("URL\u30C7\u30B3\u30FC\u30C9",[i[0]]);n[c]=e.__exec("URL\u30C7\u30B3\u30FC\u30C9",[i[1]])}return n}},BASE64\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t){if(typeof window<"u"&&window.btoa){let e=new TextEncoder().encode(t),n=String.fromCharCode.apply(null,e);return btoa(n)}if(typeof Buffer<"u")return Buffer.from(t).toString("base64");throw new Error("\u300EBASE64\u30A8\u30F3\u30B3\u30FC\u30C9\u300F\u306F\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}},BASE64\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u3078","\u306B"]],pure:!0,fn:function(t){if(typeof window<"u"&&window.atob){let e=atob(t),n=Array.prototype.map.call(e,o=>o.charCodeAt()),r=new Uint8Array(n);return new TextDecoder("UTF-8").decode(r)}if(typeof Buffer<"u")return Buffer.from(t,"base64").toString();throw new Error("\u300EBASE64\u30C7\u30B3\u30FC\u30C9\u300F\u306F\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}}};var Jt={meta:{type:"const",value:{pluginName:"plugin_math",description:"\u6570\u5B66\u95A2\u6570\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},SIN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sin(t)}},COS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.cos(t)}},TAN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.tan(t)}},ARCSIN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.asin(t)}},ARCCOS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.acos(t)}},ARCTAN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.atan(t)}},ATAN2:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.atan2(t,e)}},\u5EA7\u6A19\u89D2\u5EA6\u8A08\u7B97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.atan2(t[1],t[0])/Math.PI*180}},RAD2DEG:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/Math.PI*180}},DEG2RAD:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/180*Math.PI}},\u5EA6\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/Math.PI*180}},\u30E9\u30B8\u30A2\u30F3\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/180*Math.PI}},SIGN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseFloat(t)===0?0:t>0?1:-1}},\u7B26\u53F7:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){return e.__exec("SIGN",[t])}},ABS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.abs(t)}},\u7D76\u5BFE\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.abs(t)}},EXP:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.exp(t)}},HYPOT:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.hypot(t,e)}},\u659C\u8FBA:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.hypot(t,e)}},LN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.log(t)}},LOG:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.log(t)}},LOGN:{type:"func",josi:[["\u3067"],["\u306E"]],pure:!0,fn:function(t,e){return t===2?Math.LOG2E*Math.log(e):t===10?Math.LOG10E*Math.log(e):Math.log(e)/Math.log(t)}},FRAC:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t%1}},\u5C0F\u6570\u90E8\u5206:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t%1}},\u6574\u6570\u90E8\u5206:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.trunc(t)}},\u4E71\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="number")return Math.floor(Math.random()*t);if(typeof t=="object"&&t.\u5148\u982D!==void 0){let e=t.\u5148\u982D,n=t.\u672B\u5C3E;return Math.floor(Math.random()*(n-e+1))+e}if(Array.isArray(t)){let e=t[0],n=t[1];return Math.floor(Math.random()*(n-e+1))+e}}},\u4E71\u6570\u7BC4\u56F2:{type:"func",josi:[["\u304B\u3089"],["\u307E\u3067\u306E","\u306E"]],pure:!0,fn:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},SQRT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sqrt(t)}},\u5E73\u65B9\u6839:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sqrt(t)}},ROUND:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.round(t)}},\u56DB\u6368\u4E94\u5165:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return Math.round(t)}},\u5C0F\u6570\u70B9\u5207\u4E0A:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.ceil(t*n)/n}},\u5C0F\u6570\u70B9\u5207\u4E0B:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.floor(t*n)/n}},\u5C0F\u6570\u70B9\u56DB\u6368\u4E94\u5165:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.round(t*n)/n}},CEIL:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.ceil(t)}},\u5207\u4E0A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.ceil(t)}},FLOOR:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.floor(t)}},\u5207\u6368:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.floor(t)}}};var U={delimiter:",",eol:`\r
`,auto_convert_number:!0};function fr(t){return/^-?\d+(\.\d+)?([eE][-+]?\d+)?$/.test(t)}function at(t,e=void 0){e===void 0&&(e=U.delimiter),t=""+t+`
`,t=t.replace(/(\r\n|\r)/g,`
`),t=t.replace(/\s+$/,"")+`
`;let n="^(.*?)([\\"+e+"\\n])",r=new RegExp(n),o=function(c){let a=c;return typeof c=="string"&&U.auto_convert_number&&fr(c)&&(a=parseFloat(c)),a},s=[],u=[],i="";for(;t!=="";){if(i=t.charAt(0),i===e){t=t.substring(1),u.push("");continue}if(i===`
`){u.push(""),s.push(u),u=[],t=t.substring(1);continue}if(t=t.replace(/^\s+/,""),i=t.charAt(0),i===e){console.log("delimiter"),u.push(""),t=t.substring(e.length);continue}if(i==="="&&t.charAt(1)==='"'){t=t.substring(1);continue}if(i!=='"'){let f=r.exec(t);if(!f){u.push(o(t)),s.push(u),u=[];break}f[2]===`
`?(u.push(o(f[1])),s.push(u),u=[]):f[2]===e&&u.push(o(f[1])),t=t.substring(f[0].length);continue}if(t.substring(0,2)==='""'){u.push(""),t=t.substring(2);continue}let c=1,a="";for(;c<t.length;){let f=t.charAt(c),l=t.charAt(c+1);if(f==='"'&&l==='"'){c+=2,a+='"';continue}if(f==='"'){if(c++,l===e){c++,u.push(o(a)),a="";break}if(l===`
`){c++,u.push(o(a)),s.push(u),u=[];break}c++;continue}a+=f,c++}t=t.substr(c)}return u.length>0&&s.push(u),s}function ft(t,e=void 0,n=void 0){e===void 0&&(e=U.delimiter),n===void 0&&(n=U.eol);let r=lr(e);if(t===void 0)return"";let o="";for(let s=0;s<t.length;s++){let u=t[s];if(u===void 0){o+=n;continue}for(let i=0;i<u.length;i++)u[i]=r(u[i]);o+=u.join(e)+n}return o=o.replace(/(\r\n|\r|\n)/g,n),o}function lr(t){return function(e){e=""+e;let n=!1;return(e.indexOf(`
`)>=0||e.indexOf("\r")>=0)&&(n=!0),e.indexOf(t)>=0&&(n=!0),e.indexOf('"')>=0&&(n=!0,e=e.replace(/"/g,'""')),n&&(e='"'+e+'"'),e}}var pr={meta:{type:"const",value:{pluginName:"plugin_csv",description:"CSV\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},CSV\u53D6\u5F97:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return U.delimiter=",",at(t)}},TSV\u53D6\u5F97:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return U.delimiter="	",at(t)}},\u8868CSV\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return U.delimiter=",",ft(t)}},\u8868TSV\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return U.delimiter="	",ft(t)}},CSV\u30AA\u30D7\u30B7\u30E7\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t){for(let e in t){let n=t[e];e==="delimiter"||e==="\u533A\u5207\u6587\u5B57"?U.delimiter=n:e==="eol"?U.eol=n:e==="auto_convert_number"&&(U.auto_convert_number=n)}},return_none:!0}},Bt=pr;var qt={meta:{type:"const",value:{pluginName:"plugin_promise",description:"promise\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){t.__promise==null&&(t.__promise={setLastPromise:function(e){return t.__setSysVar("\u305D",e),e}})}},\u305D:{type:"const",value:""},\u52D5\u6642:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){return e.__promise.setLastPromise(new Promise((n,r)=>t(n,r)))},return_none:!1},\u6210\u529F\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.then(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(r))))},return_none:!1},\u51E6\u7406\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.then(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(!0,r,n)),r=>(n.__setSysVar("\u5BFE\u8C61",r),t(!1,r,n))))},return_none:!1},\u5931\u6557\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.catch(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(r))))},return_none:!1},\u7D42\u4E86\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.finally(()=>t()))},return_none:!1},\u675F:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){return t.pop().__promise.setLastPromise(Promise.all(t))},return_none:!1}};var Gt={meta:{type:"const",value:{pluginName:"plugin_test",description:"\u30C6\u30B9\u30C8\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},ASSERT\u7B49:{type:"func",josi:[["\u3068"],["\u304C"]],pure:!0,fn:function(t,e){if(t!==e)throw new Error(`\u4E0D\u4E00\u81F4 [\u5B9F\u969B]${t} [\u671F\u5F85]${e}`);return!0}},\u30C6\u30B9\u30C8\u5B9F\u884C:{type:"func",josi:[["\u3068"],["\u3067"]],pure:!1,fn:function(t,e,n){n.__exec("ASSERT\u7B49",[t,e,n])}},\u30C6\u30B9\u30C8\u7B49:{type:"func",josi:[["\u3068"],["\u304C"]],pure:!1,fn:function(t,e,n){n.__exec("ASSERT\u7B49",[t,e,n])}}};var lt=t=>JSON.parse(JSON.stringify(t)),Ut=600;function re(t={}){return typeof t!="object"&&(t={}),t.testOnly=t.testOnly||!1,t.resetEnv=t.resetEnv||!1,t.resetAll=t.resetAll||!1,t.preCode=t.preCode||"",t.nakoGlobal=t.nakoGlobal||null,t}var Re=class t{constructor(e=void 0){e===void 0&&(e={useBasicPlugin:!0}),this.__varslist=[this.newVaiables(),this.newVaiables(),this.newVaiables()],this.__locals=this.newVaiables(),this.__self=this,this.__vars=this.__varslist[2],this.__v1=this.__varslist[1],this.__v0=this.__varslist[0],this.version=ct.version,this.coreVersion=ct.version,this.__globals=[],this.__globalObj=null,this.__module={},this.pluginFunclist={},this.funclist=this.newVaiables(),this.moduleExport=this.newVaiables(),this.pluginfiles={},this.commandlist=new Set,this.nakoFuncList=this.newVaiables(),this.eventList=[],this.codeGenerateor={},this.debugOption={useDebug:!1,waitTime:0},this.logger=new we,this.filename="main.nako3",this.dependencies={},this.usedFuncs=new Set,this.numFailures=0,e.useBasicPlugin&&this.addBasicPlugins(),this.prepare=Y.getInstance(),this.parser=new Ce(this.logger),this.lexer=new G(this.logger),this.lexer.setFuncList(this.funclist),this.lexer.setModuleExport(this.moduleExport),this.reservedWords=JSON.parse(JSON.stringify(this.lexer.reservedWords)),this.josiList=JSON.parse(JSON.stringify(this.lexer.josiList))}getModList(){return this.lexer.modList}getLogger(){return this.logger}getNakoFuncList(){return this.nakoFuncList}getNakoFunc(e){return this.nakoFuncList.get(e)}getPluginfiles(){return this.pluginfiles}addBasicPlugins(){this.addPlugin(Rt),this.addPlugin(Jt),this.addPlugin(qt),this.addPlugin(Gt),this.addPlugin(Bt)}replaceLogger(){return this.lexer.logger=this.parser.logger=this.logger=new we}static listRequireStatements(e){let n=[];for(let r=0;r+2<e.length;r++){if(!(e[r].type==="not"&&(e[r+1].type==="string"||e[r+1].type==="string_ex")&&e[r+2].value==="\u53D6\u8FBC"))continue;let o=e[r+1].value+"";if(o.startsWith("\u8CAF\u8535\u5EAB:")&&(o=`https://n3s.nadesi.com/plain/${o.substring(4)}`),o.startsWith("\u62E1\u5F35\u30D7\u30E9\u30B0\u30A4\u30F3:")){let u=o.split(":")[1].match(/^([a-zA-Z0-9_-]+)\.(js|mjs|nako3)(@[0-9.]+)?$/);if(u){let i=u[1],c=u[2],a=u[3]||"@latest";c==="js"||c==="mjs"?(i.startsWith("nadesiko3-")||(i=`nadesiko3-${i}`),o=`https://cdn.jsdelivr.net/npm/${i}${a}/${i}.${c}`):o=`https://n3s.nadesi.com/plain/${i}.${c}`}else throw new q("\u300E\u53D6\u8FBC\u300F\u306E\u6307\u5B9A\u30A8\u30E9\u30FC\u3002\u300E\u62E1\u5F35\u30D7\u30E9\u30B0\u30A4\u30F3:(\u30D5\u30A1\u30A4\u30EB\u540D).(js|nako3)(@ver)\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e[r].file,e[r].line)}n.push({...e[r],start:r,end:r+3,value:o,firstToken:e[r],lastToken:e[r+2]}),r+=2}return n}_loadDependencies(e,n,r,o){let s={},u=new t({useBasicPlugin:!0}),i=(f,l)=>{let p=o.readJs(f.filePath,f.firstToken);l.push(p.task.then(h=>{let _=h();this.addPluginFromFile(f.filePath,_),s[f.filePath].funclist=_,s[f.filePath].moduleExport={},s[f.filePath].addPluginFile=()=>{this.addPluginFromFile(f.filePath,_)}}))},c=(f,l)=>{let p=o.readNako3(f.filePath,f.firstToken),h=_=>{let g=G.filenameToModName(f.filePath);_=`\u300E${g}\u300F\u306B\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A;\u300E${g}\u300F\u306B\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A;`+_+";\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7;";let b=this.rawtokenize(_,0,f.filePath);s[f.filePath].tokens=b;let w=new Map,d=new Map;return G.preDefineFunc(lt(b),this.logger,w,d),s[f.filePath].funclist=w,s[f.filePath].moduleExport=d,a(_,f.filePath,"")};l.push(p.task.then(_=>h(_)))},a=(f,l,p)=>{let h=[],g=t.listRequireStatements(u.rawtokenize(f,0,l,p)).map(b=>({...b,...o.resolvePath(b.value,b.firstToken,l)}));for(let b of g){if(s.hasOwnProperty(b.filePath)){s[b.filePath].alias.add(b.value);continue}if(s[b.filePath]={tokens:[],alias:new Set([b.value]),addPluginFile:()=>{},funclist:{},moduleExport:{}},b.type==="js"||b.type==="mjs")i(b,h);else if(b.type==="nako3")c(b,h);else throw new q(`\u30D5\u30A1\u30A4\u30EB\u300E${b.value}\u300F\u3092\u8AAD\u307F\u8FBC\u3081\u307E\u305B\u3093\u3002\u30D5\u30A1\u30A4\u30EB\u304C\u5B58\u5728\u3057\u306A\u3044\u304B\u672A\u5BFE\u5FDC\u306E\u62E1\u5F35\u5B50\u3067\u3059\u3002`,b.firstToken.file,b.firstToken.line)}if(h.length>0)return Promise.all(h)};try{let f=a(e,n,r);return f!==void 0&&f.catch(l=>{this.logger.error(l.msg),this.numFailures++}),this.dependencies=s,f}catch(f){throw this.logger.error(""+f),f}}rawtokenize(e,n,r,o=""){if(!e.startsWith(o))throw new Error("code\u306E\u5148\u982D\u306B\u306FpreCode\u3092\u542B\u3081\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let s=G.filenameToModName(r),u=this.getModList();u.indexOf(s)<0&&u.unshift(s);let i=this.prepare.convert(e),c=new De(e.length,i),a=new Ie(e,[],[]),f=new ye(e),l;try{l=this.lexer.tokenize(i.map(p=>p.text).join(""),n,r)}catch(p){if(!(p instanceof X))throw p;let h=a.map(c.map(p.preprocessedCodeStartOffset),c.map(p.preprocessedCodeEndOffset)),_=h.startOffset===null?p.line:f.map(h.startOffset,!1).line,g=it({...h,line:_},o);throw new oe(p.msg,g.startOffset,g.endOffset,g.line,r)}return l=Pt(l),l=It(l),l=Lt(l),l=Ft(l),l=l.map(p=>{let h=a.map(c.map(p.preprocessedCodeOffset||0),c.map((p.preprocessedCodeOffset||0)+(p.preprocessedCodeLength||0))),_=p.line,g=0;if(p.type==="eol"&&h.endOffset!==null){let b=f.map(h.endOffset,!1);_=b.line,g=b.column}else if(h.startOffset!==null){let b=f.map(h.startOffset,!1);_=b.line,g=b.column}return{...p,...it({line:_,column:g,startOffset:h.startOffset,endOffset:h.endOffset},o),rawJosi:p.josi}}),l}converttoken(e,n,r){return this.lexer.replaceTokens(e,n,r)}reset(e=void 0){if(!e||e.needToClearPlugin)try{this.clearPlugins()}catch{}this.__varslist=[this.__varslist[0],this.newVaiables(),this.newVaiables()],this.__v0=this.__varslist[0],this.__v1=this.__varslist[1],this.__vars=this.__varslist[2],this.__locals=this.newVaiables(),this.funclist=new Map;for(let n of this.__v0.keys()){let r=this.pluginFunclist[n];r&&this.funclist.set(n,JSON.parse(JSON.stringify(r)))}this.lexer.setFuncList(this.funclist),this.moduleExport=new Map,this.lexer.setModuleExport(this.moduleExport),this.logger.clear()}lexCodeToken(e,n,r,o){let s=this.rawtokenize(e,n,r,"");if(o===null)for(let i of s)i.startOffset=void 0,i.endOffset=void 0;else for(let i of s)i.startOffset!==void 0&&(i.startOffset+=o),i.endOffset!==void 0&&(i.endOffset+=o);let u=s.filter(i=>i.type==="line_comment"||i.type==="range_comment").map(i=>({...i}));return s=this.converttoken(s,!1,r),{tokens:s,commentTokens:u}}replaceRequireStatements(e,n=new Set){let r=[];for(let o of t.listRequireStatements(e).reverse()){if(n.has(o.value)){r.push(...e.splice(o.start||0,(o.end||0)-(o.start||0)));continue}let s=Object.keys(this.dependencies).find(i=>this.dependencies[i].alias.has(o.value));if(s===void 0)throw o.firstToken?new oe(`\u30D5\u30A1\u30A4\u30EB\u300E${o.value}\u300F\u304C\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093\u3002`,o.firstToken.startOffset||0,o.firstToken.endOffset||0,o.firstToken.line,o.firstToken.file):new Error(`\u30D5\u30A1\u30A4\u30EB\u300E${o.value}\u300F\u304C\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093\u3002`);this.dependencies[s].addPluginFile();let u=lt(this.dependencies[s].tokens);n.add(o.value),r.push(...this.replaceRequireStatements(u,n)),r.push(...e.splice(o.start||0,(o.end||0)-(o.start||0),...u))}return r}removeRequireStatements(e){let n=[];for(let r of t.listRequireStatements(e).reverse()){let o=Object.keys(this.dependencies).find(s=>this.dependencies[s].alias.has(r.value));o!==void 0&&this.dependencies[o].addPluginFile(),n.push(...e.splice(r.start||0,(r.end||0)-(r.start||0)))}return n}lex(e,n="main.nako3",r="",o=!1){let s=this.rawtokenize(e,0,n,r),u=o?this.removeRequireStatements(s):this.replaceRequireStatements(s,void 0);for(let c of u)(c.type==="word"||c.type==="not")&&(c.type="require");if(u.length>=3)for(let c=0;c<u.length;c+=3){let a=u[c+1].value;a=G.filenameToModName(a),this.lexer.modList.indexOf(a)<0&&this.lexer.modList.push(a)}let i=s.filter(c=>c.type==="line_comment"||c.type==="range_comment").map(c=>({...c}));s=this.converttoken(s,!0,n);for(let c=0;c<s.length;c++)if(s[c]&&s[c].type==="code"){let a=this.lexCodeToken(s[c].value,s[c].line,n,s[c].startOffset||0);i.push(...a.commentTokens),s.splice(c,1,...a.tokens),c--}return this.logger.trace(`--- lex ---
`+JSON.stringify(s,null,2)),{commentTokens:i,tokens:s,requireTokens:u}}parse(e,n,r=""){this.lexer.setFuncList(this.funclist),this.parser.setFuncList(this.funclist),this.lexer.setModuleExport(this.moduleExport),this.parser.setModuleExport(this.moduleExport);let o=this.lex(e,n,r),s;try{this.parser.genMode="sync",s=this.parser.parse(o.tokens,n)}catch(u){throw typeof u.startOffset!="number"?y.fromNode(u.message,o.tokens[this.parser.getIndex()]):u}return this.usedFuncs=this.parser.usedFuncs,this.deleteUnNakoFuncs(),this.logger.trace(`--- ast ---
`+JSON.stringify(s,null,2)),s}getUsedFuncs(e){return this.usedFuncs=new Set,this._getUsedFuncs(e),this.deleteUnNakoFuncs()}_getUsedFuncs(e){if(e){if((e.type==="func"||e.type==="func_pointer")&&e.name)this.usedFuncs.add(e.name);else if(e.blocks)for(let n of e.blocks)this._getUsedFuncs(n)}}deleteUnNakoFuncs(){for(let e of this.usedFuncs)this.commandlist.has(e)||this.usedFuncs.delete(e);return this.usedFuncs}compile(e,n,r=!1,o=""){let s=re();return s.testOnly=r,s.preCode=o,this.compileFromCode(e,n,s).runtimeEnv}compileFromCode(e,n,r=void 0){n===""&&(n="main.nako3"),r===void 0&&(r=re());try{r.resetEnv&&this.reset(),r.resetAll&&this.clearPlugins(),this.eventList.filter(u=>u.eventName==="beforeParse").map(u=>u.callback(e));let o=this.parse(e,n,r.preCode);this.eventList.filter(u=>u.eventName==="beforeGenerate").map(u=>u.callback(o));let s=this.generateCode(o,new me(r.testOnly));return this.eventList.filter(u=>u.eventName==="afterGenerate").map(u=>u.callback(s)),s}catch(o){throw this.logger.error(o),o}}generateCode(e,n,r="sync"){if(r==="sync")return Et(this,e,n);r==="\u975E\u540C\u671F\u30E2\u30FC\u30C9"&&this.logger.error("\u300E!\u975E\u540C\u671F\u30E2\u30FC\u30C9\u300F\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F\u3002[\u8A73\u7D30](https://github.com/kujirahand/nadesiko3/issues/1164)");let o=this.codeGenerateor[r];if(!o)throw new Error(`\u30B3\u30FC\u30C9\u30B8\u30A7\u30CD\u30EC\u30FC\u30BF\u306E\u300C${r}\u300D\u306F\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002`);return o.generate(this,e,n.isTest)}addCodeGenerator(e,n){this.codeGenerateor[e]=n}async _run(e,n,r,o,s=""){let u=re({resetEnv:r,resetAll:r,testOnly:o,preCode:s});return this._runEx(e,n,u)}clearPlugins(){this.__globals.forEach(e=>{e&&(e.__setSysVar("__forceClose",!0),e.reset())}),this.__globals=[]}evalJS(e,n){this.__globalObj=n,this.__globalObj.lastJSCode=e,this.eventList.filter(r=>r.eventName==="beforeRun").map(r=>r.callback(n));try{new Function(n.lastJSCode).apply(n)}catch(r){throw n.numFailures++,this.getLogger().error(r),r}this.eventList.filter(r=>r.eventName==="finish").map(r=>r.callback(n))}runSync(e,n,r=void 0){r=re(r);let o=this.compileFromCode(e,n,r),s=this.getNakoGlobal(r,o.gen,n);return this.evalJS(o.runtimeEnv,s),s}async runAsync(e,n,r=void 0){r=re(r);let o=this.compileFromCode(e,n,r),s=this.getNakoGlobal(r,o.gen,n);return this.evalJS(o.runtimeEnv,s),s}getNakoGlobal(e,n,r){let o=e.nakoGlobal;return o||(this.__globals.length>0&&e.resetAll===!1&&e.resetEnv===!1?o=this.__globals[this.__globals.length-1]:o=new Pe(this,n,this.__globals.length+1),o.__varslist[0].set("\u540D\u524D\u7A7A\u9593",G.filenameToModName(r))),this.__globals.indexOf(o)<0&&this.__globals.push(o),o}addListener(e,n){this.eventList.push({eventName:e,callback:n})}test(e,n,r="",o=!1){let s=re();return s.preCode=r,s.testOnly=o,this.runSync(e,n,s)}run(e,n="main.nako3",r=""){let o=re();return o.preCode=r,this.runSync(e,n,o)}compileStandalone(e,n,r){r===void 0&&(r=new me);let o=this.parse(e,n);return this.generateCode(o,r).standalone}addPlugin(e,n=!0,r=""){let o=this.__varslist[0],s=o.get("__pluginInfo");s||(s={},o.set("__pluginInfo",s));let u=0,i="unknown",c={pluginName:"unknown",nakoVersionResult:!0,nakoVersion:"0.0.0",path:""};if(e.meta&&e.meta.value&&typeof e.meta=="object"){c=e.meta.value||{pluginName:"unknown",nakoVersion:"0.0.0"},i=c.pluginName||"unknown";let p=((c.nakoVersion||"0.0.0")+".0.0").split(".").map(h=>parseInt(h));u=p[1]*100+p[2],c.path=r}if(i==="unknown"&&(i=Object.keys(e).join("-")),s[i]!==void 0)return;if(i=(f=>f.replace(/[^a-zA-z0-9\-_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF\u3400-\u4DBF\uF900-\uFAFF]/g,"_"))(i),s[i]=c,Ut>u){let f=Object.keys(e).join(",");if(i==="unknown"&&(i=f.substring(0,30)+"..."),i!==""){let l=`\u306A\u3067\u3057\u3053\u30D7\u30E9\u30B0\u30A4\u30F3\u300E${i}\u300F\u306F\u53E4\u3044\u5F62\u5F0F\u306A\u306E\u3067\u6B63\u3057\u304F\u52D5\u4F5C\u3057\u306A\u3044\u53EF\u80FD\u6027\u304C\u3042\u308A\u307E\u3059\u3002(\u30E9\u30F3\u30BF\u30A4\u30E0\u306E\u8981\u6C42: ${Ut}/\u30D7\u30E9\u30B0\u30A4\u30F3: ${u})`;console.warn(l,"see","https://github.com/kujirahand/nadesiko3/issues/1647"),this.logger.warn(l),c.nakoVersionResult=!1}}if(this.__module[i]=e,this.pluginfiles[i]="*",typeof e.\u521D\u671F\u5316=="object"){let f=e.\u521D\u671F\u5316;delete e.\u521D\u671F\u5316;let l=`!${i}:\u521D\u671F\u5316`;e[l]=f}for(let f in e){let l=e[f];if(this.funclist.set(f,l),n&&(this.pluginFunclist[f]=JSON.parse(JSON.stringify(l))),l.type==="func")o.set(f,l.fn),l.asyncFn&&(l.pure=!0);else if(l.type==="const"||l.type==="var")o.set(f,l.value);else throw console.error("[\u30D7\u30E9\u30B0\u30A4\u30F3\u8FFD\u52A0\u30A8\u30E9\u30FC]",l),new Error("\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u8FFD\u52A0\u3067\u30A8\u30E9\u30FC\u3002");f==="\u521D\u671F\u5316"||f.substring(0,1)==="!"||this.commandlist.add(f)}}addPluginObject(e,n,r=!0){n.meta===void 0&&(n.meta={type:"const",value:{pluginName:e,nakoVersion:"0.0.0"}}),this.addPlugin(n,r)}addPluginFile(e,n,r,o=!0){this.addPluginFromFile(n,r,o)}addPluginFromFile(e,n,r=!0){this.addPlugin(n,r,e)}addFunc(e,n,r,o=!0,s=!1){let u={josi:n,fn:r,type:"func",return_none:o,asyncFn:s,pure:!0};this.funclist.set(e,u),this.pluginFunclist[e]=lt(u),this.__varslist[0].set(e,r)}setFunc(e,n,r,o=!0,s=!1){this.addFunc(e,n,r,o,s)}getFunc(e){return this.funclist.get(e)}_runEx(e,n,r,o="",s=void 0){return r.preCode=o,s&&(r.nakoGlobal=s),this.runSync(e,n,r)}runEx(e,n,r,o=""){return this._runEx(e,n,r,o)}async runReset(e,n="main.nako3",r=""){let o=re({resetAll:!0,resetEnv:!0,preCode:r});return this.runAsync(e,n,o)}newVaiables(e){return new Map(e)}};var Ht=["!\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","!\u3053\u3053\u307E\u3067\u3060\u308B\u3044"];function hr(t,e="main.nako3"){return nt(t,Ht)?yr(t,e):{code:t,insertedLines:[],deletedLines:[]}}function dr(t){return nt(t,Ht)}var Wt="\u{1F377}\u{1F377}\u6539\u884C\u{1F379}\u9ED0\u9ED1\u9F18\u9F36\u9F48\u25A8\u{1F37A}\u{1F37A}\u{1F376}\u{1F376}",Q=Wt;function _r(t){for(Q=Wt;t.indexOf(Q)>=0;){let e=String.fromCodePoint(Math.floor(Math.random()*40952)+19968);Q+=e+e}return Q}function ht(t){let e=Y.getInstance(),n=t.length,r="",o="",s=0,u=!1;for(;s<n;){let i=t.charAt(s),c=t.substring(s,2),a=e.convert1ch(i),f=c.split("").map(l=>e.convert1ch(l)).join("");if(o!==""){o===(o.length===1?a:f)?(u||(r+=t.substr(s,o.length)),s+=o.length,u=!1,o=""):(u||(r+=i),s++);continue}switch(a){case'"':case"'":o=i,r+=i,s++;continue;case"\u300C":o="\u300D",r+=i,s++;continue;case"\u300E":o="\u300F",r+=i,s++;continue;case"\u201C":o="\u201D",r+=i,s++;continue;case"{":o="}",r+=i,s++;continue;case"[":o="]",r+=i,s++;continue}switch(c){case"\u{1F334}":o="\u{1F334}",r+=c,s+=2;continue;case"\u{1F33F}":o="\u{1F33F}",r+=c,s+=2;continue}if(a==="#"){o=`
`,u=!0,s++;continue}if(f==="//"){o=`
`,u=!0,s+=2;continue}if(f==="/*"){o="*/",u=!0,s+=2;continue}r+=i,s++}return r}function yr(t,e){let n=[],r=[],o="\u3053\u3053\u307E\u3067\u2030",u=Kt(t).split(`
`),i=[],c=[],a=0;_r(t);let f=-1;for(u.forEach(p=>{if(f+=p.split(Q).length,/^[ 　・\t]*$/.test(p)){r.push({lineNumber:i.length,len:p.length});return}let h=ht(p).replace(/^[ 　・\t]+/,"").replace(/\s+$/,"");if(h===""){i.push(p);return}if(h==="\u3053\u3053\u307E\u3067")throw new fe("\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587\u304C\u6709\u52B9\u5316\u3055\u308C\u3066\u3044\u308B\u3068\u304D\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u4F7F\u3046\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",f,e);let _=Je(p);if(a===_){i.push(p);return}if(a<_){c.push(a),a=_,i.push(p);return}if(a>_)for(a=_;c.length>0;){let g=c.pop()||0;if(g===_){h.substring(0,3)!=="\u9055\u3048\u3070"&&(n.push(i.length),i.push(pt(g)+o)),i.push(p);return}if(_<g){n.push(i.length),i.push(pt(g)+o);continue}}});c.length>0;){let p=c.pop()||0;n.push(i.length),i.push(pt(p)+o)}let l=[];for(let p=0;p<i.length;p++)if(i[p].includes(Q)){let h=i[p].split(Q);for(let _=0;_<n.length;_++)l.length<n[_]&&(n[_]+=h.length-1);for(let _=0;_<r.length;_++)l.length<r[_].lineNumber&&(r[_].lineNumber+=h.length-1);l.push(...h)}else l.push(i[p]);return{code:l.join(`
`),insertedLines:n,deletedLines:r}}function pt(t){let e="";for(let n=0;n<t;n++)e+=" ";return e}function zt(t){let e=/^([ 　・\t]*)/.exec(ht(t));return e?e[1]:""}function Je(t){let e=0;for(let n=0;n<t.length;n++){let r=t.charAt(n);if(r===" "){e++;continue}if(r==="\u3000"){e+=2;continue}if(r==="\u30FB"){e+=2;continue}if(r==="	"){e+=4;continue}break}return e}function Kt(t){let e=Y.getInstance(),n=t.length,r="",o="",s=0;for(;s<n;){let u=t.charAt(s),i=t.substr(s,2),c=e.convert1ch(u),a=i.split("").map(f=>e.convert1ch(f)).join("");if(o!==""){o===(o.length===1?c:a)?(r+=t.substr(s,o.length),s+=o.length,o=""):(u===`
`?r+=Q:r+=u,s++);continue}switch(c){case'"':case"'":o=u,r+=u,s++;continue;case"\u300C":o="\u300D",r+=u,s++;continue;case"\u300E":o="\u300F",r+=u,s++;continue;case"\u201C":o="\u201D",r+=u,s++;continue;case"{":o="}",r+=u,s++;continue;case"[":o="]",r+=u,s++;continue}switch(i){case"\u{1F334}":o="\u{1F334}",r+=i,s+=2;continue;case"\u{1F33F}":o="\u{1F33F}",r+=i,s+=2;continue}if(c==="#"){o=`
`,r+=u,s++;continue}if(a==="//"){o=`
`,r+=i,s+=2;continue}if(a==="/*"){o="*/",r+=i,s+=2;continue}r+=u,s++}return r}function gr(t){let e={lines:[],pairs:[],parents:[],spaces:[]},n=Kt(t).split(`
`),r=[],o=0,s=Je(n[0]);for(let u of n){let i=u.split(Q).length,c=ht(u),a=c.replace(/^[ 　・\t]+/,"")===""?s:Je(c);if(e.lines.push(...Array(i).fill(a)),e.spaces.push(...Array(i).fill(zt(c))),s<a)r.push(o-1);else if(s>a){let l=r.pop();l!==void 0&&e.pairs.push([l,o])}let f=r[r.length-1]!==void 0?r[r.length-1]:null;e.parents.push(...Array(i).fill(f)),s=a,o+=i}for(let u of r)e.pairs.push([u,o]);return e}var ke={convert:hr,getBlockStructure:gr,getIndent:zt,countIndent:Je,isIndentSyntaxEnabled:dr};var mr=ke.getBlockStructure,ve=ke.getIndent,Xt=ke.countIndent,br=ke.isIndentSyntaxEnabled;function wr(t){switch(t.type){case"line_comment":return"comment.line";case"range_comment":return"comment.block";case"def_test":return"keyword.control";case"def_func":return"keyword.control";case"func":return"entity.name.function";case"number":return"constant.numeric";case"\u3068\u306F":case"\u306A\u3089\u3070":case"\u3067\u306A\u3051\u308C\u3070":return"keyword.control";case"\u3053\u3053\u304B\u3089":case"\u3053\u3053\u307E\u3067":case"\u3082\u3057":case"\u9055\u3048\u3070":case"require":return"keyword.control";case"\u56DE":case"\u9593":case"\u7E70\u308A\u8FD4\u3059":case"\u53CD\u5FA9":case"\u629C\u3051\u308B":case"\u7D9A\u3051\u308B":case"\u623B\u308B":case"\u5148\u306B":case"\u6B21\u306B":case"\u4EE3\u5165":case"\u9010\u6B21\u5B9F\u884C":case"\u6761\u4EF6\u5206\u5C90":case"\u53D6\u8FBC":case"\u30A8\u30E9\u30FC\u76E3\u8996":case"\u30A8\u30E9\u30FC":case"\u5909\u6570":case"\u5B9F\u884C\u901F\u5EA6\u512A\u5148":return"keyword.control";case"\u5B9A\u3081\u308B":case"\u5B9A\u6570":return"support.constant";case"shift_r0":case"shift_r":case"shift_l":case"gteq":case"lteq":case"noteq":case"eq":case"not":case"gt":case"lt":case"and":case"or":case"@":case"+":case"-":case"**":case"*":case"\xF7\xF7":case"/":case"%":case"^":case"&":return"keyword.operator";case"string":case"string_ex":return"string.other";case"word":return["\u305D\u3046","\u305D\u308C","\u56DE\u6570","\u5BFE\u8C61\u30AD\u30FC","\u5BFE\u8C61"].includes(t.value)?"variable.language":"variable.other";default:return"markup.other"}}function Be(t,e,n,r,o){let s=wr(t),u=vr(t,e);return t.rawJosi&&n.length>=t.rawJosi.length&&r&&o?[{type:s,docHTML:u,value:n.slice(0,-t.rawJosi.length)},{type:s+".markup.underline",docHTML:u,value:n.slice(-t.josi.length)}]:[{type:s,docHTML:u,value:n}]}function dt(t,e){for(let n of Object.keys(e.__module))if(Object.keys(e.__module[n]).includes(t))return n;return null}function kr(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");return t.toString(26).split("").map(n=>e[parseInt(n,26)]).join("")}function Ue(t){let e=t.map((n,r)=>n.map(o=>`${kr(r)}${o}`).join("|")).join("\u3001");return e!==""?`\uFF08${e}\uFF09`:""}function qe(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function vr(t,e){let n=r=>`<span class="tooltip-plugin-name">${qe(r)}</span>`;if(t.type==="func"){let r=dt(t.value+"",e)||(t.meta&&t.meta.file?t.meta.file:null),o=t.meta&&t.meta.josi?Ue(t.meta.josi):"";return r?qe(o+t.value)+n(r):qe(o+t.value)}else if(t.type==="word"){let r=dt(t.value+"",e)||(t.meta&&t.meta.file?t.meta.file:null);if(r)return qe(t.value+"")+n(r)}return null}var Ge=(t,e)=>[{type:"markup.other",value:e.getLine(t),docHTML:null}],Qt=(t,e)=>{let n=t.logger;try{return t.replaceLogger(),e()}finally{t.logger=n}};function Yt(t,e,n){let r=t.join(`
`);e.reset({needToClearPlugin:!1});let o=Qt(e,()=>e.lex(r,"main.nako3",void 0,!0));o.commentTokens=o.commentTokens.filter(a=>a.file==="main.nako3"),o.requireTokens=o.requireTokens.filter(a=>a.file==="main.nako3"),o.tokens=o.tokens.filter(a=>a.file==="main.nako3");for(let[a,{funclist:f}]of Object.entries(e.dependencies))for(let l of o.tokens)l.type==="word"&&l.value!=="\u305D\u308C"&&f[l.value]&&(l.type="func",l.meta={...f[l.value+""],file:a});let s=[...o.tokens,...o.commentTokens,...o.requireTokens].filter(a=>a.type!=="eol"&&a.type!=="eof"&&typeof a.startOffset=="number"&&typeof a.endOffset=="number"&&a.startOffset<a.endOffset);s.sort((a,f)=>(a.startOffset||0)-(f.startOffset||0));let u=0,i=0,c=[];for(let a=0;a<t.length;a++){c.push([]);let f=u+t[a].length,l=u;for(;i<s.length&&s[i].endOffset<=u;)i++;if(i<s.length&&s[i].startOffset<=u&&s[i].endOffset>=f)c[a].push(...Be(s[i],e,t[a],s[i].endOffset<=f,n));else{for(i<s.length&&s[i].startOffset<=u&&(c[a].push(...Be(s[i],e,r.slice(l,s[i].endOffset),!0,n)),l=s[i].endOffset,i++);i<s.length&&s[i].endOffset<f;)l<s[i].startOffset&&(c[a].push({type:"markup.other",docHTML:null,value:r.slice(l,s[i].startOffset)}),l=s[i].startOffset),c[a].push(...Be(s[i],e,r.slice(l,s[i].endOffset),!0,n)),l=s[i].endOffset,i++;i<s.length&&s[i].startOffset<f?(l<s[i].startOffset&&(c[a].push({type:"markup.other",docHTML:null,value:r.slice(l,s[i].startOffset)}),l=s[i].startOffset),c[a].push(...Be(s[i],e,r.slice(s[i].startOffset,f),s[i].endOffset<=f,n))):c[a].push({type:"markup.other",docHTML:null,value:r.slice(l,f)})}u+=t[a].length+1}return{editorTokens:c,lexerOutput:o}}var _t=class t{constructor(e,n,r,o){this.session=e,this.doc=n,this.AceRange=r,this.markers=[],this.hasAnnotations=!1,this.disable=o}static fromNullable(e,n,r,o,s){return n===null&&(n=0),r===null&&(r=e),o===null&&(o=s(r).length),e===r&&n===o&&o++,[e,n,r,o]}static fromOffset(e,n,r){let o=new ye(e),s=o.map(n,!1),u=o.map(r,!1);return[s.line,s.column,u.line,u.column]}static fromError(e,n,r){return typeof n.startOffset=="number"&&typeof n.endOffset=="number"?this.fromOffset(e,n.startOffset,n.endOffset):typeof n.line=="number"?this.fromNullable(n.line,null,null,null,r):this.fromNullable(0,null,null,null,r)}add(e,n,r,o,s,u){if(this.disable)return;let i=new this.AceRange(...t.fromNullable(e,n,r,o,c=>this.doc.getLine(c)));this.markers.push(this.session.addMarker(i,"marker-"+(u==="warn"?"yellow":"red"),"text",!1)),this.session.setAnnotations([{row:e,column:n,text:s,type:u==="warn"?"warning":"error"}]),this.hasAnnotations=!0}addByError(e,n,r){this.add(...t.fromError(e,n,o=>this.doc.getLine(o)),n.message,r)}clear(){for(let e of this.markers)this.session.removeMarker(e);this.markers.length=0,this.hasAnnotations&&(this.session.clearAnnotations(),this.hasAnnotations=!1)}},yt=class{constructor(e,n,r,o,s){this.onUpdate=r,this.doc=e,this.dirty=!0,this.nako3=n,this.onCompileError=o,this.underlineJosi=s,this.lastLexerOutput=null,this.lines=this.doc.getAllLines().map(i=>[{type:"markup.other",value:i,docHTML:null}]),this.cache=null,this.deleted=!1,this.enabled=!0;let u=()=>{if(!this.deleted)if(this.dirty&&this.enabled){let i=Date.now();this.dirty=!1;let c=this.doc.getAllLines().join(`
`);try{let a=Date.now(),f=Yt(this.doc.getAllLines(),n,this.underlineJosi);this.lastLexerOutput=f.lexerOutput,this.lines=f.editorTokens,this.cache={code:c,lines:JSON.stringify(this.lines)},r(0,this.doc.getLength()-1,Date.now()-a)}catch(a){o(c,a)}setTimeout(u,Math.max(100,Math.min(5e3,(Date.now()-i)*5)))}else setTimeout(u,100)};setTimeout(()=>{u()},0)}dispose(){this.deleted=!0}$updateOnChange(e){this.dirty=!0;let n=e.start.row,r=e.end.row;if(n===r)if(e.action==="insert"&&this.lines[n]){let o=e.start.column,s=this.lines[n].filter(a=>a.type!=="composition_placeholder"),u=[],i=0,c=0;for(;i<s.length&&c+s[i].value.length<=o;)u.push(s[i]),c+=s[i].value.length,i++;for(i<s.length&&c<o?(u.push({type:s[i].type,value:s[i].value.slice(0,o-c),docHTML:null}),u.push({type:"markup.other",value:e.lines[0],docHTML:null}),u.push({type:s[i].type,value:s[i].value.slice(o-c),docHTML:null}),i++):u.push({type:"markup.other",value:e.lines[0],docHTML:null});i<s.length;)u.push(s[i]),i++;this.lines[n]=u}else this.lines[n]=Ge(n,this.doc);else e.action==="remove"?this.lines.splice(n,r-n+1,Ge(n,this.doc)):this.lines.splice(n,1,...Array(r-n+1).fill(null).map((o,s)=>Ge(s+n,this.doc)))}getTokens(e){if(!this.lines[e]){let n=!1;if(this.enabled){let r=this.doc.getAllLines().join(`
`);if(this.cache!==null&&this.cache.code===r)n=!0;else try{let o=Yt(this.doc.getAllLines(),this.nako3,this.underlineJosi);this.cache={code:r,lines:JSON.stringify(o.editorTokens)},n=!0}catch(o){o instanceof P||console.error(o)}}n&&this.cache!==null?this.lines[e]=JSON.parse(this.cache.lines)[e]:this.lines[e]=Ge(e,this.doc)}return this.lines[e]}start(e){}fireUpdateEvent(e,n){}setDocument(e){}scheduleStart(){}setTokenizer(e){}stop(){}getState(e){return"start"}},B=class t{constructor(e,n){this.AceRange=e,this.nako3=n}static toggleCommentLines(e,{doc:n},r,o){let s=Y.getInstance(),u=c=>{let a=ve(c);if(a===c)return{type:"blank"};c=c.substring(a.length);let f=c.substring(0,2).split("").map(l=>s.convert1ch(l)).join("");return f.substring(0,1)==="#"?{type:"comment",start:a.length,len:1+(c.charAt(1)===" "?1:0)}:f==="//"?{type:"comment",start:a.length,len:2+(c.charAt(2)===" "?1:0)}:{type:"code"}},i=[];for(let c=r;c<=o;c++)i.push(c);if(!i.every(c=>u(n.getLine(c)).type==="blank")&&i.every(c=>u(n.getLine(c)).type!=="code"))for(let c of i){let a=u(n.getLine(c));a.type==="comment"&&n.removeInLine(c,a.start,a.start+a.len)}else{let c=Math.min(...i.map(a=>Xt(n.getLine(a))));for(let a of i){let f=n.getLine(a),l=f.length;for(let p=0;p<f.length;p++)if(Xt(f.slice(0,p))>=c){l=p;break}n.insertInLine({row:a,column:l},"// ")}}}static checkOutdent(e,n,r){return/^[ 　・\t]*ここまで$/.test(n+r)}autoOutdent(e,{doc:n},r){if(r===0)return;let o=n.getLine(r-1),s;if(t.isBlockStart(o))s=ve(o);else{let i=this.getBlockStructure(n.getAllLines().join(`
`)),c=i.parents[r];s=c!==null?i.spaces[c]:""}let u=ve(n.getLine(r));n.replace(new this.AceRange(r,0,r,u.length),s)}static getNextLineIndent(e,n,r){return this.isBlockStart(n)?ve(n)+r:ve(n)}static isBlockStart(e){return/^[ 　・\t]*●|(ならば|なければ|ここから|条件分岐|違えば|回|繰り返(す|し)|の間|反復|とは|には|エラー監視|エラーならば|実行速度優先)、?\s*$/.test(e)}static getCompletionItems(e,n,r,o){let s=new Map,u=new Set,i=(c,a,f)=>{let l=s.get(c);if(l)l.meta.add(f);else{let p=n.split("").filter(h=>a.includes(h)).length;s.set(c,{value:a,meta:new Set([f]),score:p}),u.add(a)}};for(let c of Object.keys(r.__varslist[0])){if(c.startsWith("!"))continue;let a=r.funclist[c];if(typeof a!="object"||a===null)continue;let f=dt(c,r)||"\u30D7\u30E9\u30B0\u30A4\u30F3";a.type==="func"?i(Ue(a.josi)+c,c,f):i(c,c,f)}for(let[c,{funclist:a}]of Object.entries(r.dependencies))for(let[f,l]of Object.entries(a)){let p=l&&l.type==="func"?Ue(l.josi):"";i(p+f,f,c)}if(o.lastLexerOutput!==null)for(let c of o.lastLexerOutput.tokens){let a=c.value+"";if(!(c.line===e||u.has(a))){if(c.type==="word")i(a,a,"\u5909\u6570");else if(c.type==="func"){let f=r.funclist[a],l=f&&f.type==="func"?Ue(f.josi):"";i(l+a,a,"\u95A2\u6570")}}}return Array.from(s.entries()).map(([c,a])=>({caption:c,...a,meta:Array.from(a.meta).join(", ")}))}static getSnippets(e){let n=br(e),r=(o,s,u)=>n?{caption:o,meta:`\u21E5 ${s}`,score:1,snippet:u.replace(/\t*ここまで(\n|$)/g,"").replace(/\t/g,"    ")}:{caption:o,meta:`\u21E5 ${s}`,score:1,snippet:u.replace(/\t/g,"    ")};return[r("if","\u3082\u3057\u301C\u306A\u3089\u3070",`\u3082\u3057\${1:1=1}\u306A\u3089\u3070
	\${2:1\u3092\u8868\u793A}
\u9055\u3048\u3070
	\${3:2\u3092\u8868\u793A}
\u3053\u3053\u307E\u3067
`),r("times","\u301C\u56DE",`\${1:3}\u56DE
	\${2:1\u3092\u8868\u793A}
\u3053\u3053\u307E\u3067
`),r("for","\u7E70\u308A\u8FD4\u3059","${1:N}\u3067${2:1}\u304B\u3089${3:3}\u307E\u3067\u7E70\u308A\u8FD4\u3059\n	${4:N\u3092\u8868\u793A}\n\u3053\u3053\u307E\u3067\n"),r("while","\u301C\u306E\u9593",`\${1:N<2\u306E\u9593}
	N=N+1
\u3053\u3053\u307E\u3067
`),r("foreach","\u301C\u3092\u53CD\u5FA9",`\${1:[1,2,3]}\u3092\u53CD\u5FA9
	\${2:\u5BFE\u8C61\u3092\u8868\u793A}
\u3053\u3053\u307E\u3067
`),r("switch","\u301C\u3067\u6761\u4EF6\u5206\u5C90",`\${1:N}\u3067\u6761\u4EF6\u5206\u5C90
	\${2:1}\u306A\u3089\u3070
		\${3:1\u3092\u8868\u793A}
	\u3053\u3053\u307E\u3067
	\${4:2}\u306A\u3089\u3070
		\${5:2\u3092\u8868\u793A}
	\u3053\u3053\u307E\u3067
	\u9055\u3048\u3070
		\${6:3\u3092\u8868\u793A}
	\u3053\u3053\u307E\u3067
\u3053\u3053\u307E\u3067
`),r("function","\u25CF\u301C\u3068\u306F","\u25CF\uFF08${1:A\u3068B\u3092}\uFF09${2:\u8DB3\u3059}\u3068\u306F\n	${3:A+B\u3092\u623B\u3059}\n\u3053\u3053\u307E\u3067\n"),r("test","\u25CF\u30C6\u30B9\u30C8:\u301C\u3068\u306F",`\u25CF\u30C6\u30B9\u30C8:\${2:\u8DB3\u3059}\u3068\u306F
	1\u30682\u3092\u8DB3\u3059
	\u305D\u308C\u30683\u304CASSERT\u7B49\u3057\u3044
\u3053\u3053\u307E\u3067
`),r("try","\u30A8\u30E9\u30FC\u76E3\u8996",`\u30A8\u30E9\u30FC\u76E3\u8996
	\${1:1\u306E\u30A8\u30E9\u30FC\u767A\u751F}
\u30A8\u30E9\u30FC\u306A\u3089\u3070
	\${2:2\u3092\u8868\u793A}
\u3053\u3053\u307E\u3067
`)]}static getCompletionPrefix(e,n){let r=null;if(e.length===0||!/[ぁ-んa-zA-Zァ-ヶー\u3005\u4E00-\u9FCF]/.test(e[e.length-1]))return"";try{n.reset(),r=Qt(n,()=>n.lex(e,"completion.nako3",void 0,!0)).tokens.filter(s=>s.type!=="eol"&&s.type!=="eof")}catch(s){s instanceof P||console.error(s)}if(r===null||r.length===0||!r[r.length-1].value)return"";let o=r[r.length-1].value+"";return/[ぁ-ん]/.test(o[o.length-1])&&!/[ぁ-ん]/.test(o[0])?"":o}getFoldWidget({doc:e},n,r){return t.isBlockStart(e.getLine(r))?"start":""}getFoldWidgetRange({doc:e},n,r){let o=this.getBlockStructure(e.getAllLines().join(`
`)).pairs.find(s=>s[0]===r);return o!==void 0?new this.AceRange(o[0],e.getLine(o[0]).length,o[1]-1,e.getLine(o[1]-1).length):null}static getCodeLens(e){let n=[];for(let[r,o]of Array.from(e.getAllLines().entries())){let s=/^[ 　・\t]*●テスト:(.+?)(?:とは|$)/.exec(o);s!==null&&n.push({start:{row:r},command:{title:"\u30C6\u30B9\u30C8\u3092\u5B9F\u884C",id:"runTest",arguments:[s[1]]}})}return n}getBlockStructure(e){return(!this.blockStructure||this.blockStructure.code!==e)&&(this.blockStructure={code:e,data:mr(e)}),this.blockStructure.data}},gt=class{constructor(e,n,r){this.editor=e,this.AceRange=n,this.UndoManager=r}newTab(e){return{content:e,cursor:{range:new this.AceRange(0,0,0,0),reversed:!1},scroll:{left:0,top:0},undoManger:new this.UndoManager}}getTab(){return{content:this.editor.getValue(),cursor:{range:this.editor.session.selection.getRange(),reversed:this.editor.session.selection.isBackwards()},scroll:{left:this.editor.session.getScrollLeft(),top:this.editor.session.getScrollTop()},undoManger:this.editor.session.getUndoManager()}}setTab(e){this.editor.setValue(e.content),this.editor.session.selection.setRange(e.cursor.range,e.cursor.reversed),this.editor.session.setScrollLeft(e.scroll.left),this.editor.session.setScrollTop(e.scroll.top),this.editor.session.setUndoManager(e.undoManger)}},He=class t{static save(e){try{let n={};for(let r of["syntaxHighlighting","keyboardHandler","theme","fontSize","wrap","useSoftTabs","tabSize","showInvisibles","enableLiveAutocompletion","indentedSoftWrap","underlineJosi"])n[r]=e.getOption(r);localStorage.setItem("nako3EditorOptions",JSON.stringify(n))}catch(n){return console.error(n),null}}static load(e){try{if(!window.localStorage)return null;let n=window.localStorage.getItem("nako3EditorOptions");if(n===null)return null;let r=JSON.parse(n);["ace/keyboard/vscode","ace/keyboard/emacs","ace/keyboard/sublime","ace/keyboard/vim"].includes(r.keyboardHandler)&&e.setOption("keyboardHandler",r.keyboardHandler),["ace/theme/xcode","ace/theme/monokai"].includes(r.theme)&&e.setOption("theme",r.theme),typeof r.fontSize=="number"&&e.setOption("fontSize",Math.min(48,Math.max(6,r.fontSize)));for(let o of["syntaxHighlighting","wrap","useSoftTabs","showInvisibles","enableLiveAutocompletion","indentedSoftWrap","underlineJosi"])typeof r[o]=="boolean"&&e.setOption(o,r[o]);typeof r.tabSize=="number"&&e.setOption("tabSize",Math.min(16,Math.max(0,r.tabSize)))}catch(n){return console.error(n),null}}static initPanel(e,n){let r=new e(n);if(this.done)return;this.done=!0;let o=!0;r.renderOptionGroup=u=>{if(o){for(let i of Object.keys(u))delete u[i];u.\u30B7\u30F3\u30BF\u30C3\u30AF\u30B9\u30CF\u30A4\u30E9\u30A4\u30C8={path:"syntaxHighlighting"},u.\u30AD\u30FC\u30D0\u30A4\u30F3\u30C9={path:"keyboardHandler",type:"select",items:[{caption:"VSCode",value:"ace/keyboard/vscode"},{caption:"Emacs",value:"ace/keyboard/emacs"},{caption:"Sublime",value:"ace/keyboard/sublime"},{caption:"Vim",value:"ace/keyboard/vim"}]},u.\u30AB\u30E9\u30FC\u30C6\u30FC\u30DE={path:"theme",type:"select",items:[{caption:"\u30E9\u30A4\u30C8",value:"ace/theme/xcode"},{caption:"\u30C0\u30FC\u30AF",value:"ace/theme/monokai"}]},u.\u6587\u5B57\u30B5\u30A4\u30BA={path:"fontSize",type:"number",defaultValue:16},u.\u884C\u306E\u6298\u308A\u8FD4\u3057={path:"wrap",type:"select",items:[{caption:"\u306A\u3057",value:"off"},{caption:"\u3042\u308A",value:"free"}]},u.\u30BD\u30D5\u30C8\u30BF\u30D6=[{path:"useSoftTabs"},{ariaLabel:"Tab Size",path:"tabSize",type:"number",values:[2,3,4,8,16]}],u.\u7A7A\u767D\u6587\u5B57\u3092\u8868\u793A={path:"showInvisibles"},u.\u5E38\u306B\u81EA\u52D5\u88DC\u5B8C={path:"enableLiveAutocompletion"},u.\u6298\u308A\u8FD4\u3057\u305F\u884C\u3092\u30A4\u30F3\u30C7\u30F3\u30C8={path:"indentedSoftWrap"},u.\u52A9\u8A5E\u306B\u4E0B\u7DDA\u3092\u5F15\u304F={path:"underlineJosi"},o=!1}else for(let i of Object.keys(u))delete u[i]},r.render();let s=e.prototype.render;e.prototype.render=function(...u){s.apply(this,...u),this.on("setOption",()=>{console.log("\u8A2D\u5B9A\u3092\u4FDD\u5B58\u3057\u307E\u3057\u305F\u3002"),t.save(this.editor)})}}},Zt=[],Sr=0;function en(t,e,n){let r=n.edit(t),o=typeof t=="string"?document.getElementById(t):t;if(o===null)throw new Error(`[wnako3_editor] id\u304C ${t} \u306EHTML\u8981\u7D20\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`);let s=n.require("ace/range").Range,u=new _t(r.session,r.session.bgTokenizer.doc,s,!!o.dataset.nako3DisableMarker);if(o.classList.contains("nako3_ace_mounted"))throw new Error("\u306A\u3067\u3057\u3053\u8A00\u8A9E\u306E\u30A8\u30C7\u30A3\u30BF\u306E\u521D\u671F\u5316\u51E6\u7406\u3092\u540C\u4E00\u306EHTML\u8981\u7D20\u306B\u5BFE\u3057\u3066\u8907\u6570\u56DE\u9069\u7528\u3057\u307E\u3057\u305F\u3002");o.setAttribute("lang","en"),o.classList.add("nako3_ace_mounted"),o.classList.add("nako3_editor");let i=o.dataset.nako3Readonly;i&&(o.classList.add("readonly"),r.setReadOnly(!0)),r.setFontSize(16);let c=v=>{let j=v.doc,x=j.getAllLines(),C=v.selection.getRange();j.removeFullLines(0,j.getLength()),j.insert({row:0,column:0},x.join(`
`)),v.selection.setRange(C,!1)};n.require("ace/config").defineOptions(r.constructor.prototype,"editor",{syntaxHighlighting:{set:function(v){this.session.bgTokenizer.enabled=v,c(this.session)},initialValue:!0},underlineJosi:{set:function(v){this.session.bgTokenizer.underlineJosi=v,c(this.session)},initialValue:!0}}),r.setOptions({wrap:"free",indentedSoftWrap:!1,showPrintMargin:!1}),n.require("ace/keybindings/vscode"),r.setKeyboardHandler("ace/keyboard/vscode");let a=n.require("ace/tooltip").Tooltip,f=new a(r.container);n.require("ace/lib/event").addListener(r.renderer.content,"mouseout",()=>{f.hide()}),r.on("mousemove",v=>{let j=v.getDocumentPosition();if(j.column>=v.editor.session.getLine(j.row).length){f.hide();return}let x=v.editor.session.getTokenAt(j.row,j.column+1);if(x===null||!x.docHTML){f.hide();return}f.setHtml(x.docHTML),f.show(null,v.clientX,v.clientY)}),r.session.on("change",()=>{f.hide(),u.clear()}),r.on("guttermousedown",v=>{let j=v.domEvent.target;if(j.className.indexOf("ace_gutter-cell")===-1||!r.isFocused())return;let x=v.getDocumentPosition().row,C=v.editor.editorId||0;j.className.indexOf("ace_breakpoint")===-1?(v.editor.session.setBreakpoint(x),window.postMessage({action:"breakpoint:on",row:x,editorId:C})):(v.editor.session.clearBreakpoint(x),window.postMessage({action:"breakpoint:off",row:x,editorId:C})),v.stop()});let p=!!o.dataset.nako3ForceSyntaxHighlighting,h=!0,_=r.session.bgTokenizer,g=new yt(r.session.bgTokenizer.doc,e,(v,j,x)=>{_._signal("update",{data:{first:v,last:j}}),x>220&&r.getOption("syntaxHighlighting")&&!i&&!p&&h&&(h=!1,D.classList.add("visible"),r.setOption("syntaxHighlighting",!1),setTimeout(()=>{D.classList.remove("visible")},13e3))},(v,j)=>{u.addByError(v,j,"error")},r.getOption("underlineJosi"));r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0});let b=Sr++;r.wnako3EditorId=b,Zt.push({getCompletions(v,j,x,C,R){if(v.wnako3EditorId!==b)R(null,[]);else{let Xe=B.getCompletionItems(x.row,C,e,g);if(Xe.some(L=>L.value===C)){R(null,[]);return}R(null,Xe)}}},{getCompletions(v,j,x,C,R){R(null,v.wnako3EditorId!==b?[]:B.getSnippets(v.session.doc.getAllLines().join(`
`)))}}),n.require("ace/ext/language_tools").setCompleters(Zt),n.require("ace/autocomplete/util").getCompletionPrefix=v=>{let j=v.getCursorPosition();return B.getCompletionPrefix(v.session.doc.getLine(j.row).slice(0,j.column),e)};let w=new B(s,e),d=n.require("ace/lib/oop"),m=n.require("ace/mode/text").Mode,k=function(){this.HighlightRules=new m().HighlightRules,this.foldingRules={getFoldWidget:w.getFoldWidget.bind(w),getFoldWidgetRange:w.getFoldWidgetRange.bind(w)}};d.inherits(k,m),k.prototype.toggleCommentLines=B.toggleCommentLines.bind(B),k.prototype.getNextLineIndent=B.getNextLineIndent.bind(B),k.prototype.checkOutdent=B.checkOutdent.bind(B),k.prototype.autoOutdent=w.autoOutdent.bind(w),r.session.setMode(new k),r.session.bgTokenizer.stop(),r.session.bgTokenizer=g,r.setTheme("ace/theme/xcode"),He.load(r);let A=n.require("ace/ext/options").OptionPanel;He.initPanel(A,r);let N=document.createElement("div");N.classList.add("button-container"),r.container.appendChild(N);let D=document.createElement("span");D.classList.add("slow-speed-message"),D.innerHTML="<span>\u30A8\u30C7\u30A3\u30BF\u306E|\u5FDC\u7B54\u901F\u5EA6\u304C|\u4F4E\u4E0B\u3057\u305F\u305F\u3081|\u30B7\u30F3\u30BF\u30C3\u30AF\u30B9|\u30CF\u30A4\u30E9\u30A4\u30C8\u3092|\u7121\u52B9\u5316|\u3057\u307E\u3057\u305F\u3002</span>".replace(/\|/g,"</span><span>"),N.appendChild(D);let ue=[];try{let v=n.require("ace/ext/code_lens");r.setOption("enableCodeLens",!0),r.commands.addCommand({name:"runTest",exec:(j,x)=>{ue.filter(C=>C.name==="test").forEach(C=>C.callback(x[0]))}}),v.registerCodeLensProvider(r,{provideCodeLenses:(j,x)=>{x(null,ue.some(C=>C.name==="test")?B.getCodeLens(j.doc):[])}})}catch(v){console.error(v)}let ge=()=>{r.container.classList.remove("fullscreen"),r.renderer.setScrollMargin(0,0,0,0)},te=document.createElement("span");te.classList.add("editor-button"),te.innerText="\u5168\u753B\u9762",te.addEventListener("click",v=>{r.container.classList.contains("fullscreen")?ge():(r.container.classList.add("fullscreen"),r.renderer.setScrollMargin(20,20,0,0)),v.preventDefault()}),N.appendChild(te);let Me=document.createElement("span");Me.classList.add("editor-button"),Me.innerText="\u8A2D\u5B9A",Me.addEventListener("click",v=>{ge(),r.execCommand("showSettingsMenu"),v.preventDefault()}),N.appendChild(Me);let Mn=n.require("ace/undomanager").UndoManager,En=new gt(r,s,Mn);o.dataset.nako3Resizable&&(new MutationObserver(()=>{r.resize()}).observe(r.container,{attributes:!0}),r.renderer.setScrollMargin(4,0,4,0),r.container.classList.add("resizable"));let vt=()=>{g.dirty=!0};return{editor:r,editorMarkers:u,editorTabs:En,retokenize:vt,run:v=>{let j=r.getValue(),x=v.preCode||"",C=e.replaceLogger();if(v.outputContainer){let L=v.outputContainer;C.addListener("info",({html:ce})=>{L||console.log(ce),L.style.display="block",L.innerHTML+=ce}),v.outputContainer.classList.add("nako3-output-container")}let R=v.file||"main.nako3";return C.addListener("info",({position:L,noColor:ce,level:Ye})=>{L&&L.file===R&&(Ye==="warn"||Ye==="error")&&u.addByError(j,{...L,message:ce},Ye)}),{promise:e.loadDependencies(x+j,R,x,v.localFiles||{}).then(async()=>{if(R||(R="main.nako3"),v.method==="test")return e.test(x+j,R,x,v.testName);if(v.method==="compile")return e.compile(x+j,R,!1,x);{let L={resetEnv:!0,resetAll:!0,preCode:x};return await e.runAsync(x+j,R,L)}}).catch(L=>{console.error("[wnako3_editor]",L,e.__globalObj)}).then(async L=>{for(vt();g.dirty;)await new Promise(ce=>setTimeout(ce,0));return L}).catch(L=>{console.error("[wnako3_editor::run::promise::catch]",L)}),logger:C,code:j}},codeLensListeners:ue}}var jr={version:"3.7.2",major:3,minor:7,patch:2},Se=jr;var tn={\u6C34\u8272:{type:"const",value:"aqua"},\u7D2B\u8272:{type:"const",value:"fuchsia"},\u7DD1\u8272:{type:"const",value:"lime"},\u9752\u8272:{type:"const",value:"blue"},\u8D64\u8272:{type:"const",value:"red"},\u9EC4\u8272:{type:"const",value:"yellow"},\u9ED2\u8272:{type:"const",value:"black"},\u767D\u8272:{type:"const",value:"white"},\u8336\u8272:{type:"const",value:"maroon"},\u7070\u8272:{type:"const",value:"gray"},\u91D1\u8272:{type:"const",value:"gold"},\u9EC4\u91D1\u8272:{type:"const",value:"gold"},\u9280\u8272:{type:"const",value:"silver"},\u767D\u91D1\u8272:{type:"const",value:"silver"},\u30AA\u30EA\u30FC\u30D6\u8272:{type:"const",value:"olive"},\u30D9\u30FC\u30B8\u30E5\u8272:{type:"const",value:"beige"},\u30A2\u30EA\u30B9\u30D6\u30EB\u30FC\u8272:{type:"const",value:"aliceblue"},RGB:{type:"func",josi:[["\u3068"],["\u3068"],["\u3067","\u306E"]],pure:!0,fn:function(t,e,n){let r=o=>{let s="00"+o.toString(16);return s.substr(s.length-2,2)};return"#"+r(t)+r(e)+r(n)},return_none:!1},\u8272\u6DF7:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=n=>{let r="00"+n.toString(16);return r.substr(r.length-2,2)};if(!t)throw new Error("\u300E\u8272\u6DF7\u305C\u308B\u300F\u306E\u5F15\u6570\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3057\u307E\u3059");if(t.length<3)throw new Error("\u300E\u8272\u6DF7\u305C\u308B\u300F\u306E\u5F15\u6570\u306B\u306F[RR,GG,BB]\u5F62\u5F0F\u306E\u914D\u5217\u3092\u6307\u5B9A\u3057\u307E\u3059");return"#"+e(t[0])+e(t[1])+e(t[2])},return_none:!1}};var nn={WNAKO\u30D0\u30FC\u30B8\u30E7\u30F3:{type:"const",value:"?"},\u7D42:{type:"func",josi:[],pure:!0,fn:function(t){if(t&&t.__v0){if(t.__setSysVar("__forceClose",!0),!t.__getSysVar("__useDebug"))throw new Error("__\u7D42\u308F\u308B__")}else throw new Error("__\u7D42\u308F\u308B__")},return_none:!0},OS\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(){let t=window.navigator.userAgent.toLowerCase();return t.indexOf("windows")!==-1?"windows":t.indexOf("android")!==-1?"android":t.indexOf("iphone")!==-1?"iphone":t.indexOf("ipad")!==-1?"ipad":t.indexOf("mac os x")!==-1||t.indexOf("macintosh")!==-1?"darwin":t.indexOf("cros")!==-1?"chromeos":t.indexOf("ubuntu")!==-1?"ubuntu":t.indexOf("linux")!==-1?"linux":"unknown"}}};var rn={\u8A00:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,fn:function(t){window.alert(t)},return_none:!0},\u30C0\u30A4\u30A2\u30ED\u30B0\u30AD\u30E3\u30F3\u30BB\u30EB\u5024:{type:"var",value:""},\u5C0B:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,fn:function(t,e){let n=window.prompt(t);return n===null?e.__getSysVar("\u30C0\u30A4\u30A2\u30ED\u30B0\u30AD\u30E3\u30F3\u30BB\u30EB\u5024"):/^[-+]?[0-9]+(\.[0-9]+)?$/.test(n)?parseFloat(n):/^[-+－＋]?[0-9０-９]+([.．][0-9０-９]+)?$/.test(n)?parseFloat(n.replace(/[－＋０-９．]/g,r=>String.fromCharCode(r.charCodeAt(0)-65248))):n}},\u6587\u5B57\u5C0B:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,fn:function(t,e){let n=window.prompt(t);return n===null?e.__getSysVar("\u30C0\u30A4\u30A2\u30ED\u30B0\u30AD\u30E3\u30F3\u30BB\u30EB\u5024"):n}},\u4E8C\u629E:{type:"func",josi:[["\u3067","\u306E","\u3068","\u3092"]],pure:!0,fn:function(t){return window.confirm(t)}}};var on={\u30D6\u30E9\u30A6\u30B6\u79FB\u52D5:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){window.location.href=t}},\u30D6\u30E9\u30A6\u30B6\u623B:{type:"func",josi:[],pure:!0,fn:function(){window.history.back(-1)}},\u30D6\u30E9\u30A6\u30B6URL:{type:"const",value:""}};var sn={HTTP\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u53D7\u4FE1:{type:"func",josi:[["\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3067"],["\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e,n){n.__exec("AJAX\u9001\u4FE1\u6642",[t,e,n])},return_none:!0},AJAX\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e,n){let r=n.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");r===""&&(r={method:"GET"}),fetch(e,r).then(o=>o.status!==200?n.__getSysVar("AJAX:ONERROR")(o.status):o.text()).then(o=>{n.__setSysVar("\u5BFE\u8C61",o),t(o,n)}).catch(o=>{n.__getSysVar("AJAX:ONERROR")(o)})},return_none:!0},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3:{type:"const",value:""},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078","\u3068"]],pure:!0,fn:function(t,e){e.__setSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3",t)},return_none:!0},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3POST\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){let n=e.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[t,e]),r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n};e.__setSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3",r)},return_none:!0},AJAX\u5931\u6557\u6642:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){e.__setSysVar("AJAX:ONERROR",t)}},AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).text()},return_none:!1},AJAX_JSON\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).json()},return_none:!1},AJAX\u30D0\u30A4\u30CA\u30EA\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).blob()},return_none:!1},GET\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e,n){n.__exec("AJAX\u9001\u4FE1\u6642",[t,e,n])},return_none:!0},POST\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n,r){let o=r.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[n,r]);fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o}).then(u=>u.text()).then(u=>{r.__setSysVar("\u5BFE\u8C61",u),t(u)}).catch(u=>{r.__getSysVar("AJAX:ONERROR")(u)})}},POST\u30D5\u30A9\u30FC\u30E0\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n,r){let o=new FormData;for(let u in n)o.set(u,n[u]);fetch(e,{method:"POST",body:o}).then(u=>u.text()).then(u=>{r.__setSysVar("\u5BFE\u8C61",u),t(u)}).catch(u=>{r.__getSysVar("AJAX:ONERROR")(u)})}},POST\u30C7\u30FC\u30BF\u751F\u6210:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=[];for(let r in t){let o=t[r],s=encodeURIComponent(r)+"="+encodeURIComponent(o);n.push(s)}return n.join("&")}},POST\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,asyncFn:!0,fn:function(t,e,n){return new Promise((r,o)=>{let s=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(i=>i.text()).then(i=>{r(i)}).catch(i=>{o(i.message)})})}},POST\u30D5\u30A9\u30FC\u30E0\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,asyncFn:!0,fn:function(t,e,n){return new Promise((r,o)=>{let s=new FormData;for(let i in e)s.set(i,e[i]);fetch(t,{method:"POST",body:s}).then(i=>i.text()).then(i=>{r(i)}).catch(i=>{o(i.message)})})}},AJAX\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),fetch(t,n)},return_none:!1},HTTP\u4FDD\u969C\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e){return e.__exec("AJAX\u4FDD\u969C\u9001\u4FE1",[t,e])},return_none:!1},POST\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);return fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r})},return_none:!1},POST\u30D5\u30A9\u30FC\u30E0\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=new FormData;for(let s in e)r.set(s,e[s]);return fetch(t,{method:"POST",body:r})},return_none:!1},AJAX\u5185\u5BB9\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"],["\u3067"]],pure:!0,fn:function(t,e,n){return e=e.toString().toUpperCase(),e==="TEXT"||e==="\u30C6\u30AD\u30B9\u30C8"?t.text():e==="JSON"?t.json():e==="BLOB"?t.blob():e==="ARRAY"||e==="\u914D\u5217"?t.arrayBuffer():e==="BODY"||e==="\u672C\u4F53"?t.body:t.body()},return_none:!1},BLOB\u4F5C\u6210:{type:"func",josi:[["\u3092","\u304B\u3089"],["\u3067"]],pure:!0,fn:function(t,e){return t instanceof Array||(t=[t]),new Blob(t,e)}},AJAX\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e){if(!e.resolve)throw new Error("\u300EAJAX\u9010\u6B21\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");e.resolveCount++;let n=e.resolve,r=e.reject,o=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");o===""&&(o={method:"GET"}),fetch(t,o).then(s=>s.text()).then(s=>{e.__setSysVar("\u5BFE\u8C61",s),n()}).catch(s=>{r(s.message)})},return_none:!0},HTTP\u9010\u6B21\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e){if(!e.resolve)throw new Error("\u300EHTTP\u9010\u6B21\u53D6\u5F97\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");e.__exec("AJAX\u9010\u6B21\u9001\u4FE1",[t,e])},return_none:!0},POST\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!n.resolve)throw new Error("\u300EPOST\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");n.resolveCount++;let r=n.resolve,o=n.reject,s=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(i=>i.text()).then(i=>{n.__setSysVar("\u5BFE\u8C61",i),r(i)}).catch(i=>{o(i.message)})},return_none:!0},POST\u30D5\u30A9\u30FC\u30E0\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!n.resolve)throw new Error("\u300EPOST\u30D5\u30A9\u30FC\u30E0\u9010\u6B21\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");n.resolveCount++;let r=n.resolve,o=n.reject,s=new FormData;for(let i in e)s.set(i,e[i]);fetch(t,{method:"POST",body:s}).then(i=>i.text()).then(i=>{n.__setSysVar("\u5BFE\u8C61",i),r(i)}).catch(i=>{o(i.message)})},return_none:!0}};var un={DOCUMENT:{type:"const",value:""},WINDOW:{type:"const",value:""},NAVIGATOR:{type:"const",value:""},DOM\u8981\u7D20ID\u53D6\u5F97:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=document.getElementById(t);return e.__addPropMethod(n),n}},DOM\u8981\u7D20\u53D6\u5F97:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(typeof t=="string"){let n=document.querySelector(t);return e.__addPropMethod(n),n}return t}},DOM\u8981\u7D20\u5168\u53D6\u5F97:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=Array.from(document.querySelectorAll(t));if(!n)return[];for(let r of n)e.__addPropMethod(r);return n}},\u30BF\u30B0\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return Array.from(document.getElementsByTagName(t))}},DOM\u5B50\u8981\u7D20\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t=n.__query(t,"DOM\u5B50\u8981\u7D20\u53D6\u5F97",!0),!t.querySelector)throw new Error("\u300EDOM\u5B50\u8981\u7D20\u53D6\u5F97\u300F\u3067\u89AA\u8981\u7D20\u304CDOM\u3067\u306F\u3042\u308A\u307E\u305B\u3093\u3002");let r=t.querySelector(e);return n.__addPropMethod(r),r}},DOM\u5B50\u8981\u7D20\u5168\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t=n.__query(t,"DOM\u5B50\u8981\u7D20\u5168\u53D6\u5F97",!0),!t.querySelectorAll)throw new Error("\u300EDOM\u5B50\u8981\u7D20\u5168\u53D6\u5F97\u300F\u3067\u89AA\u8981\u7D20\u304CDOM\u3067\u306F\u3042\u308A\u307E\u305B\u3093\u3002");let r=Array.from(t.querySelectorAll(e));if(!r)return[];for(let o of r)n.__addPropMethod(o);return r}},DOM\u30A4\u30D9\u30F3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n,r){t=r.__query(t,"DOM\u30A4\u30D9\u30F3\u30C8\u8A2D\u5B9A",!1),t[e]=r.__findVar(n,null)},return_none:!0},DOM\u30C6\u30AD\u30B9\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u306E","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){t=n.__query(t,"DOM\u30C6\u30AD\u30B9\u30C8\u8A2D\u5B9A",!1);let r=t.tagName.toUpperCase();if(r==="INPUT"||r==="TEXTAREA")t.value=e;else if(r==="SELECT")for(let o=0;o<t.options.length;o++){let s=t.options[o].value;if(String(s)===e){t.selectedIndex=o;break}}else t.innerHTML=e},return_none:!0},DOM\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){if(t=e.__query(t,"DOM\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",!0),!t)return"";let n=t.tagName.toUpperCase();if(n==="INPUT"||n==="TEXTAREA")return t.value;if(n==="SELECT"){let r=t.selectedIndex;return r<0?null:t.options[r].value}return t.innerHTML}},DOM_HTML\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u306E","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){t=n.__query(t,"DOM_HTML\u8A2D\u5B9A",!1),t.innerHTML=e},return_none:!0},DOM_HTML\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){return t=e.__query(t,"DOM_HTML\u53D6\u5F97",!0),t?t.innerHTML:""}},\u30C6\u30AD\u30B9\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u306E","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("DOM\u30C6\u30AD\u30B9\u30C8\u8A2D\u5B9A",[t,e,n])},return_none:!0},\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__exec("DOM\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},HTML\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u306E","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("DOM_HTML\u8A2D\u5B9A",[t,e,n])},return_none:!0},HTML\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__exec("DOM_HTML\u53D6\u5F97",[t,e])}},DOM\u5C5E\u6027\u8A2D\u5B9A:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],uses:["DOM\u548C\u5C5E\u6027"],pure:!0,fn:function(t,e,n,r){t=r.__query(t,"DOM\u5C5E\u6027\u8A2D\u5B9A",!1);let o=r.__getSysVar("DOM\u548C\u5C5E\u6027");o[e]&&(e=o[e]),e in t?t[e]=n:t.setAttribute(e,n)},return_none:!0},DOM\u5C5E\u6027\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],uses:["DOM\u548C\u5C5E\u6027"],pure:!0,fn:function(t,e,n){if(t=n.__query(t,"DOM\u5C5E\u6027\u53D6\u5F97",!0),!t)return"";let r=n.__getSysVar("DOM\u548C\u5C5E\u6027");return r[e]&&(e=r[e]),e in t?t[e]:t.getAttribute(e)}},DOM\u548C\u5C5E\u6027:{type:"const",value:{\u5E45:"width",\u9AD8\u3055:"height",\u9AD8:"height",\u5E45\u5C5E\u6027:"width",\u9AD8\u5C5E\u6027:"height",\u30BF\u30A4\u30D7:"type",\u30C7\u30FC\u30BF:"data",\u540D\u524D:"name",ID:"id",\u30AF\u30E9\u30B9:"className",\u8AAD\u53D6\u5C02\u7528:"readOnly",\u8AAD\u307F\u53D6\u308A\u5C02\u7528:"readOnly",\u7121\u52B9\u5316:"disabled",\u975E\u8868\u793A:"hidden",\u5024:"value",\u30C6\u30AD\u30B9\u30C8:"innerText",HTML:"innerHTML",\u30B9\u30C6\u30C3\u30D7:"step",\u6700\u5C0F\u5024:"min",\u6700\u5927\u5024:"max",\u5FC5\u9808\u9805\u76EE:"required",\u9078\u629E\u72B6\u614B:"checked",\u5165\u529B\u30D2\u30F3\u30C8:"placeholder",\u6587\u5B57\u5E45:"size",\u30B9\u30BF\u30A4\u30EB:"style",\u884C\u6570:"rows",\u5217\u6570:"cols",\u81EA\u52D5\u5165\u529B:"autocomplete",\u81EA\u52D5\u30D5\u30A9\u30FC\u30AB\u30B9:"autofocus",\u6700\u5927\u6587\u5B57\u6570:"maxlength",\u6700\u5C0F\u6587\u5B57\u6570:"minlength"}},DOM\u548C\u30B9\u30BF\u30A4\u30EB:{type:"const",value:{\u5E45:"width",\u9AD8\u3055:"height",\u9AD8:"height",\u80CC\u666F\u8272:"background-color",\u8272:"color",\u30DE\u30FC\u30B8\u30F3:"margin",\u4F59\u767D:"padding",\u6587\u5B57\u30B5\u30A4\u30BA:"font-size",\u884C\u63C3\u3048:"text-align",\u884C\u63C3:"text-align",\u4E0A:"top",\u5DE6:"left",\u53F3:"right",\u4E2D\u592E:"center",\u30DC\u30FC\u30C0\u30FC:"border",\u30DC\u30C3\u30AF\u30B9\u8868\u793A:"display",\u306A\u3057:"none",\u30D6\u30ED\u30C3\u30AF:"block",\u8868\u793A\u4F4D\u7F6E:"float",\u91CD\u306A\u308A:"z-index",\u91CD:"z-index",\u8AAD\u53D6\u5C02\u7528:"readOnly",\u8AAD\u307F\u53D6\u308A\u5C02\u7528:"readOnly",readonly:"readOnly"}},DOM\u30D7\u30ED\u30D1\u30C6\u30A3\u60C5\u5831:{type:"const",value:{\u5E45:"style",\u9AD8:"style",\u8AAD\u53D6\u5C02\u7528:"attribute",\u5E45\u5C5E\u6027:"attribute",\u9AD8\u5C5E\u6027:"attribute",\u6709\u52B9:"hook",\u53EF\u8996:"hook",\u30DD\u30B1\u30C3\u30C8:"hook",\u30D2\u30F3\u30C8:"hook",\u30C6\u30AD\u30B9\u30C8:"hook"}},DOM\u30B9\u30BF\u30A4\u30EB\u8A2D\u5B9A:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],uses:["DOM\u548C\u30B9\u30BF\u30A4\u30EB"],pure:!0,fn:function(t,e,n,r){t=r.__query(t,"DOM\u30B9\u30BF\u30A4\u30EB\u8A2D\u5B9A",!1);let o=r.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB");o[e]!==void 0&&(e=o[e]),o[n]!==void 0&&(n=o[n]),t.style[e]=n},return_none:!0},DOM\u30B9\u30BF\u30A4\u30EB\u4E00\u62EC\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],uses:["DOM\u548C\u30B9\u30BF\u30A4\u30EB"],pure:!0,fn:function(t,e,n){if(typeof t=="string"){let o=document.querySelectorAll(t);if(o==null||o.length===0)throw new Error(`\u300EDOM\u30B9\u30BF\u30A4\u30EB\u4E00\u62EC\u8A2D\u5B9A\u300F\u3067\u300E${t}\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002`);t=o}t instanceof window.HTMLElement&&(t=[t]);let r=n.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB");for(let o=0;o<t.length;o++){let s=t[o];n.__addPropMethod(s);for(let u in e){let i=u,c=e[u];r[i]!==void 0&&(i=r[i]),r[c]!==void 0&&(c=r[c]),s.style[i]=c}}},return_none:!0},DOM\u30B9\u30BF\u30A4\u30EB\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],uses:["DOM\u548C\u30B9\u30BF\u30A4\u30EB"],pure:!0,fn:function(t,e,n){if(t=n.__query(t,"DOM\u30B9\u30BF\u30A4\u30EB\u53D6\u5F97",!0),!t)return"";let r=n.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB");return r[e]&&(e=r[e]),t.style[e]}},DOM\u30B9\u30BF\u30A4\u30EB\u4E00\u62EC\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],uses:["DOM\u548C\u30B9\u30BF\u30A4\u30EB"],pure:!0,fn:function(t,e,n){let r={};if(t=n.__query(t,"DOM\u30B9\u30BF\u30A4\u30EB\u4E00\u62EC\u53D6\u5F97",!0),!t)return r;e instanceof String&&(e=[e]);let o=n.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB");if(e instanceof Array)return e.forEach(s=>{o[s]&&(s=o[s]),r[s]=t.style[s]}),r;if(e instanceof Object){for(let s in e)o[s]&&(s=o[s]),r[s]=t.style[s];return r}return t.style[e]}},\u30C7\u30FC\u30BF\u5C5E\u6027\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],fn:function(t,e,n){return t=n.__query(t,"\u30C7\u30FC\u30BF\u5C5E\u6027\u53D6\u5F97",!0),t?t.dataset[e]:""}},\u30C7\u30FC\u30BF\u5C5E\u6027\u8A2D\u5B9A:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n,r){if(t=r.__query(t,"\u30C7\u30FC\u30BF\u5C5E\u6027\u8A2D\u5B9A",!0),!t)return"";t.dataset[e]=n},return_none:!0},DOM\u8A2D\u5B9A\u5909\u66F4:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n,r){t=r.__query(t,"DOM\u8A2D\u5B9A\u5909\u66F4",!1);let o=r.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB"),s=r.__getSysVar("DOM\u548C\u5C5E\u6027"),u=r.__getSysVar("DOM\u30D7\u30ED\u30D1\u30C6\u30A3\u60C5\u5831");if(o[n]!==void 0&&(n=o[n]),e instanceof Array)for(let i=0;i<e.length;i++){let c=e[i];o[c]!==void 0?c=o[c]:s[c]!==void 0&&(c=s[c],s[n]!==void 0&&(n=s[n])),i<e.length-1?t=t[c]:t[c]=n}else{let i=e;if(u[i]!==void 0){let c=u[i];if(c==="style"){i=o[i],t.style[i]=n;return}else if(c==="attribute"){i=s[i],s[n]!==void 0&&(n=s[n]),t[i]=n;return}else if(c==="hook"){let a=`DOM${i}\u8A2D\u5B9A`;r.__exec(a,[t,n,r]);return}}if(o[i]!==void 0&&typeof n=="string"&&n.match(/^[0-9.]+([a-z]{2,5})$/)){i=o[i],t.style[i]=n;return}if(s[i]!==void 0){i=s[i],s[n]!==void 0&&(n=s[n]),t[i]=n;return}if(o[i]!==void 0){i=o[i],t.style[i]=n;return}if(typeof n=="string"&&n.match(/^[0-9.]+(px|em|ex|rem|vw|vh)$/)){t.style[i]=n;return}t[i]=n}},return_none:!0},DOM\u8A2D\u5B9A\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],fn:function(t,e,n){t=n.__query(t,"DOM\u8A2D\u5B9A\u53D6\u5F97",!0);let r=n.__getSysVar("DOM\u548C\u30B9\u30BF\u30A4\u30EB"),o=n.__getSysVar("DOM\u548C\u5C5E\u6027"),s=n.__getSysVar("DOM\u30D7\u30ED\u30D1\u30C6\u30A3\u60C5\u5831");if(e instanceof Array)for(let u=0;u<e.length;u++){let i=e[u];if(r[i]!==void 0?i=r[i]:o[i]!==void 0&&(i=o[i]),u<e.length-1)t=t[i];else return t[i]}else{let u=e;if(s[u]!==void 0){let i=s[u];if(i==="style")return u=r[u],t.style[u];if(i==="attribute")return u=o[u],t[u];if(i==="hook"){let c=`DOM${u}\u53D6\u5F97`;return n.__exec(c,[t,n])}}if(o[u]!==void 0){u=o[u];let i=t[u];if(i!==void 0)return i}if(r[u]!==void 0){u=r[u];let i=t.style[u];if(i!==void 0)return i;let c=t[u];if(c!==void 0)return c}return t[u]}}},DOM\u6709\u52B9\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){if(t=n.__query(t,"DOM\u6709\u52B9\u8A2D\u5B9A",!0),!t)return"";t.dataset.\u6709\u52B9=e,t.disabled=!e}},DOM\u6709\u52B9\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){return t=e.__query(t,"DOM\u6709\u52B9\u53D6\u5F97",!0),t?t.dataset.\u6709\u52B9:""}},DOM\u53EF\u8996\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){if(t=n.__query(t,"DOM\u53EF\u8996\u8A2D\u5B9A",!0),!t)return"";t.dataset.\u53EF\u8996=e,t.style.visibility=e?"visible":"hidden"}},DOM\u53EF\u8996\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){return t=e.__query(t,"DOM\u53EF\u8996\u53D6\u5F97",!0),t?t.dataset.\u53EF\u8996:""}},\u30DD\u30B1\u30C3\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){if(t=e.__query(t,"\u30DD\u30B1\u30C3\u30C8\u53D6\u5F97",!0),!t)return"";try{return JSON.parse(t.dataset.pocket)}catch(n){return console.log("[\u306A\u3067\u3057\u3053] \u30DD\u30B1\u30C3\u30C8\u53D6\u5F97\u306EJSON\u30C7\u30FC\u30BF\u306E\u4E0D\u6B63:",n),t.dataset.pocket}}},DOM\u30DD\u30B1\u30C3\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){return e.__exec("\u30DD\u30B1\u30C3\u30C8\u53D6\u5F97",[t,e])}},\u30DD\u30B1\u30C3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){if(t=n.__query(t,"\u30DD\u30B1\u30C3\u30C8\u8A2D\u5B9A",!0),!t)return"";t.dataset.pocket=JSON.stringify(e)},return_none:!0},DOM\u30DD\u30B1\u30C3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){return n.__exec("\u30DD\u30B1\u30C3\u30C8\u8A2D\u5B9A",[t,e,n])},return_none:!0},\u30D2\u30F3\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){return t=e.__query(t,"\u30D2\u30F3\u30C8\u53D6\u5F97",!0),t?t.getAttribute("title"):""}},DOM\u30D2\u30F3\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],fn:function(t,e){return e.__exec("\u30D2\u30F3\u30C8\u53D6\u5F97",[t,e])}},\u30D2\u30F3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){if(t=n.__query(t,"\u30D2\u30F3\u30C8\u8A2D\u5B9A",!0),!t)return"";t.setAttribute("title",e)},return_none:!0},DOM\u30D2\u30F3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],fn:function(t,e,n){return n.__exec("\u30D2\u30F3\u30C8\u8A2D\u5B9A",[t,e,n])},return_none:!0},DOM\u8981\u7D20\u4F5C\u6210:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return document.createElement(t)}},DOM\u5B50\u8981\u7D20\u8FFD\u52A0:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){t=n.__query(t,"DOM\u5B50\u8981\u7D20\u8FFD\u52A0",!1),e=n.__query(e,"DOM\u5B50\u8981\u7D20\u8FFD\u52A0",!1),t.appendChild(e)}},DOM\u5B50\u8981\u7D20\u524A\u9664:{type:"func",josi:[["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){t=n.__query(t,"DOM\u5B50\u8981\u7D20\u524A\u9664",!1),e=n.__query(e,"DOM\u5B50\u8981\u7D20\u524A\u9664",!1),t.removeChild(e)}},\u6CE8\u76EE:{type:"func",josi:[["\u3092","\u3078","\u306B"]],pure:!0,fn:function(t,e){t=e.__query(t,"\u6CE8\u76EE",!0),t&&t.focus&&t.focus()},return_none:!0}};var cn={\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8:{type:"const",value:""},DOM\u30A4\u30D9\u30F3\u30C8\u8FFD\u52A0:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n,r){r.__addEvent(t,e,n,null)},return_none:!0},DOM\u30A4\u30D9\u30F3\u30C8\u524A\u9664:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n,r){r.__removeEvent(t,e,n)},return_none:!0},DOM\u30A4\u30D9\u30F3\u30C8\u767A\u706B\u6642:{type:"func",josi:[["\u3067"],["\u306E"],["\u304C"]],pure:!0,fn:function(t,e,n,r){r.__addEvent(e,n,t,null)},return_none:!0},DOM\u30A4\u30D9\u30F3\u30C8\u51E6\u7406\u505C\u6B62:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t,e){if(t!==null&&typeof t=="object"&&"preventDefault"in t){let n=t;typeof n.preventDefault=="function"&&n.preventDefault()}},return_none:!0},\u30AF\u30EA\u30C3\u30AF\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"click",t,n.__mouseHandler)},return_none:!0},\u30C0\u30D6\u30EB\u30AF\u30EA\u30C3\u30AF\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"dblclick",t,n.__mouseHandler)},return_none:!0},\u53F3\u30AF\u30EA\u30C3\u30AF\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"contextmenu",t,n.__mouseHandler)},return_none:!0},\u5909\u66F4\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"change",t,null)},return_none:!0},\u8AAD\u8FBC\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"load",t,null)},return_none:!0},\u30D5\u30A9\u30FC\u30E0\u9001\u4FE1\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"submit",t,null)},return_none:!0},\u62BC\u30AD\u30FC:{type:"const",value:""},\u30AD\u30FC\u62BC\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"keydown",t,n.__keyHandler)},return_none:!0},\u30AD\u30FC\u96E2\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"keyup",t,n.__keyHandler)},return_none:!0},\u30AD\u30FC\u30BF\u30A4\u30D4\u30F3\u30B0\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"keypress",t,n.__keyHandler)},return_none:!0},\u30DE\u30A6\u30B9X:{type:"const",value:0},\u30DE\u30A6\u30B9Y:{type:"const",value:0},\u62BC\u30DC\u30BF\u30F3:{type:"const",value:0},\u30DE\u30A6\u30B9\u62BC\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"mousedown",t,n.__mouseHandler)},return_none:!0},\u30DE\u30A6\u30B9\u79FB\u52D5\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E","\u3078","\u306B"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"mousemove",t,n.__mouseHandler)},return_none:!0},\u30DE\u30A6\u30B9\u96E2\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"mouseup",t,n.__mouseHandler)},return_none:!0},\u30DE\u30A6\u30B9\u5165\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E","\u306B","\u3078"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"mouseover",t,n.__mouseHandler)},return_none:!0},\u30DE\u30A6\u30B9\u51FA\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"mouseout",t,n.__mouseHandler)},return_none:!0},\u30DE\u30A6\u30B9\u30DB\u30A4\u30FC\u30EB\u5024:{type:"const",value:0},\u30DE\u30A6\u30B9\u30DB\u30A4\u30FC\u30EB\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"wheel",t,r=>{let o=r;typeof o.deltaY=="number"&&n.__setSysVar("\u30DE\u30A6\u30B9\u30DB\u30A4\u30FC\u30EB\u5024",o.deltaY)})},return_none:!0},\u30BF\u30C3\u30C1X:{type:"const",value:0},\u30BF\u30C3\u30C1Y:{type:"const",value:0},\u30BF\u30C3\u30C1\u914D\u5217:{type:"const",value:[]},\u30BF\u30C3\u30C1\u30A4\u30D9\u30F3\u30C8\u8A08\u7B97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__touchHandler(t,e)}},\u30BF\u30C3\u30C1\u958B\u59CB\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"touchstart",t,n.__touchHandler)},return_none:!0},\u30BF\u30C3\u30C1\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"touchmove",t,n.__touchHandler)},return_none:!0},\u30BF\u30C3\u30C1\u7D42\u4E86\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"touchend",t,n.__touchHandler)},return_none:!0},\u30BF\u30C3\u30C1\u30AD\u30E3\u30F3\u30BB\u30EB\u6642:{type:"func",josi:[["\u3067"],["\u3092","\u306E"]],pure:!0,fn:function(t,e,n){n.__addEvent(e,"touchcancel",t,n.__touchHandler)},return_none:!0},\u753B\u9762\u66F4\u65B0\u6642\u5B9F\u884C:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(t=e.__findVar(t,null),!t)throw new Error("\u300E\u753B\u9762\u66F4\u65B0\u6642\u5B9F\u884C\u300F\u3067\u95A2\u6570\u306E\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002");return e.__requestAnimationFrameLastId=window.requestAnimationFrame(t),e.__requestAnimationFrameLastId}},\u753B\u9762\u66F4\u65B0\u51E6\u7406\u53D6\u6D88:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){window.cancelAnimationFrame(t),e.__requestAnimationFrameLastId===t&&(e.__requestAnimationFrameLastId=0)},return_none:!0}};var an={DOM\u89AA\u8981\u7D20:{type:"const",value:""},DOM\u90E8\u54C1\u500B\u6570:{type:"const",value:0},DOM\u90E8\u54C1\u30AA\u30D7\u30B7\u30E7\u30F3:{type:"const",value:{\u81EA\u52D5\u6539\u884C:!1,\u30C6\u30FC\u30D6\u30EB\u30D8\u30C3\u30C0:!0,\u30C6\u30FC\u30D6\u30EB\u80CC\u666F\u8272:["#AA4040","#ffffff","#fff0f0"],\u30C6\u30FC\u30D6\u30EB\u6570\u5024\u53F3\u5BC4\u305B:!0}},DOM\u89AA\u8981\u7D20\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){return typeof t=="string"&&(t=document.querySelector(t)||document.getElementById(t)),e.__setSysVar("DOM\u89AA\u8981\u7D20",t),e.__addPropMethod(t),t}},DOM\u89AA\u90E8\u54C1\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){return e.__exec("DOM\u89AA\u8981\u7D20\u8A2D\u5B9A",[t,e])}},DOM\u30B9\u30AD\u30F3:{type:"const",value:""},DOM\u30B9\u30AD\u30F3\u8F9E\u66F8:{type:"const",value:{}},DOM\u30B9\u30AD\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u306B","\u306E"]],pure:!0,fn:function(t,e){e.__setSysVar("DOM\u30B9\u30AD\u30F3",t)},return_none:!0},DOM\u90E8\u54C1\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("DOM\u89AA\u8981\u7D20"),r=typeof t=="string"?document.createElement(t):t;r.id="nadesi-dom-"+e.__getSysVar("DOM\u90E8\u54C1\u500B\u6570"),e.__addPropMethod(r);let o=e.__getSysVar("DOM\u30B9\u30AD\u30F3\u8F9E\u66F8")[e.__getSysVar("DOM\u30B9\u30AD\u30F3")];return typeof o=="function"&&o(t,r,e),n.appendChild(r),e.__setSysVar("DOM\u90E8\u54C1\u500B\u6570",e.__getSysVar("DOM\u90E8\u54C1\u500B\u6570",0)+1),e.__getSysVar("DOM\u90E8\u54C1\u30AA\u30D7\u30B7\u30E7\u30F3").\u81EA\u52D5\u6539\u884C&&n.appendChild(document.createElement("br")),e.__setSysVar("\u305D",r),r}},DOM\u90E8\u54C1\u524A\u9664:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){typeof t=="string"&&(t=document.querySelector(t)),t&&t.parentNode.removeChild(t)},return_none:!0},\u30DC\u30BF\u30F3\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["button",e]);return n.innerHTML=t,n}},\u30A8\u30C7\u30A3\u30BF\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",e]);return n.type="text",n.value=t,n}},\u30C6\u30AD\u30B9\u30C8\u30A8\u30EA\u30A2\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["textarea",e]);return n.value=t,n}},\u30E9\u30D9\u30EB\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["span",e]);return n.innerHTML=t,n}},\u30AD\u30E3\u30F3\u30D0\u30B9\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["canvas",e]);return n.width=t[0],n.height=t[1],n.style.width=t[0],n.style.height=t[1],e.__exec("\u63CF\u753B\u958B\u59CB",[n,e]),n}},\u753B\u50CF\u4F5C\u6210:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["img",e]);return n.src=t,n}},\u6539\u884C\u4F5C\u6210:{type:"func",josi:[],pure:!0,fn:function(t){return t.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["br",t])}},\u30C1\u30A7\u30C3\u30AF\u30DC\u30C3\u30AF\u30B9\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=document.createElement("span"),r=document.createElement("input");r.type="checkbox",r.id="nadesi-dom-"+e.__getSysVar("DOM\u90E8\u54C1\u500B\u6570",0),e.__setSysVar("DOM\u90E8\u54C1\u500B\u6570",e.__getSysVar("DOM\u90E8\u54C1\u500B\u6570",0)+1);let o=document.createElement("label");return o.innerHTML=t,o.htmlFor=r.id,n.appendChild(r),n.appendChild(o),e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",[n,e]),r}},\u30BB\u30EC\u30AF\u30C8\u30DC\u30C3\u30AF\u30B9\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=document.createElement("select");for(let r=0;r<t.length;r++){let o=document.createElement("option");o.value=t[r],o.appendChild(document.createTextNode(t[r])),n.appendChild(o)}return e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",[n,e]),n}},\u30BB\u30EC\u30AF\u30C8\u30DC\u30C3\u30AF\u30B9\u30A2\u30A4\u30C6\u30E0\u8A2D\u5B9A:{type:"func",josi:[["\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e){typeof e=="string"&&(e=document.querySelector(e)),e.options.length=0;for(let n=0;n<t.length;n++){let r=document.createElement("option");r.value=t[n],r.appendChild(document.createTextNode(t[n])),e.appendChild(r)}},return_none:!0},\u8272\u9078\u629E\u30DC\u30C3\u30AF\u30B9\u4F5C\u6210:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",t]);return e.type="color",e}},\u65E5\u4ED8\u9078\u629E\u30DC\u30C3\u30AF\u30B9\u4F5C\u6210:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",t]);return e.type="date",e}},\u30D1\u30B9\u30EF\u30FC\u30C9\u5165\u529B\u30A8\u30C7\u30A3\u30BF\u4F5C\u6210:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",e]);return n.type="password",n.value=t,n}},\u5024\u6307\u5B9A\u30D0\u30FC\u4F5C\u6210:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t,e){(!(t instanceof Array)||t.length<2)&&(t=[0,100,50]),t.length<=2&&t.push(Math.floor((t[1]-t[0])/2));let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",e]);return n.type="range",n.min=t[0],n.max=t[1],n.value=t[2],n}},\u9001\u4FE1\u30DC\u30BF\u30F3\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["input",e]);return n.type="submit",n.value=t,n}},\u30D5\u30A9\u30FC\u30E0\u4F5C\u6210:{type:"func",josi:[["\u3067","\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=n.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["form",n]);if(t instanceof Object)for(let u in t)r[u]&&(r[u]=t[u]);let o=document.createElement("table"),s;typeof e=="string"?s=e.split(`
`):s=e;for(let u in s){let i=s[u],c;for(typeof i=="string"?c=i.split("="):c=i;c.length<4;)c.push("");let a=c[0],f=c[1],l=c[2],p=c[3],h=!1;if(a===""&&f==="")continue;let _=document.createElement("th"),g=document.createElement("label");g.innerHTML=n.__tohtmlQ(a),_.appendChild(g);let b=document.createElement("td");if(f.substring(0,2)==="?("){let m=(f.substring(2)+")").split(")"),k=m[0],A=m[1],N=k.split("|"),D=document.createElement("select");D.name=a;for(let ge of N){let te=document.createElement("option");te.value=ge,te.text=ge,D.appendChild(te)}let ue=N.indexOf(A);ue>=0&&(D.selectedIndex=ue),b.appendChild(D)}else{let d=document.createElement("input");b.appendChild(d);let m=document.createElement("label");b.appendChild(m),d.id="nako3form_"+a,g.htmlFor=d.id,f==="?text"?(d.type="text",d.value=l,d.placeholder=p,d.name=a):f==="?password"?(d.type="password",d.value=l,d.placeholder=p,d.name=a):f==="?number"?(d.type="number",d.value=l,d.placeholder=p,d.name=a):f==="?email"?(d.type="email",d.value=l,d.placeholder=p,d.name=a):f==="?tel"?(d.type="tel",d.value=l,d.placeholder=p,d.name=a):f==="?file"?(d.type="file",d.name=a):f==="?date"?(d.type="date",d.value=l.replace(/\//g,"-"),d.name=a):f==="?month"?(d.type="month",d.value=l.replace(/\//g,"-"),d.name=a):f==="?time"?(d.type="time",d.value=l,d.name=a):f==="?color"?(d.type="color",d.value=l,d.name=a):f==="?hidden"?(d.type="hidden",d.value=l,d.name=a,h=!0,r.appendChild(d)):f==="?checkbox"?(d.type="checkbox",d.value=l,d.name=a,m.innerHTML=" "+n.__tohtmlQ(p),m.htmlFor=d.id):f==="?\u9001\u4FE1"||f==="?submit"?(d.type="submit",d.value=f.substring(1),a!==""&&(d.name=a)):f.substring(0,3)==="?c#"?(d.type="color",d.value=f.substring(2),d.name=a):(d.type="text",d.value=f,d.name=a)}if(h)continue;let w=document.createElement("tr");w.appendChild(_),w.appendChild(b),o.appendChild(w)}return r.appendChild(o),r}},\u30D5\u30A9\u30FC\u30E0\u5165\u529B\u4E00\u62EC\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t){typeof t=="string"&&(t=document.querySelector(t));let e={},n=r=>{if(!(!r||!r.childNodes))for(let o=0;o<r.childNodes.length;o++){let s=r.childNodes[o];if(!s.tagName)return;let u=s.tagName.toLowerCase();if(u==="input"){if(s.type==="checkbox"){e[s.name]=s.checked?s.value:"";continue}e[s.name]=s.value;continue}else u==="textarea"?e[s.name]=s.value:u==="select"&&(s.selectedIndex>=0?e[s.name]=s.options[s.selectedIndex].value:e[s.name]="");n(s)}};return n(t),e}},\u30C6\u30FC\u30D6\u30EB\u4F5C\u6210:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["table",e]);return e.__exec("\u30C6\u30FC\u30D6\u30EB\u66F4\u65B0",[n,t,e])}},\u30D8\u30C3\u30C0\u7121\u30C6\u30FC\u30D6\u30EB\u4F5C\u6210:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("DOM\u90E8\u54C1\u30AA\u30D7\u30B7\u30E7\u30F3");n.\u30C6\u30FC\u30D6\u30EB\u30D8\u30C3\u30C0=!1;let r=e.__exec("\u30C6\u30FC\u30D6\u30EB\u4F5C\u6210",[t,e]);return n.\u30C6\u30FC\u30D6\u30EB\u30D8\u30C3\u30C0=!0,r}},\u30C6\u30FC\u30D6\u30EB\u66F4\u65B0:{type:"func",josi:[["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){if(typeof t=="string"&&(t=n.__query(t,"\u30C6\u30FC\u30D6\u30EB\u66F4\u65B0",!1)),t.innerHTML="",typeof e=="string"){let a=[],f=e.split(`
`);for(let l of f)a.push(l.split(","));e=a}let r=n.__getSysVar("DOM\u90E8\u54C1\u30AA\u30D7\u30B7\u30E7\u30F3"),o=JSON.parse(JSON.stringify(r.\u30C6\u30FC\u30D6\u30EB\u80CC\u666F\u8272)),s=r.\u30C6\u30FC\u30D6\u30EB\u30D8\u30C3\u30C0,u=r.\u30C6\u30FC\u30D6\u30EB\u6570\u5024\u53F3\u5BC4\u305B;for(let a=0;a<3;a++)o.push("");let i=o.shift()||"",c=t;for(let a=0;a<e.length;a++){let f=a,l=e[f],p=document.createElement("tr");if(i!==""){let h=s?f:f+1;p.style.backgroundColor=h===0?i:o[h%2],p.style.color=h===0?"white":"black"}for(let h of l){h=""+h;let _=document.createElement(f===0&&s?"th":"td");_.innerHTML=n.__tohtml(h),u&&h.match(/^(\+|-)?\d+(\.\d+)?$/)&&(_.style.textAlign="right"),p.appendChild(_)}c.appendChild(p)}return c}},\u30C6\u30FC\u30D6\u30EB\u30BB\u30EB\u5909\u66F4:{type:"func",josi:[["\u306E"],["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n,r){if(typeof t=="string"&&(t=document.querySelector(t)),typeof e=="string"&&(e=e.split(",")),e.length!==2)throw new Error("\u300E\u30C6\u30FC\u30D6\u30EB\u30BB\u30EB\u5909\u66F4\u300F\u306E\u5F15\u6570\u300C\u3092\u300D\u306F[\u884C,\u5217]\u306E\u5F62\u5F0F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002");let o=e[0],s=e[1];n instanceof Array||(n=[[n]]);let u=r.__getSysVar("DOM\u90E8\u54C1\u30AA\u30D7\u30B7\u30E7\u30F3"),i=JSON.parse(JSON.stringify(u.\u30C6\u30FC\u30D6\u30EB\u80CC\u666F\u8272)),c=u.\u30C6\u30FC\u30D6\u30EB\u6570\u5024\u53F3\u5BC4\u305B;for(;i.length<3;)i.push("white");for(let a=0;a<n.length;a++){let f=n[a];for(let l=0;l<f.length;l++){let p=o+a,h=t.childNodes[p];for(;!h;){let b=document.createElement("tr");t.appendChild(b),h=t.childNodes[p],h.style.backgroundColor=i[p%2+1]}let _=h.childNodes[s+l];for(;!_;){let b=document.createElement("td");h.appendChild(b),_=h.childNodes[s+l]}let g=String(f[l]);_.innerHTML=r.__tohtml(g),c&&g.match(/^(\+|-)?\d+(\.\d+)?$/)&&(_.style.textAlign="right")}}},return_none:!0},\u30DE\u30FC\u30E1\u30A4\u30C9\u4F5C\u6210:{type:"func",josi:[["\u306E"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__exec("DOM\u90E8\u54C1\u4F5C\u6210",["div",e]);n.classList.add("mermaid"),n.innerHTML=t;let r=e.__getSysVar("WINDOW");return typeof r.mermaid>"u"&&(console.log("try to load mermaid"),await e.__loadScript("https://cdn.jsdelivr.net/npm/mermaid@10.5.0/dist/mermaid.min.js"),console.log("mermaid.js\u3092\u8AAD\u307F\u8FBC\u307F\u307E\u3057\u305F")),await r.mermaid.run(),n}}};var fn={HTML\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u8A2D\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,asyncFn:!0,fn:async function(t){if(navigator.clipboard){await navigator.clipboard.writeText(t);return}let e=document.createElement("div"),n=document.createElement("pre");n.style.webkitUserSelect="auto",n.style.userSelect="auto",e.appendChild(n).textContent=t,e.style.position="fixed",e.right="200%",document.body.appendChild(e),document.getSelection().selectAllChildren(e),document.execCommand("copy"),document.body.removeChild(e)},return_none:!0},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(navigator.clipboard)typeof t=="string"&&(t=e.__findFunc(t,"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97\u6642")),navigator.clipboard.readText().then(r=>{e.__setSysVar("\u5BFE\u8C61",r),t(e)});else throw new Error("Clipbard API\u304C\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!0,fn:async function(t){if(navigator.clipboard)return await navigator.clipboard.readText();throw new Error("Clipbard API\u304C\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}}};var ln={\u4FDD\u5B58:{type:"func",josi:[["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){n.__exec("\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u4FDD\u5B58",[t,e,n])},return_none:!0},\u958B:{type:"func",josi:[["\u3092","\u304B\u3089","\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u8AAD",[t,e])},return_none:!1},\u8AAD:{type:"func",josi:[["\u3092","\u304B\u3089","\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u8AAD",[t,e])},return_none:!1},\u5B58\u5728:{type:"func",josi:[["\u304C"]],pure:!0,fn:function(t){return window.localStorage.getItem(t)!==null},return_none:!1},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u4FDD\u5B58:{type:"func",josi:[["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){let r=t;n.__getSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3")&&(n.__getSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3").indexOf("json")>=0?r=JSON.stringify(r):n.__getSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3")),window.localStorage[e]=r},return_none:!0},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u8AAD:{type:"func",josi:[["\u3092","\u304B\u3089","\u306E"]],pure:!0,fn:function(t,e){let n=window.localStorage[t];if(e.__getSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3")&&e.__getSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3").indexOf("json")>=0)try{return JSON.parse(n)}catch{console.log("\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u300E"+t+"\u300F\u306E\u8AAD\u307F\u8FBC\u307F\u306B\u5931\u6557")}return n},return_none:!1},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u30AD\u30FC\u5217\u6319:{type:"func",josi:[],pure:!0,fn:function(t){let e=[];for(let n in window.localStorage)e.push(n);return e},return_none:!1},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u30AD\u30FC\u524A\u9664:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){window.localStorage.removeItem(t)},return_none:!0},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u5168\u524A\u9664:{type:"func",josi:[],pure:!0,fn:function(){window.localStorage.clear()},return_none:!0},\u30ED\u30FC\u30AB\u30EB\u30B9\u30C8\u30EC\u30FC\u30B8\u6709\u52B9\u78BA\u8A8D:{type:"func",josi:[],pure:!0,fn:function(){return typeof window.localStorage<"u"},return_none:!1},\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3:{type:"const",value:"json"},\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){t=t.toUpperCase(t),e.__setSysVar("\u4FDD\u5B58\u30AA\u30D7\u30B7\u30E7\u30F3",t)},return_none:!0}};var F="\u63CF\u753B\u3092\u884C\u3046\u305F\u3081\u306B\u306F\u3001HTML\u5185\u306Bcanvas\u3092\u914D\u7F6E\u3057\u3001id\u3092\u632F\u3063\u3066\u300E\u63CF\u753B\u958B\u59CB\u300F\u547D\u4EE4\u306B\u6307\u5B9A\u3057\u307E\u3059\u3002",pn={\u63CF\u753B\u958B\u59CB:{type:"func",josi:[["\u306E","\u3078","\u3067"]],pure:!0,fn:function(t,e){if(typeof t=="string"&&(t=document.querySelector(t)||document.getElementById(t)),!t)throw new Error("\u300E\u63CF\u753B\u958B\u59CB\u300F\u3067Canvas\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002");e.__addPropMethod(t),e.__canvas=t,e.__ctx=t.getContext("2d"),e.__fillStyle="black",e.__strokeStyle="black",e.__setSysVar("\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9",t),e.__setSysVar("\u63CF\u753B\u4E2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8",e.__ctx)},return_none:!0},\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9:{type:"const",value:null},\u63CF\u753B\u4E2D\u30B3\u30F3\u30C6\u30AD\u30B9\u30C8:{type:"const",value:null},\u30AD\u30E3\u30F3\u30D0\u30B9\u72B6\u614B\u4FDD\u5B58:{type:"func",josi:[],pure:!0,fn:function(t){if(!t.__ctx)throw new Error(F);t.__ctx.save()},return_none:!0},\u30AD\u30E3\u30F3\u30D0\u30B9\u72B6\u614B\u5FA9\u5143:{type:"func",josi:[],pure:!0,fn:function(t){if(!t.__ctx)throw new Error(F);t.__ctx.restore()},return_none:!0},\u7DDA\u8272\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__strokeStyle=t,t!==""&&(e.__ctx.strokeStyle=t)},return_none:!0},\u5857\u8272\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__fillStyle=t,t!==""&&(e.__ctx.fillStyle=t)},return_none:!0},\u7DDA\u63CF\u753B:{type:"func",josi:[["\u304B\u3089"],["\u3078","\u307E\u3067"]],pure:!0,fn:function(t,e,n){if(!n.__ctx)throw new Error(F);n.__ctx.beginPath(),n.__ctx.moveTo(t[0],t[1]),n.__ctx.lineTo(e[0],e[1]),n.__ctx.stroke()},return_none:!0},\u7DDA\u592A\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.lineWidth=t},return_none:!0},\u56DB\u89D2\u63CF\u753B:{type:"func",josi:[["\u306E","\u3078","\u306B"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__fillStyle===""&&e.__strokeStyle===""||(e.__ctx.beginPath(),e.__ctx.rect(t[0],t[1],t[2],t[3]),e.__fillStyle!==""&&e.__ctx.fill(),e.__strokeStyle!==""&&e.__ctx.stroke())},return_none:!0},\u5168\u63CF\u753B\u30AF\u30EA\u30A2:{type:"func",josi:[],pure:!0,fn:function(t){if(!t.__ctx)throw new Error(F);t.__ctx.clearRect(0,0,t.__canvas.width,t.__canvas.height)},return_none:!0},\u63CF\u753B\u30AF\u30EA\u30A2:{type:"func",josi:[["\u306E","\u3078","\u306B"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);t instanceof Array||(t=[]),t.length===0?t=[0,0,e.__canvas.width,e.__canvas.height]:t.length<=2&&(t.unshift(0),t.unshift(0)),e.__ctx.clearRect(t[0],t[1],t[2],t[3])},return_none:!0},\u5186\u63CF\u753B:{type:"func",josi:[["\u3078","\u306B"],["\u306E"]],pure:!0,fn:function(t,e,n){if(!n.__ctx)throw new Error(F);n.__fillStyle===""&&n.__strokeStyle===""||(n.__ctx.beginPath(),n.__ctx.arc(t[0],t[1],e,0,2*Math.PI,!1),n.__fillStyle!==""&&n.__ctx.fill(),n.__strokeStyle!==""&&n.__ctx.stroke())},return_none:!0},\u6955\u5186\u63CF\u753B:{type:"func",josi:[["\u3078","\u306B","\u306E"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);if(!t)throw new Error("\u6955\u5186\u63CF\u753B\u306E\u5F15\u6570\u914D\u5217\u304C\u7121\u52B9\u3067\u3059");if(t.length<4)throw new Error("\u6955\u5186\u63CF\u753B\u306E\u5F15\u6570\u914D\u5217\u304C\u4E0D\u8DB3\u3057\u3066\u3044\u307E\u3059");t.length<7&&(t[4]||(t[4]=0),t[5]||(t[5]=0),t[6]||(t[6]=Math.PI*2),t[7]||(t[7]=!0)),!(e.__fillStyle===""&&e.__strokeStyle==="")&&(e.__ctx.beginPath(),e.__ctx.ellipse(...t),e.__fillStyle!==""&&e.__ctx.fill(),e.__strokeStyle!==""&&e.__ctx.stroke())},return_none:!0},\u591A\u89D2\u5F62\u63CF\u753B:{type:"func",josi:[["\u3067","\u306E","\u3092"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);if(e.__fillStyle===""&&e.__strokeStyle==="")return;e.__ctx.beginPath();let n=t[0];e.__ctx.moveTo(n[0],n[1]);for(let r=1;r<t.length;r++){let o=t[r];e.__ctx.lineTo(o[0],o[1])}e.__ctx.lineTo(n[0],n[1]),e.__fillStyle!==""&&e.__ctx.fill(),e.__strokeStyle!==""&&e.__ctx.stroke()},return_none:!0},\u753B\u50CF\u8AAD:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=new window.Image;return n.src=t,n.crossOrigin="Anonymous",n}},\u753B\u50CF\u8AAD\u5F85:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,asyncFn:!0,fn:function(t){return new Promise((e,n)=>{let r=new window.Image;r.src=t,r.crossOrigin="Anonymous",r.onload=()=>{e(r)},r.onerror=()=>{n(new Error(`\u300E\u753B\u50CF\u8AAD\u5F85\u300F\u3067\u8AAD\u8FBC\u307F\u30A8\u30E9\u30FC\u3002URL=\u300E${t}\u300F`))}})}},\u753B\u50CF\u9010\u6B21\u8AAD:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(e.resolve===void 0)throw new Error("\u300E\u753B\u50CF\u9010\u6B21\u8AAD\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u3067\u4F7F\u3063\u3066\u304F\u3060\u3055\u3044\u3002");e.resolveCount++;let n=new window.Image;return n.src=t,n.crossOrigin="Anonymous",n.onload=()=>{e.__setSysVar("\u5BFE\u8C61",n),e.resolve()},n.onerror=()=>{e.__setSysVar("\u5BFE\u8C61",""),e.reject()},n}},\u753B\u50CF\u8AAD\u6642:{type:"func",josi:[["\u3067"],["\u306E","\u3092"]],pure:!0,fn:function(t,e,n){let r=n.__findVar(t,null),o=new window.Image;o.src=e,o.crossOrigin="Anonymous",o.onload=()=>{n.__setSysVar("\u5BFE\u8C61",o),r(n)},o.onerror=()=>{n.__setSysVar("\u5BFE\u8C61",""),r(n)}},return_none:!0},\u753B\u50CF\u63CF\u753B:{type:"func",josi:[["\u306E","\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n){if(!n.__ctx)throw new Error(F);let r=(o,s)=>{if(e.length===2)s.drawImage(o,e[0],e[1]);else if(e.length===4)s.drawImage(o,e[0],e[1],e[2],e[3]);else if(e.length===8)s.drawImage(o,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);else throw new Error("\u300E\u753B\u50CF\u63CF\u753B\u300F\u306E\u7B2C\u4E8C\u5F15\u6570\u306E\u914D\u5217\u8981\u7D20\u306F2,4,8\u500B\u306E\u3044\u305A\u308C\u304B\u3067\u3059\u3002")};if(typeof t=="string"){let o=new window.Image;return o.src=t,o.crossOrigin="Anonymous",o.onload=()=>{r(o,n.__ctx)},o}else return r(t,n.__ctx),t},return_none:!1},\u753B\u50CF\u90E8\u5206\u63CF\u753B:{type:"func",josi:[["\u306E"],["\u3092","\u304B\u3089"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n,r){let o="\u300E\u753B\u50CF\u90E8\u5206\u63CF\u753B\u300F\u306B\u4F7F\u3048\u308B\u5F15\u6570\u306F\u753B\u50CF\u3068\u3001\u63CF\u753B\u3059\u308B\u5EA7\u6A19\u30782\u3064\u304B\u3001\u63CF\u753B\u3059\u308B\u5EA7\u6A19\u3068\u305D\u306E\u4F4D\u7F6E\u306E4\u3064\u304B\u3001\u4F7F\u7528\u3059\u308B\u5EA7\u6A19\u3068\u4F7F\u7528\u3059\u308B\u4F4D\u7F6E\u3068\u63CF\u753B\u3059\u308B\u5EA7\u6A19\u3068\u5927\u304D\u3055\u306E8\u3064\u3060\u3051\u3067\u3059\u3002";if(t&&e&&!Array.isArray(e)&&Array.isArray(t)&&(typeof e=="string"||String(e.__proto__)==="[object HTMLImageElement]")){let u=t;t=e,e=u}if(!r.__ctx)throw new Error(F);let s=(u,i)=>{if(n||(e?e.length>=2&&(n=e,e=void 0):i.drawImage(u)),n.length===2)i.drawImage(u,n[0],n[1]);else if(n.length===4)if(!e)i.drawImage(u,n[0],n[1],n[2],n[3]);else if(e.length===4)i.drawImage(u,e[0],e[1],e[2],e[3],n[0],n[1],n[2],n[3]);else throw new Error(o);else throw new Error(o)};if(typeof t=="string"){let u=new window.Image;return u.src=t,u.crossOrigin="Anonymous",u.onload=()=>{s(u,r.__ctx)},u}else return s(t,r.__ctx),t},return_none:!1},\u63CF\u753B\u30D5\u30A9\u30F3\u30C8\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u306E","\u3067","\u306B"]],pure:!0,fn:function(t,e){typeof t=="number"&&(t=t+"px sans-serif"),/^[0-9]+(px|em)$/.test(t)&&(t=t+" sans-serif"),e.__ctx.font=t},return_none:!0},\u6587\u5B57\u63CF\u753B:{type:"func",josi:[["\u3078","\u306B"],["\u306E","\u3092"]],pure:!0,fn:function(t,e,n){if(!n.__ctx)throw new Error(F);n.__ctx.fillText(e,t[0],t[1])},return_none:!0},\u6587\u5B57\u63CF\u753B\u5E45\u53D6\u5F97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);return e.__ctx.measureText(t)},return_none:!1},\u63CF\u753B\u8D77\u70B9\u8A2D\u5B9A:{type:"func",josi:[["\u3078","\u306B"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.translate(t[0],t[1])},return_none:!0},\u63CF\u753B\u56DE\u8EE2:{type:"func",josi:[["\u3060\u3051","\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.rotate(t*Math.PI/180)},return_none:!0},\u63CF\u753B\u62E1\u5927:{type:"func",josi:[["\u3060\u3051","\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.scale(t[0],t[1])},return_none:!0},\u63CF\u753B\u5909\u63DB\u30DE\u30C8\u30EA\u30AF\u30B9\u8A2D\u5B9A:{type:"func",josi:[["\u3060\u3051","\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.setTransform(t[0],t[1],t[2],t[3],t[4],t[5],t[6])},return_none:!0},\u63CF\u753B\u5909\u63DB\u30DE\u30C8\u30EA\u30AF\u30B9\u8FFD\u52A0:{type:"func",josi:[["\u3060\u3051","\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!e.__ctx)throw new Error(F);e.__ctx.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6])},return_none:!0},\u63CF\u753B\u30C7\u30FC\u30BFURL\u5909\u63DB:{type:"func",josi:[],pure:!0,fn:function(t){return t.__getSysVar("\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9").toDataURL("image/png")}},\u63CF\u753B\u30C7\u30FC\u30BFBLOB\u5909\u63DB:{type:"func",josi:[],pure:!0,asyncFn:!0,fn:function(t){return new Promise((e,n)=>{t.__getSysVar("\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9").toBlob(o=>{e(o)},"image/png")})}},\u63CF\u753B\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u30EA\u30F3\u30AF\u4F5C\u6210:{type:"func",josi:[["\u3078","\u306B"]],pure:!0,fn:function(t,e){if(typeof t=="string"&&(t=document.querySelector(t)),!t)throw new Error("\u300E\u63CF\u753B\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u30EA\u30F3\u30AF\u4F5C\u6210\u300F\u3067DOM\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002");let n=e.__getSysVar("\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9");if(!n)throw new Error("\u300E\u63CF\u753B\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u300F\u3067\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002");t.href=n.toDataURL("image/png"),t.download="canvas.png"},return_none:!0},\u63CF\u753B\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__getSysVar("\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9");if(!e)throw new Error("\u300E\u63CF\u753B\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u300F\u3067\u63CF\u753B\u4E2D\u30AD\u30E3\u30F3\u30D0\u30B9\u304C\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002");let n=document.createElement("a");return n.href=e.toDataURL("image/png"),n.download="canvas.png",n.click(),!0}}};var hn={\u4F4D\u7F6E\u60C5\u5831\u53D6\u5F97\u6642:{type:"func",josi:[["\u306E","\u306B","\u3078"]],pure:!0,fn:function(t,e){let n=t;if(typeof n=="string"&&(n=e.__findVar(n)),!("geolocation"in navigator))throw new Error("\u95A2\u6570\u300E\u4F4D\u7F6E\u60C5\u5831\u53D6\u5F97\u6642\u300F\u306F\u4F7F\u3048\u307E\u305B\u3093\u3002");navigator.geolocation.getCurrentPosition(r=>{e.__setSysVar("\u5BFE\u8C61",[r.coords.latitude,r.coords.longitude]),n(r)})},return_none:!0},\u4F4D\u7F6E\u60C5\u5831\u76E3\u8996\u6642:{type:"func",josi:[["\u306E","\u306B","\u3078"]],pure:!0,fn:function(t,e){let n=t;if(typeof n=="string"&&(n=e.__findVar(n)),!("geolocation"in navigator))throw new Error("\u95A2\u6570\u300E\u4F4D\u7F6E\u60C5\u5831\u76E3\u8996\u6642\u300F\u306F\u4F7F\u3048\u307E\u305B\u3093\u3002");return navigator.geolocation.watchPosition(r=>{e.__setSysVar("\u5BFE\u8C61",[r.coords.latitude,r.coords.longitude]),n(r)})},return_none:!1},\u4F4D\u7F6E\u60C5\u5831\u76E3\u8996\u505C\u6B62:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){navigator.geolocation.clearWatch(t)},return_none:!0}};var dn={\u8A71:{type:"func",josi:[["\u3068","\u3092","\u306E"]],pure:!0,fn:function(t,e){let n=e.__exec("\u97F3\u58F0\u5408\u6210\u767A\u8A71\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97",[t,e]);return window.speechSynthesis.speak(n),console.log("#\u8A71\u3059:",t),t}},\u8A71\u7D42:{type:"func",josi:[["\u3068","\u3092","\u306E"]],pure:!0,asyncFn:!0,fn:function(t,e){return new Promise((n,r)=>{try{let o=e.__exec("\u97F3\u58F0\u5408\u6210\u767A\u8A71\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97",[t,e]);o.onend=()=>{n()},window.speechSynthesis.speak(o),console.log("#\u8A71\u3059:",t)}catch(o){r(o)}})}},\u8A71\u7D42\u6642:{type:"func",josi:[["\u3067"],["\u3068","\u3092","\u306E"]],pure:!0,fn:function(t,e,n){let r=n.__exec("\u97F3\u58F0\u5408\u6210\u767A\u8A71\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97",[e,n]);return r.onend=o=>{console.log("#\u8A71\u7D42\u6642"),n.__setSysVar("\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8",o),t(n)},window.speechSynthesis.speak(r),console.log("#\u8A71\u3059:",e),e}},\u97F3\u58F0\u5408\u6210\u767A\u8A71\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("\u8A71:\u8A71\u8005");n||(n=e.__exec("\u8A71\u8005\u8A2D\u5B9A",["ja",e]));let r=new SpeechSynthesisUtterance(t);return r.voice=n,n&&(r.lang=n.lang),r.rate=e.__getSysVar("\u8A71\u8005\u901F\u5EA6"),r.pitch=e.__getSysVar("\u8A71\u8005\u58F0\u9AD8"),r.volume=e.__getSysVar("\u8A71\u8005\u97F3\u91CF"),r}},\u8A71\u8005\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){if(!("SpeechSynthesisUtterance"in window))throw new Error("\u97F3\u58F0\u5408\u6210API\u306B\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093");return window.speechSynthesis.getVoices()}},\u8A71\u8005\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){if(!("SpeechSynthesisUtterance"in window))throw new Error("\u97F3\u58F0\u5408\u6210API\u306B\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093");if(typeof t=="string"){let n=window.speechSynthesis.getVoices();for(let r of n)if(r.lang.indexOf(t)>=0||r.name===t){let o=new SpeechSynthesisUtterance;return o.voice=r,o.lang=r.lang,e.__setSysVar("\u8A71:\u8A71\u8005",r),console.log("#\u8A71\u8005:",r.name),r}}if(typeof t=="object")return e.__setSysVar("\u8A71:\u8A71\u8005",t),t}},\u8A71\u8005\u901F\u5EA6:{type:"const",value:1},\u8A71\u8005\u58F0\u9AD8:{type:"const",value:1},\u8A71\u8005\u97F3\u91CF:{type:"const",value:1},\u8A71\u8005\u8A73\u7D30\u8A2D\u5B9A:{type:"func",josi:[["\u3067","\u306B","\u3078"]],pure:!0,fn:function(t,e){let n=(r,o)=>{r==="\u901F\u5EA6"&&e.__setSysVar("\u8A71\u8005\u901F\u5EA6",o),(r==="\u58F0\u9AD8"||r==="\u30D4\u30C3\u30C1")&&e.__setSysVar("\u8A71\u8005\u58F0\u9AD8",o),r==="\u97F3\u91CF"&&e.__setSysVar("\u8A71\u8005\u97F3\u91CF",o)};for(let r in t){let o=t[r];n(r,o)}}}};var _n={WS\u63A5\u7D9A\u5B8C\u4E86\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONOPEN",t)},return_none:!0},WS\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONMESSAGE",t)},return_none:!0},WS\u30A8\u30E9\u30FC\u767A\u751F\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONERROR",t)},return_none:!0},WS\u63A5\u7D9A:{type:"func",josi:[["\u306B","\u3078","\u306E"]],pure:!0,fn:function(t,e){let n=new WebSocket(t);return n.onopen=()=>{let r=e.__getSysVar("WS:ONOPEN");r&&r(e)},n.onerror=r=>{let o=e.__getSysVar("WS:ONERROR");o&&o(r,e),console.log("WS\u30A8\u30E9\u30FC",r)},n.onmessage=r=>{e.__setSysVar("\u5BFE\u8C61",r.data);let o=e.__getSysVar("WS:ONMESSAGE");o&&o(e)},e.__setSysVar("WS:SOCKET",n),n}},WS\u9001\u4FE1:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__getSysVar("WS:SOCKET").send(t)}},WS\u5207\u65AD:{type:"func",josi:[],pure:!0,fn:function(t){t.__getSysVar("WS:SOCKET").close()}}};var yn={\u30AA\u30FC\u30C7\u30A3\u30AA\u958B:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t,e){let n=new Audio;return n.src=t,n},return_none:!1},\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.loop=!1,t.play()},return_none:!0},\u30AA\u30FC\u30C7\u30A3\u30AA\u30EB\u30FC\u30D7\u518D\u751F:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.loop=!0,t.play()},return_none:!0},\u30AA\u30FC\u30C7\u30A3\u30AA\u505C\u6B62:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u505C\u6B62\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.pause(),t.currentTime=0,setTimeout(()=>{t.currentTime=0},10)},return_none:!0},\u30AA\u30FC\u30C7\u30A3\u30AA\u4E00\u6642\u505C\u6B62:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u4E00\u6642\u505C\u6B62\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.pause()},return_none:!0},\u30AA\u30FC\u30C7\u30A3\u30AA\u97F3\u91CF\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u9577\u53D6\u5F97\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");return t.volume}},\u30AA\u30FC\u30C7\u30A3\u30AA\u97F3\u91CF\u8A2D\u5B9A:{type:"func",josi:[["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u9577\u53D6\u5F97\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.volume=e},return_none:!0},\u30AA\u30FC\u30C7\u30A3\u30AA\u9577\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u9577\u53D6\u5F97\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");return t.duration}},\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F\u4F4D\u7F6E\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F\u4F4D\u7F6E\u53D6\u5F97\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");return t.currentTime}},\u30AA\u30FC\u30C7\u30A3\u30AA\u518D\u751F\u4F4D\u7F6E\u8A2D\u5B9A:{type:"func",josi:[["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){if(!t)throw new Error("\u30AA\u30FC\u30C7\u30A3\u30AA\u505C\u6B62\u3059\u308B\u524D\u306B\u3001\u30AA\u30FC\u30C7\u30A3\u30AA\u958B\u304F\u3067\u97F3\u58F0\u30D5\u30A1\u30A4\u30EB\u3092\u8AAD\u307F\u8FBC\u3093\u3067\u304F\u3060\u3055\u3044");t.currentTime=e},return_none:!0}};var mt=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function bt(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on".concat(e),n)}function je(t,e,n,r){t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on".concat(e),n)}function bn(t,e){let n=e.slice(0,e.length-1);for(let r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function wn(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");let e=t.split(","),n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function xr(t,e){let n=t.length>=e.length?t:e,r=t.length>=e.length?e:t,o=!0;for(let s=0;s<n.length;s++)r.indexOf(n[s])===-1&&(o=!1);return o}var Oe={backspace:8,"\u232B":8,tab:9,clear:12,enter:13,"\u21A9":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"\u21EA":20,",":188,".":190,"/":191,"`":192,"-":mt?173:189,"=":mt?61:187,";":mt?59:186,"'":222,"[":219,"]":221,"\\":220},z={"\u21E7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,cmd:91,command:91},ze={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},V={16:!1,18:!1,17:!1,91:!1},E={};for(let t=1;t<20;t++)Oe["f".concat(t)]=111+t;var $=[],xe=null,kn="all",ee=new Map,Ae=t=>Oe[t.toLowerCase()]||z[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),Or=t=>Object.keys(Oe).find(e=>Oe[e]===t),$r=t=>Object.keys(z).find(e=>z[e]===t);function vn(t){kn=t||"all"}function $e(){return kn||"all"}function Ar(){return $.slice(0)}function Mr(){return $.map(t=>Or(t)||$r(t)||String.fromCharCode(t))}function Er(){let t=[];return Object.keys(E).forEach(e=>{E[e].forEach(n=>{let{key:r,scope:o,mods:s,shortcut:u}=n;t.push({scope:o,shortcut:u,mods:s,keys:r.split("+").map(i=>Ae(i))})})}),t}function Nr(t){let e=t.target||t.srcElement,{tagName:n}=e,r=!0,o=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(o||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(r=!1),r}function Fr(t){return typeof t=="string"&&(t=Ae(t)),$.indexOf(t)!==-1}function Tr(t,e){let n,r;t||(t=$e());for(let o in E)if(Object.prototype.hasOwnProperty.call(E,o))for(n=E[o],r=0;r<n.length;)n[r].scope===t?n.splice(r,1).forEach(u=>{let{element:i}=u;return kt(i)}):r++;$e()===t&&vn(e||"all")}function Cr(t){let e=t.keyCode||t.which||t.charCode,n=$.indexOf(e);if(n>=0&&$.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&$.splice(0,$.length),(e===93||e===224)&&(e=91),e in V){V[e]=!1;for(let r in z)z[r]===e&&(H[r]=!1)}}function Sn(t){if(typeof t>"u")Object.keys(E).forEach(o=>{Array.isArray(E[o])&&E[o].forEach(s=>We(s)),delete E[o]}),kt(null);else if(Array.isArray(t))t.forEach(o=>{o.key&&We(o)});else if(typeof t=="object")t.key&&We(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];let[o,s]=n;typeof o=="function"&&(s=o,o=""),We({key:t,scope:o,method:s,splitKey:"+"})}}var We=t=>{let{key:e,scope:n,method:r,splitKey:o="+"}=t;wn(e).forEach(u=>{let i=u.split(o),c=i.length,a=i[c-1],f=a==="*"?"*":Ae(a);if(!E[f])return;n||(n=$e());let l=c>1?bn(z,i):[],p=[];E[f]=E[f].filter(h=>{let g=(r?h.method===r:!0)&&h.scope===n&&xr(h.mods,l);return g&&p.push(h.element),!g}),p.forEach(h=>kt(h))})};function gn(t,e,n,r){if(e.element!==r)return;let o;if(e.scope===n||e.scope==="all"){o=e.mods.length>0;for(let s in V)Object.prototype.hasOwnProperty.call(V,s)&&(!V[s]&&e.mods.indexOf(+s)>-1||V[s]&&e.mods.indexOf(+s)===-1)&&(o=!1);(e.mods.length===0&&!V[16]&&!V[18]&&!V[17]&&!V[91]||o||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat($),e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function mn(t,e){let n=E["*"],r=t.keyCode||t.which||t.charCode;if(!H.filter.call(this,t))return;if((r===93||r===224)&&(r=91),$.indexOf(r)===-1&&r!==229&&$.push(r),["metaKey","ctrlKey","altKey","shiftKey"].forEach(i=>{let c=ze[i];t[i]&&$.indexOf(c)===-1?$.push(c):!t[i]&&$.indexOf(c)>-1?$.splice($.indexOf(c),1):i==="metaKey"&&t[i]&&($=$.filter(a=>a in ze||a===r))}),r in V){V[r]=!0;for(let i in z)z[i]===r&&(H[i]=!0);if(!n)return}for(let i in V)Object.prototype.hasOwnProperty.call(V,i)&&(V[i]=t[ze[i]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&($.indexOf(17)===-1&&$.push(17),$.indexOf(18)===-1&&$.push(18),V[17]=!0,V[18]=!0);let o=$e();if(n)for(let i=0;i<n.length;i++)n[i].scope===o&&(t.type==="keydown"&&n[i].keydown||t.type==="keyup"&&n[i].keyup)&&gn(t,n[i],o,e);if(!(r in E))return;let s=E[r],u=s.length;for(let i=0;i<u;i++)if((t.type==="keydown"&&s[i].keydown||t.type==="keyup"&&s[i].keyup)&&s[i].key){let c=s[i],{splitKey:a}=c,f=c.key.split(a),l=[];for(let p=0;p<f.length;p++)l.push(Ae(f[p]));l.sort().join("")===$.sort().join("")&&gn(t,c,o,e)}}function H(t,e,n){$=[];let r=wn(t),o=[],s="all",u=document,i=0,c=!1,a=!0,f="+",l=!1,p=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(s=e.scope),e.element&&(u=e.element),e.keyup&&(c=e.keyup),e.keydown!==void 0&&(a=e.keydown),e.capture!==void 0&&(l=e.capture),typeof e.splitKey=="string"&&(f=e.splitKey),e.single===!0&&(p=!0)),typeof e=="string"&&(s=e),p&&Sn(t,s);i<r.length;i++)t=r[i].split(f),o=[],t.length>1&&(o=bn(z,t)),t=t[t.length-1],t=t==="*"?"*":Ae(t),t in E||(E[t]=[]),E[t].push({keyup:c,keydown:a,scope:s,mods:o,shortcut:r[i],method:n,key:r[i],splitKey:f,element:u});if(typeof u<"u"&&window){if(!ee.has(u)){let h=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return mn(g,u)},_=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;mn(g,u),Cr(g)};ee.set(u,{keydownListener:h,keyupListenr:_,capture:l}),bt(u,"keydown",h,l),bt(u,"keyup",_,l)}if(!xe){let h=()=>{$=[]};xe={listener:h,capture:l},bt(window,"focus",h,l)}}}function Lr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(E).forEach(n=>{E[n].filter(o=>o.scope===e&&o.shortcut===t).forEach(o=>{o&&o.method&&o.method()})})}function kt(t){let e=Object.values(E).flat();if(e.findIndex(r=>{let{element:o}=r;return o===t})<0){let{keydownListener:r,keyupListenr:o,capture:s}=ee.get(t)||{};r&&o&&(je(t,"keyup",o,s),je(t,"keydown",r,s),ee.delete(t))}if((e.length<=0||ee.size<=0)&&(Object.keys(ee).forEach(o=>{let{keydownListener:s,keyupListenr:u,capture:i}=ee.get(o)||{};s&&u&&(je(o,"keyup",u,i),je(o,"keydown",s,i),ee.delete(o))}),ee.clear(),Object.keys(E).forEach(o=>delete E[o]),xe)){let{listener:o,capture:s}=xe;je(window,"focus",o,s),xe=null}}var wt={getPressedKeyString:Mr,setScope:vn,getScope:$e,deleteScope:Tr,getPressedKeyCodes:Ar,getAllKeyCodes:Er,isPressed:Fr,filter:Nr,trigger:Lr,unbind:Sn,keyMap:Oe,modifier:z,modifierMap:ze};for(let t in wt)Object.prototype.hasOwnProperty.call(wt,t)&&(H[t]=wt[t]);if(typeof window<"u"){let t=window.hotkeys;H.noConflict=e=>(e&&window.hotkeys===H&&(window.hotkeys=t),H),window.hotkeys=H}var jn={\u30DB\u30C3\u30C8\u30AD\u30FC\u767B\u9332:{type:"func",josi:[["\u306B","\u3067"],["\u3092"]],pure:!0,fn:function(t,e,n){H(t,function(r,o){r.preventDefault(),n.__findFunc(e)(n)})}},\u30DB\u30C3\u30C8\u30AD\u30FC\u89E3\u9664:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){H.unbind(t)}}};var xn={\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("WINDOW");if(typeof n>"u")throw new Error("\u300E\u30B0\u30E9\u30D5\u63CF\u753B\u300F\u306E\u30A8\u30E9\u30FC\u3002\u30D6\u30E9\u30A6\u30B6\u3067\u5B9F\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002");if(typeof n.Chart>"u"&&(console.log("try to load chart.js"),await e.__loadScript("https://cdn.jsdelivr.net/npm/chart.js@4.4.0"),console.log("loaded chart.js")),typeof n.Chart>"u")throw new Error("\u300E\u30B0\u30E9\u30D5\u63CF\u753B\u300F\u306E\u30A8\u30E9\u30FC\u3002Chart.js\u3092\u53D6\u308A\u8FBC\u307F\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002");let r=n.Chart;if(!e.__canvas)throw new Error("\u300E\u30B0\u30E9\u30D5\u63CF\u753B\u300F\u306E\u30A8\u30E9\u30FC\u3002\u300E\u63CF\u753B\u958B\u59CB\u300F\u547D\u4EE4\u3067\u63CF\u753B\u5148\u306ECanvas\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002 ");t.\u30BF\u30A4\u30D7&&(t.type=t.\u30BF\u30A4\u30D7),t.\u30C7\u30FC\u30BF&&(t.data=t.\u30C7\u30FC\u30BF),t.\u30AA\u30D7\u30B7\u30E7\u30F3&&(t.options=t.\u30AA\u30D7\u30B7\u30E7\u30F3),e.__chartjs&&e.__chartjs.destroy();let o=new r(e.__canvas,t);return e.__chartjs=o,o}},\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3:{type:"const",value:{}},\u7DDA\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["line",t,e]);let n={type:"line",data:t,options:e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3")};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[n,e])}},\u68D2\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){let n=Object.assign({},e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3"),{indexAxis:"x"});t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["bar",t,e]);let r={type:"bar",data:t,options:n};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[r,e])}},\u6A2A\u68D2\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=Object.assign({},e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3"),{indexAxis:"y"});t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["bar",t,e]);let r={type:"bar",data:t,options:n};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[r,e])}},\u7A4D\u4E0A\u68D2\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){let n=Object.assign({},e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3"),{indexAxis:"x",scales:{x:{stacked:!0},y:{stacked:!0}}});t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["bar",t,e]);let r={type:"bar",data:t,options:n};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[r,e])}},\u7A4D\u4E0A\u6A2A\u68D2\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){let n=Object.assign({},e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3"),{indexAxis:"y",scales:{x:{stacked:!0},y:{stacked:!0}}});t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["bar",t,e]);let r={type:"bar",data:t,options:n};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[r,e])}},\u6563\u5E03\u56F3\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){let n=Object.assign({},e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3"),{});t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["scatter",t,e]);let r={type:"scatter",data:t,options:n};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[r,e])}},\u5186\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["pie",t,e]);let n={type:"pie",data:t,options:e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3")};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[n,e])}},\u30C9\u30FC\u30CA\u30C4\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["pie",t,e]);let n={type:"doughnut",data:t,options:e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3")};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[n,e])}},\u30DD\u30FC\u30E9\u30FC\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["pie",t,e]);let n={type:"polarArea",data:t,options:e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3")};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[n,e])}},\u30EC\u30FC\u30C0\u30FC\u30B0\u30E9\u30D5\u63CF\u753B:{type:"func",josi:[["\u3092","\u3067","\u306E"]],asyncFn:!0,fn:async function(t,e){t=e.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",["bar",t,e]);let n={type:"radar",data:t,options:e.__getSysVar("\u30B0\u30E9\u30D5\u30AA\u30D7\u30B7\u30E7\u30F3")};return e.__exec("\u30B0\u30E9\u30D5\u63CF\u753B",[n,e])}},\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62:{type:"func",josi:[["\u306E"],["\u3092"]],fn:function(t,e,n){let r=JSON.parse(JSON.stringify(e)),o=["rgba(255, 99, 132, 0.2)","rgba(54, 162, 235, 0.2)","rgba(255, 206, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(153, 102, 255, 0.2)","rgba(255, 159, 64, 0.2)"],s=["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)"],u={},i=[],c=[];if(u.labels=[],r instanceof Array){if(r[0]instanceof Array){if(t==="pie"){let f={};f.data=[],u.datasets=[f];for(let l=0;l<r.length;l++)u.labels.push(r[l][0]),f.data.push(r[l][1]),i.push(o[l%6]),c.push(s[l%6]);return f.backgroundColor=i,f.borderColor=c,u}if(typeof r[1][0]=="string"){for(let f=1;f<r.length;f++)u.labels.push(r[f][0]),r[f]=r[f].slice(1);r[0]=r[0].slice(1)}else for(let f=1;f<r.length;f++)u.labels.push(f);u.datasets=[];for(let f=0;f<r[0].length;f++){let l={};u.datasets.push(l),l.label=r[0][f],l.backgroundColor=o[f%6],l.borderColor=s[f%6],l.data=[];for(let p=1;p<r.length;p++)l.data.push(r[p][f])}return u}for(let f=0;f<r.length;f++)u.labels.push(f+1),i.push(o[f%6]),c.push(s[f%6]);let a={};return u.datasets=[a],a.label="\u30C7\u30FC\u30BF",a.data=r,a.backgroundColor=i,a.borderColor=c,u}return r instanceof Object?r:n.__exec("\u4E8C\u6B21\u5143\u30B0\u30E9\u30D5\u30C7\u30FC\u30BF\u5909\u5F62",[[r],n])}}};var On={\u30CF\u30C3\u30B7\u30E5\u5024\u8A08\u7B97\u6642:{type:"func",josi:[["\u3078"],["\u3092"],["\u3067"]],pure:!0,fn:function(t,e,n,r){t=r.__findVar(t,null);let o=new TextEncoder().encode(e);crypto.subtle.digest(n,o).then(function(s){let i=Array.from(new Uint8Array(s)).map(a=>a.toString(16).padStart(2,"0")).join(""),c=r.__setSysVar("\u5BFE\u8C61",i);t(c)})},return_none:!0},\u30CF\u30C3\u30B7\u30E5\u5024\u8A08\u7B97:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,asyncFn:!0,fn:async function(t,e,n){let r=new TextEncoder().encode(t),o=await crypto.subtle.digest(e,r);return Array.from(new Uint8Array(o)).map(i=>i.toString(16).padStart(2,"0")).join("")}},\u30E9\u30F3\u30C0\u30E0UUID\u751F\u6210:{type:"func",josi:[],pure:!0,fn:function(t){return window.crypto.randomUUID()}},\u30E9\u30F3\u30C0\u30E0\u914D\u5217\u751F\u6210:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=new Uint8Array(t);return window.crypto.getRandomValues(n),n}}};var Vr=[tn,nn,rn,on,sn,un,cn,an,fn,ln,pn,hn,dn,_n,yn,jn,xn,On],$n={meta:{type:"const",value:{pluginName:"plugin_browser",description:"\u30D6\u30E9\u30A6\u30B6\u7528\u306E\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako"],nakoVersion:"3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){let e=typeof document>"u"?{body:{},querySelector:()=>null}:document,n=typeof window>"u"?{location:{href:"http://localhost/"}}:window,r=typeof navigator>"u"?{}:navigator,o=typeof n.location>"u"?{href:"http://localhost/"}:n.location;t.__setSysVar("AJAX:ONERROR",s=>{console.log(s)}),t.__setSysVar("DOCUMENT",e),t.__setSysVar("WINDOW",n),t.__setSysVar("NAVIGATOR",r),t.__setSysVar("DOM\u89AA\u8981\u7D20",e.body),t.__setSysVar("\u30D6\u30E9\u30A6\u30B6URL",o.href),t.__tohtml=s=>(""+s).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;"),t.__tohtmlQ=s=>t.__tohtml(s).replace(/"/g,"&#34;").replace(/'/g,"&#39;"),t.__dom_events=[],t.__addEvent=(s,u,i,c)=>{let a=null;if(typeof s=="string"){if(a=e.querySelector(s),!a)throw new Error("DOM\u30A4\u30D9\u30F3\u30C8\u304C\u8FFD\u52A0\u3067\u304D\u307E\u305B\u3093\u3002\u8981\u7D20\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002")}else a=s;if(typeof i=="string"&&(i=t.__findVar(i,null),!i))throw new Error("DOM\u30A4\u30D9\u30F3\u30C8\u304C\u8FFD\u52A0\u3067\u304D\u307E\u305B\u3093\u3002\u95A2\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002");let f=p=>(t.__setSysVar("\u5BFE\u8C61",p.target),t.__setSysVar("\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8",p),c&&c(p,t),typeof i=="function"?i(p,t):!1);t.__dom_events.push({dom:a,event:u,func:f,rawFunc:i});let l=a;typeof l.addEventListener=="function"&&l.addEventListener(u,f)},t.__keyHandler=(s,u)=>{u.__setSysVar("\u62BC\u30AD\u30FC",s.key)},t.__mouseHandler=(s,u)=>{let i=s.target;if(i&&i instanceof HTMLElement){let c=i.getBoundingClientRect();if(u.__setSysVar("\u30DE\u30A6\u30B9X",s.clientX-c.left),u.__setSysVar("\u30DE\u30A6\u30B9Y",s.clientY-c.top),s.buttons!==void 0){let a=["","\u5DE6","\u53F3","","\u4E2D\u592E"];u.__setSysVar("\u62BC\u30DC\u30BF\u30F3",a[s.buttons])}}},t.__touchHandler=(s,u)=>{let i=s.target;if(i&&i instanceof HTMLElement){let c=i.getBoundingClientRect(),a=s.changedTouches;if(a.length<=0)return;let f=[];for(let l=0;l<a.length;l++){let p=a[l],h=p.clientX-c.left,_=p.clientY-c.top;l===0&&(u.__setSysVar("\u30BF\u30C3\u30C1X",h),u.__setSysVar("\u30BF\u30C3\u30C1Y",_)),f.push([h,_])}return u.__setSysVar("\u30BF\u30C3\u30C1\u914D\u5217",f),f}},t.__removeEvent=(s,u,i)=>{let c=null;if(typeof s=="string"){if(c=e.querySelector(s),!c)throw new Error("DOM\u30A4\u30D9\u30F3\u30C8\u304C\u524A\u9664\u3067\u304D\u307E\u305B\u3093\u3002\u8981\u7D20\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002")}else c=s;if(typeof i=="string"&&(i=t.__findVar(i,null),!i))throw new Error("DOM\u30A4\u30D9\u30F3\u30C8\u304C\u524A\u9664\u3067\u304D\u307E\u305B\u3093\u3002\u95A2\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002");for(let a=0;a<t.__dom_events.length;a++){let f=t.__dom_events[a];if(f.dom===s&&f.event===u&&f.rawFunc===i){f.dom.removeEventListener(f.event,f.func),t.__dom_events.splice(a,1);break}}},t.__requestAnimationFrameLastId=0,t.__removeAllDomEvents=()=>{t.__dom_events.forEach(s=>{s.dom.removeEventListener(s.event,s.func)}),t.__dom_events=[],t.__requestAnimationFrameLastId>0&&(n.cancelAnimationFrame(t.__requestAnimationFrameLastId),t.__requestAnimationFrameLastId=0)},t.__addPropMethod=s=>{s&&s.__setProp===void 0&&(s.__setProp=(u,i,c)=>{c.__exec("DOM\u8A2D\u5B9A\u5909\u66F4",[s,u,i,c])},s.__getProp=(u,i)=>i.__exec("DOM\u8A2D\u5B9A\u53D6\u5F97",[s,u,i]))},t.__registPropAccessor&&globalThis.Element&&t.__registPropAccessor(Element,function(s,u){return u.__exec("DOM\u8A2D\u5B9A\u53D6\u5F97",[this,s,u])},function(s,u,i){i.__exec("DOM\u8A2D\u5B9A\u5909\u66F4",[this,s,u,i])}),t.__query=(s,u,i)=>{let c=null;if(typeof s=="string"?(c=document.querySelector(s),c||(c=document.getElementById(s))):c=s,!c)if(i)console.warn(`[\u30D2\u30F3\u30C8](${t.__getSysVar("__line")})\u300E${u}\u300F\u3067DOM\u53D6\u5F97\u306B\u5931\u6557\u3057\u3066\u3044\u307E\u3059\u3002DOM=`,s);else{let a=typeof s=="string"?s:String(s);throw new Error(`\u300E${u}\u300F\u3067\u30AF\u30A8\u30EA\u300E${a}\u300F\u3067DOM\u53D6\u5F97\u306B\u5931\u6557\u3057\u307E\u3057\u305F\u3002`)}return t.__addPropMethod(c),c},t.__loadScript=s=>new Promise((u,i)=>{let c=document.createElement("script");c.type="text/javascript",c.src=s,c.onload=()=>{u()},c.onerror=()=>{i(new Error(`Failed to load script at url: ${s}`))},document.getElementsByTagName("head")[0].appendChild(c)})}},"!\u30AF\u30EA\u30A2":{type:"func",josi:[],pure:!0,fn:function(t){if(t.__chartjs){let e=t.__chartjs;typeof e.destroy=="function"&&e.destroy()}t.__removeAllDomEvents()}}};Vr.forEach(t=>{let e={};Object.assign(e,t),typeof e.\u521D\u671F\u5316<"u"&&delete e.\u521D\u671F\u5316,Object.assign($n,e)});var An=$n;var Dr=/^(なでしこ|nako|nadesiko)3?$/,Ke=class extends Re{constructor(){super({useBasicPlugin:!0}),this.version=Se.version,this.wnakoVersion=Se,this.localFiles={},this.addPluginObject("PluginBrowser",An),this.addListener("beforeRun",e=>{e.__varslist[0].set("\u30CA\u30C7\u30B7\u30B3\u7A2E\u985E","wnako3"),e.__varslist[0].set("\u30CA\u30C7\u30B7\u30B3\u30D0\u30FC\u30B8\u30E7\u30F3",Se.version),e.__varslist[0].set("WNAKO\u30D0\u30FC\u30B8\u30E7\u30F3",Se.version)})}async runNakoScript(){let e=0,n=document.querySelectorAll("script");for(let r=0;r<n.length;r++){let o=n[r];if(o.type.match(Dr)){e++;let u=`${typeof window.location=="object"?window.location.href:"url_unknown"}#script${e}.nako3`,i=o.text;await this.loadDependencies(i,u),await this.runAsync(o.text,u)}}e>1&&console.log("\u5B9F\u884C\u3057\u305F\u306A\u3067\u3057\u3053\u306E\u500B\u6570=",e)}async loadDependencies(e,n,r="",o={}){return this.localFiles=o||{},this._loadDependencies(e,n,r,this.getLoaderTool())}checkScriptTagParam(){let e=document.querySelectorAll("script");for(let n=0;n<e.length;n++){let o=e[n].src||"";if(o.indexOf("wnako3.js?run")>=0||o.indexOf("wnako3.js&run")>=0)return!0}return!1}setupEditor(e){return en(e,this,window.ace)}getLoaderTool(){return{readJs:this.readJs,readNako3:this.readNako3,resolvePath:this.resolvePath}}readJs(e,n){return this.localFiles&&this.localFiles[e]?{task:(async()=>()=>(Function(this.localFiles[e])(),{}))()}:{task:(async()=>{let r=("/"+e).split("/").pop()||"?",o=await fetch(e);if(!o.ok)throw new q(`\u30D5\u30A1\u30A4\u30EB\u300E${e}\u300F\u306E\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F: ${o.status} ${o.statusText}`,n.file,n.line);let s=await o.text(),i=`exportObject${Math.floor(Math.random()*1e6)}`;if(s.includes("default export")&&(s=s.replace("default export",`;let ${i} = `),s+=`
;navigator.nako3.addPluginObject('${r}', ${i});
`),!s.includes("navigator.nako3.addPluginObject"))throw new q(`\u30D5\u30A1\u30A4\u30EB ${e} \u306E\u4E2D\u306B\u6587\u5B57\u5217 "navigator.nako3.addPluginObject" \u304C\u5B58\u5728\u3057\u307E\u305B\u3093\u3002\u73FE\u5728\u3001\u30D6\u30E9\u30A6\u30B6\u7248\u306E\u306A\u3067\u3057\u3053\u8A00\u8A9Ev3\u306F\u81EA\u52D5\u767B\u9332\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u307F\u3092\u30B5\u30DD\u30FC\u30C8\u3057\u3066\u3044\u307E\u3059\u3002`,n.file,n.line);let c=navigator,a=c.nako3;return()=>{let f=c,l=f.nako3;f.nako3=a;try{Function(s).apply(a.__globalObj)}catch(p){throw new q(`\u30D7\u30E9\u30B0\u30A4\u30F3 ${e} \u306E\u53D6\u308A\u8FBC\u307F\u306B\u5931\u6557: ${p instanceof Error?p.message:p+""}`,n.file,n.line)}finally{f.nako3=l}return{}}})()}}readNako3(e,n){return this.localFiles&&this.localFiles[e]?{task:new Promise((r,o)=>{let s=this.localFiles[e];r(s)})}:{task:(async()=>{let r=await fetch(e);if(!r.ok)throw new q(`\u30D5\u30A1\u30A4\u30EB ${e} \u306E\u30C0\u30A6\u30F3\u30ED\u30FC\u30C9\u306B\u5931\u6557\u3057\u307E\u3057\u305F: ${r.status} ${r.statusText}`,n.file,n.line);return await r.text()})()}}resolvePath(e,n,r){let o=e;if(!o.match(/^https?:\/\//))if(this.localFiles&&this.localFiles[e])o=this.localFiles[e];else try{o=new URL(e).pathname}catch{try{let c=Ir(r);if(c===""){let a=window.location.href.split("/");c="/"+a.slice(3,a.length-1).join("/")}o=Pr(c,e)}catch(c){throw new q(`\u53D6\u308A\u8FBC\u307F\u6587\u306E\u5F15\u6570\u3067\u30D1\u30B9\u304C\u89E3\u6C7A\u3067\u304D\u307E\u305B\u3093\u3002https:// \u304B http:// \u3067\u59CB\u307E\u308B\u30A2\u30C9\u30EC\u30B9\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002
${c}`,n.file,n.line)}}let s=(i,c)=>{for(let a of c)if(i.endsWith(a)||i.endsWith(a+".txt"))return!0;return!1},u=(o+"?").split("?")[0];if(s(u,[".js",".mjs"]))return{filePath:o,type:"js"};if(s(u,[".nako3",".nako"]))return{filePath:o,type:"nako3"};if(s(o,[".js",".mjs"]))return{filePath:o,type:"js"};if(s(o,[".nako3",".nako"]))return{filePath:o,type:"nako3"};throw new q(`\u30D5\u30A1\u30A4\u30EB\u300E${e}\u300F\u306F\u62E1\u5F35\u5B50\u304C(.nako3|.js|.js.txt|.mjs|.mjs.txt)\u4EE5\u5916\u306A\u306E\u3067\u53D6\u308A\u8FBC\u3081\u307E\u305B\u3093\u3002`,n.file,n.line)}};function Ir(t){let e=t.split("/");return e&&e.length>1?e.slice(0,e.length-1).join("/"):""}function Pr(t,e){let n=t.split("/"),r=e.split("/");for(let o of r)if(o!==""&&o!=="."){if(o===".."){n.pop();continue}n.push(o)}return n.join("/")}if(typeof navigator=="object"&&!navigator.exportWNako3){let t=navigator.nako3=new Ke;window.addEventListener("DOMContentLoaded",e=>{t.checkScriptTagParam()&&t.runNakoScript()},!1)}})();
//# sourceMappingURL=wnako3.js.map
