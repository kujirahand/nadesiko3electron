"use strict";(()=>{var I={and:1,or:1,eq:2,noteq:2,"===":2,"!==":2,gt:2,gteq:2,lt:2,lteq:2,"&":3,"+":4,"-":4,shift_l:4,shift_r:4,shift_r0:4,"*":5,"/":5,"\xF7":5,"\xF7\xF7":5,"%":5,"^":6,"**":6},U=["\u3044\u3066","\u3048\u3066","\u304D\u3066","\u3051\u3066","\u3057\u3066","\u3063\u3066","\u306B\u3066","\u307F\u3066","\u3081\u3066","\u306D\u3066","\u306B\u306F","\u3093\u3067"],oe=[];for(let t in I)oe.push(t);function x(t="?",e="",n=-1,r=0,s="main.nako3"){return{type:t,value:e,indent:n,line:r,column:0,file:s,josi:""}}var ue=class{constructor(e){this.logger=e,this.stackList=[],this.tokens=[],this.usedFuncs=new Set,this.stack=[],this.index=0,this.y=[],this.modName="inline",this.namespaceStack=[],this.modList=[],this.funclist=new Map,this.funcLevel=0,this.usedAsyncFn=!1,this.localvars=new Map([["\u305D\u308C",{type:"var",value:""}]]),this.genMode="sync",this.arrayIndexFrom=0,this.flagReverseArrayIndex=!1,this.flagCheckArrayInit=!1,this.recentlyCalledFunc=[],this.isReadingCalc=!1,this.isExportDefault=!0,this.isExportStack=[],this.moduleExport=new Map,this.isModifiedNodes=!1,this.init()}init(){this.funclist=new Map,this.moduleExport=new Map,this.reset()}reset(){this.tokens=[],this.index=0,this.stack=[],this.y=[],this.genMode="sync"}setFuncList(e){this.funclist=e}setModuleExport(e){this.moduleExport=e}popStack(e=void 0){if(!e){let n=this.stack.pop();return n||null}for(let n=this.stack.length-1;n>=0;n--){let r=this.stack[n];if(e.length===0||e.indexOf(r.josi)>=0)return this.stack.splice(n,1),this.logger.trace("POP :"+JSON.stringify(r)),r}return null}saveStack(){this.stackList.push(this.stack),this.stack=[]}loadStack(){this.stack=this.stackList.pop()}findVar(e){if(this.localvars.get(e))return{name:e,scope:"local",info:this.localvars.get(e)};if(e.indexOf("__")>=0)return this.funclist.get(e)?{name:e,scope:"global",info:this.funclist.get(e)}:void 0;let n=`${this.modName}__${e}`;if(this.funclist.get(n))return{name:n,scope:"global",info:this.funclist.get(n)};for(let r of this.modList){let s=`${r}__${e}`,i=this.moduleExport.get(r),o=this.funclist.get(s);if(o&&(o.isExport===!0||o.isExport!==!1&&i!==!1))return{name:s,scope:"global",info:this.funclist.get(s)}}if(this.funclist.get(e))return{name:e,scope:"system",info:this.funclist.get(e)}}pushStack(e){this.logger.trace("PUSH:"+JSON.stringify(e)),this.stack.push(e)}isEOF(){return this.index>=this.tokens.length}getIndex(){return this.index}check(e){return this.tokens[this.index].type===e}check2(e){for(let n=0;n<e.length;n++){let r=n+this.index;if(this.tokens.length<=r)return!1;if(e[n]==="*")continue;let s=this.tokens[r];if(e[n]instanceof Array){if(e[n].indexOf(s.type)<0)return!1;continue}if(s.type!==e[n])return!1}return!0}checkTypes(e){let n=this.tokens[this.index].type;return e.indexOf(n)>=0}accept(e){let n=[],r=this.index,s=()=>(this.index=r,!1);for(let i=0;i<e.length;i++){if(this.isEOF())return s();let o=e[i];if(o==null)return s();if(typeof o=="string"){let u=this.get();if(u&&u.type!==o)return s();n[i]=u;continue}if(typeof o=="function"){let c=o.bind(this)(n);if(c===null)return s();n[i]=c;continue}if(o instanceof Array){if(!this.checkTypes(o))return s();n[i]=this.get();continue}throw new Error("System Error : accept broken : "+typeof o)}return this.y=n,!0}get(){return this.isEOF()?null:this.tokens[this.index++]}getCur(){if(this.isEOF())throw new Error("\u30C8\u30FC\u30AF\u30F3\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3002");let e=this.tokens[this.index++];if(!e)throw new Error("\u30C8\u30FC\u30AF\u30F3\u304C\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3002");return e}unget(){this.index>0&&this.index--}peek(e=0){return this.isEOF()?null:this.tokens[this.index+e]}peekDef(e=null){return this.isEOF()?(e||(e=x()),e):this.tokens[this.index]}peekSourceMap(e=void 0){let n=e===void 0?this.peek():e;return n===null?{startOffset:void 0,endOffset:void 0,file:void 0,line:0,column:0}:{startOffset:n.startOffset,endOffset:n.endOffset,file:n.file,line:n.line,column:n.column}}nodeToStr(e,n,r){let s=n.depth-1,i=u=>n.typeName!==void 0?n.typeName:u,o=r?" debug: "+JSON.stringify(e,null,2):"";if(!e)return"(NULL)";switch(e.type){case"not":if(s>=0){let u=e.blocks[0];return`${i("")}\u300E${this.nodeToStr(u,{depth:s},r)}\u306B\u6F14\u7B97\u5B50\u300Enot\u300F\u3092\u9069\u7528\u3057\u305F\u5F0F${o}\u300F`}else return`${i("\u6F14\u7B97\u5B50")}\u300Enot\u300F`;case"op":{let u=e,c=u.operator||"",a={eq:"\uFF1D",not:"!",gt:">",lt:"<",and:"\u304B\u3064",or:"\u307E\u305F\u306F"};if(c in a&&(c=a[c]),s>=0){let f=this.nodeToStr(u.blocks[0],{depth:s},r),l=this.nodeToStr(u.blocks[1],{depth:s},r);return u.operator==="eq"?`${i("")}\u300E${f}\u3068${l}\u304C\u7B49\u3057\u3044\u304B\u3069\u3046\u304B\u306E\u6BD4\u8F03${o}\u300F`:`${i("")}\u300E${f}\u3068${l}\u306B\u6F14\u7B97\u5B50\u300E${c}\u300F\u3092\u9069\u7528\u3057\u305F\u5F0F${o}\u300F`}else return`${i("\u6F14\u7B97\u5B50")}\u300E${c}${o}\u300F`}case"number":return`${i("\u6570\u5024")}${e.value}`;case"bigint":return`${i("\u5DE8\u5927\u6574\u6570")}${e.value}`;case"string":return`${i("\u6587\u5B57\u5217")}\u300E${e.value}${o}\u300F`;case"word":return`${i("\u5358\u8A9E")}\u300E${e.value}${o}\u300F`;case"func":return`${i("\u95A2\u6570")}\u300E${e.name||e.value}${o}\u300F`;case"eol":return"\u884C\u306E\u672B\u5C3E";case"eof":return"\u30D5\u30A1\u30A4\u30EB\u306E\u672B\u5C3E";default:{let u=e.name;return u&&(u=e.value),typeof u!="string"&&(u=e.type),`${i("")}\u300E${u}${o}\u300F`}}}};var M=class extends Error{constructor(e,n,r=void 0,s=void 0){let i=`${r||""}${s===void 0?"":`(${s+1}\u884C\u76EE): `}`;n=n.replace(/„Äémain__(.+?)„Äè/g,"\u300E$1\u300F"),super(`[${e}]${i}${n}`),this.name="NakoError",this.type="NakoError",this.tag="["+e+"]",this.positionJa=i,this.msg=n}},ce=class extends M{constructor(e,n,r){super("\u30A4\u30F3\u30C7\u30F3\u30C8\u30A8\u30E9\u30FC",e,r,n),this.type="NakoIndentError",this.line=n,this.file=r}},P=class extends M{constructor(e,n,r,s,i){super("\u5B57\u53E5\u89E3\u6790\u30A8\u30E9\u30FC\uFF08\u5185\u90E8\u30A8\u30E9\u30FC\uFF09",e,i,s),this.type="InternalLexerError",this.preprocessedCodeStartOffset=n,this.preprocessedCodeEndOffset=r,this.line=s,this.file=i}},R=class extends M{constructor(e,n,r,s,i){super("\u5B57\u53E5\u89E3\u6790\u30A8\u30E9\u30FC",e,i,s),this.type="NakoLexerError",this.startOffset=n,this.endOffset=r,this.line=s,this.file=i}},d=class t extends M{static fromNode(e,n,r=void 0){if(!n)return new t(e,void 0,void 0,void 0,void 0);let s=typeof n.startOffset=="number"?n.startOffset:void 0,i=r&&typeof r.endOffset=="number"?r.endOffset:typeof n.endOffset=="number"?n.endOffset:void 0;return new t(e,n.line,s,i,n.file)}constructor(e,n,r,s,i){super("\u6587\u6CD5\u30A8\u30E9\u30FC",e,i,n),this.type="NakoSyntaxError",this.file=i,this.line=n,this.startOffset=r,this.endOffset=s}},G=class t extends M{constructor(e,n){let r="unknown";typeof e=="string"?r=e:e instanceof t||e instanceof M?r=e.msg:e instanceof Error&&(e.name==="Error"?r=e.message:r=`${e.name}: ${e.message}`);let s,i,o;n===void 0?(s=void 0,i=void 0):(o=/^l(-?\d+):(.*)$/.exec(n))?(s=parseInt(o[1]),i=o[2]):(o=/^l(-?\d+)$/.exec(n))?(s=parseInt(o[1]),i="main.nako3"):(s=0,i=n),super("\u5B9F\u884C\u6642\u30A8\u30E9\u30FC",r,i,s),this.type="NakoRuntimeError",this.lineNo=n,this.line=s,this.file=i}},Z=class extends M{constructor(e,n,r){super("\u53D6\u308A\u8FBC\u307F\u30A8\u30E9\u30FC",e,n,r),this.file=n,this.line=r}};var At=new Map([["\u3082\u3057","\u3082\u3057"],["\u56DE","\u56DE"],["\u56DE\u7E70\u8FD4","\u56DE"],["\u9593","\u9593"],["\u9593\u7E70\u8FD4","\u9593"],["\u7E70\u8FD4","\u7E70\u8FD4"],["\u5897\u7E70\u8FD4","\u5897\u7E70\u8FD4"],["\u6E1B\u7E70\u8FD4","\u6E1B\u7E70\u8FD4"],["\u5F8C\u5224\u5B9A","\u5F8C\u5224\u5B9A"],["\u53CD\u5FA9","\u53CD\u5FA9"],["\u629C","\u629C\u3051\u308B"],["\u7D9A","\u7D9A\u3051\u308B"],["\u623B","\u623B\u308B"],["\u5148","\u5148\u306B"],["\u6B21","\u6B21\u306B"],["\u4EE3\u5165","\u4EE3\u5165"],["\u5B9F\u884C\u901F\u5EA6\u512A\u5148","\u5B9F\u884C\u901F\u5EA6\u512A\u5148"],["\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528","\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528"],["\u5B9A","\u5B9A\u3081\u308B"],["\u9010\u6B21\u5B9F\u884C","\u9010\u6B21\u5B9F\u884C"],["\u6761\u4EF6\u5206\u5C90","\u6761\u4EF6\u5206\u5C90"],["\u5897","\u5897"],["\u6E1B","\u6E1B"],["\u5909\u6570","\u5909\u6570"],["\u5B9A\u6570","\u5B9A\u6570"],["\u30A8\u30E9\u30FC\u76E3\u8996","\u30A8\u30E9\u30FC\u76E3\u8996"],["\u30A8\u30E9\u30FC","\u30A8\u30E9\u30FC"],["\u305D\u308C","word"],["\u305D\u3046","word"],["\u95A2\u6570","def_func"],["\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587"],["\u975E\u540C\u671F\u30E2\u30FC\u30C9","\u975E\u540C\u671F\u30E2\u30FC\u30C9"],["DNCL\u30E2\u30FC\u30C9","DNCL\u30E2\u30FC\u30C9"],["DNCL2\u30E2\u30FC\u30C9","DNCL2\u30E2\u30FC\u30C9"],["\u30E2\u30FC\u30C9\u8A2D\u5B9A","\u30E2\u30FC\u30C9\u8A2D\u5B9A"],["\u53D6\u8FBC","\u53D6\u8FBC"],["\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024","\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024"],["\u53B3\u30C1\u30A7\u30C3\u30AF","\u53B3\u30C1\u30A7\u30C3\u30AF"]]),Se=At;function Ge(t){let e=t.charCodeAt(0);return t==="	"?4:t===" "||t==="|"?1:t==="\u30FB"||t==="\u3000"||t==="\u23CB"||t==="\u23CC"||e>=9472&&e<=9599||e>=9120&&e<=9135||e>=9144&&e<=9151?2:0}var fe=["\u306B\u3064\u3044\u3066","\u304F\u3089\u3044","\u306A\u306E\u304B","\u307E\u3067\u3092","\u307E\u3067\u306E","\u306B\u3088\u308B","\u3068\u306F","\u304B\u3089","\u307E\u3067","\u3060\u3051","\u3088\u308A","\u307B\u3069","\u306A\u3069","\u3044\u3066","\u3048\u3066","\u304D\u3066","\u3051\u3066","\u3057\u3066","\u3063\u3066","\u306B\u3066","\u307F\u3066","\u3081\u3066","\u306D\u3066","\u3067\u306F","\u306B\u306F","\u3093\u3067","\u305A\u3064","\u306F","\u3092","\u306B","\u3078","\u3067","\u3068","\u304C","\u306E"],Nt=["\u3067\u306A\u3051\u308C\u3070","\u306A\u3051\u308C\u3070","\u306A\u3089\u3070","\u306A\u3089","\u305F\u3089","\u308C\u3070"],Ot=["\u3053\u3068","\u3067\u3042\u308B","\u3067\u3059","\u3057\u307E\u3059","\u3067\u3057\u305F"],je={};Nt.forEach(t=>{fe.push(t),je[t]=!0});var W={};Ot.forEach(t=>{fe.push(t),W[t]=!0});var ae=[];for(let t of fe)ae.push("\u3082\u306E"+t),ae.push(t);ae.sort((t,e)=>e.length-t.length);var Ft="^[\\t ]*("+ae.join("|")+")",q=new RegExp(Ft),Be=fe;var Et=/^[\u3005\u4E00-\u9FCF_a-zA-Z0-9„Ç°-„É∂„Éº\u2460-\u24FF\u2776-\u277F\u3251-\u32BF]+/,We=/^[„ÅÅ-„Çì]/,Tt=/^[„ÅÅ-„Çì]+$/,Ct=/^.+(‰ª•‰∏ä|‰ª•‰∏ã|Ë∂Ö|Êú™Ê∫Ä)$/,Mt=/^(„Åã„Å§|„Åæ„Åü„ÅØ)/,Ue=t=>function(){throw new Error("\u7A81\u7136\u306E\u300E"+t+"\u300F\u304C\u3042\u308A\u307E\u3059\u3002")},qe=/^(ÂÜÜ|„Éâ„É´|ÂÖÉ|Ê≠©|„é°|Âù™|Â∫¶|‚ÑÉ|¬∞|ÂÄã|„Å§|Êú¨|ÂÜä|Êâç|Ê≠≥|Âåπ|Êûö|Áöø|„Çª„ÉÉ„Éà|ÁæΩ|‰∫∫|‰ª∂|Ë°å|Âàó|Ê©ü|ÂìÅ|m|mm|cm|km|g|kg|t|b|mb|kb|gb)/,ze=/^(px|em|ex|rem|vw|vh|vmin|vmax)/,Xe=[{name:"\u3053\u3053\u307E\u3067",pattern:/^;;;/},{name:"eol",pattern:/^\n/},{name:"eol",pattern:/^;/},{name:"space",pattern:/^(\x20|\x09|„Éª|‚éø |‚îî|ÔΩú)+/},{name:"comma",pattern:/^,/},{name:"line_comment",pattern:/^#[^\n]*/},{name:"line_comment",pattern:/^\/\/[^\n]*/},{name:"range_comment",pattern:/^\/\*/,cbParser:It},{name:"def_test",pattern:/^‚óè„ÉÜ„Çπ„Éà:/},{name:"def_func",pattern:/^‚óè/},{name:"\u2026",pattern:/^‚Ä¶/},{name:"\u2026",pattern:/^\.{2,3}/},{name:"bigint",pattern:/^0[xX][0-9a-fA-F]+(_[0-9a-fA-F]+)*n/,readJosi:!0},{name:"bigint",pattern:/^0[oO][0-7]+(_[0-7]+)*n/,readJosi:!0},{name:"bigint",pattern:/^0[bB][0-1]+(_[0-1]+)*n/,readJosi:!0},{name:"bigint",pattern:/^\d+(_\d+)*?n/,readJosi:!0},{name:"number",pattern:/^0[xX][0-9a-fA-F]+(_[0-9a-fA-F]+)*/,readJosi:!0,cb:z},{name:"number",pattern:/^0[oO][0-7]+(_[0-7]+)*/,readJosi:!0,cb:z},{name:"number",pattern:/^0[bB][0-1]+(_[0-1]+)*/,readJosi:!0,cb:z},{name:"number",pattern:/^\d+(_\d+)*\.(\d+(_\d+)*)?([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:z},{name:"number",pattern:/^\.\d+(_\d+)*([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:z},{name:"number",pattern:/^\d+(_\d+)*([eE][+|-]?\d+(_\d+)*)?/,readJosi:!0,cb:z},{name:"\u3053\u3053\u304B\u3089",pattern:/^(„Åì„Åì„Åã„Çâ),?/},{name:"\u3053\u3053\u307E\u3067",pattern:/^(„Åì„Åì„Åæ„Åß|üíß)/},{name:"\u3082\u3057",pattern:/^„ÇÇ„Åó„ÇÇ?/},{name:"\u9055\u3048\u3070",pattern:/^ÈÅï(„Åà„Å∞)?/},{name:"shift_r0",pattern:/^>>>/},{name:"shift_r",pattern:/^>>/},{name:"shift_l",pattern:/^<</},{name:"===",pattern:/^===/},{name:"!==",pattern:/^!==/},{name:"gteq",pattern:/^(‚âß|>=|=>)/},{name:"lteq",pattern:/^(‚â¶|<=|=<)/},{name:"noteq",pattern:/^(‚â†|<>|!=)/},{name:"\u2190",pattern:/^(‚Üê|<--)/},{name:"eq",pattern:/^(==|üü∞üü∞)/},{name:"eq",pattern:/^(=|üü∞)/},{name:"line_comment",pattern:/^(!|üí°)(„Ç§„É≥„Éá„É≥„ÉàÊßãÊñá|„Åì„Åì„Åæ„Åß„Å†„Çã„ÅÑ|DNCL„É¢„Éº„Éâ|DNCL2„É¢„Éº„Éâ|DNCL2)[^\n]*/},{name:"not",pattern:/^(!|üí°)/},{name:"gt",pattern:/^>/},{name:"lt",pattern:/^</},{name:"and",pattern:/^(„Åã„Å§|&&|and\s)/},{name:"or",pattern:/^(„Åæ„Åü„ÅØ|Êàñ„ÅÑ„ÅØ|„ÅÇ„Çã„ÅÑ„ÅØ|or\s|\|\|)/},{name:"@",pattern:/^@/},{name:"+",pattern:/^\+/},{name:"-",pattern:/^-/},{name:"**",pattern:/^(√ó√ó|\*\*)/},{name:"*",pattern:/^(√ó|\*)/},{name:"\xF7\xF7",pattern:/^√∑√∑/},{name:"\xF7",pattern:/^(√∑|\/)/},{name:"%",pattern:/^%/},{name:"^",pattern:/^\^/},{name:"&",pattern:/^&/},{name:"[",pattern:/^\[/},{name:"]",pattern:/^]/,readJosi:!0},{name:"(",pattern:/^\(/},{name:")",pattern:/^\)/,readJosi:!0},{name:"|",pattern:/^\|/},{name:"??",pattern:/^\?\?/},{name:"word",pattern:/^\$\{.+?\}/,cbParser:t=>Lt(t)},{name:"$",pattern:/^(\$|\.)/},{name:"string",pattern:/^üåø/,cbParser:t=>B("\u{1F33F}","\u{1F33F}",t)},{name:"string_ex",pattern:/^üå¥/,cbParser:t=>B("\u{1F334}","\u{1F334}",t)},{name:"string_ex",pattern:/^„Äå/,cbParser:t=>B("\u300C","\u300D",t)},{name:"string",pattern:/^„Äé/,cbParser:t=>B("\u300E","\u300F",t)},{name:"string_ex",pattern:/^‚Äú/,cbParser:t=>B("\u201C","\u201D",t)},{name:"string_ex",pattern:/^"/,cbParser:t=>B('"','"',t)},{name:"string",pattern:/^'/,cbParser:t=>B("'","'",t)},{name:"\u300D",pattern:/^„Äç/,cbParser:Ue("\u300D")},{name:"\u300F",pattern:/^„Äè/,cbParser:Ue("\u300F")},{name:"func",pattern:/^\{Èñ¢Êï∞\},?/},{name:"{",pattern:/^\{/},{name:"}",pattern:/^\}/,readJosi:!0},{name:":",pattern:/^:/},{name:"_eol",pattern:/^_\s*\n/},{name:"dec_lineno",pattern:/^‚Ä∞/},{name:"word",pattern:/^[\uD800-\uDBFF][\uDC00-\uDFFF][_a-zA-Z0-9]*/,readJosi:!0},{name:"word",pattern:/^[\u1F60-\u1F6F][_a-zA-Z0-9]*/,readJosi:!0},{name:"word",pattern:/^„Ää.+?„Äã/,readJosi:!0},{name:"word",pattern:/^[_a-zA-Z\u3005\u4E00-\u9FCF„ÅÅ-„Çì„Ç°-„É∂\u2460-\u24FF\u2776-\u277F\u3251-\u32BF]/,cbParser:Pt}];function Vt(t){return We.test(t)?Tt.test(t)?t:t.replace(/[„ÅÅ-„Çì]+$/g,""):t.replace(/[„ÅÅ-„Çì]+/g,"")}function It(t){let e="",r=0;t=t.substring(2);let s=t.indexOf("*/");s<0?(e=t,t=""):(e=t.substring(0,s),t=t.substring(s+2));for(let i=0;i<e.length;i++)e.charAt(i)===`
`&&r++;return e=e.replace(/(^\s+|\s+$)/,""),{src:t,res:e,josi:"",numEOL:r}}function Pt(t,e=!0){let n="",r="";for(;t!=="";){if(n.length>0){if(Mt.exec(t))break;let c=q.exec(t);if(c){r=c[0].replace(/^\s+/,""),t=t.substring(c[0].length),t.charAt(0)===","&&(t=t.substring(1));break}}let i=Et.exec(t);if(i){n+=i[0],t=t.substring(i[0].length);continue}if(We.test(t)){n+=t.charAt(0),t=t.substring(1);continue}break}/[„ÅÅ-„Çì]Èñì$/.test(n)&&(t=n.charAt(n.length-1)+t,n=n.slice(0,-1));let s=Ct.exec(n);return s&&(t=s[1]+r+t,r="",n=n.substring(0,n.length-s[1].length)),r.substring(0,2)==="\u3082\u306E"&&(r=r.substring(2)),W[r]&&(r=""),e&&(n=Vt(n)),n===""&&r!==""&&(n=r,r=""),{src:t,res:n,josi:r,numEOL:0}}function B(t,e,n){let r="",s="",i=0;n=n.substring(t.length);let o=n.indexOf(e);if(o<0)throw r=n,n="",new Error(`\u300E${t}\u300F\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u7D42\u7AEF\u8A18\u53F7\u300E${e}\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002`);if(r=n.substring(0,o),n=n.substring(o+e.length),r.indexOf(t)>=0)throw t==="\u300E"?new Error("\u300C\u300E\u300D\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u4E2D\u306B\u300C\u300E\u300D\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002"):new Error(`\u300E${t}\u300F\u3067\u59CB\u3081\u305F\u6587\u5B57\u5217\u306E\u4E2D\u306B\u300E${t}\u300F\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002`);let u=q.exec(n);u&&(s=u[0].replace(/^\s+/,""),n=n.substring(u[0].length),n.charAt(0)===","&&(n=n.substring(1))),W[s]&&(s=""),s.substring(0,2)==="\u3082\u306E"&&(s=s.substring(2));for(let c=0;c<r.length;c++)r.charAt(c)===`
`&&i++;return{src:n,res:r,josi:s,numEOL:i}}function Lt(t){let e="",n="",r=0;t=t.substring(2);let s=t.indexOf("}");if(s<0)throw new Error("\u5909\u6570\u540D\u306E\u7D42\u308F\u308A\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002");e=t.substring(0,s),t=t.substring(s+1);let i=q.exec(t);i&&(n=i[0].replace(/^\s+/,""),t=t.substring(i[0].length),t.charAt(0)===","&&(t=t.substring(1)));for(let o=0;o<e.length;o++)e.charAt(o)===`
`&&r++;if(r>0)throw new Error("\u5909\u6570\u540D\u306B\u6539\u884C\u3092\u542B\u3081\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002");return{src:t,res:e,josi:n,numEOL:r}}function z(t){return Number(t.replace(/_/g,""))}var T=class t{constructor(e){this.logger=e,this.funclist=new Map,this.modList=[],this.result=[],this.modName="main.nako3",this.moduleExport=new Map,this.reservedWords=Array.from(Se.keys()),this.josiList=Be}setFuncList(e){this.funclist=e}setModuleExport(e){this.moduleExport=e}replaceTokens(e,n,r){if(this.result=e,this.modName=t.filenameToModName(r),t.preDefineFunc(e,this.logger,this.funclist,this.moduleExport),this._replaceWord(this.result),n)if(this.result.length>0){let s=this.result[this.result.length-1];this.result.push({type:"eol",line:s.line,column:0,indent:-1,file:s.file,josi:"",value:"---",startOffset:s.startOffset,endOffset:s.endOffset,rawJosi:""}),this.result.push({type:"eof",line:s.line,indent:-1,column:0,file:s.file,josi:"",value:"",startOffset:s.startOffset,endOffset:s.endOffset,rawJosi:""})}else this.result.push({type:"eol",line:0,column:0,indent:-1,file:"",josi:"",value:"---",startOffset:0,endOffset:0,rawJosi:""}),this.result.push({type:"eof",line:0,column:0,indent:-1,file:"",josi:"",value:"",startOffset:0,endOffset:0,rawJosi:""});return this.result}static preDefineFunc(e,n,r,s){let i=0,o=!1,u=()=>{let c=[],a={};if(e[i].type!=="(")return[];for(i++;e[i];){let y=e[i];if(i++,y.type===")")break;y.type==="func"?o=!0:y.type!=="|"&&y.type!=="comma"&&(o&&(y.funcPointer=!0,o=!1),c.push(y),a[y.value]||(a[y.value]=[]),a[y.value].push(y.josi))}let f=[],l=[],h=[],p={};for(let y of c)if(!p[y.value]){let m=a[y.value];h.push(m),f.push(y.value),y.funcPointer?l.push(y.value):l.push(null),p[y.value]=!0}return[h,f,l]};for(;i<e.length;){let c=e[i];if(c.type==="not"&&e.length-i>3){let _={type:"eol"};if(i>=1&&(_=e[i-1]),_.type==="eol"){let w=e[i+1];if(w.type==="word"&&w.value==="\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024"){if(w.type="\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024",w=e[i+2],w.type==="string"&&w.value==="\u975E\u516C\u958B"){let A=t.filenameToModName(c.file);s.set(A,!1),i+=3;continue}else if(w.type==="string"&&w.value==="\u516C\u958B"){let A=t.filenameToModName(c.file);s.set(A,!0),i+=3;continue}}}}if(c.type==="word"&&c.josi==="\u306B\u306F"){c.josi="\u306B\u306F",e.splice(i+1,0,{type:"def_func",value:"\u95A2\u6570",indent:c.indent,line:c.line,column:c.column,file:c.file,josi:"",startOffset:c.endOffset,endOffset:c.endOffset,rawJosi:"",tag:"\u7121\u540D\u95A2\u6570"}),i++;continue}if(c.type==="word"&&c.value==="\u6C38\u9060"&&c.josi==="\u306B"){let _=e[i+1];_.value==="\u7E70\u8FD4"&&(_.value="\u9593",_.josi="\u306E"),i++;continue}if(c.type==="word"&&c.josi===""&&c.value.length>=2&&c.value.match(/Âõû$/)){c.value=c.value.substring(0,c.value.length-1),c.endOffset||(c.endOffset=1);let _={type:"\u56DE",value:"\u56DE",indent:c.indent,line:c.line,column:c.column,file:c.file,josi:"",startOffset:c.endOffset-1,endOffset:c.endOffset,rawJosi:""};e.splice(i+1,0,_),c.endOffset--,i++}if(c.type==="word"){let _=Se.get(c.value);_&&(c.type=_),c.value==="\u305D\u3046"&&(c.value="\u305D\u308C")}if(c.type!=="def_test"&&c.type!=="def_func"){i++;continue}let a=!0,f={type:"eol"};i>=1&&(f=e[i-1]),f.type==="eol"&&(a=!1);let l=c;i++;let h=[],p=[],y=[],m="",g=null,k=null;if(e[i]&&e[i].type==="{"){i++;let _=e[i]&&e[i].type==="word"?e[i].value:"";_==="\u516C\u958B"?k=!0:_==="\u975E\u516C\u958B"?k=!1:_==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?k=!0:n.warn(`\u4E0D\u660E\u306A\u95A2\u6570\u5C5E\u6027\u300E${String(_)}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),i++,e[i]&&e[i].type==="}"&&i++}if(e[i]&&e[i].type==="("&&([h,p,y]=u()),!a&&e[i]&&e[i].type==="word"&&(g=e[i++],m=g.value),h.length===0&&e[i]&&e[i].type==="("&&([h,p,y]=u()),m!==""&&g){if(m=t.filenameToModName(c.file)+"__"+m,r.has(m)){let w=m.replace(/^main__/,"");n.warn(`\u95A2\u6570\u300E${w}\u300F\u306F\u65E2\u306B\u5B9A\u7FA9\u3055\u308C\u3066\u3044\u307E\u3059\u3002`,l)}g.value=m,r.set(m,{type:"func",josi:h,fn:null,asyncFn:!1,isExport:k,varnames:p,funcPointers:y})}let b={type:"func",josi:h,varnames:p,funcPointers:y};l.meta=b}}splitStringEx(e){let n=[],r=e.split(/[{ÔΩõ]/);n.push(r[0]);for(let s of r.slice(1)){let i=s.replace("\uFF5D","}").indexOf("}");if(i===-1)return null;n.push(s.slice(0,i),s.slice(i+1))}return n}_replaceWord(e){let n=[],r=0,s=!1,i=[],o=()=>r<=0?"eol":e[r-1].type,u=e.length>0?t.filenameToModName(e[0].file):"main";for(;r<e.length;){let c=e[r];if((c.type==="word"||c.type==="func")&&c.value==="\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A"){if(s)throw new P("\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A\u306E\u95A2\u6570\u53C2\u7167\u3092\u53D6\u5F97\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.startOffset===void 0?0:c.startOffset,c.endOffset===void 0?0:c.endOffset,c.line,c.file);i.push(u),u=e[r-1].value}if((c.type==="word"||c.type==="func")&&c.value==="\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7"){if(s)throw new P("\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7\u306E\u95A2\u6570\u53C2\u7167\u3092\u53D6\u5F97\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.startOffset===void 0?0:c.startOffset,c.endOffset===void 0?0:c.endOffset,c.line,c.file);let a=i.pop();a&&(u=a)}if(c.type==="word"&&c.value!=="\u305D\u308C"){let a=String(c.value);if(a.indexOf("__")<0){let l=`${u}__${a}`,h=this.funclist.get(l);if(h&&h.type==="func"){let p=c;p.type=s?"func_pointer":"func",p.meta=h,p.value=l,s&&(s=!1,e.splice(r-1,1));continue}for(let p of this.modList){let y=`${p}__${a}`,m=this.funclist.get(y),g=this.moduleExport.get(p);if(m&&m.type==="func"&&(m.isExport===!0||m.isExport!==!1&&g!==!1)){let k=c;k.type=s?"func_pointer":"func",k.meta=m,k.value=y,s&&(s=!1,e.splice(r-1,1));break}}}let f=this.funclist.get(a);if(f&&f.type==="func"){let l=c;if(l.type=s?"func_pointer":"func",l.meta=f,s){s=!1,e.splice(r-1,1);continue}}}if(s=!1,c.type==="func"&&c.value==="{\u95A2\u6570}"){r++,s=!0;continue}if(c.type==="-"&&e[r+1]){let a=e[r+1].type;if(a==="number"||a==="bigint"){let f=o();(f==="eol"||I[f]||e[r-1].josi!=="")&&(e.splice(r,1),a==="number"?e[r].value*=-1:e[r].value="-"+String(e[r].value))}}if(c.josi===void 0&&(c.josi=""),c.josi==="\u306F"){c.rawJosi||(c.rawJosi=c.josi);let a=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"eq",indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:a,endOffset:c.endOffset,josi:"",rawJosi:"",value:void 0}),r+=2,c.josi=c.rawJosi="",c.endOffset=a;continue}if(c.josi==="\u3068\u306F"){c.rawJosi||(c.rawJosi=c.josi);let a=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"\u3068\u306F",indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:a,endOffset:c.endOffset,josi:"",rawJosi:"",value:void 0}),c.josi=c.rawJosi="",c.endOffset=a,r+=2;continue}if(je[c.josi]){let a=c.josi==="\u3067\u306A\u3051\u308C\u3070"||c.josi==="\u306A\u3051\u308C\u3070"?"\u3067\u306A\u3051\u308C\u3070":"\u306A\u3089\u3070";c.rawJosi||(c.rawJosi=a);let f=c.endOffset===void 0?void 0:c.endOffset-c.rawJosi.length;e.splice(r+1,0,{type:"\u306A\u3089\u3070",value:a,indent:c.indent,line:c.line,column:c.column,file:c.file,startOffset:f,endOffset:c.endOffset,josi:"",rawJosi:""}),c.josi=c.rawJosi="",c.endOffset=f,r+=2;continue}if(c.type==="_eol"){e.splice(r,1);continue}if(c.type==="line_comment"||c.type==="range_comment"){n.push(c.value),e.splice(r,1);continue}c.type==="eol"&&(c.value=n.join("/"),n=[]),r++}}countIndent(e){let n=0;for(let r=0;r<e.length;r++){let s=e.charAt(r),i=Ge(s);if(i===0)return[n,r];n+=i}return[n,e.length]}tokenize(e,n,r){let s=e.length,i=[],o,u,c=1,a=!1,f=0,l=this.countIndent(e);for(f=l[0],e=e.substring(l[1]),c+=l[1];e!=="";){let h=!1;for(let p of Xe){let y=p.pattern.exec(e);if(!y)continue;let m=p.name;if(h=!0,p.name==="space"){c+=y[0].length,e=e.substring(y[0].length);continue}if(p.cbParser){let _;if(a&&p.name==="word")_=p.cbParser(e,!1);else try{_=p.cbParser(e)}catch(w){throw new R(w.message,s-e.length,s-e.length+1,n,r)}if(p.name==="string_ex"){let w=this.splitStringEx(_.res);if(w===null)throw new P("\u5C55\u958B\u3042\u308A\u6587\u5B57\u5217\u3067\u5024\u306E\u57CB\u3081\u8FBC\u307F{...}\u304C\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093\u3002",s-e.length,s-_.src.length,n,r);let A=0;for(let O=0;O<w.length;O++){let ie=O===w.length-1?_.josi:"";O%2===0?(i.push({type:"string",value:w[O],file:r,josi:ie,indent:f,line:n,column:c,preprocessedCodeOffset:s-e.length+A,preprocessedCodeLength:w[O].length+2+ie.length}),A+=w[O].length+2):(i.push({type:"&",value:"&",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:s-e.length+A,preprocessedCodeLength:0}),i.push({type:"(",value:"(",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:s-e.length+A,preprocessedCodeLength:0}),i.push({type:"code",value:w[O],josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:s-e.length+A,preprocessedCodeLength:w[O].length}),i.push({type:")",value:")",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:s-e.length+A+w[O].length,preprocessedCodeLength:0}),i.push({type:"&",value:"&",josi:"",indent:f,file:r,line:n,column:c,preprocessedCodeOffset:s-e.length+A+w[O].length,preprocessedCodeLength:0}),A+=w[O].length)}n+=_.numEOL,c+=e.length-_.src.length,e=_.src,_.numEOL>0&&(c=1);break}o=c,c+=e.length-_.src.length,i.push({type:p.name,value:_.res,josi:_.josi,indent:f,line:n,column:o,file:r,preprocessedCodeOffset:s-e.length,preprocessedCodeLength:e.length-_.src.length}),e=_.src,n+=_.numEOL,_.numEOL>0&&(c=1);break}let g=s-e.length,k=y[0];if(p.cb&&(k=p.cb(k)),o=c,u=n,c+=y[0].length,e=e.substring(y[0].length),(p.name==="eol"&&k===`
`||p.name==="_eol")&&(k=n++,c=1),p.name==="number"){let _=qe.exec(e);_&&(e=e.substring(_[0].length),c+=y[0].length);let w=ze.exec(e);w&&(m="string",e=e.substring(w[0].length),c+=y[0].length,k+=w[0])}let b="";if(p.readJosi){let _=q.exec(e);_&&(c+=_[0].length,b=_[0].replace(/^\s+/,""),e=e.substring(_[0].length),e.charAt(0)===","&&(e=e.substring(1)),W[b]&&(b=""),b.substring(0,2)==="\u3082\u306E"&&(b=b.substring(2)))}switch(m){case"def_test":{a=!0;break}case"eol":{a=!1;break}default:break}if(m==="dec_lineno"){n--;continue}if(i.push({type:m,value:k,indent:f,line:u,column:o,file:r,josi:b,preprocessedCodeOffset:g,preprocessedCodeLength:s-e.length-g}),m==="eol"&&c===1){let _=this.countIndent(e);f=_[0],c+=_[1],e=e.substring(_[1])}break}if(!h)throw new P("\u672A\u77E5\u306E\u8A9E\u53E5: "+e.substring(0,3)+"...",s-e.length,s-s+3,n,r)}return i}static tokensToTypeStr(e,n){return e.map(s=>s.type).join(n)}static filenameToModName(e){if(!e)return"main";if(e=e.replace(/[\\:]/g,"/"),e.indexOf("/")>=0){let n=e.split("/");e=n[n.length-1]}return e=e.replace(/\.nako3?$/,""),e}};var le=class extends ue{parse(e,n){this.reset(),this.tokens=e,this.modName=T.filenameToModName(n),this.modList.push(this.modName);let r=this.startParser();for(this.isModifiedNodes=!1,this._checkAsyncFn(r);this.isModifiedNodes;)this.isModifiedNodes=!1,this._checkAsyncFn(r);return r}startParser(){let e=this.ySentenceList(),n=this.get();if(n&&n.type!=="eof")throw this.logger.debug(`\u69CB\u6587\u89E3\u6790\u3067\u30A8\u30E9\u30FC\u3002${this.nodeToStr(n,{depth:1},!0)}\u306E\u4F7F\u3044\u65B9\u304C\u9593\u9055\u3063\u3066\u3044\u307E\u3059\u3002`,n),d.fromNode(`\u69CB\u6587\u89E3\u6790\u3067\u30A8\u30E9\u30FC\u3002${this.nodeToStr(n,{depth:1},!1)}\u306E\u4F7F\u3044\u65B9\u304C\u9593\u9055\u3063\u3066\u3044\u307E\u3059\u3002`,n);return e}yNop(){return{type:"nop",josi:"",...this.peekSourceMap(),end:this.peekSourceMap()}}ySentenceList(){let e=[],n=-1,r=this.peekSourceMap();for(;!this.isEOF();){let s=this.ySentence();if(!s)break;e.push(s),n<0&&(n=s.line)}if(e.length===0){let s=this.peek()||this.tokens[0];throw this.logger.debug("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557:"+this.nodeToStr(this.peek(),{depth:1},!0),s),d.fromNode("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557:"+this.nodeToStr(this.peek(),{depth:1},!1),s)}return{type:"block",blocks:e,josi:"",...r,end:this.peekSourceMap()}}makeStackBalanceReport(){let e=[];this.stack.forEach(i=>{let o=this.nodeToStr(i,{depth:1},!1);i.josi&&(o+=i.josi),e.push(o)});let n=e.join(","),r="",s=65;for(let i of this.recentlyCalledFunc){r+=" - ";let o=0,u=i.josi;if(u)for(let c of u){let a=String.fromCharCode(s+o);r+=a,c.length===1?r+=c[0]:r+=`(${c.join("|")})`,o++}r+=String(i.name)+`
`}return this.recentlyCalledFunc=[],`\u672A\u89E3\u6C7A\u306E\u5358\u8A9E\u304C\u3042\u308A\u307E\u3059: [${n}]
\u6B21\u306E\u547D\u4EE4\u306E\u53EF\u80FD\u6027\u304C\u3042\u308A\u307E\u3059:
${r}`}yEOL(){let e=this.get();if(!e)return null;if(this.stack.length>0){let n=this.makeStackBalanceReport();throw d.fromNode(n,e)}return this.recentlyCalledFunc=[],{type:"eol",comment:e.value,line:e.line,column:e.column,file:e.file}}ySentence(){let e=this.peekSourceMap();if(this.check("eol"))return this.yEOL();if(this.check("\u3082\u3057"))return this.yIF();if(this.check("\u5F8C\u5224\u5B9A"))return this.yAtohantei();if(this.check("\u30A8\u30E9\u30FC\u76E3\u8996"))return this.yTryExcept();if(this.accept(["\u629C\u3051\u308B"]))return{type:"break",josi:"",...e,end:this.peekSourceMap()};if(this.accept(["\u7D9A\u3051\u308B"]))return{type:"continue",josi:"",...e,end:this.peekSourceMap()};if(this.check("??"))return this.yDebugPrint();if(this.accept(["DNCL\u30E2\u30FC\u30C9"]))return this.yDNCLMode(1);if(this.accept(["DNCL2\u30E2\u30FC\u30C9"]))return this.yDNCLMode(2);if(this.accept(["not","string","\u30E2\u30FC\u30C9\u8A2D\u5B9A"]))return this.ySetGenMode(this.y[1].value);if(this.accept(["not","\u30E2\u30B8\u30E5\u30FC\u30EB\u516C\u958B\u65E2\u5B9A\u5024","eq","string"]))return this.yExportDefault(this.y[3].value);if(this.accept(["not","\u53B3\u30C1\u30A7\u30C3\u30AF"]))return this.ySetMode("\u53B3\u3057\u304F\u30C1\u30A7\u30C3\u30AF");if(this.check("\u9010\u6B21\u5B9F\u884C"))return this.yTikuji();if(this.accept(["not","\u975E\u540C\u671F\u30E2\u30FC\u30C9"]))return this.yASyncMode();if(this.check2(["func","eq"])){let n=this.get()||x();throw d.fromNode(`\u95A2\u6570\u300E${n.value}\u300F\u306B\u4EE3\u5165\u3067\u304D\u307E\u305B\u3093\u3002`,n)}if(this.accept([this.ySpeedMode]))return this.y[0];if(this.accept([this.yPerformanceMonitor]))return this.y[0];if(this.accept([this.yLet]))return this.y[0];if(this.accept([this.yDefTest]))return this.y[0];if(this.accept([this.yDefFunc]))return this.y[0];if(this.accept([this.yCall])){let n=this.y[0],r=this.peek();if(r&&r.type==="\u306A\u3089\u3070"){let s=this.peekSourceMap(),i=n;return this.get(),this.yIfThen(i,s)}else if(U.indexOf(n.josi||"")>=0){if(this.stack.length>=1){let i=this.makeStackBalanceReport();throw d.fromNode(i,n)}let s=this.ySentence();if(s!==null)return{type:"block",blocks:[n,s],josi:s.josi,...e,end:this.peekSourceMap()}}return n}return null}yASyncMode(){return this.logger.error("\u300E\u975E\u540C\u671F\u30E2\u30FC\u30C9\u300F\u69CB\u6587\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F(https://nadesi.com/v3/doc/go.php?1028)\u3002",this.peek()),{type:"eol",...this.peekSourceMap(),end:this.peekSourceMap()}}yDNCLMode(e){let n=this.peekSourceMap();return e===1&&(this.arrayIndexFrom=1,this.flagReverseArrayIndex=!0),this.flagCheckArrayInit=!0,{type:"eol",...n,end:this.peekSourceMap()}}ySetGenMode(e){let n=this.peekSourceMap();return this.genMode=e,{type:"eol",...n,end:this.peekSourceMap()}}yExportDefault(e){let n=this.peekSourceMap();return this.isExportDefault=e==="\u516C\u958B",this.moduleExport.set(this.modName,this.isExportDefault),{type:"eol",...n,end:this.peekSourceMap()}}ySetMode(e){let n=this.peekSourceMap();return{type:"run_mode",value:e,...n,end:this.peekSourceMap()}}yBlock(){let e=this.peekSourceMap(),n=[];for(this.check("\u3053\u3053\u304B\u3089")&&this.get();!this.isEOF()&&!(this.checkTypes(["\u9055\u3048\u3070","\u3053\u3053\u307E\u3067","\u30A8\u30E9\u30FC"])||!this.accept([this.ySentence]));)n.push(this.y[0]);return{type:"block",blocks:n,josi:"",...e,end:this.peekSourceMap()}}yDefFuncReadArgs(){if(!this.check("("))return null;let e=[];for(this.get();!this.isEOF();){if(this.check(")")){this.get();break}let n=this.get();n&&e.push(n),this.check("comma")&&this.get()}return e}yDefTest(){return this.yDefFuncCommon("def_test")}yDefFunc(){return this.yDefFuncCommon("def_func")}yDefFuncCommon(e){if(!this.check(e))return null;let n=this.peekSourceMap(),r=this.get();if(!r)return null;let s=r,i=this.isExportDefault;if(this.check("{")){this.get();let h=this.get();if(this.check("}"))this.get();else throw d.fromNode("\u95A2\u6570\u306E\u5C5E\u6027\u306E\u6307\u5B9A\u304C\u6B63\u3057\u304F\u3042\u308A\u307E\u305B\u3093\u3002\u300E{\u300F\u3068\u300E}\u300F\u3067\u56F2\u3080\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002",s);h!=null&&(h.value==="\u516C\u958B"&&(i=!0),h.value==="\u975E\u516C\u958B"&&(i=!1),h.value==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"&&(i=!0))}let o=[];this.check("(")&&(o=this.yDefFuncReadArgs()||[]);let u=this.get();if(!u||u.type!=="func")throw this.logger.debug(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!0)+"\u306E\u5BA3\u8A00\u3067\u30A8\u30E9\u30FC\u3002",u),d.fromNode(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!1)+"\u306E\u5BA3\u8A00\u3067\u30A8\u30E9\u30FC\u3002",s);if(this.check("(")){if(o.length>0)throw this.logger.debug(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!0)+"\u306E\u5BA3\u8A00\u3067\u3001\u5F15\u6570\u5B9A\u7FA9\u306F\u540D\u524D\u306E\u524D\u304B\u5F8C\u306B\u4E00\u5EA6\u3060\u3051\u53EF\u80FD\u3067\u3059\u3002",u),d.fromNode(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!1)+"\u306E\u5BA3\u8A00\u3067\u3001\u5F15\u6570\u5B9A\u7FA9\u306F\u540D\u524D\u306E\u524D\u304B\u5F8C\u306B\u4E00\u5EA6\u3060\u3051\u53EF\u80FD\u3067\u3059\u3002",u);o=this.yDefFuncReadArgs()||[]}this.check("\u3068\u306F")&&this.get();let c=this.yNop(),a=!1,f=!1;this.check("\u3053\u3053\u304B\u3089")&&(a=!0),this.check("eol")&&(a=!0);try{this.funcLevel++,this.usedAsyncFn=!1;let h=this.localvars;if(this.localvars=new Map([["\u305D\u308C",{type:"var",value:""}]]),a){this.saveStack();for(let p of o){if(!p||!p.value)continue;let y=p.value;this.localvars.set(y,{type:"var",value:""})}if(c=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else{let p=this.peek(),y=JSON.stringify(p);throw p&&p.type&&p.value&&(y=p.value),d.fromNode(`\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u95A2\u6570\u5B9A\u7FA9\u306E\u672B\u5C3E\u306B\u5FC5\u8981\u3067\u3059\u3002\u300E${y}\u300F\u306E\u524D\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,s)}this.loadStack()}else this.saveStack(),c=this.ySentence()||this.yNop(),this.loadStack();this.funcLevel--,f=this.usedAsyncFn,this.localvars=h}catch(h){throw this.logger.debug(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!0)+`\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3057\u305F\u3002
`+String(h.message),s),d.fromNode(this.nodeToStr(u,{depth:0,typeName:"\u95A2\u6570"},!1)+`\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3057\u305F\u3002
`+String(h.message),s)}let l=this.funclist.get(u.value);return l&&!l.asyncFn&&f&&(l.asyncFn=f),{type:e,name:u.value,args:o,blocks:[c],asyncFn:f,isExport:i,josi:"",meta:s.meta,...n,end:this.peekSourceMap()}}yIFCond(){let e=this.peekSourceMap(),n=this.yGetArg();if(!n)throw d.fromNode("\u300C\u3082\u3057\u300D\u6587\u306E\u6761\u4EF6\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);if(n.josi==="\u306A\u3089\u3070")return n;if(n.josi==="\u3067\u306A\u3051\u308C\u3070")return n={type:"not",operator:"not",blocks:[n],josi:"",...e,end:this.peekSourceMap()},n;if(n.josi!==""&&this.check("func"))this.stack.push(n),n=this.yCall();else if(n.josi==="\u304C"){let s=this.index,i=this.yGetArg();if(!i)throw d.fromNode("\u3082\u3057\u6587\u306E\u6761\u4EF6\u300CA\u304CB\u306A\u3089\u3070\u300D\u3067B\u304C\u306A\u3044\u304B\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);if(this.check("\u306A\u3089\u3070")){let o=this.get()||{value:"\u306A\u3089\u3070"};i.josi=o.value}if(i&&(i.josi==="\u306A\u3089\u3070"||i.josi==="\u3067\u306A\u3051\u308C\u3070"))return{type:"op",operator:i.josi==="\u3067\u306A\u3051\u308C\u3070"?"noteq":"eq",blocks:[n,i],josi:"",...e,end:this.peekSourceMap()};this.index=s}if(this.check("\u306A\u3089\u3070")||(this.stack.push(n),n=this.yCall()),!this.check("\u306A\u3089\u3070")){let s=n||this.yNop();throw this.logger.debug("\u3082\u3057\u6587\u3067\u300E\u306A\u3089\u3070\u300F\u304C\u306A\u3044\u304B\u3001\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1)+"\u306E\u76F4\u524D\u306B\u300E\u306A\u3089\u3070\u300F\u3092\u66F8\u3044\u3066\u304F\u3060\u3055\u3044\u3002",s),d.fromNode("\u3082\u3057\u6587\u3067\u300E\u306A\u3089\u3070\u300F\u304C\u306A\u3044\u304B\u3001\u6761\u4EF6\u304C\u8907\u96D1\u904E\u304E\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1)+"\u306E\u76F4\u524D\u306B\u300E\u306A\u3089\u3070\u300F\u3092\u66F8\u3044\u3066\u304F\u3060\u3055\u3044\u3002",s)}let r=this.get();if(r&&r.value==="\u3067\u306A\u3051\u308C\u3070"&&(n={type:"not",operator:"not",blocks:[n],josi:"",...e,end:this.peekSourceMap()}),!n)throw d.fromNode("\u300C\u3082\u3057\u300D\u6587\u306E\u6761\u4EF6\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002"+this.nodeToStr(this.peek(),{depth:1},!1),e);return n}yIF(){let e=this.peekSourceMap();if(!this.check("\u3082\u3057"))return null;let n=this.get();if(n==null)return null;for(;this.check("comma");)this.get();let r=null;try{r=this.yIFCond()}catch(s){throw d.fromNode(`\u300E\u3082\u3057\u300F\u6587\u306E\u6761\u4EF6\u3067\u6B21\u306E\u30A8\u30E9\u30FC\u304C\u3042\u308A\u307E\u3059\u3002
`+String(s.message),n)}return this.yIfThen(r,e)}yIfThen(e,n){let r=this.yNop(),s=this.yNop(),i=!1;if(this.check("eol"))r=this.yBlock();else{let o=this.ySentence();o&&(r=o),i=!0}for(;this.check("eol");)this.get();if(this.check("\u9055\u3048\u3070")){for(this.get();this.check("comma");)this.get();if(this.check("eol"))s=this.yBlock();else{let o=this.ySentence();o&&(s=o),i=!0}}if(i===!1)if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3082\u3057\u300F\u6587\u3067\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n);return{type:"if",blocks:[e,r,s],josi:"",...n,end:this.peekSourceMap()}}ySpeedMode(){let e=this.peekSourceMap();if(!this.check2(["string","\u5B9F\u884C\u901F\u5EA6\u512A\u5148"]))return null;let n=this.get();this.get();let r="";if(n&&n.value)r=n.value;else return null;let s={\u884C\u756A\u53F7\u7121\u3057:!1,\u6697\u9ED9\u306E\u578B\u5909\u63DB\u7121\u3057:!1,\u5F37\u5236\u30D4\u30E5\u30A2:!1,\u305D\u308C\u7121\u52B9:!1};for(let u of r.split("/")){if(u==="\u5168\u3066"){for(let c of Object.keys(s))s[c]=!0;break}Object.keys(s).includes(u)?s[u]=!0:this.logger.warn(`\u5B9F\u884C\u901F\u5EA6\u512A\u5148\u6587\u306E\u30AA\u30D7\u30B7\u30E7\u30F3\u300E${u}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,n)}let i=!1;this.check("\u3053\u3053\u304B\u3089")?(this.get(),i=!0):this.check("eol")&&(i=!0);let o=this.yNop();return i?(o=this.yBlock(),this.check("\u3053\u3053\u307E\u3067")&&this.get()):o=this.ySentence()||o,{type:"speed_mode",options:s,blocks:[o],josi:"",...e}}yPerformanceMonitor(){let e=this.peekSourceMap();if(!this.check2(["string","\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528"]))return null;let n=this.get();if(!n)return null;this.get();let r={\u30E6\u30FC\u30B6\u95A2\u6570:!1,\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u672C\u4F53:!1,\u30B7\u30B9\u30C6\u30E0\u95A2\u6570:!1};for(let o of n.value.split("/")){if(o==="\u5168\u3066"){for(let u of Object.keys(r))r[u]=!0;break}Object.keys(r).includes(o)?r[o]=!0:this.logger.warn(`\u30D1\u30D5\u30A9\u30FC\u30DE\u30F3\u30B9\u30E2\u30CB\u30BF\u9069\u7528\u6587\u306E\u30AA\u30D7\u30B7\u30E7\u30F3\u300E${o}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,n)}let s=!1;this.check("\u3053\u3053\u304B\u3089")?(this.get(),s=!0):this.check("eol")&&(s=!0);let i=this.yNop();return s?(i=this.yBlock(),this.check("\u3053\u3053\u307E\u3067")&&this.get()):i=this.ySentence()||i,{type:"performance_monitor",options:r,blocks:[i],josi:"",...e}}yTikuji(){if(!this.check("\u9010\u6B21\u5B9F\u884C"))return null;let e=this.getCur();return this.logger.error("\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F(https://nadesi.com/v3/doc/go.php?944)\u3002",e),{type:"eol",...this.peekSourceMap(),end:this.peekSourceMap()}}yGetArgOperator(e){let n=[e];for(;!this.isEOF();){let r=this.peek();if(r&&I[r.type]){r=this.getCur(),n.push(r);let s=this.yValue();if(s===null)throw d.fromNode(`\u8A08\u7B97\u5F0F\u3067\u6F14\u7B97\u5B50\u300E${r.value}\u300F\u5F8C\u306B\u5024\u304C\u3042\u308A\u307E\u305B\u3093`,e);n.push(s);continue}break}return n.length===0?null:n.length===1?n[0]:this.infixToAST(n)}yRange(e){if(!this.check("\u2026"))return null;let n=this.peekSourceMap();this.get();let r=this.yValue();if(!e||!r)throw d.fromNode("\u7BC4\u56F2\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u6307\u5B9A\u30A8\u30E9\u30FC\u3002\u300EA\u2026B\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let s=this.funclist.get("\u7BC4\u56F2");if(!s)throw new Error("\u95A2\u6570\u300E\u7BC4\u56F2\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002plugin_system\u3092\u30B7\u30B9\u30C6\u30E0\u306B\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return{type:"func",name:"\u7BC4\u56F2",blocks:[e,r],josi:r.josi,meta:s,asyncFn:!1,...n,end:this.peekSourceMap()}}yDebugPrint(){let e=this.peekSourceMap(),n=this.get();if(!n||n.value!=="??")throw d.fromNode("\u300E??\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);let r=this.yCalc();if(!r)throw d.fromNode("\u300E??(\u8A08\u7B97\u5F0F)\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);let s=this.funclist.get("\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C");if(!s)throw new Error("\u95A2\u6570\u300E\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C\u300F\u304C\u898B\u3064\u304B\u308A\u307E\u305B\u3093\u3002plugin_system\u3092\u30B7\u30B9\u30C6\u30E0\u306B\u8FFD\u52A0\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return{type:"func",name:"\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C",blocks:[r],josi:"",meta:s,asyncFn:!1,...e,end:this.peekSourceMap()}}yGetArg(){let e=this.yValue();return e===null?null:this.check("\u2026")?this.yRange(e):this.yGetArgOperator(e)}infixToPolish(e){let n=i=>I[i.type]?I[i.type]:10,r=[],s=[];for(;e.length>0;){let i=e.shift();if(!i)break;for(;r.length>0;){let o=r[r.length-1];if(n(i)>n(o))break;let u=r.pop();if(!u){this.logger.error("\u8A08\u7B97\u5F0F\u306B\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002",i);break}s.push(u)}r.push(i)}for(;r.length>0;){let i=r.pop();i&&s.push(i)}return s}infixToAST(e){if(e.length===0)return null;let n=e[e.length-1].josi,r=e[e.length-1],s=this.infixToPolish(e),i=[];for(let u of s){if(!I[u.type]){i.push(u);continue}let c=i.pop(),a=i.pop();if(a===void 0||c===void 0)throw this.logger.debug(`--- \u8A08\u7B97\u5F0F(\u9006\u30DD\u30FC\u30E9\u30F3\u30C9) ---
`+JSON.stringify(s)),d.fromNode("\u8A08\u7B97\u5F0F\u3067\u30A8\u30E9\u30FC",r);let f={type:"op",operator:u.type,blocks:[a,c],josi:n,startOffset:a.startOffset,endOffset:a.endOffset,line:a.line,column:a.column,file:a.file};i.push(f)}let o=i.pop();return o||null}yGetArgParen(e){let n=!1,r=this.stack.length;for(;!this.isEOF();){if(this.check(")")){n=!0;break}let i=this.yCalc();if(i){this.pushStack(i),this.check("comma")&&this.get();continue}break}if(!n)throw d.fromNode(`C\u98A8\u95A2\u6570\u300E${e[0].value}\u300F\u3067\u30AB\u30C3\u30B3\u304C\u9589\u3058\u3066\u3044\u307E\u305B\u3093`,e[0]);let s=[];for(;r<this.stack.length;){let i=this.popStack();i&&s.unshift(i)}return s}yRepeatTime(){let e=this.peekSourceMap();if(!this.check("\u56DE"))return null;this.get(),this.check("comma")&&this.get(),this.check("\u7E70\u8FD4")&&this.get();let n=this.popStack([])||{type:"word",value:"\u305D\u308C",josi:"",...e,end:this.peekSourceMap()},r=!1,s=this.yNop();if(this.check("comma")&&this.get(),this.check("\u3053\u3053\u304B\u3089")?(this.get(),r=!0):this.check("eol")&&(r=!0),r)if(s=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u56DE\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);else{let i=this.ySentence();i&&(s=i)}return{type:"repeat_times",blocks:[n,s],josi:"",...e,end:this.peekSourceMap()}}yWhile(){let e=this.peekSourceMap();if(!this.check("\u9593"))return null;for(this.get();this.check("comma");)this.get();this.check("\u7E70\u8FD4")&&this.get();let n=this.popStack();if(n===null)throw d.fromNode("\u300E\u9593\u300F\u3067\u6761\u4EF6\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);if(this.check("comma")&&this.get(),!this.checkTypes(["\u3053\u3053\u304B\u3089","eol"]))throw d.fromNode("\u300E\u9593\u300F\u306E\u76F4\u5F8C\u306F\u6539\u884C\u304C\u5FC5\u8981\u3067\u3059",e);let r=this.yBlock();if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u9593\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"while",blocks:[n,r],josi:"",...e,end:this.peekSourceMap()}}yAtohantei(){let e=this.peekSourceMap();this.check("\u5F8C\u5224\u5B9A")&&this.get(),this.check("\u7E70\u8FD4")&&this.get(),this.check("\u3053\u3053\u304B\u3089")&&this.get();let n=this.yBlock();this.check("\u3053\u3053\u307E\u3067")&&this.get(),this.check("comma")&&this.get();let r=this.yGetArg(),s=!1,i=this.peek();return i&&i.value==="\u306A\u308B"&&(i.josi==="\u307E\u3067"||i.josi==="\u307E\u3067\u306E")&&(this.get(),s=!0),this.check("\u9593")&&this.get(),s&&(r={type:"not",operator:"not",blocks:[r],josi:"",...e,end:this.peekSourceMap()}),r||(r={type:"number",value:1,josi:"",...e,end:this.peekSourceMap()}),{type:"atohantei",blocks:[r,n],josi:"",...e,end:this.peekSourceMap()}}yFor(){let e="\u300E\u7E70\u308A\u8FD4\u3059\u300F\u6587\u3067A\u304B\u3089B\u307E\u3067\u306E\u6307\u5B9A\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n=!0,r=!0,s=null,i=this.peekSourceMap();if(!(this.check("\u7E70\u8FD4")||this.check("\u5897\u7E70\u8FD4")||this.check("\u6E1B\u7E70\u8FD4")))return null;let o=this.getCur(),u=this.stack.pop();if(u)if(u.type==="word"&&(u.value==="\u5897"||u.value==="\u6E1B")){u.value==="\u5897"?n=!1:r=!1;let m=String(u.value)+o.type;if(m==="\u5897\u7E70\u8FD4")o.type="\u5897\u7E70\u8FD4";else if(m==="\u6E1B\u7E70\u8FD4")o.type="\u6E1B\u7E70\u8FD4";else throw Error("[System Error] \u5897\u7E70\u308A\u8FD4\u3057 | \u6E1B\u7E70\u308A\u8FD4\u3057\u306E\u30A8\u30E9\u30FC\u3002")}else this.stack.push(u);let c=this.yNop();(o.type==="\u5897\u7E70\u8FD4"||o.type==="\u6E1B\u7E70\u8FD4")&&(c=this.popStack(["\u305A\u3064"])||this.yNop(),o.type==="\u5897\u7E70\u8FD4"?n=!1:r=!1,s=o.type==="\u5897\u7E70\u8FD4"?"up":"down");let a=this.popStack(["\u307E\u3067","\u3092"]),f=this.popStack(["\u304B\u3089"])||this.yNop(),l=this.popStack(["\u3092","\u3067"]),h="";if(l!==null){if(l.type!=="word")throw d.fromNode("\u300E(\u5909\u6570\u540D)\u3092A\u304B\u3089B\u307E\u3067\u7E70\u308A\u8FD4\u3059\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",l);h=l.value}if((f===null||a===null)&&!(f==null&&a&&a.type==="func"&&a.name==="\u7BC4\u56F2"))throw d.fromNode(e,o);this.check("comma")&&this.get();let p=!1;this.check("\u3053\u3053\u304B\u3089")?(p=!0,this.get()):this.check("eol")&&(p=!0,this.get());let y=this.yNop();if(p)if(y=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u7E70\u308A\u8FD4\u3059\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",i);else{let m=this.ySentence();m&&(y=m)}return y||(y=this.yNop()),{type:"for",blocks:[f,a,c,y],flagDown:n,flagUp:r,loopDirection:s,word:h,josi:"",...i,end:this.peekSourceMap()}}yReturn(){let e=this.peekSourceMap();if(!this.check("\u623B\u308B"))return null;this.get();let n=this.popStack(["\u3067","\u3092"])||this.yNop();if(this.stack.length>0)throw d.fromNode("\u300E\u623B\u300F\u6587\u306E\u76F4\u524D\u306B\u672A\u89E3\u6C7A\u306E\u5F15\u6570\u304C\u3042\u308A\u307E\u3059\u3002\u300E(\u5F0F)\u3092\u623B\u3059\u300F\u306E\u3088\u3046\u306B\u5F0F\u3092\u30AB\u30C3\u30B3\u3067\u62EC\u3063\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"return",blocks:[n],josi:"",...e,end:this.peekSourceMap()}}yForEach(){let e=this.peekSourceMap();if(!this.check("\u53CD\u5FA9"))return null;for(this.get();this.check("comma");)this.get();let n=this.popStack(["\u3092"])||this.yNop(),r=this.popStack(["\u3067"]),s="";if(r!==null){if(r.type!=="word")throw d.fromNode("\u300E(\u5909\u6570\u540D)\u3067(\u914D\u5217)\u3092\u53CD\u5FA9\u300F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e);s=r.value}let i=this.yNop(),o=!1;if(this.check("\u3053\u3053\u304B\u3089")?(o=!0,this.get()):this.check("eol")&&(o=!0),o)if(i=this.yBlock(),this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u53CD\u5FA9\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);else{let u=this.ySentence();u&&(i=u)}return{type:"foreach",word:s,blocks:[n,i],josi:"",...e,end:this.peekSourceMap()}}ySwitch(){let e=this.peekSourceMap();if(!this.check("\u6761\u4EF6\u5206\u5C90"))return null;let n=this.get();if(!n)return null;let r=this.get();if(!r)return null;let s=this.popStack(["\u3067"]);if(!s)throw d.fromNode("\u300E(\u5024)\u3067\u6761\u4EF6\u5206\u5C90\u300F\u306E\u3088\u3046\u306B\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);if(r.type!=="eol")throw d.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u306E\u76F4\u5F8C\u306F\u6539\u884C\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let i=[];for(i[0]=s,i[1]=this.yNop();!this.isEOF();){if(this.check("eol")){this.get();continue}if(this.check("\u3053\u3053\u307E\u3067")){this.get();break}let u=this.peek();if(u&&u.type==="\u9055\u3048\u3070"){this.get(),this.check("comma")&&this.get();let h=this.yBlock();for(this.check("\u3053\u3053\u307E\u3067")&&this.get();this.check("eol");)this.get();this.check("\u3053\u3053\u307E\u3067")&&this.get(),i[1]=h;break}let c=this.yValue();if(!c)throw d.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u306F\u300E(\u6761\u4EF6)\u306A\u3089\u3070\u301C\u3053\u3053\u307E\u3067\u300F\u3068\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);let a=this.get();if(!a||a.type!=="\u306A\u3089\u3070")throw d.fromNode("\u300E\u6761\u4EF6\u5206\u5C90\u300F\u3067\u6761\u4EF6\u306F\uFF0A\uFF0A\u306A\u3089\u3070\u3068\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",n);this.check("comma")&&this.get();let f=this.yBlock(),l=this.peek();l&&l.type==="\u3053\u3053\u307E\u3067"&&this.get(),i.push(c),i.push(f)}return{type:"switch",blocks:i,case_count:i.length/2-1,josi:"",...e,end:this.peekSourceMap()}}yMumeiFunc(){let e=this.peekSourceMap();if(!this.check("def_func"))return null;let n=this.get();if(!n)return null;let r=n,s=[];this.check("comma")&&this.get(),this.check("(")&&(s=this.yDefFuncReadArgs()||[]),this.check("comma")&&this.get(),this.funcLevel++,this.saveStack();let i=this.usedAsyncFn;this.usedAsyncFn=!1;let o=this.yBlock(),u=this.usedAsyncFn;if(!this.check("\u3053\u3053\u307E\u3067"))throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u306B\u306F\u300F\u69CB\u6587\u304B\u7121\u540D\u95A2\u6570\u306E\u672B\u5C3E\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u5FC5\u8981\u3067\u3059\u3002",e);return this.get(),this.loadStack(),this.usedAsyncFn=i,this.funcLevel--,{type:"func_obj",name:"",args:s,blocks:[o],meta:r.meta,josi:"",isExport:!1,asyncFn:u,...e,end:this.peekSourceMap()}}yDainyu(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;let r=this.popStack(["\u3092"])||{type:"word",value:"\u305D\u308C",josi:"\u3092",...e},s=this.popStack(["\u3078","\u306B"]);if(!s||s.type!=="word"&&s.type!=="func"&&s.type!=="ref_array")throw d.fromNode("\u4EE3\u5165\u6587\u3067\u4EE3\u5165\u5148\u306E\u5909\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5909\u6570\u540D)\u306B(\u5024)\u3092\u4EE3\u5165\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002",n);if(s.type==="func")throw d.fromNode("\u95A2\u6570\u300E"+String(s.name)+"\u300F\u306B\u4EE3\u5165\u3067\u304D\u307E\u305B\u3093\u3002\u300E(\u5909\u6570\u540D)\u306B(\u5024)\u3092\u4EE3\u5165\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002",n);if(s.type==="ref_array"){let o=s.index||[],u=[r,...o];return{type:"let_array",name:s.name.value,indexes:s.index,blocks:u,josi:"",checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return{type:"let",name:this.getVarName(s).value,blocks:[r],josi:"",...e,end:this.peekSourceMap()}}ySadameru(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;let r=this.popStack(["\u3092"])||{type:"word",value:"\u305D\u308C",josi:"\u3092",...e,end:this.peekSourceMap()};if(!r||r.type!=="word"&&r.type!=="func"&&r.type!=="ref_array")throw d.fromNode("\u300E\u5B9A\u3081\u308B\u300F\u6587\u3067\u5B9A\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5B9A\u6570\u540D)\u3092(\u5024)\u306B\u5B9A\u3081\u308B\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002",n);let s=this.popStack(["\u3078","\u306B","\u3068"])||this.yNop(),i=this.isExportDefault;if(this.check2(["{","word","}"])){this.get();let u=this.get();if(u===null)throw d.fromNode("\u5B9A\u3081\u308B\u300E"+r.value+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",r);let c=u.value;c==="\u516C\u958B"?i=!0:c==="\u975E\u516C\u958B"?i=!1:c==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?i=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${c}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),this.get()}return{type:"def_local_var",name:this.createVar(r,!0,i).value,vartype:"\u5B9A\u6570",isExport:i,blocks:[s],josi:"",...e,end:this.peekSourceMap()}}yIncDec(){let e=this.peekSourceMap(),n=this.get();if(n===null)return null;if(this.check("\u7E70\u8FD4"))return this.pushStack({type:"word",value:n.value,josi:n.josi,...e,end:this.peekSourceMap()}),this.yFor();let r=this.popStack(["\u3092"]);if(!r||r.type!=="word"&&r.type!=="ref_array")throw d.fromNode(`\u300E${n.type}\u300F\u6587\u3067\u5B9A\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u300E(\u5909\u6570\u540D)\u3092(\u5024)\u3060\u3051${n.type}\u300F\u306E\u3088\u3046\u306B\u4F7F\u3044\u307E\u3059\u3002`,n);let s=this.popStack(["\u3060\u3051",""]);if(s||(s={type:"number",value:1,josi:"\u3060\u3051",...e,end:this.peekSourceMap()}),n.value==="\u6E1B"){let i={type:"number",value:-1,line:n.line};s={type:"op",operator:"*",blocks:[s,i],josi:"",...e}}return{type:"inc",name:r,blocks:[s],josi:n.josi,...e,end:this.peekSourceMap()}}yCall(){if(this.isEOF())return null;for(;!this.isEOF();){if(this.check("\u3053\u3053\u304B\u3089")&&this.get(),this.check("\u4EE3\u5165"))return this.yDainyu();if(this.check("\u5B9A\u3081\u308B"))return this.ySadameru();if(this.check("\u56DE"))return this.yRepeatTime();if(this.check("\u9593"))return this.yWhile();if(this.check("\u7E70\u8FD4")||this.check("\u5897\u7E70\u8FD4")||this.check("\u6E1B\u7E70\u8FD4"))return this.yFor();if(this.check("\u53CD\u5FA9"))return this.yForEach();if(this.check("\u6761\u4EF6\u5206\u5C90"))return this.ySwitch();if(this.check("\u623B\u308B"))return this.yReturn();if(this.check("\u5897")||this.check("\u6E1B"))return this.yIncDec();if(this.check2([["func","word"],"("])){let n=this.peek();if(n&&n.josi===""){let r=this.yValue();if(r){let s=r.josi||"";if(r.type==="func"&&(r.josi===""||U.indexOf(s)>=0))return r.josi="",r;this.pushStack(r)}this.check("comma")&&this.get();continue}}if(this.check("func")){let n=this.yCallFunc();if(n===null)continue;if(this.check("\u9593")){this.pushStack(n);continue}if(!this.checkTypes(oe))return n;let r=this.yGetArgOperator(n);this.pushStack(r);continue}let e=this.yGetArg();if(e){this.pushStack(e);continue}break}if(this.stack.length>0){if(this.isReadingCalc)return this.popStack();this.logger.debug(`--- stack dump ---
`+JSON.stringify(this.stack,null,2)+`
peek: `+JSON.stringify(this.peek(),null,2));let e=`\u4E0D\u5B8C\u5168\u306A\u6587\u3067\u3059\u3002${this.stack.map(i=>this.nodeToStr(i,{depth:0},!0)).join("\u3001")}\u304C\u89E3\u6C7A\u3057\u3066\u3044\u307E\u305B\u3093\u3002`,n=`\u4E0D\u5B8C\u5168\u306A\u6587\u3067\u3059\u3002${this.stack.map(i=>this.nodeToStr(i,{depth:0},!1)).join("\u3001")}\u304C\u89E3\u6C7A\u3057\u3066\u3044\u307E\u305B\u3093\u3002`;for(let i of this.stack){let o=this.nodeToStr(i,{depth:0},!1),u=this.nodeToStr(i,{depth:1},!1);o!==u&&(e+=`${this.nodeToStr(i,{depth:0},!0)}\u306F${this.nodeToStr(i,{depth:1},!0)}\u3068\u3057\u3066\u4F7F\u308F\u308C\u3066\u3044\u307E\u3059\u3002`,n+=`${o}\u306F${u}\u3068\u3057\u3066\u4F7F\u308F\u308C\u3066\u3044\u307E\u3059\u3002`)}let r=this.stack[0],s=this.stack[this.stack.length-1];throw this.logger.debug(e,r),d.fromNode(n,r,s)}return this.popStack([])}yCallFunc(){let e=this.peekSourceMap(),n=this.get();if(!n)return null;let r=n,s=r.meta,i=r.value,o=null;if(r.josi==="\u306B\u306F"){try{o=this.yMumeiFunc()}catch(l){throw d.fromNode(`\u300E${r.value}\u306B\u306F...\u300F\u3067\u7121\u540D\u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u4EE5\u4E0B\u306E\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${l.message}`,r)}if(o===null)throw d.fromNode("\u300EF\u306B\u306F\u300F\u69CB\u6587\u304C\u3042\u308A\u307E\u3057\u305F\u304C\u3001\u95A2\u6570\u5B9A\u7FA9\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002",r)}if(!s||typeof s.josi>"u")throw d.fromNode("\u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30A8\u30E9\u30FC\u3002",r);this.recentlyCalledFunc.push({name:i,...s}),s&&s.asyncFn&&(this.usedAsyncFn=!0);let u=[],c=0,a=0;for(let l=s.josi.length-1;l>=0;l--)for(;;){let h=this.popStack(s.josi[l]);if(h!==null)a++;else if(l<s.josi.length-1||!s.isVariableJosi)c++,h=o;else break;if(h!==null&&s.funcPointers!==void 0&&s.funcPointers[l]!==null)if(h.type==="func")h.type="func_pointer";else{let p=s.varnames?s.varnames[l]:`${l+1}\u756A\u76EE\u306E\u5F15\u6570`;throw d.fromNode(`\u95A2\u6570\u300E${r.value}\u300F\u306E\u5F15\u6570\u300E${p}\u300F\u306B\u306F\u95A2\u6570\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304C\u5FC5\u8981\u3067\u3059\u3002`,r)}if(h===null&&(h={type:"word",value:"\u305D\u308C",josi:"",...e,end:e}),u.unshift(h),l<s.josi.length-1||!s.isVariableJosi)break}if(c>=2&&(a>0||r.josi===""||U.indexOf(r.josi)>=0))throw d.fromNode(`\u95A2\u6570\u300E${r.value}\u300F\u306E\u5F15\u6570\u304C\u4E0D\u8DB3\u3057\u3066\u3044\u307E\u3059\u3002`,r);this.usedFuncs.add(r.value);let f={type:"func",name:r.value,blocks:u,meta:s,josi:r.josi,asyncFn:!!s.asyncFn,...e,end:this.peekSourceMap()};if(f.name==="\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A"){if(u.length>0&&u[0]){let l=String(u[0].value);l==="\u30E1\u30A4\u30F3"&&(l=String(u[0].file)),this.namespaceStack.push(this.modName),this.isExportStack.push(this.isExportDefault),this.modName=T.filenameToModName(l),this.modList.push(this.modName)}}else if(f.name==="\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7"){let l=this.namespaceStack.pop();l&&(this.modName=l);let h=this.isExportStack.pop();h!=null&&(this.isExportDefault=h)}return r.josi===""?f:U.indexOf(r.josi)>=0?(f.josi="\u3057\u3066",f):(f.meta=s,this.pushStack(f),null)}yLet(){let e=this.peekSourceMap();if(this.check2(["word","eq"])){let n=this.peek(),r=!1;try{if(this.accept(["word","eq",this.yCalc])||this.accept(["word","eq",this.ySentence])){if(this.y[2].type==="eol")throw new Error("\u5024\u304C\u7A7A\u3067\u3059\u3002");this.check("comma")&&this.get();let s=this.getVarName(this.y[0]),i=this.y[2];return{type:"let",name:s.value,blocks:[i],josi:"",...e,end:this.peekSourceMap()}}else throw r=!0,this.logger.debug(`${this.nodeToStr(n,{depth:1},!0)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,n),d.fromNode(`${this.nodeToStr(n,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,e)}catch(s){throw r?s:(this.logger.debug(`${this.nodeToStr(n,{depth:1},!0)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u4EE5\u4E0B\u306E\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${s.message}`,n),d.fromNode(`${this.nodeToStr(n,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u3067\u8A08\u7B97\u5F0F\u306B\u4EE5\u4E0B\u306E\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002
${s.message}`,e))}}if(this.check2(["word","$","*","$","*","$","*","$","*","eq"])||this.check2(["word","$","*","$","*","$","*","eq"])||this.check2(["word","$","*","$","*","eq"])||this.check2(["word","$","*","eq"])){let n=[],r=this.getVarName(this.get());for(;;){let i=this.peek();if(i===null||i.type!=="$")break;this.get(),n.push(this.get())}this.get();let s=this.yCalc();if(s===null)throw d.fromNode(`${this.nodeToStr(r,{depth:1},!1)}\u3078\u306E\u4EE3\u5165\u6587\u306E\u8A08\u7B97\u5F0F\u306B\u66F8\u304D\u9593\u9055\u3044\u304C\u3042\u308A\u307E\u3059\u3002`,e);return{type:"let_prop",name:r.value,index:n,blocks:[s],josi:"",...e,end:this.peekSourceMap()}}if(this.check2(["word","@"])){let n=this.yLetArrayAt(e);if(this.check("comma")&&this.get(),n)return n.checkInit=this.flagCheckArrayInit,n}if(this.check2(["word","["])){let n=this.yLetArrayBracket(e);if(this.check("comma")&&this.get(),n)return n.checkInit=this.flagCheckArrayInit,n}if(this.accept(["word","\u3068\u306F"])){let n=this.y[0];if(!this.checkTypes(["\u5909\u6570","\u5B9A\u6570"]))throw d.fromNode("\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u300E"+String(n.value)+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",n);let r=this.getCur(),s=this.isExportDefault;if(this.check2(["{","word","}"])){this.get();let u=this.get();if(u===null)throw d.fromNode("\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u300E"+String(n.value)+"\u300F\u306E\u5B9A\u7FA9\u30A8\u30E9\u30FC",n);let c=u.value;c==="\u516C\u958B"?s=!0:c==="\u975E\u516C\u958B"?s=!1:c==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?s=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${c}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`),this.get()}let i=this.createVar(n,r.type==="\u5B9A\u6570",s),o=this.yNop();return this.check("eq")&&(this.get(),o=this.yCalc()||o),this.check("comma")&&this.get(),{type:"def_local_var",name:i.value,vartype:r.type,isExport:s,blocks:[o],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570","word"])){let n=this.y[1];if(this.index-=2,this.accept(["\u5909\u6570","word","eq",this.yCalc])){let r=this.createVar(this.y[1],!1,this.isExportDefault),s=this.y[3]||this.yNop();return{type:"def_local_var",name:r.value,vartype:"\u5909\u6570",blocks:[s],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570","word","{","word","}","eq",this.yCalc])){let r=this.isExportDefault,s=this.y[3].value;s==="\u516C\u958B"?r=!0:s==="\u975E\u516C\u958B"?r=!1:s==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?r=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5909\u6570\u5C5E\u6027\u300E${s}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`);let i=this.createVar(this.y[1],!1,r),o=this.y[6]||this.yNop();return{type:"def_local_var",name:i.value,vartype:"\u5909\u6570",isExport:r,blocks:[o],...e,end:this.peekSourceMap()}}return this.index+=2,{type:"def_local_var",name:this.createVar(n,!1,this.isExportDefault).value,vartype:"\u5909\u6570",blocks:[this.yNop()],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570","word","eq"])){let n=this.y[1],r=this.createVar(n,!0,this.isExportDefault),s=this.yCalc()||this.yNop();return{type:"def_local_var",name:r.value,vartype:"\u5B9A\u6570",blocks:[s],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570","word","{","word","}","eq"])){let n=this.isExportDefault,r=this.y[3].value;r==="\u516C\u958B"?n=!0:r==="\u975E\u516C\u958B"?n=!1:r==="\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8"?n=!0:this.logger.warn(`\u4E0D\u660E\u306A\u5B9A\u6570\u5C5E\u6027\u300E${r}\u300F\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u3059\u3002`);let s=this.createVar(this.y[1],!0,n),i=this.yCalc()||this.yNop();return{type:"def_local_var",name:s.value,vartype:"\u5B9A\u6570",isExport:n,blocks:[i],...e,end:this.peekSourceMap()}}if(this.accept(["\u5B9A\u6570",this.yJSONArray,"eq"])){let n=this.y[1];if(n&&n.blocks instanceof Array){for(let i in n.blocks)if(n.blocks[i].type!=="word")throw d.fromNode(`\u8907\u6570\u5B9A\u6570\u306E\u4EE3\u5165\u6587${Number(i)+1}\u756A\u76EE\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5B9A\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,this.y[0])}else throw d.fromNode("\u8907\u6570\u5B9A\u6570\u306E\u4EE3\u5165\u6587\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5B9A\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",this.y[0]);let r=this._tokensToNodes(this.createVarList(n.blocks,!0,this.isExportDefault)),s=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:r,vartype:"\u5B9A\u6570",blocks:[s],...e,end:this.peekSourceMap()}}if(this.accept(["\u5909\u6570",this.yJSONArray,"eq"])){let n=this.y[1];if(n&&n.blocks instanceof Array)n.blocks.forEach((i,o)=>{if(i.type!=="word")throw d.fromNode(`\u8907\u6570\u5909\u6570\u306E\u4EE3\u5165\u6587${String(o+1)}\u756A\u76EE\u3067\u30A8\u30E9\u30FC\u300E\u5909\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,this.y[0])});else throw d.fromNode("\u8907\u6570\u5909\u6570\u306E\u4EE3\u5165\u6587\u3067\u30A8\u30E9\u30FC\u3002\u300E\u5909\u6570[A,B,C]=[1,2,3]\u300F\u306E\u66F8\u5F0F\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002",this.y[0]);let r=this._tokensToNodes(this.createVarList(n.blocks,!1,this.isExportDefault)),s=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:r,vartype:"\u5909\u6570",blocks:[s],...e,end:this.peekSourceMap()}}if(this.check2(["word","comma","word"])){if(this.accept(["word","comma","word","eq"])){let n=[this.y[0],this.y[2]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","eq"])){let n=[this.y[0],this.y[2],this.y[4]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","comma","word","eq"])){let n=[this.y[0],this.y[2],this.y[4],this.y[6]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}if(this.accept(["word","comma","word","comma","word","comma","word","comma","word","eq"])){let n=[this.y[0],this.y[2],this.y[4],this.y[6],this.y[8]];n=this.createVarList(n,!1,this.isExportDefault);let r=this.yCalc()||this.yNop();return{type:"def_local_varlist",names:n,vartype:"\u5909\u6570",blocks:[r],...e,end:this.peekSourceMap()}}}return null}checkArrayIndex(e){if(this.arrayIndexFrom===0)return e;let n={...e,type:"number",value:this.arrayIndexFrom};return{...e,type:"op",operator:"-",blocks:[e,n]}}checkArrayReverse(e){return e?!this.flagReverseArrayIndex||e.length<=1?e:e.reverse():[]}yLetArrayAt(e){if(this.accept(["word","@",this.yValue,"eq",this.yCalc])){let n=this.y[4];return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,this.checkArrayIndex(this.y[2])],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"@",this.yValue,"eq",this.yCalc])){let n=this.y[6],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"@",this.yValue,"@",this.yValue,"eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"comma",this.yValue,"eq",this.yCalc])){let n=this.y[6],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","@",this.yValue,"comma",this.yValue,"comma",this.yValue,"eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return null}yLetArrayBracket(e){if(this.accept(["word","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[5],r=[this.checkArrayIndex(this.y[2])];return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"]","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[8],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[5])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],tag:"2",checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"comma",this.yCalc,"]","eq",this.yCalc])){let n=this.y[7],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,tag:"2",...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"]","[",this.yCalc,"]","[",this.yCalc,"]","eq",this.yCalc])){let n=this.y[11],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[5]),this.checkArrayIndex(this.y[8])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}if(this.accept(["word","[",this.yCalc,"comma",this.yCalc,"comma",this.yCalc,"]","eq",this.yCalc])){let n=this.y[9],r=this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]);return{type:"let_array",name:this.getVarName(this.y[0]).value,index:this.checkArrayReverse([this.checkArrayIndex(this.y[2]),this.checkArrayIndex(this.y[4]),this.checkArrayIndex(this.y[6])]),blocks:[n,...r],checkInit:this.flagCheckArrayInit,...e,end:this.peekSourceMap()}}return null}yCalc(){let e=this.peekSourceMap();if(this.check("eol"))return null;let n=this.yGetArg();if(!n)return null;if(n.josi==="")return n;let r=this.isReadingCalc;this.isReadingCalc=!0,this.pushStack(n);let s=this.yCall();if(this.isReadingCalc=r,!s)return this.popStack();let i=s;if(U.indexOf(s.josi||"")>=0){let u=this.yCalc();u&&(i={type:"renbun",operator:"renbun",blocks:[s,u],josi:u.josi,...e,end:this.peekSourceMap()})}let o=this.peek();return o&&I[o.type]?this.yGetArgOperator(i):i}yValueKakko(){if(!this.check("("))return null;let e=this.get();if(!e)throw new Error("[System Error] check \u3057\u305F\u306E\u306B get \u3067\u304D\u306A\u3044");this.saveStack();let n=this.yCalc()||this.ySentence();if(n===null){let s=this.get();throw this.logger.debug("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(s,{depth:1},!0)+"\u306E\u8FD1\u304F",e),d.fromNode("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(s,{depth:1},!1)+"\u306E\u8FD1\u304F",e)}if(!this.check(")"))throw this.logger.debug("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(n,{depth:1},!0)+"\u306E\u8FD1\u304F",e),d.fromNode("(...)\u306E\u89E3\u6790\u30A8\u30E9\u30FC\u3002"+this.nodeToStr(n,{depth:1},!1)+"\u306E\u8FD1\u304F",e);let r=this.get();return this.loadStack(),r&&(n.josi=r.josi),this.yRefArrayValue(n)}yConst(e,n){return{type:e.type,value:e.value,josi:e.josi,...n}}yValue(){let e=this.peekSourceMap();if(this.check("comma")&&this.get(),this.checkTypes(["number","bigint","string"]))return this.yConst(this.getCur(),e);if(this.check("("))return this.yValueKakko();if(this.check2(["-","number"])||this.check2(["-","word"])||this.check2(["-","func"])){let o=this.get(),u=this.yValue(),c=u&&u.josi?u.josi:"",f={type:"number",value:-1,line:o&&o.line?o.line:0},l=u||this.yNop();return{type:"op",operator:"*",blocks:[f,l],josi:c,...e,end:this.peekSourceMap()}}if(this.check("not")){this.get();let o=this.yValue(),u=o&&o.josi?o.josi:"";return{type:"not",operator:"not",blocks:[o],josi:u,...e,end:this.peekSourceMap()}}let n=this.yJSONArray();if(n)return n;let r=this.yJSONObject();if(r)return r;if(this.check("func")){let o=this.peek();if(!o)throw new Error("[System Error] \u6B63\u3057\u304F\u5024\u304C\u53D6\u308C\u307E\u305B\u3093\u3067\u3057\u305F\u3002");let u=oe.concat(["eol",")","]","\u306A\u3089\u3070","\u56DE","\u9593","\u53CD\u5FA9","\u6761\u4EF6\u5206\u5C90"]);if(this.check2(["func",u])||o?.josi&&o.josi!==""){this.get();let c=o,a=this.getVarNameRef(c);this.usedFuncs.add(a.value);let f=c.meta,l=[];if(!f)throw d.fromNode(`\u4E00\u8A9E\u95A2\u6570\u300E${a.value}\u300F\u306F\u5B58\u5728\u3057\u307E\u305B\u3093\u3002`,c);if(f.josi&&f.josi.length===1)l.push({type:"word",value:"\u305D\u308C"});else if(f.josi&&f.josi.length>=2)throw d.fromNode(`\u95A2\u6570\u300E${a.value}\u300F\u3067\u5F15\u6570\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002${f.josi.length}\u500B\u306E\u5F15\u6570\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,c);return{type:"func",name:a.value,blocks:l,josi:a.josi,meta:f,asyncFn:!!f.asyncFn,...e,end:this.peekSourceMap()}}}if(this.check2([["func","word"],"("])&&this.peekDef().josi===""){let o=this.peek();if(this.accept([["func","word"],"(",this.yGetArgParen,")"])){let u=this.getVarNameRef(this.y[0]),c=u.meta,a=this.y[2],f=u.value,l=!1;if(this.usedFuncs.add(f),c&&c.josi){if(c.josi.length!==a.length){if(!c.isVariableJosi)throw d.fromNode(`\u95A2\u6570\u300E${u.value}\u300F\u3067\u5F15\u6570${a.length}\u500B\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u304C\u3001${c.josi.length}\u500B\u306E\u5F15\u6570\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,u)}l=!!c.asyncFn}return{type:"func",name:f,blocks:a,josi:this.y[3].josi,meta:c,asyncFn:l,...e,end:this.peekSourceMap()}}throw d.fromNode("C\u98A8\u95A2\u6570\u547C\u3073\u51FA\u3057\u306E\u30A8\u30E9\u30FC",o||x())}if(this.check("def_func"))return this.yMumeiFunc();let s=this.yValueWord();if(s)return s;let i=this.yValueFuncPointer();return i||null}yValueWordGetIndex(e){if(e.index||(e.index=[]),this.check("@")){if(this.accept(["@",this.yValue,"comma",this.yValue,"comma",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.index.push(this.checkArrayIndex(this.y[3])),e.index.push(this.checkArrayIndex(this.y[5])),e.index=this.checkArrayReverse(e.index),e.josi=this.y[5].josi,!0;if(this.accept(["@",this.yValue,"comma",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.index.push(this.checkArrayIndex(this.y[3])),e.index=this.checkArrayReverse(e.index),e.josi=this.y[3].josi,!0;if(this.accept(["@",this.yValue]))return e.index.push(this.checkArrayIndex(this.y[1])),e.josi=this.y[1].josi,!0;throw d.fromNode("\u5909\u6570\u306E\u5F8C\u308D\u306E\u300E@\u8981\u7D20\u300F\u306E\u6307\u5B9A\u304C\u4E0D\u6B63\u3067\u3059\u3002",e)}if(this.check("[")&&this.accept(["[",this.yCalc,"]"]))return e.index.push(this.checkArrayIndex(this.y[1])),e.josi=this.y[2].josi,this.y[2].josi==="";if(this.check("[")&&this.accept(["[",this.yCalc,"comma",this.yCalc,"]"])){let n=[this.checkArrayIndex(this.y[1]),this.checkArrayIndex(this.y[3])],r=e.index.pop();return e.index=this.checkArrayReverse(n),r&&e.index.unshift(r),e.josi=this.y[4].josi,this.y[4].josi===""}if(this.check("[")&&this.accept(["[",this.yCalc,"comma",this.yCalc,"comma",this.yCalc,"]"])){let n=[this.checkArrayIndex(this.y[1]),this.checkArrayIndex(this.y[3]),this.checkArrayIndex(this.y[5])],r=e.index.pop();return e.index=this.checkArrayReverse(n),r&&e.index.unshift(r),e.josi=this.y[6].josi,this.y[6].josi===""}return!1}yValueWordGetProp(e){if(e.index||(e.index=[]),this.check("$")){if(this.accept(["$","word"]))return this.y[1].type="string",e.index.push(this.y[1]),e.josi=this.y[1].josi,this.y[1].josi==="";if(this.accept(["$",this.yValue]))return e.index.push(this.y[1]),e.josi=this.y[1].josi,this.y[1].josi===""}return!1}yValueFuncPointer(){let e=this.peekSourceMap();if(this.check("func_pointer")){let n=this.getCur();return{type:"func_pointer",name:n.value,josi:n.josi,...e,end:this.peekSourceMap()}}return null}yValueWord(){let e=this.peekSourceMap();if(this.check("word")){let n=this.getCur(),r=this.getVarNameRef(n);if(r.josi===""&&this.checkTypes(["[","@"])){let s={type:"ref_array",name:r,index:[],josi:"",...e,end:this.peekSourceMap()};for(;!this.isEOF()&&this.yValueWordGetIndex(s););if(s.index&&s.index.length===0)throw d.fromNode(`\u914D\u5217\u300E${r.value}\u300F\u30A2\u30AF\u30BB\u30B9\u3067\u6307\u5B9A\u30DF\u30B9`,r);return s}if(r.josi===""&&(this.check2(["$","word"])||this.check2(["$","string"]))){let s=[],i="";for(;this.check("$");){this.get();let o=this.get();s.push(o),i=o.josi}return{type:"ref_prop",name:r,index:s,josi:i,...e,end:this.peekSourceMap()}}return r}return null}createVar(e,n,r){let s=e.value,i=n?"const":"var";if(this.funcLevel===0){s.indexOf("__")<0&&(s=this.modName+"__"+s);let o={type:i,value:"",isExport:r};this.funclist.set(s,o);let u=e;return u.value=s,e}else return this.localvars.set(s,{type:i,value:""}),e}getVarName(e){let n=this.findVar(e.value);return n?(n&&n.scope==="global"&&(e.value=n.name),e):(this.createVar(e,!1,this.isExportDefault),e)}getVarNameRef(e){let n=this.findVar(e.value);return n?n&&n.scope==="global"&&(e.value=n.name):this.funcLevel===0&&e.value.indexOf("__")<0&&(e.value=this.modName+"__"+String(e.value)),e}createVarList(e,n,r){for(let s=0;s<e.length;s++)e[s]=this.createVar(e[s],n,r);return e}yJSONObjectValue(){let e=[],n=this.peek();if(!n)return[];for(;!this.isEOF();){for(;this.check("eol");)this.get();if(this.check("}"))break;if(this.accept(["word",":",this.yCalc]))this.y[0].type="string",e.push(this.y[0]),e.push(this.y[2]);else if(this.accept(["string",":",this.yCalc]))e.push(this.y[0]),e.push(this.y[2]);else if(this.accept(["word"])){let r=this.y[0],s=JSON.parse(JSON.stringify(r));r.type="string",e.push(r),e.push(s)}else if(this.checkTypes(["string","number"])){let r=this.getCur();e.push(r),e.push(r)}else throw d.fromNode("\u8F9E\u66F8\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u5BA3\u8A00\u3067\u672B\u5C3E\u306E\u300E}\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002",n);this.check("comma")&&this.get()}return e}yJSONObject(){let e=this.yJSONObjectRaw();return e?this.yRefArrayValue(e):null}yJSONObjectRaw(){let e=this.peekSourceMap();if(this.accept(["{","}"]))return{type:"json_obj",blocks:[],josi:this.y[1].josi,...e,end:this.peekSourceMap()};if(this.accept(["{",this.yJSONObjectValue,"}"]))return{type:"json_obj",blocks:this.y[1],josi:this.y[2].josi,...e,end:this.peekSourceMap()};if(this.accept(["{",this.yJSONObjectValue]))throw d.fromNode("\u8F9E\u66F8\u578B\u5909\u6570\u306E\u521D\u671F\u5316\u304C\u300E}\u300F\u3067\u9589\u3058\u3089\u308C\u3066\u3044\u307E\u305B\u3093\u3002",this.y[1]);return null}yJSONArrayValue(){this.check("eol")&&this.get();let e=this.yCalc();if(e===null)return[];this.check("comma")&&this.get();let n=[e];for(;!this.isEOF()&&(this.check("eol")&&this.get(),!this.check("]"));){let r=this.yCalc();if(r===null)break;this.check("comma")&&this.get(),n.push(r)}return n}yRefArrayValue(e){let n=e;for(;;){if(n.josi===""&&this.checkTypes(["@","["])){let r={type:"ref_array_value",name:"@",index:[n],josi:"",line:n.line,end:this.peekSourceMap()};for(;!this.isEOF()&&this.yValueWordGetIndex(r););n=r;continue}if(this.check("$")){let r={type:"ref_array_value",name:"$",index:[n],josi:"",line:n.line,end:this.peekSourceMap()};for(;!this.isEOF()&&this.yValueWordGetProp(r););n=r;continue}break}return n}yJSONArray(){let e=this.yJSONArrayRaw();return e?this.yRefArrayValue(e):null}yJSONArrayRaw(){let e=this.peekSourceMap();if(this.accept(["[","]"]))return{type:"json_array",blocks:[],josi:this.y[1].josi,...e,end:this.peekSourceMap()};if(this.accept(["[",this.yJSONArrayValue,"]"]))return{type:"json_array",blocks:this.y[1],josi:this.y[2].josi,...e,end:this.peekSourceMap()};if(this.accept(["[",this.yJSONArrayValue]))throw d.fromNode("\u914D\u5217\u5909\u6570\u306E\u521D\u671F\u5316\u304C\u300E]\u300F\u3067\u9589\u3058\u3089\u308C\u3066\u3044\u307E\u305B\u3093\u3002",this.y[1]);return null}yTryExcept(){let e=this.peekSourceMap();if(!this.check("\u30A8\u30E9\u30FC\u76E3\u8996"))return null;let n=this.getCur(),r=this.yBlock();if(!this.check2(["\u30A8\u30E9\u30FC","\u306A\u3089\u3070"]))throw d.fromNode("\u30A8\u30E9\u30FC\u69CB\u6587\u3067\u300E\u30A8\u30E9\u30FC\u306A\u3089\u3070\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u30A8\u30E9\u30FC\u76E3\u8996..\u30A8\u30E9\u30FC\u306A\u3089\u3070..\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u3067\u8A18\u8FF0\u3057\u307E\u3059\u3002",n);this.get(),this.get();let s=this.yBlock();if(this.check("\u3053\u3053\u307E\u3067"))this.get();else throw d.fromNode("\u300E\u3053\u3053\u307E\u3067\u300F\u304C\u3042\u308A\u307E\u305B\u3093\u3002\u300E\u30A8\u30E9\u30FC\u76E3\u8996\u300F...\u300E\u30A8\u30E9\u30FC\u306A\u3089\u3070\u300F...\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u5BFE\u5FDC\u3055\u305B\u3066\u304F\u3060\u3055\u3044\u3002",e);return{type:"try_except",blocks:[r,s],josi:"",...e,end:this.peekSourceMap()}}_checkAsyncFn(e){if(!e)return!1;if(e.type==="def_func"||e.type==="def_test"||e.type==="func_obj"){let n=e;if(n.asyncFn)return!0;let r=!1;for(let s of n.blocks)if(this._checkAsyncFn(s))return r=!0,n.asyncFn=r,n.meta.asyncFn=r,this.isModifiedNodes=!0,!0}if(e.type==="func"){let n=e;if(n.asyncFn)return!0;if(n.blocks){for(let s of n.blocks)if(this._checkAsyncFn(s))return n.asyncFn=!0,this.isModifiedNodes=!0,!0}let r=this.funclist.get(n.name);return r&&r.asyncFn?(n.asyncFn=!0,this.isModifiedNodes=!0,!0):!1}if(e.type==="renbun")return!0;if(e.blocks){for(let n of e.blocks)if(this._checkAsyncFn(n))return!0}return!1}_tokensToNodes(e){let n=[];for(let r of e)n.push(this._tokenToNode(r));return n}_tokenToNode(e){let n=this.peekSourceMap(e);if(e.type==="string"||e.type==="number"||e.type==="bigint")return this.yConst(e,n);if(e.type==="word")return{type:"word",value:e.value,josi:e.josi,...n};if(e.type==="eol"||e.type==="_eol")return{type:"eol",...n};throw new Error("[System Error] \u672A\u77E5\u306E\u30C8\u30FC\u30AF\u30F3\u304CAst\u306B\u5909\u63DB\u3055\u308C\u307E\u3057\u305F\u3002")}};var xe=class{constructor(e,n,r){this.from=e,this.to=n,this.index=r}},N=class{constructor(e,n){this.text=e,this.sourcePosition=n}},$e=class{constructor(e){this.history=[],this.code=e}getText(){return this.code}replaceAll(e,n){for(;;){let r=this.getText().indexOf(e);if(r===-1)break;e.length!==n.length&&this.history.unshift(new xe(e.length,n.length,r)),this.code=this.code.replace(e,n)}}getSourcePosition(e){for(let n of this.history)e>=n.index+n.to?e+=n.from-n.to:n.index<=e&&e<n.index+n.to&&(n.to>=2&&e===n.index+n.to-1?e=n.index+n.from-1:e=n.index);return e}},he=class t{static getInstance(){return t._instance||(t._instance=new t),t._instance}constructor(){this.convertTable=new Map([[8208,"-"],[8209,"-"],[8211,"-"],[8212,"-"],[8213,"-"],[8722,"-"],[732,"~"],[759,"~"],[8275,"~"],[8764,"~"],[12316,"~"],[65374,"~"],[8192," "],[8194," "],[8195," "],[8196," "],[8197," "],[8198," "],[8199," "],[8201," "],[8202," "],[8203," "],[8239," "],[8287," "],[12288," "],[12644," "],[8251,"#"],[12290,";"],[12304,"["],[12305,"]"],[12289,","],[65292,","],[10005,"*"],[10006,"*"],[10007,"*"],[10008,"*"],[10060,"*"],[10133,"+"],[10134,"-"],[10135,"\xF7"],[129008,"="]])}convert1ch(e){if(!e)return"";let n=e.codePointAt(0)||0,r=this.convertTable.get(n)||"";if(r)return r;if(n<127)return e;if(n>=65281&&n<=65374){let s=n-65248;return String.fromCodePoint(s)}return e}convert(e){if(!e)return[];let n=new $e(e);n.replaceAll(`\r
`,`
`),n.replaceAll("\r",`
`);let r=!1,s=!1,i="",o=[],u=0,c="",a=0;for(;a<n.getText().length;){let f=n.getText().charAt(a),l=n.getText().substring(a,a+2);if(r){if(f===i){r=!1,o.push(new N(c+i,n.getSourcePosition(u))),a++,u=a;continue}c+=f,a++;continue}if(s){if(l===i){s=!1,i==="\uFF0A\uFF0F"&&(i="*/"),o.push(new N(c+i,n.getSourcePosition(u))),a+=2,u=a;continue}c+=f,a++;continue}if(f==="\u300C"){o.push(new N(f,n.getSourcePosition(u))),a++,u=a,r=!0,i="\u300D",c="";continue}if(f==="\u300E"){o.push(new N(f,n.getSourcePosition(u))),a++,u=a,r=!0,i="\u300F",c="";continue}if(f==="\u201C"){o.push(new N(f,n.getSourcePosition(u))),a++,u=a,r=!0,i="\u201D",c="";continue}if(l==="\u{1F334}"||l==="\u{1F33F}"){o.push(new N(l,n.getSourcePosition(u))),a+=2,u=a,s=!0,i=l,c="";continue}let h=this.convert1ch(f);if(h==='"'||h==="'"){o.push(new N(h,n.getSourcePosition(u))),a++,u=a,r=!0,i=f,c="";continue}if(h==="#"){o.push(new N(h,n.getSourcePosition(u))),a++,u=a,r=!0,i=`
`,c="";continue}if(l==="//"||l==="\uFF0F\uFF0F"){o.push(new N("//",n.getSourcePosition(u))),a+=2,u=a,r=!0,i=`
`,c="";continue}if(l==="\uFF0F\uFF0A"){o.push(new N("/*",n.getSourcePosition(u))),a+=2,u=a,s=!0,i="\uFF0A\uFF0F",c="";continue}if(l==="/*"){o.push(new N(l,n.getSourcePosition(u))),a+=2,u=a,s=!0,i="*/",c="";continue}o.push(new N(h,n.getSourcePosition(u))),a++,u=a}return(r||s)&&(i==='"'||i==="'"||i==="\u300D"||i==="\u300F"||o.push(new N(c+i,n.getSourcePosition(u)))),o}};var Dt=`(function(){
`,Jt="})",Rt=`(async function(){
`,Q=class{constructor(e=!1,n=[],r="",s=""){this.isTest=e,this.codeStandalone=r,this.codeEnv=s,this.importFiles=["plugin_system.mjs","plugin_math.mjs","plugin_csv.mjs","plugin_promise.mjs","plugin_test.mjs"];for(let i of n)this.importFiles.push(i)}},Ae=class t{constructor(e){this.nakoFuncList=new Map(e.getNakoFuncList()),this.nakoTestFuncs=new Map,this.usedFuncSet=new Set,this.loopId=1,this.numAsyncFn=0,this.usedAsyncFn=!1,this.flagLoop=!1,this.__self=e,this.genMode="sync",this.lastLineNo=null,this.varslistSet=this.setVarslistSet(e.__varslist),this.varsSet={isFunction:!1,names:new Set,readonly:new Set},this.varslistSet[2]=this.varsSet,this.defFuncName="",this.speedMode={lineNumbers:0,implicitTypeCasting:0,invalidSore:0,forcePure:0},this.performanceMonitor={userFunction:0,systemFunction:0,systemFunctionBody:0,mumeiId:0},this.constPools=[],this.constPoolsTemplate=[],this.warnUndefinedVar=!1,this.warnUndefinedReturnUserFunc=!1,this.warnUndefinedCallingUserFunc=!1,this.warnUndefinedCallingSystemFunc=!1,this.warnUndefinedCalledUserFuncArgs=!1,this.debugOption=e.debugOption}static isValidIdentifier(e){return/^(?!(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$)[$A-Z_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc][$A-Z_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]*$/.test(e)}setVarslistSet(e){let n=[];for(let r=0;r<=1;r++){let s=e[r],i=new Set(s.keys());i.delete("meta"),n[r]={isFunction:!1,names:i,readonly:new Set}}return n}convLineno(e,n=!1,r=0){if(this.speedMode.lineNumbers>0)return"";let s=e.line+r,i;if(typeof e.line!="number"?i="unknown":typeof e.file!="string"?i=`l${s}`:i=`l${s}:${e.file}`,!n){if(i===this.lastLineNo)return"";this.lastLineNo=i}let o=JSON.stringify(i),u="";return this.debugOption.useDebug&&(this.debugOption.messageAction&&(u+=`window.postMessage({action:'${this.debugOption.messageAction}',line: ${o}});`),s>=1&&(this.debugOption.waitTime>0&&(u+=`await __v0.get('\u79D2\u5F85')(${this.debugOption.waitTime},__self);`),this.numAsyncFn+=1,this.usedAsyncFn=!0,u+=`await __v0.get('__DEBUG_BP_WAIT')(${s}, __self);`),u+="if (__v0.get('__forceClose')) { return -1 };"),`__line(${o});`+u}varname_get(e){return this.varslistSet.length===3?`__self.__varslist[2].get(${JSON.stringify(e)})`:`__self.__vars.get(${JSON.stringify(e)})`}varname_set(e,n){return this.varslistSet.length===3?`__self.__varslist[2].set(${JSON.stringify(e)}, (${n}))`:`__self.__vars.set(${JSON.stringify(e)}, (${n}))`}varname_set_sys(e,n){return`__self.__setSysVar(${JSON.stringify(e)}, (${n}))`}static getFuncName(e){if(e.indexOf("__")>=0){let r=e.split("__"),s=r[0],i=t.getFuncName(r[1]);return`${s}__${i}`}let n=e.replace(/[„ÅÅ-„Çì]+$/,"");return n===""&&(n=e),n}static convPrint(e){return`__print(${e});`}convRequire(e){let n=e.value;return this.convLineno(e,!1)+`__module['${n}'] = require('${n}');
`}getDefFuncCode(e,n){let r="";r+=`const nakoVersion = { version: ${JSON.stringify(e.version)} }
`,r+=`const __self = self;
`,r+=`__self.__self = __self;
`,r+=`const __varslist = __self.__varslist;
`,r+=`const __module = __self.__module;
`,r+=`const __v0 = __self.__v0 = __self.__varslist[0];
`,r+=`const __v1 = __self.__v1 = __self.__varslist[1];
`,r+=`const __vars = __self.__vars = __self.__varslist[2];
`,r+=`const __modList = __self.__modList = ${JSON.stringify(e.getModList())}
`,r+=`const __line = (lineno) => { __self.__v0.set('__line', lineno); }
`,r+=`__v0.set('__line', 'l0:__getDefFuncCode');
`,r+=`__v0.set('__forceClose', false);
`,r+=`__v0.set('__useDebug', ${String(this.debugOption.useDebug)});
`,r+="__self.constPools = "+JSON.stringify(this.constPools)+`;
`,r+="__self.constPoolsTemplate = "+JSON.stringify(this.constPoolsTemplate)+`;
`,r+=`__self.__propAccessor = [];
`;let s="";if(this.nakoFuncList.forEach((i,o)=>{let u=L(D(String(i.fn),1)),c=i.asyncFn?"true":"false";s+=`//[DEF_FUNC name='${o}' asyncFn=${c}]
__self.__varslist[1].set("${o}", ${u});
//[/DEF_FUNC name='${o}']
`}),s!==""&&(r+=`__v0.set('__line', '\u95A2\u6570\u306E\u5B9A\u7FA9');
`+s),n.isTest){let i=`const __tests = [];
`;this.nakoTestFuncs.forEach(o=>{let u=o.fn;i+=`${String(u)};
`}),i!==""&&(r+=`__v0.set('__line', '\u30C6\u30B9\u30C8\u306E\u5B9A\u7FA9');
`,r+=i+`
`)}return r}addPlugin(e){return this.__self.addPlugin(e)}addPluginObject(e,n){this.__self.addPluginObject(e,n)}addPluginFile(e,n,r){this.__self.addPluginFile(e,n,r)}addFunc(e,n,r){this.__self.addFunc(e,n,r)}getFunc(e){return this.__self.getFunc(e)}registerFunction(e){if(e.type!=="block")throw d.fromNode("\u69CB\u6587\u89E3\u6790\u306B\u5931\u6557\u3057\u3066\u3044\u307E\u3059\u3002\u69CB\u6587\u306F\u5FC5\u305Ablock\u304C\u5148\u982D\u306B\u306A\u308A\u307E\u3059",e);let n=[],r=o=>{if(!o.name)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u95A2\u6570\u540D\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");let u=o.name;this.usedFuncSet.add(u),this.__self.__varslist[1].set(u,()=>{}),this.varslistSet[1].names.add(u);let c=o.meta;if(!c)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u95A2\u6570\u540D\u306E\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");this.nakoFuncList.set(u,{josi:c.josi,fn:()=>{},type:"func",asyncFn:!!o.asyncFn,isExport:o.isExport}),n.push({name:u,node:o})},s=o=>{if(o.blocks)for(let u of o.blocks)u.type==="def_func"?r(u):s(u)};s(e);let i=new Set;this.speedMode.invalidSore===0&&i.add("\u305D\u308C"),this.varsSet={isFunction:!1,names:i,readonly:new Set},this.varslistSet=this.setVarslistSet(this.__self.__varslist),this.varslistSet[2]=this.varsSet}convGen(e,n){let r=this.convLineno(e,!1)+this._convGen(e,!0);return n.isTest?"":r}_convGen(e,n){if(!e)return"";let r="";if(e instanceof Array){for(let s=0;s<e.length;s++){let i=e[s];r+=this._convGen(i,n)}return r}if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e!="object")return""+String(e);switch(e.type){case"nop":break;case"block":r+=this.convBlock(e);break;case"comment":case"eol":r+=this.convComment(e);break;case"run_mode":r+=this.convRunMode(e);break;case"break":r+=this.convCheckLoop(e,"break");break;case"continue":r+=this.convCheckLoop(e,"continue");break;case"end":r+="__v0.get('\u7D42')(__self);";break;case"number":r+=e.value;break;case"bigint":r+=e.value;break;case"string":r+=this.convString(e);break;case"def_local_var":r+=this.convDefLocalVar(e);break;case"def_local_varlist":r+=this.convDefLocalVarlist(e);break;case"let":r+=this.convLet(e);break;case"let_prop":r+=this.convLetProp(e);break;case"ref_prop":r+=this.convRefProp(e);break;case"inc":r+=this.convInc(e);break;case"word":case"variable":r+=this.convGetVar(e);break;case"op":case"calc":r+=this.convOp(e);break;case"renbun":r+=this.convRenbun(e);break;case"not":r+="(("+this._convGen(e.blocks[0],!0)+")?false:true)";break;case"func":case"func_pointer":case"calc_func":r+=this.convCallFunc(e,n);break;case"if":r+=this.convIf(e);break;case"for":r+=this.convFor(e);break;case"foreach":r+=this.convForeach(e);break;case"repeat_times":r+=this.convRepeatTimes(e);break;case"speed_mode":r+=this.convSpeedMode(e,n);break;case"performance_monitor":r+=this.convPerformanceMonitor(e,n);break;case"while":r+=this.convWhile(e);break;case"atohantei":r+=this.convAtohantei(e);break;case"switch":r+=this.convSwitch(e);break;case"let_array":r+=this.convLetArray(e);break;case"ref_array":r+=this.convRefArray(e);break;case"ref_array_value":r+=this.convRefArrayValue(e);break;case"json_array":r+=this.convJsonArray(e);break;case"json_obj":r+=this.convJsonObj(e);break;case"bool":r+=e.value?"true":"false";break;case"null":r+="null";break;case"def_test":r+=this.convDefTest(e);break;case"def_func":r+=this.convDefFunc(e);break;case"func_obj":r+=this.convFuncObj(e);break;case"return":r+=this.convReturn(e);break;case"try_except":r+=this.convTryExcept(e);break;case"require":r+=this.convRequire(e);break;default:throw new Error("System Error: unknown_type="+e.type)}return r}findVar(e,n=null){if(this.varslistSet.length>3&&this.varsSet.names.has(e))return{i:this.varslistSet.length-1,name:e,isTop:!0,js:this.varname_get(e),js_set:this.varname_set(e,String(n))};for(let r=2;r>=0;r--)if(this.varslistSet[r].names.has(e))return{i:r,name:e,isTop:!1,js:`__self.__varslist[${r}].get(${JSON.stringify(e)})`,js_set:`__self.__varslist[${r}].set(${JSON.stringify(e)}, ${n??"undefined"})`};return null}genVar(e,n){let r=this.findVar(e),s=n.line;if(r===null){if(!(e==="\u5F15\u6570"||e==="\u305D\u308C"||e==="\u5BFE\u8C61"||e==="\u5BFE\u8C61\u30AD\u30FC")){if(this.warnUndefinedVar){let o=e.replace(/^main__(.+)$/,"$1");this.__self.getLogger().warn(`\u5909\u6570\u300E${o}\u300F\u306F\u5B9A\u7FA9\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002`,n)}}return this.varsSet.names.add(e),this.varname_get(e)}if(r.i===0){let o=this.__self.getNakoFunc(e);if(!o)return`${r.js}/*[link_error]l${s}:${n.file??"unknown"}*/`;if(o.type==="const"||o.type==="var")return r.js;if(o.type==="func"){if(!o.josi||o.josi.length===0)return`(${r.js}())`;throw d.fromNode(`\u300E${e}\u300F\u304C\u8907\u6587\u3067\u4F7F\u308F\u308C\u307E\u3057\u305F\u3002\u5358\u6587\u3067\u8A18\u8FF0\u3057\u3066\u304F\u3060\u3055\u3044\u3002(v1\u975E\u4E92\u63DB)`,n)}throw d.fromNode(`\u300E${e}\u300F\u306F\u95A2\u6570\u3067\u3042\u308A\u53C2\u7167\u3067\u304D\u307E\u305B\u3093\u3002`,n)}return r.js}convGetVar(e){let n=e.value;return this.genVar(n,e)}convBlock(e){let n="";for(let r of e.blocks)n+=this._convGen(r,!1);return n}convComment(e){let n=String(e.comment);n=n.replace(/\n/g,"\xB6"),n=n.replace(/\*\//g,"\uFF0A\uFF0F"),n=n.replace(/(^\s+|\s+$)/g,"");let r=this.convLineno(e,!1);return e.line===0&&(r=""),n===""&&r===""?";":n===""?";"+r+`
`:";"+r+"//"+n+`
`}convRunMode(e){let n=e.value,r=!1;return n==="\u53B3\u3057\u304F\u30C1\u30A7\u30C3\u30AF"&&(r=!0),this.warnUndefinedVar=r,this.warnUndefinedReturnUserFunc=r,this.warnUndefinedCallingUserFunc=r,this.warnUndefinedCallingSystemFunc=r,this.warnUndefinedCalledUserFuncArgs=r,`/* \u5B9F\u884C\u30E2\u30FC\u30C9: ${n} */`}convReturn(e){if(this.varsSet.names.has("!\u95A2\u6570"))throw d.fromNode("\u300E\u623B\u308B\u300F\u304C\u3042\u308A\u307E\u3059\u304C\u3001\u95A2\u6570\u5B9A\u7FA9\u5185\u306E\u307F\u3067\u4F7F\u7528\u53EF\u80FD\u3067\u3059\u3002",e);let n=e.blocks[0],r=this.convLineno(e,!1),s="";if(n.type!=="nop"?s=this._convGen(n,!0):this.speedMode.invalidSore===0&&(s=this.varname_get("\u305D\u308C")),s==="")return r+"return;";if(this.warnUndefinedReturnUserFunc){let i=this.defFuncName?this.defFuncName:"\u7121\u540D\u95A2\u6570",o=this.addConstPool(`\u30E6\u30FC\u30B6\u95A2\u6570\u300E${i}\u300F\u304B\u3089undefined\u304C\u8FD4\u3055\u308C\u3066\u3044\u307E\u3059`,[],e.file,e.line);return r+`return (__self.chk(${s}, ${o}));`}else return r+`return ${s};`}getConstPoolsTemplateId(e){let n=this.constPoolsTemplate.indexOf(e);return n<0&&(n=this.constPoolsTemplate.length,this.constPoolsTemplate[n]=e),n}addConstPool(e,n,r,s){r=String(r);let i=this.getConstPoolsTemplateId(r),o=this.getConstPoolsTemplateId(e),u=[];for(let a of n){let f=""+String(a),l=this.getConstPoolsTemplateId(f);u.push(l)}let c=this.constPools.length;return this.constPools.push([o,u,i,s]),c}convCheckLoop(e,n){if(!this.flagLoop){let r=n==="continue"?"\u7D9A\u3051\u308B":"\u629C\u3051\u308B";throw d.fromNode(`\u300E${r}\u300F\u6587\u304C\u3042\u308A\u307E\u3059\u304C\u3001\u305D\u308C\u306F\u7E70\u308A\u8FD4\u3057\u306E\u4E2D\u3067\u5229\u7528\u3057\u3066\u304F\u3060\u3055\u3044\u3002`,e)}return this.convLineno(e)+n+";"}convDefFuncCommon(e,n){this.defFuncName=n;let r=!1,s="",i="";if(this.performanceMonitor.userFunction!==0){let b=n;b||(typeof this.performanceMonitor.mumeiId>"u"&&(this.performanceMonitor.mumeiId=0),this.performanceMonitor.mumeiId++,b=`anous_${this.performanceMonitor.mumeiId}`),s=`const performanceMonitorEnd = (function (key, type) {
const uf_start = performance.now() * 1000;
return function () {
const el_time = performance.now() * 1000 - uf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: el_time, min_usec: el_time, max_usec: el_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: el_time, min_usec: el_time, max_usec: el_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=el_time;
if(__self.__performance_monitor[key].min_usec>el_time){__self.__performance_monitor[key].min_usec=el_time;}
if(__self.__performance_monitor[key].max_usec<el_time){__self.__performance_monitor[key].max_usec=el_time;}
}};})('${b}', 'user');try {
`,i=`} finally { performanceMonitorEnd(); }
`}let o="",u="    ",c="",a="",f=new Set;this.speedMode.invalidSore===0&&f.add("\u305D\u308C"),this.varsSet={isFunction:!0,names:f,readonly:new Set},this.varslistSet.push(this.varsSet),r?o+=u+`var \u5F15\u6570 = arguments;
`:o+=u+`__self.__vars.set('\u5F15\u6570', arguments);
`,c+=`
// PUSH STACK
`,c+=`const __localvars = __self.__vars;
`,c+=`__self.__vars = new Map();
`,c+=`try {
`,a+=`} finally {
`,a+=u+`// POP STACK
`,a+=u+`self.__vars = __localvars;
`,a+=`}
`;let l=Array.from(this.varsSet.names.values()),h="",p=e.meta;if(!p)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");p.varnames||(p.varnames=[]);for(let b=0;b<p.varnames.length;b++){let _=p.varnames[b];if(_!=="\u5F15\u6570"){if(!this.warnUndefinedCalledUserFuncArgs)h+=u+this.varname_set(_,`arguments[${b}]`)+`;
`;else{let w=`\u533F\u540D\u95A2\u6570\u306E\u5F15\u6570\u300E${_}\u300F\u306Bundefined\u304C\u6E21\u3055\u308C\u307E\u3057\u305F`;n&&(w=`\u30E6\u30FC\u30B6\u95A2\u6570\u300E${n}\u300F\u306E\u5F15\u6570\u300E${_}\u300F\u306Bundefined\u304C\u6E21\u3055\u308C\u307E\u3057\u305F`);let ie=`${`((a) => { if (a === undefined) { ${`__self.logger.warn('${w}', {line: ${e.line}, file: ${JSON.stringify(e.file)}});`} }; return a; })`}(arguments[${b}])`;h+=u+this.varname_set(_,ie)+`;
`}this.varsSet.names.add(_)}}if(n&&(this.usedFuncSet.add(n),this.varslistSet[1].names.add(n),this.nakoFuncList.get(n)===void 0)){if(!e.meta)throw new Error("[System Error] \u95A2\u6570\u306E\u5B9A\u7FA9\u3067\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");this.nakoFuncList.set(n,{josi:e.meta.josi,fn:()=>{},type:"func",asyncFn:!1,isExport:null}),this.__self.getLogger().warn(`generate\u3067\u672A\u5B9A\u7FA9\u306E\u72B6\u614B\u306E\u95A2\u6570\u300E${n}\u300F\u304C\u52D5\u7684\u306B\u767B\u9332\u3055\u308C\u3066\u3044\u307E\u3059\u3002`)}let y=this.usedAsyncFn;this.usedAsyncFn=!1,this.debugOption.useDebug&&(this.usedAsyncFn=!0);let m=this._convGen(e.blocks[0],!1);if(h+=m.split(`
`).map(b=>"  "+b).join(`
`)+`
`,this.speedMode.invalidSore===0&&(h+=`  return (${this.varname_get("\u305D\u308C")});
`),h+=i,n&&this.usedAsyncFn){let b=this.nakoFuncList.get(n);b&&(b.asyncFn=!0)}if(r){for(let b of Array.from(this.varsSet.names.values()))l.includes(b)||t.isValidIdentifier(b)&&(o+=`  var ${b};
`);this.speedMode.invalidSore===0&&(t.isValidIdentifier("\u305D\u308C")?o+=`  var \u305D\u308C = '';
`:o+=`  ${this.varname_get("\u305D\u308C")} = '';`)}let g=this.usedAsyncFn?Rt:Dt,k="  "+this.convLineno(e,!0,1)+`
`;if(h=g+s+c+o+k+h+a,h+=Jt,n){let b=this.nakoFuncList.get(n);b&&(b.fn=h,b.asyncFn=this.usedAsyncFn,p.asyncFn=this.usedAsyncFn)}return this.usedAsyncFn=y,this.varslistSet.pop(),this.varsSet=this.varslistSet[this.varslistSet.length-1],n&&this.__self.__varslist[1].set(n,h),this.defFuncName="",h}convDefTest(e){let n=e.name,r=`__tests.push({ name: '${n}', f: () => {
`,s=this._convGen(e.blocks[0],!1);if(r+=`   ${s}
}});`,!e.meta)throw new Error("[System Error] \u30C6\u30B9\u30C8\u306E\u30E1\u30BF\u60C5\u5831\u304C\u6307\u5B9A\u3055\u308C\u3066\u3044\u307E\u305B\u3093");return this.nakoTestFuncs.set(n,{josi:e.meta.josi,fn:r,type:"test_func"}),""}convDefFunc(e){if(!e.name)return"";let n=t.getFuncName(e.name);return this.convDefFuncCommon(e,n),""}convFuncObj(e){return"/*convFuncObj*/"+this.convDefFuncCommon(e,"")}convJsonObj(e){let n=[],r=e.blocks;for(let s=0;s<r.length/2;s++){let i=s*2,o=r[i+0],u=r[i+1],c=this._convGen(o,!0),a=this._convGen(u,!0);n.push(`${c}: ${a}`)}return"{"+n.join(", ")+"}"}convJsonArray(e){return"["+e.blocks.map(s=>this._convGen(s,!0)).join(",")+"]"}convRefArray(e){let n="";n=this._convGen(e.name,!0);let r=e.index;if(!r)return n;for(let s=0;s<r.length;s++){let i=this._convGen(r[s],!0);n+="["+i+"]"}return n}convRefArrayValue(e){let n="",r=e.name?String(e.name):"???",s=e.index?e.index.shift():void 0;if(!s)return"/*[WARNING] convRefArrayOperator::InvalidValue */";n=this._convGen(s,!0);let i=e.index;if(!i)return n;if(r==="@"||r==="["){for(let u=0;u<i.length;u++){let c=this._convGen(i[u],!0);n+="["+c+"]"}return n}return r==="$"?this.convRefProp_genCode(n,i):`/* [WARNING] convRefArrayOperator::UnknownOperator [${r.replace("*/","\uFF0A/")}] */`+n}convLetArray(e){let n=this.loopId++,r=e.blocks[0],s=e.blocks.slice(1),i=this.genVar(e.name,e),o="",u=i,c="";if(e.checkInit){let l="[0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0]";if(e.name){let h=e.name,p=`$nako_tmp_a${n}`,y=this.varname_set(h,l);o+=`
/*\u914D\u5217\u521D\u671F\u5316*/if (!(${i} instanceof Array)) { ${y} };
`,o+=`${p} = ${i};
`;for(let m=0;m<s.length-1;m++){let g=this._convGen(s[m],!0);c+=`[${g}]`,o+=`
/*\u914D\u5217\u521D\u671F\u5316${m}*/if (!(${p}${c} instanceof Array)) { ${p}${c} = ${l}; };`}o+=`
`}}for(let l=0;l<s.length;l++){let h=this._convGen(s[l],!0);u+="["+h+"]"}let a=null;if(this.speedMode.invalidSore===0&&(a=this.varname_get("\u305D\u308C")),r.type!=="nop"&&(a=this._convGen(r,!0)),a==null)throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u5909\u6570\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);return u+=" = "+a+`;
`,this.convLineno(e,!1)+o+u}convGenLoop(e){let n=this.flagLoop;this.flagLoop=!0;try{return this._convGen(e,!1)}finally{this.flagLoop=n}}convFor(e){let n=e.blocks[0],r=e.blocks[1],s=e.blocks[2],i=e.blocks[3],o=this.loopId++,u=`$nako_i${o}`,c="";if(e.word!==""){let A=e.word;this.varsSet.names.add(A),c=this.varname_set(A,u)}let a=`$nako_from${o}`,f=`$nako_to${o}`,l=`$nako_temp${o}`,h="";this.speedMode.invalidSore===0&&(h=this.varname_set("\u305D\u308C",u));let p="0",y="0",m="0";r&&r.type==="func"&&r.name==="\u7BC4\u56F2"?(m=this._convGen(r,!0),p=`${l}['\u5148\u982D'] || 0`,y=`${l}['\u672B\u5C3E'] || 0`):(p=this._convGen(n,!0),y=this._convGen(r,!0));let g=e.flagDown,k=e.flagUp,b="1";s.type!=="nop"&&(b=this._convGen(s,!0));let _=this.convGenLoop(i);return this.convLineno(e,!1)+`
/*[convFor id=${o}]*/
const ${l} = ${m};
const ${a} = ${p};
const ${f} = ${y};
if (${a} <= ${f}) { // up
  if (${String(k)}) {    for (let ${u} = ${a}; ${u} <= ${f}; ${u}+= ${b}) {
      ${h};${c}
      // for block begin
      ${_}
      // for block end
    };
  };
} else { // down
  if (${String(g)}) {    for (let ${u} = ${a}; ${u} >= ${f}; ${u}-= ${b}) {
      ${h};${c}
      // for block begin
      ${_}
      // for block end
    }
  };
};
//[/convFor id=${o}]
`}convForeach(e){let n=e.blocks[0],r=e.blocks[1],s=this.loopId++,i=`$nako_i${s}`,o=`$nako_foreach_value${s}`,u=`$nako_foreach_data${s}`,c=`$nako_taisyou_temp${s}`,a=`$nako_taisyou_key_temp${s}`,f=`$nako_foreach_sore_temp${s}`,l=this.varname_set_sys("\u5BFE\u8C61",o);if(e.word!==""){let w=e.word;this.varsSet.names.add(w),l=this.varname_set(w,o)}let p=this.varname_set_sys("\u5BFE\u8C61\u30AD\u30FC",i),y="",m="",g="";this.speedMode.invalidSore===0&&(y=this.varname_set("\u305D\u308C",o),m=this.varname_set("\u305D\u308C",f),g=`let ${f} = `+this.varname_get("\u305D\u308C")+";");let k="";if(n.type==="nop")if(this.speedMode.invalidSore===0)k=this.varname_get("\u305D\u308C");else throw d.fromNode("\u300E\u53CD\u5FA9\u300F\u306E\u5BFE\u8C61\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);else k=this._convGen(n,!0);let b=L(D(this.convGenLoop(r),1));return this.convLineno(e,!1)+`
// [convForeach id=${s}]
const ${c} = __self.__getSysVar('\u5BFE\u8C61'); ${g}; const ${a} = __self.__getSysVar('\u5BFE\u8C61\u30AD\u30FC');
let ${u} = ${k};
// foreach Map?
if (${u} instanceof Map) { // Object\u306B\u5F37\u5236\u5909\u63DB
  let tmp = {}; for (let tmpKey of ${u}.keys()) { tmp[tmpKey] = ${u}.get(tmpKey); }; 
  ${u} = tmp;
}
for (let ${i} in ${u}) {
  if (!${u}.hasOwnProperty(${i})) { continue }
  // \u5BFE\u8C61\u30AD\u30FC\u306E\u8A2D\u5B9A
  ${p}
  // \u5BFE\u8C61\u306E\u8A2D\u5B9A
  let ${o} = $nako_foreach_data${s}[${i}]
  ${y};
  ${l};
  // [convForeach::block]
  ${b}
  // [/convForeach::block]
}
__self.__setSysVar('\u5BFE\u8C61', ${c});${m};__self.__setSysVar('\u5BFE\u8C61\u30AD\u30FC', ${a});// [/convForeach id=${s}]
`}convRepeatTimes(e){let n=this.loopId++,r=`$nako_i${n}`,s=`$nako_times_data${n}`,i=`$nako_kaisu_temp${n}`,o=this._convGen(e.blocks[0],!0),u=L(D(this.convGenLoop(e.blocks[1]),1)),c="",a="";return this.speedMode.invalidSore===0&&(c=this.varname_set("\u305D\u308C",r),a=this.varname_set("\u305D\u308C",i)),c+=`;__self.__setSysVar('\u56DE\u6570', ${r});`,a+=`;__self.__setSysVar('\u56DE\u6570', ${i});`,this.convLineno(e,!1)+`
// [convRepeatTimes id=${n}] // \u300En\u56DE\u300F\u69CB\u6587
let ${i} = __self.__getSysVar('\u56DE\u6570')
let ${s} = ${o};
for (let ${r} = 1; ${r} <= ${s}; ${r}++) {
  ${c}
  ${u}
}
${a}
// [/convRepeatTimes id=${n}]
`}convSpeedMode(e,n){if(!e.options)return"";let r={...this.speedMode};e.options.\u884C\u756A\u53F7\u7121\u3057&&this.speedMode.lineNumbers++,e.options.\u6697\u9ED9\u306E\u578B\u5909\u63DB\u7121\u3057&&this.speedMode.implicitTypeCasting++,e.options.\u5F37\u5236\u30D4\u30E5\u30A2&&this.speedMode.forcePure++,e.options.\u305D\u308C\u7121\u52B9&&this.speedMode.invalidSore++;try{return this._convGen(e.blocks[0],n)}finally{this.speedMode=r}}convPerformanceMonitor(e,n){let r={...this.performanceMonitor};if(!e.options)return"";e.options.\u30E6\u30FC\u30B6\u95A2\u6570&&this.performanceMonitor.userFunction++,e.options.\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u672C\u4F53&&this.performanceMonitor.systemFunctionBody++,e.options.\u30B7\u30B9\u30C6\u30E0\u95A2\u6570&&this.performanceMonitor.systemFunction++;try{return this._convGen(e.blocks[0],n)}finally{this.performanceMonitor=r}}convWhile(e){let n=e.blocks[0],r=e.blocks[1],s=this._convGen(n,!0),i=L(D(this.convGenLoop(r),1));return`// [convWhile]
`+this.convLineno(e,!1)+`
while (${s}){
  ${i}
}
// [convWhile]
`}convAtohantei(e){let r=`$nako_i${this.loopId++}`,s=this._convGen(e.blocks[0],!0),o=`while (true) {
  ${this.convGenLoop(e.blocks[1])}
  let ${r} = ${s};
  if (${r}) { continue } else { break }
}

`;return this.convLineno(e,!1)+o}convSwitch(e){let n=this._convGen(e.blocks[0],!0),r=this._convGen(e.blocks[1],!1),s="";for(let o=0;o<e.case_count;o++){let u=o*2+2,c=this._convGen(e.blocks[u+0],!0),a=this.convGenLoop(e.blocks[u+1]);s+=`  case ${c}:
`,s+=`    ${a}
    break
`}let i=`// [switch]
switch (${n}){
${s}
  default:
    ${r}
}
// [/switch]
`;return this.convLineno(e,!1)+i}convIf(e){let n=e.blocks[0],r=e.blocks[1],s=e.blocks[2],i=this._convGen(n,!0),o=L(D(this._convGen(r,!1),1)),u=L(D(this._convGen(s,!1),1)),c=`// [convIf]
`+this.convLineno(e,!1)+`
if (${i}) {
  ${o}
}`;return L(u)!==""&&(c+=`  else {
  ${u}
}
`),c+=`
// [/convIf]
`,c}convFuncGetArgsCalcType(e,n,r){let s=[],i={},o=r.blocks?r.blocks:[];for(let u=0;u<o.length;u++){let c=o[u];if(u===0&&c===null&&this.speedMode.invalidSore===0)s.push(this.varname_get("\u305D\u308C")),i.sore=!0;else{let a=this._convGen(c,!0);a===""&&(a="undefined"),typeof a!="string"&&(a="undefined"),s.push(`/*arg${u}*/${a}`)}}return[s,i]}getPluginList(){let e=[];for(let n in this.__self.__module)e.push(n);return e}convCallFunc(e,n){let r=t.getFuncName(e.name),s=this.findVar(r);if(s===null)throw d.fromNode(`\u95A2\u6570\u300E${r}\u300F\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002\u6709\u52B9\u30D7\u30E9\u30B0\u30A4\u30F3=[`+this.getPluginList().join(", ")+"]",e);let i;if(s.i===0){if(i=this.__self.getFunc(r),!i)throw new Error(`[System Error] \u95A2\u6570\u300C${r}\u300DNakoCompiler.nakoFuncList \u306E\u4E0D\u6574\u5408\u304C\u3042\u308A\u307E\u3059\u3002`);if(i.type!=="func")throw d.fromNode(`\u300E${r}\u300F\u306F\u95A2\u6570\u3067\u306F\u3042\u308A\u307E\u305B\u3093\u3002`,e)}else i=this.nakoFuncList.get(r),i===void 0&&(i={return_none:!1,asyncFn:!!e.asyncFn});if(e.type==="func_pointer")return s.js;let o=this.convFuncGetArgsCalcType(r,i,e),u=o[0],c=o[1];if(this.usedFuncSet.add(r),r==="\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A")return`
// --- \u540D\u524D\u7A7A\u9593(${u[0]}) ---
__self.__varslist[0].get('\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A')(${u[0]}, __self);__self.__modName=${u[0]};
`;if(r==="\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A")return`
__self.__varslist[0].get('\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A')(${u[0]}, __self);
`;u.push("__self");let a="function",f="",l="";if(e.setter&&(f+=`;__self.isSetter = true;
`,l+=`;__self.isSetter = false;
`),s.i===0&&this.varslistSet.length>3&&i.pure!==!0&&this.speedMode.forcePure===0){let k=[];for(let b of Array.from(this.varsSet.names.values()))t.isValidIdentifier(b)&&k.push({str:JSON.stringify(b),js:this.varname_get(b)});if(f+=`__self.__locals = __vars;
`,k.length>0){f+=`/* \u5168\u3066\u306E\u5C55\u958B\u3055\u308C\u305F\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u3092 __self.__locals \u306B\u4FDD\u5B58 */
`;for(let b of k)f+=`__self.__locals.set(${b.str}, ${b.js});
`}if(k.length>0){l+=`/* \u5168\u3066\u306E\u5C55\u958B\u3055\u308C\u305F\u30ED\u30FC\u30AB\u30EB\u5909\u6570\u3092 __self.__locals \u304B\u3089\u53D7\u3051\u53D6\u308B */
`;for(let b of k)b.js!=="\u305D\u308C"&&(l+=`__self.__varslist[2].set(${b.str}, __self.__locals[${b.str}]);
`)}}c.sore&&(f+="/*[sore]*/");let h=(k,b)=>{let _="";for(let w of k.split(`
`))w!==""&&(_+="  ".repeat(b)+w+`
`);return _},p={TYPEOF:!0,\u5909\u6570\u578B\u78BA\u8A8D:!0},y;if(!this.warnUndefinedCallingUserFunc&&s.i!==0||!this.warnUndefinedCallingSystemFunc&&s.i===0)y=u.join(",");else{let k=[];u.forEach(b=>{if(b==="__self"||p[r]===!0)k.push(`${b}`);else{let _=s.i===0?"\u547D\u4EE4\u300E$0\u300F\u306E\u5F15\u6570\u306Bundefined\u3092\u6E21\u3057\u3066\u3044\u307E\u3059\u3002":"\u30E6\u30FC\u30B6\u547D\u4EE4\u300E$0\u300F\u306E\u5F15\u6570\u306Bundefined\u3092\u6E21\u3057\u3066\u3044\u307E\u3059\u3002",w=this.addConstPool(_,[r],e.file,e.line),A=b===""?'""':b;k.push(`(__self.chk(${A}, ${w}))`)}}),y=k.join(", ")}let m=`${s.js}(${y})`;if(i.asyncFn){a=`async ${a}`,m=`await ${m}`,this.numAsyncFn++,this.usedAsyncFn=!0;let k=`$nako_i${this.loopId}`;this.loopId++,f+=`const __local_async${k} = __self.__vars;
`,l+=`__self.__vars = __local_async${k};
`}if(s.i===0&&this.performanceMonitor.systemFunctionBody!==0){let k=r;k||(typeof this.performanceMonitor.mumeiId>"u"&&(this.performanceMonitor.mumeiId=0),this.performanceMonitor.mumeiId++,k=`anous_${this.performanceMonitor.mumeiId}`),m=`(${a} (key, type) {
const sbf_start = performance.now() * 1000;
try {
return `+m+`;
} finally {
const sbl_time = performance.now() * 1000 - sbf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: sbl_time, min_usec: sbl_time, max_usec: sbl_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: sbl_time, min_usec: sbl_time, max_usec: sbl_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=sbl_time;
if(__self.__performance_monitor[key].min_usec>sbl_time){__self.__performance_monitor[key].min_usec=sbl_time;}
if(__self.__performance_monitor[key].max_usec<sbl_time){__self.__performance_monitor[key].max_usec=sbl_time;}
}}})('${r}_body', 'sysbody')
`}let g="";if(i.return_none)l===""?g=`/*VOID\u95A2\u6570\u547C\u51FA*/${f}${m}
`:g=`/*VOID\u95A2\u6570\u547C\u51FA(\u524D\u5F8C\u51E6\u7406\u4ED8)*/${f}try {
${h(m,1)};
} finally {
${h(l,1)}}
`;else{let k="",b="";if(this.speedMode.invalidSore===0&&(k="__self.__setSore(",b=")"),f===""&&l==="")g=`${k}${m}${b}`;else if(l===""){let _=`${k}${m}${b}`;g=`/* funcCallThis1 */${`(${`${a}(){ return ${_} }`}).call(this)`}`}else{let _=`$nako_i${this.loopId}`;this.loopId++,g=`/* funcCallThis2 */(${a}(){
`+h(f,1)+`
`+h("try {",1)+`
`+h(`let ${_} = ${m};`,2)+`
`+h(`return ${_};`,2)+`
`+h("} finally {",2)+`
`+h(l,1)+`
`+h("}",1)+`
}).call(this)`,i.asyncFn&&(g=`await (${g})`),g=`${k}${g}${b}`}(e.josi==="\u3057\u3066"||e.josi===""&&!n)&&(g+=`;
`)}return s.i===0&&this.performanceMonitor.systemFunction!==0&&(g=`(function (key, type) {
const sf_start = performance.now() * 1000;
try {
return `+g+`;
} finally {
const sl_time = performance.now() * 1000 - sf_start;
if (!__self.__performance_monitor) {
__self.__performance_monitor={};
__self.__performance_monitor[key] = { called:1, totel_usec: sl_time, min_usec: sl_time, max_usec: sl_time, type: type };
} else if (!__self.__performance_monitor[key]) {
__self.__performance_monitor[key] = { called:1, totel_usec: sl_time, min_usec: sl_time, max_usec: sl_time, type: type };
} else {
__self.__performance_monitor[key].called++;
__self.__performance_monitor[key].totel_usec+=sl_time;
if(__self.__performance_monitor[key].min_usec>sl_time){__self.__performance_monitor[key].min_usec=sl_time;}
if(__self.__performance_monitor[key].max_usec<sl_time){__self.__performance_monitor[key].max_usec=sl_time;}
}}})('${r}_sys', 'system')
`),g}convRenbun(e){let n=this._convGen(e.blocks[1],!0),r=this._convGen(e.blocks[0],!1);return this.numAsyncFn++,this.usedAsyncFn=!0,`/*[\u9023\u6587]*/await (async function(){ ${r}; return ${n} }).call(this)/*[/\u9023\u6587]*/`}convOp(e){let n={"&":'+""+',eq:"==",noteq:"!=","===":"===","!==":"!==",gt:">",lt:"<",gteq:">=",lteq:"<=",and:"&&",or:"||",shift_l:"<<",shift_r:">>",shift_r0:">>>","\xF7":"/"},r=e.operator||"",s=this._convGen(e.blocks[1],!0),i=this._convGen(e.blocks[0],!0);return r==="+"&&this.speedMode.implicitTypeCasting===0&&(e.blocks[0]&&e.blocks[0].type!=="number"&&e.blocks[0].type!=="bigint"&&(i=`self.__parseFloatOrBigint(${i})`),e.blocks[1]&&e.blocks[1].type!=="number"&&e.blocks[1].type!=="bigint"&&(s=`self.__parseFloatOrBigint(${s})`)),r==="^"||r==="**"?`((${i}) ** (${s}))`:r==="\xF7\xF7"?`(Math.floor(${i} / ${s}))`:(n[r]&&(r=n[r]),`(${i} ${r} ${s})`)}convInc(e){let r=`$nako_v${this.loopId++}`,s="1";this.speedMode.invalidSore===0&&(s=this.varname_get("\u305D\u308C"));let i=e.blocks[0];i.type!=="nop"&&(s=this._convGen(i,!0));let o="",u="",c="",a="",f=e.name;if(f.type==="ref_array")u=this.convRefArray(f),c=`${u} = ${r}`,a=`${u} = 0`;else{let l=f.value,h=this.findVar(l,r);if(h===null&&(this.varsSet.names.add(l),h=this.findVar(l,r),!h))throw new Error("\u300E\u5897\u300F\u307E\u305F\u306F\u300E\u6E1B\u300F\u3067\u5909\u6570\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002");u=h.js,c=h.js_set,h=this.findVar(l,"0"),h!==null&&(a=h.js_set)}return o+=`
/*[convInc]*/
`,o+=this.convLineno(e,!1)+`
`,o+=`let ${r} = ${u}
`,o+=`if (typeof ${r} === 'undefined') { ${a}; }
`,o+=`${r} = Number(${u}) + Number(${s});
`,o+=`${c}
`,o+=`/*[/convInc]*/
`,o}convLet(e){let n=e.blocks[0],r=null;if(this.speedMode.invalidSore===0&&(r=this.varname_get("\u305D\u308C")),n){if(n.type==="func"&&n.name!==void 0){let u=n,c=this.__self.getFunc(u.name);if(c&&c.return_none)throw d.fromNode(`\u95A2\u6570\u300E${n.name}\u300F\u306F\u623B\u308A\u5024\u304C\u306A\u3044\u306E\u3067\u7D50\u679C\u3092\u4EE3\u5165\u3067\u304D\u307E\u305B\u3093\u3002`,e)}r=this._convGen(n,!0)}if(r==null)throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u5909\u6570\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let s=e.name,i=this.findVar(s,r),o="/*[convLet]*/";if(i===null)this.varsSet.names.add(s),o=`${this.varname_set(s,r)};`;else{if(this.varslistSet[i.i].readonly.has(s))throw d.fromNode(`\u5B9A\u6570\u300E${s}\u300F\u306F\u65E2\u306B\u5B9A\u7FA9\u6E08\u307F\u306A\u306E\u3067\u3001\u5024\u3092\u4EE3\u5165\u3059\u308B\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002`,e);o=`${i.js_set};`}return";"+this.convLineno(e,!1)+o+`
`}convLetProp(e){if(!e.index||e.index.length===0)throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);if(!e.blocks||e.blocks.length===0)throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5024\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let n=e.index,r=n.pop();if(r===void 0)throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5148\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u540D\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let s=typeof r.value=="string"?r.value:"",i=e.blocks[0],o=null;if(i)o=this._convGen(i,!0);else throw d.fromNode("\u4EE3\u5165\u3059\u308B\u5024\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);let u=e.name,c=this.findVar(u,o),a="/*[convLetProp]*/";if(c===null)throw d.fromNode(`\u5909\u6570\u300E${u}\u300F\u304C\u898B\u5F53\u305F\u308A\u307E\u305B\u3093\u3002`,e);let f=c.js;if(n.length>0)for(let l of n)if(typeof l.value=="string")f+=`['${l.value}']`;else throw d.fromNode(`\u5909\u6570\u300E${f}\u300F\u4EE5\u4E0B\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u306B\u30A2\u30AF\u30BB\u30B9\u3067\u304D\u307E\u305B\u3093\u3002`,e);return a+=`if (typeof ${f}.__setProp === 'function') { ${f}.__setProp('${s}', ${o}, __self); } else {`,a+=`__self.__checkPropAccessor('set', ${f});`,a+=`if (typeof ${f}.__setProp === 'function') { ${f}.__setProp('${s}', ${o}, __self); } else {`,a+=`${f}['${s}'] = ${o} }};`,";"+this.convLineno(e,!1)+a+`
`}convRefProp(e){let n=this._convGen(e.name,!0),r=e.index;if(!r||r.length<=0)throw d.fromNode("\u30D7\u30ED\u30D1\u30C6\u30A3\u304C\u3042\u308A\u307E\u305B\u3093\u3002",e);return this.convRefProp_genCode(n,r)}convRefProp_genCode(e,n){let r;if(n.length<=1){let s=n[0].value,i=`${e}.__getProp('${s}', __self)`,o=`${e}['${s}']`,u=`__self.__checkPropAccessor('get', ${e});
if (typeof ${e}.__getProp === 'function') { return ${i} }
return ${o}
`;r=`( (()=>{ ${`if (${e}.__getProp) { return ${i} } else { ${u} }`} })() )`}else{let s=[],i=[];for(let h=0;h<n.length;h++){let p=n[h].value;i.push(`['${p}']`),s.push(`'${p}'`)}let o=i.join(""),u="["+s.join(",")+"]",c=`${e}.__getProp(${u}, __self)`,a=`${e}${o}`,f=`__self.__checkPropAccessor('get', ${e});
if (${e}.__getProp) { return ${c} }
return ${a}
`;r=`( (()=>{ ${`if (${e}.__getProp) { return ${c} } else { ${f} }`} })() )`}return r}convDefLocalVar(e){let n=e.blocks[0],r="0";n.type!=="nop"&&(r=this._convGen(n,!0));let s=e.name,i=e.vartype;if(this.varsSet.names.has(s))throw d.fromNode(`${i}\u300E${s}\u300F\u306E\u4E8C\u91CD\u5B9A\u7FA9\u306F\u3067\u304D\u307E\u305B\u3093\u3002`,e);this.varsSet.names.add(s),i==="\u5B9A\u6570"&&this.varsSet.readonly.add(s);let o=`/*${i}*/${this.varname_set(s,r)};
`;return this.convLineno(e,!1)+o}convDefLocalVarlist(e){let n="",r=e.vartype,s="0";if(e.blocks.length>0){let c=e.blocks[0];c.type!=="nop"&&(s=this._convGen(c,!0))}let o=`$nako_i${this.loopId++}`;n+=`let ${o} = ${s}
`,n+=`if (!(${o} instanceof Array)) { ${o}=[${o}] }
`;let u=e.names?e.names:[];for(let c=0;c<u.length;c++){let f=u[c].value;this.varsSet.names.has(f),this.varsSet.names.add(f),r==="\u5B9A\u6570"&&this.varsSet.readonly.add(f),n+=this.varname_set(f,`${o}[${c}]`)+`;
`}return this.convLineno(e,!1)+`/*[convDefLocalVarlist]*/
`+n+`/*[/convDefLocalVarlist]*/
`}convString(e){let n=String(e.value);return n=n.replace(/\\/g,"\\\\"),n=n.replace(/"/g,'\\"'),n=n.replace(/\r/g,"\\r"),n=n.replace(/\n/g,"\\n"),'"'+n+'"'}convTryExcept(e){let n=this._convGen(e.blocks[0],!1),r=this._convGen(e.blocks[1],!1);return this.convLineno(e,!1)+`try {
${n}
} catch (e) {
  __self.__setSysVar("\u30A8\u30E9\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8", e.message);
;
${r}}
`}getUsedFuncSet(){return this.usedFuncSet}getPluginInitCode(){let e="",n="";for(let r in this.__self.__module){let s=`!${r}:\u521D\u671F\u5316`;this.varslistSet[0].names.has(s)&&(this.usedFuncSet.add(`!${r}:\u521D\u671F\u5316`),n+=`__v0.get('!${r}:\u521D\u671F\u5316')(__self);
`)}return n!==""&&(e+=`__v0.set('__line', 'l0:\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316');
`+n),e}},Gt=`
// === generated by nadesiko3 v__version__(core:__coreVersion__) ===
// -----------------------------------------------------------------
// <nadesiko3standalone>
// -----------------------------------------------------------------
// --- import
import path from 'path'
import { NakoRuntimeError } from './nako3runtime/nako_errors.mjs'
__codeImportFiles__
// --- init global self
const self = {
  newVariables: () => {
    const map = new Map()
    return map
  }
}
self.coreVersion = '__coreVersion__'
self.version = '__version__'
self.logger = {
  error: (message) => { console.error(message) },
  warn: (message) => { console.warn(message) },
  send: (level, message) => { console.log(message) },
  runtimeError: (message, lineInfo) => { console.error(message, lineInfo) }
};
self.__varslist = [self.newVariables(), self.newVariables(), self.newVariables()]
self.__v0 = self.__varslist[0]
self.initFuncList = []
self.clearFuncList = []
self.__propAccessor = []
// --- jsInit ---
__jsInit__
// --- Copy module functions ---
for (const mod of __importNames__) {
  for (const funcName in mod) {
    // \u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316\u3068\u30AF\u30EA\u30A2\u95A2\u6570\u3092\u767B\u9332
    if (funcName === '\u521D\u671F\u5316') {
      __self.initFuncList.push(mod[funcName].fn)
      continue
    }
    if (funcName === '!\u30AF\u30EA\u30A2') {
      __self.clearFuncList.push(mod[funcName].fn)
      continue
    }
    // \u95A2\u6570\u3084\u5B9A\u6570\u3092\u767B\u9332
    const f = mod[funcName]
    if (f.type === 'func') { // \u95A2\u6570
      __self.__varslist[0].set(funcName, f.fn)
    } else { // \u5B9A\u6570
      __self.__varslist[0].set(funcName, f.value)
    }
  }
}
__self.__vars = __self.__varslist[2];
__self.__module = {};
__self.__locals = __self.newVariables();
__self.__genMode = 'sync';
// \u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u521D\u671F\u5316\u30B3\u30FC\u30C9\u3092\u5B9F\u884C
__self.initFuncList.map(f => f(self))
// standalone
__self.__v0.set('__standalone', true)
// -----------------------------------------------------------------
try {
  try {
// -----------------------------------------------------------------
// <prepareMainCode>
__codeStandalone__
// </prepareMainCode>
// -----------------------------------------------------------------
// <mainCode>
// -----------------------------------------------------------------
__codeJS__
// -----------------------------------------------------------------
// </mainCode>
// -----------------------------------------------------------------
  } catch (err) {
    __self.logger.error(err);
    throw err;
  }
} finally {
  // standaloneCode\u3067\u306F\u3001\u5373\u6642\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u30AF\u30EA\u30A2\u30B3\u30FC\u30C9\u3092\u5B9F\u884C
  __self.clearFuncList.map(f => f(__self))
}
// -----------------------------------------------------------------
// </nadesiko3standalone>
// -----------------------------------------------------------------
`;function Ye(t,e,n){let r=new Ae(t);r.registerFunction(e);let s=L(D(r.convGen(e,n),1)),i=r.getDefFuncCode(t,n),o=String(new Date().getTime())+"_"+Math.floor(4294967295*Math.random()).toString();if(s&&n.isTest&&(s+=`
__self._runTests(__tests);
`),r.numAsyncFn>0||r.debugOption.useDebug){let l="__eval_nako3async_"+o+"__";s=`
// ------------------------------------------------------------------
// <nadesiko3::gen::async id="${o}" times="${r.numAsyncFn}">
// ------------------------------------------------------------------
async function ${l}(__self) {
  // --- code_begin ---
  ${s}
  // --- code_end ---
  // __\u51E6\u7406\u672B\u5C3E__ // \u2190 \u30C6\u30B9\u30C8\u306A\u3069\u3067\u5FC5\u8981\u306A\u306E\u3067\u6D88\u3055\u306A\u3044
} // end of ${l}
// ------------------------------------------------------------------
// call ${l}
(async () => {
  if (__self.__v0.get('__standalone')) {
    await ${l}(self);
  } else {
    ${l}.call(self, self)
    .then(() => { /* __async_ok__ */ })
    .catch(err => {
      if (err.message === '__\u7D42\u308F\u308B__') { return }
      __self.numFailures++
      // send errors to logger
      let rterr = __self.logger.runtimeError(err, __self.__v0.get('__line'))
      __self.logger.error(rterr)
    })
  }
})();
// ------------------------------------------------------------------
// </nadesiko3::gen::async id="${o}">
// ------------------------------------------------------------------
`}else{let l="__eval_nako3sync_"+o+"__";s=`
// ------------------------------------------------------------------
// <nadesiko3::gen::syncMode>
// ------------------------------------------------------------------
function ${l}(__self) {
try {
  ${s}
  // __\u51E6\u7406\u672B\u5C3E__ // \u2190 \u30C6\u30B9\u30C8\u306A\u3069\u3067\u5FC5\u8981\u306A\u306E\u3067\u6D88\u3055\u306A\u3044
} catch (err) {
  if (err.message === '__\u7D42\u308F\u308B__') { return }
  __self.numFailures++
  throw __self.logger.runtimeError(err, __self.__v0.get('__line'))
}
} // end of ${l}
${l}(__self)
// ------------------------------------------------------------------
// </nadesiko3::gen::syncMode>
// ------------------------------------------------------------------
`}s=D(s);let u="",c=[];for(let l of n.importFiles){if(l==="nako_errors.mjs")continue;let h="nako3runtime_"+l.replace(/\.(js|mjs)$/,"").replace(/[^a-zA-Z0-9_]/g,"_");c.push(h),u+=`import ${h} from './nako3runtime/${l}'
`}let a=r.getPluginInitCode(),f=`
// <runtimeEnvCode>
const self = this
${n.codeEnv}
${i}
${a}
${s}
// </runtimeEnvCode>
`;return t.getLogger().trace(`--- generate::jsInit ---
`+i),t.getLogger().trace(`--- generate::js ---
`+s),{runtimeEnv:f,standalone:Bt(Gt,{codeImportFiles:u,coreVersion:t.coreVersion,version:t.version,importNames:"["+c.join(", ")+"]",codeStandalone:n.codeStandalone,codeJS:s,jsInit:i}),gen:r}}function Bt(t,e){for(let n in e){let r=`__${n}__`,s=e[n];t=t.split(r).join(s)}return t}function D(t,e=0){t=t.replace(/;{2,}/g,";"),t=t.replace(/\n{2,}/g,`
`);let n="";for(let i=0;i<e;i++)n+="  ";let r=[],s=t.split(`
`);for(let i=0;i<s.length;i++){let o=s[i];o=o.replace(/^(\s*);/,"$1"),L(o)!==""&&r.push(n+o)}return t=r.join(`
`),t}function L(t){return t=String(t),t.replace(/^\s+|\s+$/g,"")}function de(t){let e=[];for(let n=0;n<t.length;n++){let r=t[n],s=r.type,i=r.value,o=`[${s}:${i}]`;s===i&&(o=s),s==="comma"&&(o=","),s==="string"&&(o=`"${i}"`),s==="number"&&(o=`(${i})`),s==="word"&&(o=`[word:${i}]`),e[r.line]||(e[r.line]=Ut(r.indent)),e[r.line]+=o+r.josi+"|"}return e.join(`
`)}function Ut(t){let e="";for(let n=0;n<t;n++)e+=" ";return e}var pe=x();function S(t,e,n=void 0){return n&&(pe=n),x(t,e,pe.indent,pe.line,pe.file)}var Wt=!1;function He(t){return t.type==="\u9055\u3048\u3070"||t.type==="word"&&t.value==="\u30A8\u30E9\u30FC"&&t.josi==="\u306A\u3089\u3070"}function qt(t){let e=0,n=0,r=-1,s=!1;for(let i=0;i<t.length;i++){let o=t[i];if(o.type=="{"){e++,r==-1&&(r=o.indent);continue}if(o.type=="["){n++,r==-1&&(r=o.indent);continue}if(o.type=="}"){e--,e==0&&n==0&&(s=!0);continue}if(o.type=="]"){n--,e==0&&n==0&&(s=!0);continue}if(e>0||n>0){o.indent=r,o.type=="eol"&&(o.type="range_comment",o.value="json::eol");continue}s&&(o.indent=r,o.type=="eol"&&(s=!1,r=-1))}}function Ke(t){qt(t);let e=Y(t,"eol"),n=[],r=-1;for(let i=0;i<e.length;i++){let o=e[i];if(Ze(o))continue;let u=Qe(o);if(r>=0){let a=u.indent;for(;r>=a;){let f=u;if(He(f)&&r===a||(e[i-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",f)),e[i-1].push(S("eol",`
`,f))),n.pop(),n.length>0)r=n[n.length-1];else{r=-1;break}}}let c=zt(o);c.type===":"&&(e[i]=e[i].filter(a=>a!==c),r=c.indent,n.push(r))}if(e.length>0&&n.length>0){let i=t[0];for(let o=e.length-1;o>=0;o--){let u=e[o];if(u.length>0){i=u[u.length-1];break}}for(let o=0;o<n.length;o++)e[e.length-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",i)),e[e.length-1].push(S("eol",`
`,i))}let s=X(e);return Wt&&console.log("###",de(s)),s}function X(t){let e=[];for(let n of t)for(let r of n)e.push(r);return e}function zt(t){let e=t.length,n=x("?");if(e===0)return n;for(let r=0;r<e&&(n=t[e-r-1],!(n.type!=="eol"&&!(n.type==="line_comment"||n.type==="range_comment")));r++);return n}function Y(t,e){let n=[],r=[],s=0;for(let i of t)r.push(i),i.type==="{"?s++:i.type==="}"?s--:s===0&&i.type===e&&(n.push(r),r=[]);return r.length>0&&n.push(r),n}function Ze(t){if(t.length===0)return!0;for(let e=0;e<t.length;e++){let n=t[e].type;if(!(n==="eol"||n==="line_comment"||n==="range_comment"))return!1}return!0}function Qe(t){for(let e=0;e<t.length;e++){let n=t[e].type;if(!(n==="eol"||n==="line_comment"||n==="range_comment"))return t[e]}return t[0]}var Xt=["!\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","!\u3053\u3053\u307E\u3067\u3060\u308B\u3044","\u{1F4A1}\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587","\u{1F4A1}\u3053\u3053\u307E\u3067\u3060\u308B\u3044"];function et(t){if(!Yt(t))return t;for(let c of t)if(c.type==="\u3053\u3053\u307E\u3067")throw new ce("\u30A4\u30F3\u30C7\u30F3\u30C8\u69CB\u6587\u304C\u6709\u52B9\u5316\u3055\u308C\u3066\u3044\u308B\u3068\u304D\u306B\u300E\u3053\u3053\u307E\u3067\u300F\u3092\u4F7F\u3046\u3053\u3068\u306F\u3067\u304D\u307E\u305B\u3093\u3002",c.line,c.file);let e=0,n=0,r=c=>{c.forEach(a=>{a.type==="{"&&e++,a.type==="}"&&e--,a.type==="["&&n++,a.type==="]"&&n--})},s=[],i=Y(t,"eol"),o=0;for(let c=0;c<i.length;c++){let a=i[c];if(Ze(a))continue;if(n>0||e>0){r(a);continue}let f=Qe(a),l=f.indent;if(l!==o){if(o>=0)for(;o>l;){let h=s[s.length-1][1];if(!(He(f)&&h===l)){let p=i[c-1][0];i[c-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",p)),i[c-1].push(S("eol",`
`,p))}if(s.pop(),s.length>0)o=s[s.length-1][0];else{o=0;break}}if(!(n>0||e>0)&&(r(a),l>o)){s.push([l,o]),o=l;continue}}}for(let c=0;c<s.length;c++){let a=t[0];for(let f=i.length-1;f>=0;f--){let l=i[f];if(l.length>0){for(let h=0;h<l.length;h++){let p=l[l.length-h-1];if(p.line>0){a=p;break}}break}}i[i.length-1].push(S("\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067",a)),i[i.length-1].push(S("eol",`
`,a))}return X(i)}function Yt(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&Xt.indexOf(n.value)>=0)return!0}return!1}var Ht=["!DNCL\u30E2\u30FC\u30C9","\u{1F4A1}DNCL\u30E2\u30FC\u30C9"],Kt={"\u2190:\u2190":["eq","="],"\xF7:\xF7":["\xF7\xF7","\xF7\xF7"],"{:{":["[","["],"}:}":["]","]"],"word:\u3092\u5B9F\u884C":["\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067"],"word:\u4E71\u6570":["word","\u4E71\u6570\u7BC4\u56F2"],"word:\u8868\u793A":["word","\u9023\u7D9A\u8868\u793A"]};function rt(t){if(!Zt(t))return t;let e=Y(t,"eol");for(let n=0;n<e.length;n++){let r=e[n];if(r.length<=1)continue;for(let a=0;a<r.length;a++){if(r[a].type==="|"){r[a].type="range_comment";continue}break}let s=r[0];s.type==="word"&&s.value==="\u7E70\u8FD4"&&r.splice(0,r.length,x("word","\u5F8C\u5224\u5B9A",s.indent,s.line,s.file),x("word","\u7E70\u8FD4",s.indent,s.line,s.file));let i=F(r,["word:\u306A\u308B","word:\u7E70\u8FD4"]);i>0&&nt(r,i);let o=F(r,["word:\u306A\u308B","word:\u5B9F\u884C"]);o>0&&nt(r,o);let u=F(r,["word:\u306A\u3044"]);for(u>=1&&r[u].josi==="\u306A\u3089\u3070"&&(r[u-1].josi="\u3067\u306A\u3051\u308C\u3070",r.splice(u,1));;){let a=F(r,["word:\u4E8C\u9032","word:\u8868\u793A"]);if(a<0)break;r[a].value="\u4E8C\u9032\u8868\u793A",r[a].josi="",r.splice(a+1,1)}for(;;){let a=F(r,["word:\u6539\u884C","word:\u8868\u793A"]);if(a<0)break;let f=r[a];f.value="\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A",f.josi="",r.splice(a+1,1)}for(;;){let a=F(r,["word:\u3092\u5B9F\u884C","comma:,","word:\u305D\u3046"]);if(a<0)break;let f=r[a+2];if(f.josi==="\u3067\u306A\u3051\u308C\u3070"){f.type="\u9055\u3048\u3070",f.value="\u9055\u3048\u3070",f.josi="",r.splice(a,3,f);continue}else if(f.josi==="\u3067"){let l=r[a+3];if(l.value.substring(0,4)==="\u306A\u304F\u3082\u3057"){if(f.type="\u9055\u3048\u3070",f.value="\u9055\u3048\u3070",f.josi="",r.splice(a,3,f),l.value.length>4){let h=l.value.substring(4),p=x("word",h,l.indent,l.line,l.file);h.match(/^\d/)&&(p.type="number"),r.splice(a+2,0,p),l.value=l.value.substring(0,4)}l.type="\u3082\u3057",l.value="\u3082\u3057",l.josi="";continue}}break}for(;;){let a=F(r,["word:\u5897","word:\u3089"]);if(a<0)break;let f=r[a];f.type="word",f.value="\u5897\u7E70\u8FD4",f.josi="",r.splice(a,2,f)}for(;;){let a=F(r,["word:\u6E1B","word:\u3089"]);if(a<0)break;let f=r[a];f.type="word",f.value="\u6E1B\u7E70\u8FD4",f.josi="",r.splice(a,2,f)}for(;;){let a=F(r,["word:\u3092\u7E70\u308A\u8FD4"]);if(a<0)break;let f=r[a];f.type="\u3053\u3053\u307E\u3067",f.value="\u3053\u3053\u307E\u3067",f.josi=""}for(;;){let a=F(r,["word:\u3059\u3079\u3066","word:\u8981\u7D20"]);if(a>=1)tt(r,a);else break}for(;;){let a=F(r,["word:\u3059\u3079\u3066","word:\u5024"]);if(a>=1)tt(r,a);else break}let c=0;for(;c<r.length;){let a=r[c];if(a.type==="word"&&a.value.length>=2){let f=a.value.charAt(a.value.length-1);(f==="\u6E1B"||f==="\u5897")&&(a.value=a.value.substring(0,a.value.length-1),a.josi="\u3060\u3051",r.splice(c+1,0,x("word",f,a.indent,a.line,a.file))),c++;continue}c++}}for(let n=0;n<t.length;n++){let r=t[n],s=Kt[String(r.type)+":"+String(r.value)];s!==void 0&&(r.type=s[0],r.value=s[1])}return t=X(e),t}function tt(t,e){let n=t[e];t[e-1].josi="";let r=x("eq","=",n.indent,n.line,n.file),s=x("[","[",n.indent,n.line,n.file),i=x("]","]",n.indent,n.line,n.file);i.josi="\u306B";let o=t[e+2];o.josi="";let u=x("number",100,n.indent,n.line,n.file);u.josi="\u3092";let c=x("word","\u639B",n.indent,n.line,n.file);t.splice(e,4,r,s,o,i,u,c)}function nt(t,e){let n=F(t,["word:\u3092"]);n>=0&&(t[n].type="\u3053\u3053\u307E\u3067",t[n].value="\u3053\u3053\u307E\u3067");let r=F(t,["word:\u304C"]);r>=0&&(t[r].type="\u3053\u3053\u307E\u3067",t[r].value="\u3053\u3053\u307E\u3067"),t[e+1].value="\u9593"}function F(t,e){let n=e.map(r=>r.split(":"));for(let r=0;r<t.length;r++){let s=!0;for(let i=0;i<n.length;i++){let o=n[i],u=r+i;if(u>=t.length)return-1;if(!(t[u].type===o[0]&&t[u].value===o[1])){s=!1;break}}if(s)return r}return-1}function Zt(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&Ht.indexOf(n.value)>=0)return n.type="DNCL\u30E2\u30FC\u30C9",!0}return!1}var Qt=!1,Ne=30,en=["!DNCL2\u30E2\u30FC\u30C9","\u{1F4A1}DNCL2\u30E2\u30FC\u30C9","!DNCL2","\u{1F4A1}DNCL2"],tn={"\u2190:\u2190":["eq","="],"\xF7:\xF7":["\xF7\xF7","\xF7\xF7"],"{:{":["[","["],"}:}":["]","]"],"word:not":["not","!"],"word:\u4E71\u6570":["word","\u4E71\u6570\u7BC4\u56F2"],"word:\u8868\u793A":["word","\u9023\u7D9A\u8868\u793A"],"word:\u3068\u5B9A\u7FA9":["\u3053\u3053\u307E\u3067","\u3053\u3053\u307E\u3067"]};function st(t){if(!nn(t))return t;let e=Y(t,"eol");for(let n=0;n<e.length;n++){let r=e[n];if(r.length<=1)continue;let s=V(r,["word:\u306A\u3044"]);s>=1&&r[s].josi==="\u306A\u3089\u3070"&&(r[s-1].josi="\u3067\u306A\u3051\u308C\u3070",r.splice(s,1));for(let o=0;o<r.length;o++){let u=r[o];(u.value==="\u305D\u3046"||u.value==="\u305D\u308C")&&(u.josi==="\u3067\u306A\u3051\u308C\u3070"||u.josi==="\u3067\u306A\u304F")&&(u.type="\u9055\u3048\u3070",u.value="\u9055\u3048\u3070",u.josi="")}for(;;){let o=V(r,["word:\u3092\u5B9F\u884C","comma:,","word:\u305D\u3046"]);if(o<0)break;let u=r[o+2];if(u.josi==="\u3067\u306A\u3051\u308C\u3070"){u.type="\u9055\u3048\u3070",u.value="\u9055\u3048\u3070",u.josi="",r.splice(o,3,u);continue}else if(u.josi==="\u3067"){let c=r[o+3];if(c.value.substring(0,4)==="\u306A\u304F\u3082\u3057"){if(u.type="\u9055\u3048\u3070",u.value="\u9055\u3048\u3070",u.josi="",r.splice(o,3,u),c.value.length>4){let a=c.value.substring(4),f=x("word",a,c.indent,c.line,c.file);a.match(/^\d/)&&(f.type="number"),r.splice(o+2,0,f),c.value=c.value.substring(0,4)}c.type="\u3082\u3057",c.value="\u3082\u3057",c.josi="";continue}}break}for(;;){let o=V(r,["word:\u305D\u3046","word:\u306A\u304F"]);if(o<0)break;let u=r[o];if(u.josi==="\u3067"){u.type="\u9055\u3048\u3070",u.value="\u9055\u3048\u3070",u.josi="",r.splice(o+1,1);continue}break}for(;;){let o=V(r,["word:\u305D\u3046","word:\u306A\u304F\u3082\u3057"]);if(o<0)break;let u=r[o],c=r[o+1];u.type="\u9055\u3048\u3070",u.value="\u9055\u3048\u3070",u.josi="",c.type="\u3082\u3057",c.value="\u3082\u3057",c.josi=""}for(;;){let o=V(r,["word:\u5897","word:\u3089"]);if(o<0)break;let u=r[o];u.type="word",u.value="\u5897\u7E70\u8FD4",u.josi="",r.splice(o,2,u)}for(;;){let o=V(r,["word:\u6E1B","word:\u3089"]);if(o<0)break;let u=r[o];u.type="word",u.value="\u6E1B\u7E70\u8FD4",u.josi="",r.splice(o,2,u)}for(;;){let o=V(r,["word:\u5897","word:\u3089\u7E70\u308A\u8FD4"]);if(o<0)break;let u=r[o];u.type="word",u.value="\u5897\u7E70\u8FD4",u.josi="",r.splice(o,2,u)}for(;;){let o=V(r,["word:\u6E1B","word:\u3089\u7E70\u308A\u8FD4"]);if(o<0)break;let u=r[o];u.type="word",u.value="\u6E1B\u7E70\u8FD4",u.josi="",r.splice(o,2,u)}for(let o=0;o<r.length;o++){if(Oe([["word:\u914D\u5217","word:\u914D\u5217\u5909\u6570"],"word","word:\u3059\u3079\u3066",["word:\u8981\u7D20","word:\u5024"],"*","word:\u4EE3\u5165"],r,o)){let u=r[o+1];u.josi="";let c=r[o+4];c.josi="",r.splice(o,6,u,S("eq","=",u),S("word","\u639B"),S("(","("),S("[","["),c,S("]","]"),S("comma",","),S("number",Ne),S(")",")")),o+=6}if(Oe(["word","word:\u3059\u3079\u3066",["word:\u8981\u7D20","word:\u5024"],["number","string","word"],"word:\u3059\u308B"],r,o)){let u=r[o];u.josi="";let c=r[o+3];c.josi="",r.splice(o,5,u,S("eq","=",u),S("word","\u639B"),S("(","("),S("[","["),c,S("]","]"),S("comma",","),S("number",Ne),S(")",")"))}if(Oe([["word:\u914D\u5217\u5909\u6570","word:\u914D\u5217"],"word","word:\u521D\u671F\u5316"],r,o)){let u=r[o+1];u.josi="",r.splice(o,3,u,S("eq","=",u),S("word","\u639B"),S("(","("),S("[","["),S("number",0),S("]","]"),S("comma",","),S("number",Ne),S(")",")"))}}for(;;){let o=V(r,["word:\u4E8C\u9032","word:\u8868\u793A"]);if(o<0)break;r[o].value="\u4E8C\u9032\u8868\u793A",r[o].josi="",r.splice(o+1,1)}for(;;){let o=V(r,["word:\u6539\u884C","word:\u8868\u793A"]);if(o<0)break;let u=r[o];u.value="\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A",u.josi="",r.splice(o+1,1)}let i=0;for(;i<r.length;){let o=r[i];if(o.type==="word"&&o.value.length>=2){let u=o.value.charAt(o.value.length-1);(u==="\u6E1B"||u==="\u5897")&&(o.value=o.value.substring(0,o.value.length-1),o.josi="\u3060\u3051",r.splice(i+1,0,x("word",u,o.indent,o.line,o.file))),i++;continue}i++}}for(let n=0;n<t.length;n++){let r=t[n],s=tn[String(r.type)+":"+String(r.value)];s!==void 0&&(r.type=s[0],r.value=s[1])}return t=X(e),Qt&&(console.log("// DEBUG---DNCL:tokens---BEGIN"),console.log(de(t)),console.log("// DEBUG---DNCL:tokens---END")),t}function Oe(t,e,n){let r=(s,i)=>{if(s instanceof Array){for(let u=0;u<s.length;u++)if(r(s[u],i))return!0;return!1}if(s==="*")return!0;if(s.indexOf(":")<0)return s===i.type;let o=`${i.type}:${i.value}`;return s===o};for(let s=0;s<t.length;s++){let i=s+n;if(i>=e.length)return!1;let o=t[s],u=e[i];if(!r(o,u))return!1}return!0}function V(t,e){let n=e.map(r=>r.split(":"));for(let r=0;r<t.length;r++){let s=!0;for(let i=0;i<n.length;i++){let o=n[i],u=r+i;if(u>=t.length)return-1;if(!(t[u].type===o[0]&&t[u].value===o[1])){s=!1;break}}if(s)return r}return-1}function nn(t){for(let e=0;e<t.length&&!(e>100);e++){let n=t[e];if(n.type==="line_comment"&&en.indexOf(n.value)>=0)return n.type="DNCL2\u30E2\u30FC\u30C9",!0}return!1}var ye=class{constructor(e,n){this.sourceCodeLength=e,this.preprocessed=n;let r=0;this.cumulativeSum=[];for(let s of n)this.cumulativeSum.push(r),r+=s.text.length;this.lastIndex=0,this.lastPreprocessedCodePosition=0}map(e){let n=this.findIndex(e);return Math.min(this.preprocessed[n].sourcePosition+(e-this.cumulativeSum[n]),n===this.preprocessed.length-1?this.sourceCodeLength:this.preprocessed[n+1].sourcePosition-1)}findIndex(e){e<this.lastPreprocessedCodePosition&&(this.lastIndex=0),this.lastPreprocessedCodePosition=e;for(let n=this.lastIndex;n<this.preprocessed.length-1;n++)if(e<this.cumulativeSum[n+1])return this.lastIndex=n,n;return this.lastIndex=this.preprocessed.length-1,this.preprocessed.length-1}},_e=class{constructor(e,n,r){this.lines=[],this.linesInsertedByIndentationSyntax=n,this.linesDeletedByIndentationSyntax=r;let s=0;for(let i of e.split(`
`))this.lines.push({offset:s,len:i.length}),s+=i.length+1;this.lastLineNumber=0,this.lastOffset=0}map(e,n){if(e===null)return{startOffset:e,endOffset:n};let r=this.getLineNumber(e);for(let s of this.linesInsertedByIndentationSyntax){if(r===s){e=null,n=null;break}r>s&&(e-=this.lines[s].len+1,n!==null&&(n-=this.lines[s].len+1))}for(let s of this.linesDeletedByIndentationSyntax)r>=s.lineNumber&&(e!==null&&(e+=s.len+1),n!==null&&(n+=s.len+1));return{startOffset:e,endOffset:n}}getLineNumber(e){e<this.lastOffset&&(this.lastLineNumber=0),this.lastOffset=e;for(let n=this.lastLineNumber;n<this.lines.length-1;n++)if(e<this.lines[n+1].offset)return this.lastLineNumber=n,n;return this.lastLineNumber=this.lines.length-1,this.lines.length-1}},me=class{constructor(e){this.lineOffsets=[];let n=0;for(let r of e.split(`
`))this.lineOffsets.push(n),n+=r.length+1;this.lastLineNumber=0,this.lastOffset=0}map(e,n){e<this.lastOffset&&(this.lastLineNumber=0),this.lastOffset=e;for(let r=this.lastLineNumber;r<this.lineOffsets.length-1;r++)if(e<this.lineOffsets[r+1])return this.lastLineNumber=r,{line:r+(n?1:0),column:e-this.lineOffsets[r]};return this.lastLineNumber=this.lineOffsets.length-1,{line:this.lineOffsets.length-1+(n?1:0),column:e-this.lineOffsets[this.lineOffsets.length-1]}}};function Fe(t,e){if(typeof t.startOffset=="number"&&(t.startOffset-=e.length),typeof t.endOffset=="number"&&(t.endOffset-=e.length),e!==""){let n=e.split(`
`);typeof t.line=="number"&&(t.line-=n.length-1),t.line===0&&typeof t.column=="number"&&(t.column-=n[n.length-1].length)}return t}var rn={reset:"\x1B[0m",bold:"\x1B[1m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},Ee=["black","red","green","yellow","blue","magenta","cyan","white"],sn=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),on=t=>{let e=t.replace(/\x1b\[\d+m/g,""),n=[],r="inherit",s="inherit",i=t===e?e:t.replace(/\x1b\[(\d+)m/g,(a,f)=>{let l=+f;return l===0&&(r="inherit",s="inherit"),l===1&&(s="bold"),l>=30&&l<=37&&(r=Ee[l-30]),n.push(`color: ${r}; font-weight: ${s};`),"%c"}),o="inherit",u="inherit",c=t===e?e:"<span>"+sn(t).replace(/\x1b\[(\d+)m/g,(a,f)=>{let l=+f;return l===0&&(o="inherit",u="inherit"),l===1&&(u="bold"),l>=30&&l<=37&&(o=Ee[l-30]),`</span><span style="color: ${o}; font-weight: ${u};">`})+"</span>";return{noColor:e,nodeConsole:t===e?e:t+"\x1B[0m",html:c,browserConsole:[i,...n]}},j={convertColorTextFormat:on,colorNames:Ee,color:rn};var $=class t{static fromS(e){let n=t.trace;switch(e){case"all":n=t.all;break;case"trace":n=t.trace;break;case"debug":n=t.debug;break;case"info":n=t.info;break;case"warn":n=t.warn;break;case"error":n=t.error;break;case"stdout":n=t.stdout;break;default:throw new Error("[NakoLogger] unknown logger level:"+e)}return n}static toString(e){return["all","trace","debug","info","warn","error","stdout"][e]}};$.all=0;$.trace=1;$.debug=2;$.info=3;$.warn=4;$.error=5;$.stdout=6;function ee(t){return t?`${t.file||""}${t.line===void 0?"":`(${t.line+1}\u884C\u76EE): `}`:""}var te=class{constructor(){this.listeners=[],this.logs="",this.position=""}getErrorLogs(){return[this.logs.replace(/\s+$/,""),this.position]}clear(){this.logs="",this.position=""}addListener(e,n){let r=$.fromS(e);this.listeners.push({level:r,callback:n})}removeListener(e){this.listeners=this.listeners.filter(n=>n.callback!==e)}trace(e,n=null){this.sendI($.trace,`${j.color.bold}[\u30C7\u30D0\u30C3\u30B0\u60C5\u5831\uFF08\u8A73\u7D30\uFF09]${j.color.reset}${ee(n)}${e}`,n)}debug(e,n=null){this.sendI($.debug,`${j.color.bold}[\u30C7\u30D0\u30C3\u30B0\u60C5\u5831]${j.color.reset}${ee(n)}${e}`,n)}info(e,n=null){this.sendI($.info,`${j.color.bold}${j.color.blue}[\u60C5\u5831]${j.color.reset}${ee(n)}${e}`,n)}warn(e,n=null){this.sendI($.warn,`${j.color.bold}${j.color.green}[\u8B66\u544A]${j.color.reset}${ee(n)}${e}`,n)}error(e,n=null){if(e instanceof Error&&typeof e.type=="string")switch(e.type){case"NakoRuntimeError":case"NakoError":if(e instanceof M){let s=e,i=n;i==null&&(i={file:s.file,line:s.line||0,startOffset:0,endOffset:0}),this.sendI($.error,s.message,i);return}}e instanceof Error&&(e=e.message),this.sendI($.error,`${j.color.bold}${j.color.red}[\u30A8\u30E9\u30FC]${j.color.reset}${ee(n)}${e}`,n)}runtimeError(e,n){return new G(e,n)}stdout(e,n=null){this.sendI($.stdout,`${e}`,n)}send(e,n,r,s=null,i=null){let o=$.fromS(e);this.sendI(o,n,r,s,i)}sendI(e,n,r,s=null,i=null){let o=()=>{let u=j.convertColorTextFormat(n),c="";return n.includes(`
`)&&(c+="border-top: 1px solid #8080806b; border-bottom: 1px solid #8080806b;"),{noColor:u.noColor,nodeConsole:u.nodeConsole,browserConsole:i||u.browserConsole,html:`<div style="${c}">`+(s||u.html)+"</div>",level:$.toString(e),position:r}};if(e===$.error){let u=o();this.logs+=u.noColor+`
`,r&&this.position!==null&&(this.position=`l${r.line}:${r.file||"unknown"}`)}for(let u of this.listeners)if(u.level<=e){let c=o();u.callback(c)}}};var ge=class{constructor(e,n,r=0){this.guid=r,this.lastJSCode="",this.__locals=new Map,this.__varslist=[e.newVaiables(e.__varslist[0]),e.newVaiables(e.__varslist[1]),e.newVaiables(e.__varslist[2])],this.numFailures=0,this.index=0,this.nextIndex=-1,this.__code=[],this.__callstack=[],this.__stack=[],this.__labels=[],this.__genMode=n.genMode,this.version=e.version,this.coreVersion=e.coreVersion,this.__module={...e.__module},this.pluginfiles={...e.getPluginfiles()},this.gen=n,this.logger=e.getLogger(),this.compiler=e,this.josiList=e.josiList,this.reservedWords=e.reservedWords}clearLog(){this.__varslist[0].set("\u8868\u793A\u30ED\u30B0","")}get log(){let e=this.__varslist[0].get("\u8868\u793A\u30ED\u30B0");return e=e.replace(/\s+$/,""),e}__setSysVar(e,n){this.__varslist[0].set(e,n)}__getSysVar(e){return this.__varslist[0].get(e)}runEx(e,n,r,s=""){return r.preCode=s,r.nakoGlobal=this,this.compiler.runSync(e,n,r)}async runAsync(e,n,r,s=""){return r.preCode=s,r.nakoGlobal=this,await this.compiler.runAsync(e,n,r)}_runTests(e){let n=`${j.color.bold}\u30C6\u30B9\u30C8\u306E\u5B9F\u884C\u7D50\u679C${j.color.reset}
`,r=0,s=0;for(let i of e)try{i.f(),n+=`${j.color.green}\u2714${j.color.reset} ${i.name}
`,r++}catch(o){let u=o instanceof Error?o.message:String(o);n+=`${j.color.red}\u2613${j.color.reset} ${i.name}: ${u}
`,s++}s>0?n+=`${j.color.green}\u6210\u529F ${r}\u4EF6 ${j.color.red}\u5931\u6557 ${s}\u4EF6`:n+=`${j.color.green}\u6210\u529F ${r}\u4EF6`,this.numFailures=s,this.logger.stdout(n)}clearPlugins(){let e="!\u30AF\u30EA\u30A2";for(let n in this.pluginfiles){let r=this.__module[n];if(r[e]&&r[e].fn)try{r[e].fn(this)}catch(s){this.logger.error(`\u30D7\u30E9\u30B0\u30A4\u30F3\u300E${n}\u300F\u306E\u30AF\u30EA\u30A2\u95A2\u6570\u3067\u30A8\u30E9\u30FC\u304C\u767A\u751F\u3057\u307E\u3057\u305F:`+String(s.message))}}}reset(){this.clearPlugins()}destroy(){this.reset()}};var un={version:"3.7.9",major:3,minor:7,patch:9},Te=un;var it={meta:{type:"const",value:{pluginName:"plugin_system",description:"\u30B7\u30B9\u30C6\u30E0\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!1,fn:function(sys){let system=sys;sys.isDebug=!1,sys.__setSysVar=(t,e)=>system.__v0.set(t,e),sys.__getSysVar=(t,e=void 0)=>{let n=system.__v0.get(t);return n===void 0?e:n},sys.__setSore=t=>(sys.__vars.set("\u305D\u308C",t),t),sys.__getSore=()=>sys.__vars.get("\u305D\u308C"),sys.tags={},sys.__setSysVar("\u30CA\u30C7\u30B7\u30B3\u30D0\u30FC\u30B8\u30E7\u30F3",sys.version),sys.__setSysVar("\u30CA\u30C7\u30B7\u30B3\u8A00\u8A9E\u30D0\u30FC\u30B8\u30E7\u30F3",sys.coreVersion),system.__namespaceList||(system.__namespaceList=[]),sys.__findVar=function(t,e){if(typeof t=="function")return t;let n=system.__locals.get(t);if(n)return n;if(t.indexOf("__")>=0){for(let s=2;s>=0;s--){let o=system.__varslist[s].get(t);if(o)return o}return e}let r=system.__modList?system.__modList:[system.__modName];for(let s of r){let i=`${s}__${t}`;for(let o=2;o>=0;o--){let c=system.__varslist[o].get(i);if(c)return c}}return e},sys.__findFunc=function(t,e){let n=sys.__findVar(t);if(typeof n=="function")return n;throw new Error(`\u300E${e}\u300F\u306B\u5B9F\u884C\u3067\u304D\u306A\u3044\u95A2\u6570\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002`)},sys.__exec=function(t,e){let n=sys.__getSysVar(t);if(n)return n.apply(this,e);let r=sys.__findVar(t);if(!r)throw new Error("\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u3067\u30A8\u30A4\u30EA\u30A2\u30B9\u306E\u6307\u5B9A\u30DF\u30B9:"+t);return r.apply(this,e)},sys.__timeout=[],sys.__interval=[];let z2=sys.__zero2=t=>(t="00"+String(t),t.substring(t.length-2));sys.__zero=(t,e)=>{let n="";for(let r=0;r<e;r++)n+="0";return t=n+t,t.substring(t.length-e)},sys.__formatDate=t=>String(t.getFullYear())+"/"+z2(t.getMonth()+1)+"/"+z2(t.getDate()),sys.__formatTime=t=>z2(t.getHours())+":"+z2(t.getSeconds())+":"+z2(t.getMinutes()),sys.__formatDateTime=(t,e)=>{let n=String(t.getFullYear())+"/"+z2(t.getMonth()+1)+"/"+z2(t.getDate()),r=z2(t.getHours())+":"+z2(t.getMinutes())+":"+z2(t.getSeconds());return e.match(/^\d+\/\d+\/\d+\s+\d+:\d+:\d+$/)?n+" "+r:e.match(/^\d+\/\d+\/\d+$/)?n:e.match(/^\d+:\d+:\d+$/)?r:n+" "+r},sys.__str2date=t=>{if(t=(""+t).replace(/(^\s+|\s+$)/,""),t.match(/^(\d+|\d+\.\d+)$/))return new Date(parseFloat(t)*1e3);if(t.match(/^\d+:\d+(:\d+)?$/)){let n=new Date,r=(t+":0").split(":");return new Date(n.getFullYear(),n.getMonth(),n.getDate(),parseInt(r[0]),parseInt(r[1]),parseInt(r[2]))}t=t.replace(/[\s:\-T]/g,"/"),t+="/0/0/0";let e=t.split("/");return new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]),parseInt(e[3]),parseInt(e[4]),parseInt(e[5]))},sys.__printPool="",sys.__parseFloatOrBigint=t=>typeof t=="bigint"?t:parseFloat(t),system.chk=(t,e)=>{if(typeof t>"u"){let n=system.constPools[e],[r,s,i,o]=n,u=system.constPoolsTemplate[r];for(let a in s){let f=system.constPoolsTemplate[s[a]];u=u.split(`$${a}`).join(f)}let c=system.constPoolsTemplate[i];sys.logger.warn(u,{file:c,line:o})}return t},sys.__evalSafe=t=>{let e=eval;try{return e(t)}catch(n){return console.warn("[eval]",n),null}},sys.__evalJS=(src,sys)=>{try{return eval(src)}catch(t){return console.warn("[eval]",t),null}},sys.__registPropAccessor=(t,e,n)=>{system.__propAccessor.push({target:t,getProp:e,setProp:n})},sys.__checkPropAccessor=(t,e)=>{if(t==="get"&&e.__getProp===void 0||t==="set"&&e.__setProp===void 0){for(let n=0;n<system.__propAccessor.length;n++){let r=system.__propAccessor[n];if(r.target[Symbol.hasInstance](e)){r.getProp?e.__getProp=r.getProp:e.__getProp=null,r.setProp?e.__setProp=r.setProp:e.__setProp=null;return}}e.__getProp=e.__setProp=null}},sys.__hatena=sys.__getSysVar("\u30C7\u30D0\u30C3\u30B0\u8868\u793A")}},"!\u30AF\u30EA\u30A2":{type:"func",josi:[],fn:function(t){t.__exec&&t.__exec("\u5168\u30BF\u30A4\u30DE\u30FC\u505C\u6B62",[t]),t.__setSysVar("\u8868\u793A\u30ED\u30B0","")}},\u30CA\u30C7\u30B7\u30B3\u30D0\u30FC\u30B8\u30E7\u30F3:{type:"const",value:"?"},\u30CA\u30C7\u30B7\u30B3\u8A00\u8A9E\u30D0\u30FC\u30B8\u30E7\u30F3:{type:"const",value:"?"},\u30CA\u30C7\u30B7\u30B3\u30A8\u30F3\u30B8\u30F3:{type:"const",value:"nadesi.com/v3"},\u30CA\u30C7\u30B7\u30B3\u7A2E\u985E:{type:"const",value:"?"},\u306F\u3044:{type:"const",value:!0},\u3044\u3044\u3048:{type:"const",value:!1},\u771F:{type:"const",value:!0},\u507D:{type:"const",value:!1},\u6C38\u9060:{type:"const",value:!0},\u30AA\u30F3:{type:"const",value:!0},\u30AA\u30D5:{type:"const",value:!1},\u6539\u884C:{type:"const",value:`
`},\u30BF\u30D6:{type:"const",value:"	"},\u30AB\u30C3\u30B3:{type:"const",value:"\u300C"},\u30AB\u30C3\u30B3\u9589:{type:"const",value:"\u300D"},\u6CE2\u30AB\u30C3\u30B3:{type:"const",value:"{"},\u6CE2\u30AB\u30C3\u30B3\u9589:{type:"const",value:"}"},OK:{type:"const",value:!0},NG:{type:"const",value:!1},\u30AD\u30E3\u30F3\u30BB\u30EB:{type:"const",value:0},TRUE:{type:"const",value:!0},FALSE:{type:"const",value:!1},true:{type:"const",value:!0},false:{type:"const",value:!1},PI:{type:"const",value:Math.PI},\u7A7A:{type:"const",value:""},NULL:{type:"const",value:null},undefined:{type:"const",value:void 0},\u672A\u5B9A\u7FA9:{type:"const",value:void 0},\u30A8\u30E9\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8:{type:"const",value:""},\u5BFE\u8C61:{type:"const",value:""},\u5BFE\u8C61\u30AD\u30FC:{type:"const",value:""},\u56DE\u6570:{type:"const",value:""},CR:{type:"const",value:"\r"},LF:{type:"const",value:`
`},\u975E\u6570:{type:"const",value:NaN},\u7121\u9650\u5927:{type:"const",value:1/0},\u623B\u5024\u7121:{type:"const",value:0},\u623B\u5024\u6709:{type:"const",value:1},\u7A7A\u914D\u5217:{type:"func",josi:[],pure:!0,fn:function(){return[]}},\u7A7A\u8F9E\u66F8:{type:"func",josi:[],pure:!0,fn:function(){return{}}},\u7A7A\u30CF\u30C3\u30B7\u30E5:{type:"func",josi:[],pure:!0,fn:function(){return{}}},\u7A7A\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8:{type:"func",josi:[],pure:!1,fn:function(t){return t.__exec("\u7A7A\u30CF\u30C3\u30B7\u30E5",[t])}},\u771F\u507D\u5224\u5B9A:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return t?"\u771F":"\u507D"}},\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){t=String(e.__printPool)+t,e.__printPool="",e.__setSysVar("\u8868\u793A\u30ED\u30B0",String(e.__getSysVar("\u8868\u793A\u30ED\u30B0"))+t+`
`),e.logger.send("stdout",t+"")},return_none:!0},\u7D99\u7D9A\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__printPool+=t},return_none:!0},\u9023\u7D9A\u8868\u793A:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){let e=t.pop(),n=t.join("");e.__exec("\u8868\u793A",[n,e])},return_none:!0},\u9023\u7D9A\u7121\u6539\u884C\u8868\u793A:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){let e=t.pop(),n=t.join("");e.__exec("\u7D99\u7D9A\u8868\u793A",[n,e])},return_none:!0},\u8868\u793A\u30ED\u30B0:{type:"const",value:""},\u8868\u793A\u30ED\u30B0\u30AF\u30EA\u30A2:{type:"func",josi:[],pure:!0,fn:function(t){t.__setSysVar("\u8868\u793A\u30ED\u30B0","")},return_none:!0},\u8A00:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.logger.send("stdout",t+"")},return_none:!0},\u30B3\u30F3\u30BD\u30FC\u30EB\u8868\u793A:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t){console.log(t)},return_none:!0},\u8DB3:{type:"func",josi:[["\u306B","\u3068"],["\u3092"]],isVariableJosi:!1,pure:!0,fn:function(t,e){return typeof t=="bigint"||typeof e=="bigint"?BigInt(t)+BigInt(e):parseFloat(t)+parseFloat(e)}},\u5408\u8A08:{type:"func",josi:[["\u3068","\u3092","\u306E"]],isVariableJosi:!0,pure:!0,fn:function(...t){let e=t.pop();if(t.length>=1&&t[0]instanceof Array)return e.__exec("\u914D\u5217\u5408\u8A08",[t[0],e]);let n=!1,r=0;for(let s of t){if(typeof s=="bigint"){n=!0;break}r+=parseFloat(s)}if(n){let s=0n;for(let i of t)s+=BigInt(i);return s}return r}},\u5F15:{type:"func",josi:[["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){return t-e}},\u639B:{type:"func",josi:[["\u306B","\u3068"],["\u3092"]],pure:!0,fn:function(t,e){if(typeof t=="number")return t*e;if(typeof t=="string"){let n="";for(let r=0;r<parseInt(e);r++)n+=t;return n}if(t instanceof Array){let n=[];for(let r=0;r<parseInt(e);r++)n.push(...t);return n}return t*e}},\u500D:{type:"func",josi:[["\u306E","\u3092"],[""]],pure:!0,fn:function(t,e){return t*e}},\u5272:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t/e}},\u5272\u4F59:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t%e}},\u5076\u6570:{type:"func",josi:[["\u304C"]],pure:!0,fn:function(t){return parseInt(t)%2===0}},\u5947\u6570:{type:"func",josi:[["\u304C"]],pure:!0,fn:function(t){return parseInt(t)%2===1}},\u4E8C\u4E57:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return t*t}},\u3079\u304D\u4E57:{type:"func",josi:[["\u306E"],["\u306E"]],pure:!0,fn:function(t,e){return Math.pow(t,e)}},\u4EE5\u4E0A:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t>=e}},\u4EE5\u4E0B:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t<=e}},\u672A\u6E80:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t<e}},\u8D85:{type:"func",josi:[["\u304C"],[""]],pure:!0,fn:function(t,e){return t>e}},\u7B49:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){return t===e}},\u7B49\u7121:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){return t!==e}},\u4E00\u81F4:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){if(typeof t=="object"){let n=JSON.stringify(t),r=JSON.stringify(e);return n===r}return t===e}},\u4E0D\u4E00\u81F4:{type:"func",josi:[["\u304C"],["\u3068"]],pure:!0,fn:function(t,e){if(typeof t=="object"){let n=JSON.stringify(t),r=JSON.stringify(e);return n!==r}return t!==e}},\u7BC4\u56F2\u5185:{type:"func",josi:[["\u304C"],["\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){return e<=t&&t<=n}},\u7BC4\u56F2:{type:"func",josi:[["\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e){return{\u5148\u982D:t,\u672B\u5C3E:e}}},\u9023\u7D9A\u52A0\u7B97:{type:"func",josi:[["\u3092"],["\u306B","\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>n+r)}},MAX:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){let n=e.pop();return n.__exec("\u6700\u5927\u5024",[t,...e,n])}},\u6700\u5927\u5024:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>Math.max(n,r))}},MIN:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){let n=e.pop();return n.__exec("\u6700\u5C0F\u5024",[t,...e,n])}},\u6700\u5C0F\u5024:{type:"func",josi:[["\u306E"],["\u3068"]],isVariableJosi:!0,pure:!0,fn:function(t,...e){return e.pop(),e.push(t),e.reduce((n,r)=>Math.min(n,r))}},CLAMP:{type:"func",josi:[["\u306E","\u3092"],["\u304B\u3089"],["\u307E\u3067\u306E","\u3067"]],pure:!0,fn:function(t,e,n){return Math.min(Math.max(t,e),n)}},\u304F\u3060\u3055\u3044:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u304A\u9858:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u3067\u3059:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu||(t.__reisetu=0),t.__reisetu++},return_none:!0},\u62DD\u5553:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu=0},return_none:!0},\u656C\u5177:{type:"func",josi:[],pure:!0,fn:function(t){t.__reisetu+=100},return_none:!0},\u793C\u7BC0\u30EC\u30D9\u30EB\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){return t.__reisetu||(t.__reisetu=0),t.__reisetu}},JS\u5B9F\u884C:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){return e.__evalJS(t,e)}},JS\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u53D6\u5F97:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){return e.__findVar(t,null)}},JS\u95A2\u6570\u5B9F\u884C:{type:"func",josi:[["\u3092"],["\u3067"]],fn:function(t,e,n){if(typeof t=="string"&&(t=n.__evalJS(t,n)),typeof t!="function")throw new Error("JS\u95A2\u6570\u53D6\u5F97\u3067\u5B9F\u884C\u3067\u304D\u307E\u305B\u3093\u3002");return e instanceof Array||(e=[e]),t.apply(null,e)}},ASYNC:{type:"func",josi:[],asyncFn:!0,pure:!0,fn:async function(){},return_none:!0},AWAIT\u5B9F\u884C:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,asyncFn:!0,fn:async function(t,e,n){if(typeof t=="string"&&(t=n.__findFunc(t,"AWAIT\u5B9F\u884C")),!(t instanceof Function))throw new Error("\u300EAWAIT\u5B9F\u884C\u300F\u306E\u7B2C\u4E00\u5F15\u6570\u306F\u306A\u3067\u3057\u3053\u95A2\u6570\u540D\u304BFunction\u578B\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002");return await t(...e)}},JS\u30E1\u30BD\u30C3\u30C9\u5B9F\u884C:{type:"func",josi:[["\u306E"],["\u3092"],["\u3067"]],fn:function(t,e,n,r){if(typeof t=="string"&&(t=r.__evalJS(t,r)),typeof t!="object")throw new Error("JS\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u3092\u53D6\u5F97\u3067\u304D\u307E\u305B\u3093\u3067\u3057\u305F\u3002");return typeof e!="function"&&(e=t[e]),n instanceof Array||(n=[n]),e.apply(t,n)}},\u30CA\u30C7\u30B7\u30B3:{type:"func",josi:[["\u3092","\u3067"]],pure:!1,fn:function(t,e){e.__setSysVar("\u8868\u793A\u30ED\u30B0",""),e.__self.runEx(t,e.__modName,{resetEnv:!1,resetLog:!0});let n=String(e.__getSysVar("\u8868\u793A\u30ED\u30B0"));return n&&e.logger.trace(n),n}},\u30CA\u30C7\u30B7\u30B3\u7D9A:{type:"func",josi:[["\u3092","\u3067"]],fn:function(t,e){e.__self.runEx(t,e.__modName,{resetEnv:!1,resetAll:!1});let n=String(e.__getSysVar("\u8868\u793A\u30ED\u30B0"));return n&&e.logger.trace(n),n}},\u5B9F\u884C:{type:"func",josi:[["\u3092","\u306B","\u3067"]],pure:!1,fn:function(t,e){if(typeof t=="function")return t(e);if(typeof t=="string"){let n=e.__findFunc(t,"\u5B9F\u884C");if(typeof n=="function")return n(e)}return t}},\u5B9F\u884C\u6642\u9593\u8A08\u6E2C:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){if(typeof t=="string"&&(t=e.__findFunc(t,"\u5B9F\u884C\u6642\u9593\u8A08\u6E2C")),performance&&performance.now){let n=performance.now();return t(e),performance.now()-n}else{let n=Date.now();return t(e),Date.now()-n}}},\u7D42:{type:"func",josi:[],pure:!0,fn:function(t){if(t.__setSysVar("__forceClose",!0),!t.__getSysVar("__useDebug"))throw new Error("__\u7D42\u308F\u308B__")}},\u5909\u6570\u578B\u78BA\u8A8D:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return typeof t}},TYPEOF:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return typeof t}},\u6587\u5B57\u5217\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t)}},TOSTR:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t)}},\u6574\u6570\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseInt(t)}},TOINT:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseInt(t)}},\u5B9F\u6570\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseFloat(t)}},TOFLOAT:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return parseFloat(t)}},INT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseInt(t)}},FLOAT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseFloat(t)}},NAN\u5224\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return isNaN(t)}},\u975E\u6570\u5224\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Number.isNaN(t)}},HEX:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseInt(t).toString(16)}},\u9032\u6570\u5909\u63DB:{type:"func",josi:[["\u3092","\u306E"],[""]],pure:!0,fn:function(t,e){return parseInt(t).toString(e)}},\u4E8C\u9032:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return parseInt(t).toString(2)}},\u4E8C\u9032\u8868\u793A:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=parseInt(t).toString(2);e.__exec("\u8868\u793A",[n,e])}},RGB:{type:"func",josi:[["\u3068"],["\u306E"],["\u3067"]],pure:!0,fn:function(t,e,n){let r=s=>{let i="00"+parseInt(String(s)).toString(16);return i.substring(i.length-2,i.length)};return"#"+r(t)+r(e)+r(n)}},\u8AD6\u7406OR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t||e}},\u8AD6\u7406AND:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t&&e}},\u8AD6\u7406NOT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return!t}},OR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t|e}},AND:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t&e}},XOR:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return t^e}},NOT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return~t}},SHIFT_L:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t<<e}},SHIFT_R:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t>>e}},SHIFT_UR:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t>>>e}},\u6587\u5B57\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Array.from?Array.from(t).length:String(t).length}},\u4F55\u6587\u5B57\u76EE:{type:"func",josi:[["\u3067","\u306E"],["\u304C"]],pure:!0,fn:function(t,e){let n=Array.from(t),r=Array.from(e);for(let s=0;s<n.length;s++)if(n.slice(s,s+r.length).join("")===r.join(""))return s+1;return 0}},CHR:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="number")return String.fromCodePoint?String.fromCodePoint(t):String.fromCharCode(t);let e=[];for(let n of t)String.fromCodePoint||e.push(String.fromCharCode(n)),e.push(String.fromCodePoint(n));return e}},ASC:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="string")return String.prototype.codePointAt?String(t).codePointAt(0)||0:String(t).charCodeAt(0);let e=[];for(let n of t)String.prototype.codePointAt||e.push(String(n).charCodeAt(0)),e.push(String(n).codePointAt(0)||0);return e}},\u6587\u5B57\u633F\u5165:{type:"func",josi:[["\u3067","\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){e<=0&&(e=1);let r=Array.from(t);return r.splice(e-1,0,n),r.join("")}},\u6587\u5B57\u691C\u7D22:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){e<=0&&(e=1);let r=Array.from(t),s=Array.from(n);for(let i=e-1;i<r.length;i++)if(r.slice(i,i+s.length).join("")===s.join(""))return i+1;return 0}},\u8FFD\u52A0:{type:"func",josi:[["\u3067","\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?(t.push(e),t):String(t)+String(e)}},\u4E00\u884C\u8FFD\u52A0:{type:"func",josi:[["\u3067","\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?(t.push(e),t):String(t)+String(e)+`
`}},\u9023\u7D50:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,isVariableJosi:!0,fn:function(...t){return t.pop(),t.join("")}},\u6587\u5B57\u5217\u9023\u7D50:{type:"func",josi:[["\u3068","\u3092"]],pure:!0,isVariableJosi:!0,fn:function(...t){return t.pop(),t.join("")}},\u6587\u5B57\u5217\u5206\u89E3:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return Array.from?Array.from(t):String(t).split("")}},\u30EA\u30D5\u30EC\u30A4\u30F3:{type:"func",josi:[["\u3092","\u306E"],["\u3067"]],pure:!0,fn:function(t,e){let n="";for(let r=0;r<e;r++)n+=String(t);return n}},\u51FA\u73FE\u56DE\u6570:{type:"func",josi:[["\u3067"],["\u306E"]],pure:!0,fn:function(t,e){return t=""+t,e=""+e,t.split(e).length-1}},MID:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n,r){return r.__exec("\u6587\u5B57\u629C\u51FA",[t,e,n])}},\u6587\u5B57\u629C\u51FA:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u3092",""]],pure:!0,fn:function(t,e,n){if(typeof e=="string"&&(e=parseInt(e)),typeof n=="string"&&(n=parseInt(n)),n<=0)return"";let r=Array.from(t);return e<0&&(e=r.length+e+1,e<0&&(e=1)),r.slice(e-1,e+n-1).join("")}},LEFT:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051"]],pure:!0,fn:function(t,e,n){return n.__exec("\u6587\u5B57\u5DE6\u90E8\u5206",[t,e])}},\u6587\u5B57\u5DE6\u90E8\u5206:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051",""]],pure:!0,fn:function(t,e){return Array.from(t).slice(0,e).join("")}},RIGHT:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051"]],pure:!0,fn:function(t,e,n){return n.__exec("\u6587\u5B57\u53F3\u90E8\u5206",[t,e])}},\u6587\u5B57\u53F3\u90E8\u5206:{type:"func",josi:[["\u306E","\u3067"],["\u3060\u3051",""]],pure:!0,fn:function(t,e){let n=Array.from(t),r=n.length-e;return r<0&&(r=0),n.slice(r,n.length).join("")}},\u533A\u5207:{type:"func",josi:[["\u306E","\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return(""+t).split(""+e)}},\u6587\u5B57\u5217\u5206\u5272:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=""+t,e=""+e;let n=t.indexOf(e);return n<0?[t]:[t.substring(0,n),t.substring(n+e.length)]}},\u5207\u53D6:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u307E\u3067","\u3092"]],pure:!0,fn:function(t,e,n){t=String(t);let r=t.indexOf(e);return r<0?(n.__setSysVar("\u5BFE\u8C61",""),t):(n.__setSysVar("\u5BFE\u8C61",t.substring(r+e.length)),t.substring(0,r))}},\u7BC4\u56F2\u5207\u53D6:{type:"func",josi:[["\u3067","\u306E"],["\u304B\u3089"],["\u307E\u3067","\u3092"]],pure:!0,fn:function(t,e,n,r){t=String(t);let s="",i="",o=t.indexOf(e);if(o<0)return r.__setSysVar("\u5BFE\u8C61",t),"";s=t.substring(0,o);let u=t.substring(o+e.length),c=u.indexOf(n);if(c<0)return r.__setSysVar("\u5BFE\u8C61",s),u;let a=u.substring(0,c);return i=u.substring(c+n.length),r.__setSysVar("\u5BFE\u8C61",s+i),a}},\u6587\u5B57\u524A\u9664:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3060\u3051","\u3092",""]],pure:!0,fn:function(t,e,n){let r=Array.from(t);return r.splice(e-1,n),r.join("")}},\u6587\u5B57\u59CB:{type:"func",josi:[["\u304C"],["\u3067","\u304B\u3089"]],pure:!0,fn:function(t,e){return t.startsWith(e)}},\u6587\u5B57\u7D42:{type:"func",josi:[["\u304C"],["\u3067"]],pure:!0,fn:function(t,e){return t.endsWith(e)}},\u51FA\u73FE:{type:"func",josi:[["\u306B","\u3067"],["\u304C"]],pure:!0,fn:function(t,e){return typeof t=="string"||t instanceof Array?t.includes(e):String(t).includes(e)}},\u7F6E\u63DB:{type:"func",josi:[["\u306E","\u3067"],["\u3092","\u304B\u3089"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){return String(t).split(e).join(n)}},\u5358\u7F6E\u63DB:{type:"func",josi:[["\u306E","\u3067"],["\u3092"],["\u306B","\u3078"]],pure:!0,fn:function(t,e,n){return String(t).replace(e,n)}},\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"").replace(/\s+$/,"")}},\u7A7A\u767D\u9664\u53BB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"").replace(/\s+$/,"")}},\u53F3\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/\s+$/,"")}},\u5DE6\u30C8\u30EA\u30E0:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/^\s+/,"")}},\u672B\u5C3E\u7A7A\u767D\u9664\u53BB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/\s+$/,"")}},\u5927\u6587\u5B57\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).toUpperCase()}},\u5C0F\u6587\u5B57\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).toLowerCase()}},\u5E73\u4EEE\u540D\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return(n=>String(n).replace(/[\u30a1-\u30f6]/g,function(r){let s=r.charCodeAt(0)-96;return String.fromCharCode(s)}))(""+t)}},\u30AB\u30BF\u30AB\u30CA\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return(n=>String(n).replace(/[\u3041-\u3096]/g,function(r){let s=r.charCodeAt(0)+96;return String.fromCharCode(s)}))(""+t)}},\u82F1\u6570\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[A-Za-z0-9]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+65248)})}},\u82F1\u6570\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[Ôº°-Ôº∫ÔΩÅ-ÔΩöÔºê-Ôºô]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})}},\u82F1\u6570\u8A18\u53F7\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[\x20-\x7E]/g,function(e){return e===" "?"\u3000":String.fromCharCode(e.charCodeAt(0)+65248)})}},\u82F1\u6570\u8A18\u53F7\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){return String(t).replace(/[\u3000\uFF00-\uFF5F]/g,function(e){return e==="\u3000"?" ":String.fromCharCode(e.charCodeAt(0)-65248)})}},\u30AB\u30BF\u30AB\u30CA\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u4E00\u89A7"),r=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u4E00\u89A7"),s=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),i=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),o="",u=0;for(;u<t.length;){let c=t.substring(u,u+2),a=i.indexOf(c);if(a>=0){o+=s.charAt(a/2),u+=2;continue}let f=t.charAt(u),l=r.indexOf(f);if(l>=0){o+=n.charAt(l),u++;continue}o+=f,u++}return o}},\u30AB\u30BF\u30AB\u30CA\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u4E00\u89A7"),r=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u4E00\u89A7"),s=e.__getSysVar("\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7"),i=e.__getSysVar("\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7");return t.split("").map(o=>{let u=n.indexOf(o);if(u>=0)return r.charAt(u);let c=s.indexOf(o);return c>=0?i.substring(c*2,c*2+2):o}).join("")}},\u5168\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!1,fn:function(t,e){let n=t;return n=e.__exec("\u30AB\u30BF\u30AB\u30CA\u5168\u89D2\u5909\u63DB",[n,e]),n=e.__exec("\u82F1\u6570\u8A18\u53F7\u5168\u89D2\u5909\u63DB",[n,e]),n}},\u534A\u89D2\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!1,fn:function(t,e){let n=t;return n=e.__exec("\u30AB\u30BF\u30AB\u30CA\u534A\u89D2\u5909\u63DB",[n,e]),n=e.__exec("\u82F1\u6570\u8A18\u53F7\u534A\u89D2\u5909\u63DB",[n,e]),n}},\u5168\u89D2\u30AB\u30CA\u4E00\u89A7:{type:"const",value:"\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F2\u30F3\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u3001\u3002\u30FC\u300C\u300D"},\u5168\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7:{type:"const",value:"\u30AC\u30AE\u30B0\u30B2\u30B4\u30B6\u30B8\u30BA\u30BC\u30BE\u30C0\u30C2\u30C5\u30C7\u30C9\u30D0\u30D3\u30D6\u30D9\u30DC\u30D1\u30D4\u30D7\u30DA\u30DD"},\u534A\u89D2\u30AB\u30CA\u4E00\u89A7:{type:"const",value:"\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF66\uFF9D\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF64\uFF61\uFF70\uFF62\uFF63\uFF9E\uFF9F"},\u534A\u89D2\u30AB\u30CA\u6FC1\u97F3\u4E00\u89A7:{type:"const",value:"\uFF76\uFF9E\uFF77\uFF9E\uFF78\uFF9E\uFF79\uFF9E\uFF7A\uFF9E\uFF7B\uFF9E\uFF7C\uFF9E\uFF7D\uFF9E\uFF7E\uFF9E\uFF7F\uFF9E\uFF80\uFF9E\uFF81\uFF9E\uFF82\uFF9E\uFF83\uFF9E\uFF84\uFF9E\uFF8A\uFF9E\uFF8B\uFF9E\uFF8C\uFF9E\uFF8D\uFF9E\uFF8E\uFF9E\uFF8A\uFF9F\uFF8B\uFF9F\uFF8C\uFF9F\uFF8D\uFF9F\uFF8E\uFF9F"},JSON\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t)}},JSON\u30A8\u30F3\u30B3\u30FC\u30C9\u6574\u5F62:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t,null,2)}},JSON\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return JSON.parse(t)}},JSON_E:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t)}},JSON_ES:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return JSON.stringify(t,null,2)}},JSON_D:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t){return JSON.parse(t)}},\u6B63\u898F\u8868\u73FE\u30DE\u30C3\u30C1:{type:"func",josi:[["\u3092","\u304C"],["\u3067","\u306B"]],pure:!0,fn:function(t,e,n){let r,s=(""+e).match(/^\/(.+)\/([a-zA-Z]*)$/);s===null?r=new RegExp(e,"g"):r=new RegExp(s[1],s[2]);let i=n.__getSysVar("\u62BD\u51FA\u6587\u5B57\u5217");i.splice(0,i.length);let o=String(t).match(r),u=o;if(!r.global){if(o&&o.length>0){u=o[0];for(let c=1;c<o.length;c++)i[c-1]=o[c]}}return u}},\u62BD\u51FA\u6587\u5B57\u5217:{type:"const",value:[]},\u6B63\u898F\u8868\u73FE\u7F6E\u63DB:{type:"func",josi:[["\u306E"],["\u3092","\u304B\u3089"],["\u3067","\u306B","\u3078"]],pure:!0,fn:function(t,e,n){let r,s=e.match(/^\/(.+)\/([a-zA-Z]*)/);return s===null?r=new RegExp(e,"g"):r=new RegExp(s[1],s[2]),String(t).replace(r,n)}},\u6B63\u898F\u8868\u73FE\u533A\u5207:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n,r=e.match(/^\/(.+)\/([a-zA-Z]*)/);return r===null?n=new RegExp(e,"g"):n=new RegExp(r[1],r[2]),String(t).split(n)}},\u901A\u8CA8\u5F62\u5F0F:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return String(t).replace(/(?<!\.\d*?)(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}},\u30BC\u30ED\u57CB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=String(t);let n="0";for(let s=0;s<e;s++)n+="0";e=parseInt(e),e<t.length&&(e=t.length);let r=n+String(t);return r.substring(r.length-e,r.length)}},\u7A7A\u767D\u57CB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){t=String(t);let n=" ";for(let s=0;s<e;s++)n+=" ";e=parseInt(e),e<t.length&&(e=t.length);let r=n+String(t);return r.substring(r.length-e,r.length)}},\u304B\u306A\u304B\u5224\u5B9A:{type:"func",josi:[["\u3092","\u306E","\u304C"]],pure:!0,fn:function(t){let e=String(t).charCodeAt(0);return e>=12353&&e<=12447}},\u30AB\u30BF\u30AB\u30CA\u5224\u5B9A:{type:"func",josi:[["\u3092","\u306E","\u304C"]],pure:!0,fn:function(t){let e=String(t).charCodeAt(0);return e>=12449&&e<=12538}},\u6570\u5B57\u5224\u5B9A:{type:"func",josi:[["\u3092","\u304C"]],pure:!0,fn:function(t){let e=String(t).charAt(0);return e>="0"&&e<="9"||e>="\uFF10"&&e<="\uFF19"}},\u6570\u5217\u5224\u5B9A:{type:"func",josi:[["\u3092","\u304C"]],pure:!0,fn:function(t){let e=/^[+\-ÔºãÔºç]?([0-9Ôºê-Ôºô]*)(([.Ôºé][0-9Ôºê-Ôºô]+)?|([.Ôºé][0-9Ôºê-Ôºô]+[eEÔΩÖÔº•][+\-ÔºãÔºç]?[0-9Ôºê-Ôºô]+)?)$/;return String(t).match(e)!==null}},\u914D\u5217\u7D50\u5408:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){return t instanceof Array?t.join(""+e):String(t).split(`
`).join(""+e)}},\u914D\u5217\u53EA\u7D50\u5408:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t instanceof Array?t.join(""):String(t).split(`
`).join("")}},\u914D\u5217\u691C\u7D22:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?t.indexOf(e):-1}},\u914D\u5217\u8981\u7D20\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t instanceof Array?t.length:t instanceof Object?Object.keys(t).length:typeof t=="string"?String(t).length:1}},\u8981\u7D20\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u914D\u5217\u8981\u7D20\u6570",[t])}},LEN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u914D\u5217\u8981\u7D20\u6570",[t])}},\u914D\u5217\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array)return t.splice(e,0,n);throw new Error("\u300E\u914D\u5217\u633F\u5165\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u8981\u7D20\u3078\u306E\u633F\u5165\u3002")}},\u914D\u5217\u4E00\u62EC\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array&&n instanceof Array){for(let r=0;r<n.length;r++)t.splice(e+r,0,n[r]);return t}throw new Error("\u300E\u914D\u5217\u4E00\u62EC\u633F\u5165\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u8981\u7D20\u3078\u306E\u633F\u5165\u3002")}},\u914D\u5217\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.sort();throw new Error("\u300E\u914D\u5217\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u6570\u5024\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array){for(let e=0;e<t.length;e++)t[e]=parseFloat(t[e]);return t}throw new Error("\u300E\u914D\u5217\u6570\u5024\u5909\u63DB\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u6570\u5024\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.sort((e,n)=>parseFloat(e)-parseFloat(n));throw new Error("\u300E\u914D\u5217\u6570\u5024\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8:{type:"func",josi:[["\u3067"],["\u306E","\u3092"]],pure:!1,fn:function(t,e,n){let r=t;if(typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8")),e instanceof Array)return e.sort(r);throw new Error("\u300E\u914D\u5217\u30AB\u30B9\u30BF\u30E0\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u9006\u9806:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array)return t.reverse();throw new Error("\u300E\u914D\u5217\u30BD\u30FC\u30C8\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u30B7\u30E3\u30C3\u30D5\u30EB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t){if(t instanceof Array){for(let e=t.length-1;e>0;e--){let n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t}throw new Error("\u300E\u914D\u5217\u30B7\u30E3\u30C3\u30D5\u30EB\u300F\u3067\u914D\u5217\u4EE5\u5916\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u524A\u9664:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u5207\u53D6",[t,e,n])}},\u914D\u5217\u5207\u53D6:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Array){if(typeof e=="number"){let n=t.splice(e,1);if(n instanceof Array)return n[0]}if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let n=e.\u5148\u982D,r=e.\u672B\u5C3E-e.\u5148\u982D+1;return t.splice(n,r)}return null}if(t instanceof Object&&typeof e=="string"){if(t[e]){let n=t[e];return delete t[e],n}return}throw new Error("\u300E\u914D\u5217\u5207\u53D6\u300F\u3067\u914D\u5217\u4EE5\u5916\u3092\u6307\u5B9A\u3002")}},\u914D\u5217\u53D6\u51FA:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){if(t instanceof Array)return t.splice(e,n);throw new Error("\u300E\u914D\u5217\u53D6\u51FA\u300F\u3067\u914D\u5217\u4EE5\u5916\u3092\u6307\u5B9A\u3002")}},\u914D\u5217\u30DD\u30C3\u30D7:{type:"func",josi:[["\u306E","\u304B\u3089"]],pure:!0,fn:function(t){if(t instanceof Array)return t.pop();throw new Error("\u300E\u914D\u5217\u30DD\u30C3\u30D7\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u51E6\u7406\u3002")}},\u914D\u5217\u30D7\u30C3\u30B7\u30E5:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u8FFD\u52A0",[t,e,n])}},\u914D\u5217\u8FFD\u52A0:{type:"func",josi:[["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Array)return t.push(e),t;throw new Error("\u300E\u914D\u5217\u8FFD\u52A0\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u51E6\u7406\u3002")}},\u914D\u5217\u8907\u88FD:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return JSON.parse(JSON.stringify(t))}},\u914D\u5217\u7BC4\u56F2\u30B3\u30D4\u30FC:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e){if(!Array.isArray(t))throw new Error("\u300E\u914D\u5217\u7BC4\u56F2\u30B3\u30D4\u30FC\u300F\u3067\u914D\u5217\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002");if(typeof e=="number")return typeof t[e]=="object"?JSON.parse(JSON.stringify(t[e])):t[e];if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let n=e.\u5148\u982D,r=Number(e.\u672B\u5C3E)+1;return JSON.parse(JSON.stringify(t.slice(n,r)))}}},\u53C2\u7167:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){if(typeof t=="string"){if(typeof e=="number")return t.charAt(e);if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let r=e.\u5148\u982D,s=Number(e.\u672B\u5C3E)+1;return t.substring(r,s)}throw new Error(`\u300E\u53C2\u7167\u300F\u3067\u6587\u5B57\u5217\u578B\u306E\u7BC4\u56F2\u6307\u5B9A(${JSON.stringify(e)})\u304C\u4E0D\u6B63\u3067\u3059\u3002`)}if(Array.isArray(t)){if(typeof e=="number")return t[e];if(typeof e=="object"&&typeof e.\u5148\u982D=="number"){let r=e.\u5148\u982D,s=Number(e.\u672B\u5C3E)+1;return t.slice(r,s)}}if(typeof t=="object")return t[e];throw new Error("\u300E\u53C2\u7167\u300F\u3067\u6587\u5B57\u5217/\u914D\u5217/\u8F9E\u66F8\u578B\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u53C2\u7167:{type:"func",josi:[["\u306E","\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u53C2\u7167",[t,e,n])}},\u914D\u5217\u8DB3:{type:"func",josi:[["\u306B","\u3078","\u3068"],["\u3092"]],pure:!0,fn:function(t,e){return t instanceof Array?t.concat(e):JSON.parse(JSON.stringify(t))}},\u914D\u5217\u6700\u5927\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t.reduce((e,n)=>Math.max(e,n))}},\u914D\u5217\u6700\u5C0F\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t.reduce((e,n)=>Math.min(e,n))}},\u914D\u5217\u5408\u8A08:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(t instanceof Array){let e=0;return t.forEach(n=>{let r=parseFloat(n);isNaN(r)||(e+=r)}),e}throw new Error("\u300E\u914D\u5217\u5408\u8A08\u300F\u3067\u914D\u5217\u5909\u6570\u4EE5\u5916\u306E\u5024\u304C\u6307\u5B9A\u3055\u308C\u307E\u3057\u305F\u3002")}},\u914D\u5217\u5165\u66FF:{type:"func",josi:[["\u306E"],["\u3068"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u914D\u5217\u5165\u66FF\u300F\u306E\u7B2C1\u5F15\u6570\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002");let r=t[e];return t[e]=t[n],t[n]=r,t}},\u914D\u5217\u9023\u756A\u4F5C\u6210:{type:"func",josi:[["\u304B\u3089"],["\u307E\u3067\u306E","\u307E\u3067","\u306E"]],pure:!0,fn:function(t,e){let n=[];for(let r=t;r<=e;r++)n.push(r);return n}},\u914D\u5217\u8981\u7D20\u4F5C\u6210:{type:"func",josi:[["\u3092"],["\u3060\u3051","\u3067"]],pure:!0,fn:function(t,e){let n=s=>Array.isArray(s)?s.map(i=>n(i)):s instanceof Date?new Date(s.getTime()):typeof s=="object"&&s!==null?JSON.parse(JSON.stringify(s)):s,r=function(s,i){if(!Array.isArray(i))return Array.from({length:i},()=>n(s));if(Array.isArray(i)&&i.length===1)return Array.from({length:i[0]},()=>n(s));let[o,...u]=i;return Array.from({length:o},()=>r(n(s),u))};return r(t,e)}},\u914D\u5217\u95A2\u6570\u9069\u7528:{type:"func",josi:[["\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n){let r=t;typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u95A2\u6570\u9069\u7528"));let s=[];for(let i of e)s.push(r(i));return s}},\u914D\u5217\u30DE\u30C3\u30D7:{type:"func",josi:[["\u3092"],["\u3078","\u306B"]],pure:!0,fn:function(t,e,n){return n.__exec("\u914D\u5217\u95A2\u6570\u9069\u7528",[t,e,n])}},\u914D\u5217\u30D5\u30A3\u30EB\u30BF:{type:"func",josi:[["\u3067","\u306E"],["\u3092","\u306B\u3064\u3044\u3066"]],pure:!0,fn:function(t,e,n){let r=t;typeof t=="string"&&(r=n.__findFunc(t,"\u914D\u5217\u30D5\u30A3\u30EB\u30BF"));let s=[];for(let i of e)r(i)&&s.push(i);return s}},\u8868\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u30BD\u30FC\u30C8\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.sort((n,r)=>{let s=n[e],i=r[e];return s===i?0:s<i?-1:1}),t}},\u8868\u6570\u5024\u30BD\u30FC\u30C8:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u6570\u5024\u30BD\u30FC\u30C8\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.sort((n,r)=>{let s=n[e],i=r[e];return s-i}),t}},\u8868\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092","\u3067"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.filter(r=>String(r[e]).indexOf(n)>=0)}},\u8868\u5B8C\u5168\u4E00\u81F4\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3092","\u3067"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5B8C\u5168\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.filter(r=>r[e]===n)}},\u8868\u691C\u7D22:{type:"func",josi:[["\u306E"],["\u3067","\u306B"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n,r){if(!(t instanceof Array))throw new Error("\u300E\u8868\u691C\u7D22\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");for(let s=n;s<t.length;s++)if(t[s][e]===r)return s;return-1}},\u8868\u5217\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u6570\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let e=1;for(let n=0;n<t.length;n++)t[n].length>e&&(e=t[n].length);return e}},\u8868\u884C\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(!(t instanceof Array))throw new Error("\u300E\u8868\u884C\u6570\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.length}},\u8868\u884C\u5217\u4EA4\u63DB:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u884C\u5217\u4EA4\u63DB\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=e.__exec("\u8868\u5217\u6570",[t]),r=t.length,s=[];for(let i=0;i<n;i++){let o=[];s.push(o);for(let u=0;u<r;u++)o[u]=t[u][i]!==void 0?t[u][i]:""}return s}},\u8868\u53F3\u56DE\u8EE2:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u53F3\u56DE\u8EE2\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=e.__exec("\u8868\u5217\u6570",[t]),r=t.length,s=[];for(let i=0;i<n;i++){let o=[];s.push(o);for(let u=0;u<r;u++)o[u]=t[r-u-1][i]}return s}},\u8868\u91CD\u8907\u524A\u9664:{type:"func",josi:[["\u306E"],["\u3092","\u3067"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u91CD\u8907\u524A\u9664\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=[],r={};for(let s=0;s<t.length;s++){let i=t[s][e];r[i]===void 0&&(r[i]=!0,n.push(t[s]))}return n}},\u8868\u5217\u53D6\u5F97:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u53D6\u5F97\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");return t.map(r=>r[e])}},\u8868\u5217\u633F\u5165:{type:"func",josi:[["\u306E"],["\u306B","\u3078"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u633F\u5165\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let r=[];return t.forEach((s,i)=>{let o=[];e>0&&(o=o.concat(s.slice(0,e))),o.push(n[i]),o=o.concat(s.slice(e)),r.push(o)}),r}},\u8868\u5217\u524A\u9664:{type:"func",josi:[["\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u524A\u9664\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=[];return t.forEach(r=>{let s=r.slice(0);s.splice(e,1),n.push(s)}),n}},\u8868\u5217\u5408\u8A08:{type:"func",josi:[["\u306E"],["\u3092","\u3067"]],pure:!0,fn:function(t,e){if(!(t instanceof Array))throw new Error("\u300E\u8868\u5217\u5408\u8A08\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let n=0;return t.forEach(r=>{n+=r[e]}),n}},\u8868\u66D6\u6627\u691C\u7D22:{type:"func",josi:[["\u306E"],["\u304B\u3089"],["\u3067"],["\u3092"]],pure:!0,fn:function(t,e,n,r){if(!(t instanceof Array))throw new Error("\u300E\u8868\u66D6\u6627\u691C\u7D22\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let s=new RegExp(r);for(let i=e;i<t.length;i++){let o=t[i];if(s.test(o[n]))return i}return-1}},\u8868\u6B63\u898F\u8868\u73FE\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7:{type:"func",josi:[["\u306E","\u3067"],["\u304B\u3089"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!(t instanceof Array))throw new Error("\u300E\u8868\u6B63\u898F\u8868\u73FE\u30D4\u30C3\u30AF\u30A2\u30C3\u30D7\u300F\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let r=new RegExp(n),s=[];for(let i=0;i<t.length;i++){let o=t[i];r.test(o[e])&&s.push(o.slice(0))}return s}},\u8F9E\u66F8\u30AD\u30FC\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=[];if(t instanceof Object){for(let n in t)e.push(n);return e}if(t instanceof Array){for(let n=0;n<t.length;n++)e.push(n);return e}throw new Error("\u300E\u8F9E\u66F8\u30AD\u30FC\u5217\u6319\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u8F9E\u66F8\u30AD\u30FC\u524A\u9664:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e){if(t instanceof Object)return e in t&&delete t[e],t;throw new Error("\u300E\u8F9E\u66F8\u30AD\u30FC\u524A\u9664\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u8F9E\u66F8\u30AD\u30FC\u5B58\u5728:{type:"func",josi:[["\u306E","\u306B"],["\u304C"]],pure:!0,fn:function(t,e){return e in t}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){return e.__exec("\u8F9E\u66F8\u30AD\u30FC\u5217\u6319",[t,e])}},\u30CF\u30C3\u30B7\u30E5\u5185\u5BB9\u5217\u6319:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=[];if(t instanceof Object){for(let n in t)e.push(t[n]);return e}throw new Error("\u300E\u30CF\u30C3\u30B7\u30E5\u5185\u5BB9\u5217\u6319\u300F\u3067\u30CF\u30C3\u30B7\u30E5\u4EE5\u5916\u304C\u4E0E\u3048\u3089\u308C\u307E\u3057\u305F\u3002")}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u524A\u9664:{type:"func",josi:[["\u304B\u3089","\u306E"],["\u3092"]],pure:!0,fn:function(t,e,n){return n.__exec("\u8F9E\u66F8\u30AD\u30FC\u524A\u9664",[t,e,n])}},\u30CF\u30C3\u30B7\u30E5\u30AD\u30FC\u5B58\u5728:{type:"func",josi:[["\u306E","\u306B"],["\u304C"]],pure:!0,fn:function(t,e){return e in t}},\u79D2\u5F85:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:function(t,e){return new Promise((n,r)=>{try{let s=setTimeout(()=>{let i=e.__timeout.indexOf(s);i>=0&&e.__timeout.splice(i,1),n()},parseFloat(t)*1e3);e.__timeout.push(s)}catch(s){r(s)}})},return_none:!0},\u79D2\u5F85\u6A5F:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:async function(t,e){return await e.__exec("\u79D2\u5F85",[t,e])},return_none:!0},\u79D2\u9010\u6B21\u5F85\u6A5F:{type:"func",josi:[[""]],pure:!0,asyncFn:!0,fn:async function(t,e){return await e.__exec("\u79D2\u5F85",[t,e])},return_none:!0},\u79D2\u5F8C:{type:"func",josi:[["\u3092"],[""]],pure:!0,fn:function(t,e,n){typeof t=="string"&&(t=n.__findFunc(t,"\u79D2\u5F8C"));let r=setTimeout(()=>{let s=n.__timeout.indexOf(r);s>=0&&n.__timeout.splice(s,1);try{t(r,n)}catch(i){let o=i;i instanceof G||(o=new G(i,n.__getSysVar("__line"))),n.logger.error(o)}},parseFloat(e)*1e3);return n.__timeout.unshift(r),n.__setSysVar("\u5BFE\u8C61",r),r}},\u79D2\u6BCE:{type:"func",josi:[["\u3092"],[""]],pure:!1,fn:function(t,e,n){typeof t=="string"&&(t=n.__findFunc(t,"\u79D2\u6BCE"));let r=setInterval(()=>{t(r,n)},parseFloat(e)*1e3);return n.__interval.unshift(r),n.__setSysVar("\u5BFE\u8C61",r),r}},\u79D2\u30BF\u30A4\u30DE\u30FC\u958B\u59CB\u6642:{type:"func",josi:[["\u3092"],[""]],pure:!1,fn:function(t,e,n){return n.__exec("\u79D2\u6BCE",[t,e,n])}},\u30BF\u30A4\u30DE\u30FC\u505C\u6B62:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t,e){let n=e.__interval.indexOf(t);if(n>=0)return e.__interval.splice(n,1),clearInterval(t),!0;let r=e.__timeout.indexOf(t);return r>=0?(e.__timeout.splice(r,1),clearTimeout(t),!0):!1},return_none:!1},\u5168\u30BF\u30A4\u30DE\u30FC\u505C\u6B62:{type:"func",josi:[],pure:!0,fn:function(t){for(let e=0;e<t.__interval.length;e++){let n=t.__interval[e];clearInterval(n)}t.__interval=[];for(let e=0;e<t.__timeout.length;e++){let n=t.__timeout[e];clearTimeout(n)}t.__timeout=[]},return_none:!0},\u5143\u53F7\u30C7\u30FC\u30BF:{type:"const",value:[{\u5143\u53F7:"\u4EE4\u548C",\u6539\u5143\u65E5:"2019/05/01"},{\u5143\u53F7:"\u5E73\u6210",\u6539\u5143\u65E5:"1989/01/08"},{\u5143\u53F7:"\u662D\u548C",\u6539\u5143\u65E5:"1926/12/25"},{\u5143\u53F7:"\u5927\u6B63",\u6539\u5143\u65E5:"1912/07/30"},{\u5143\u53F7:"\u660E\u6CBB",\u6539\u5143\u65E5:"1868/10/23"}]},\u4ECA:{type:"func",josi:[],pure:!0,fn:function(){let t=n=>{let r="00"+String(n);return r.substring(r.length-2,r.length)},e=new Date;return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())}},\u30B7\u30B9\u30C6\u30E0\u6642\u9593:{type:"func",josi:[],pure:!0,fn:function(){return Math.floor(new Date().getTime()/1e3)}},\u30B7\u30B9\u30C6\u30E0\u6642\u9593\u30DF\u30EA\u79D2:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getTime()}},\u4ECA\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){return t.__formatDate(new Date)}},\u660E\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){let e=Date.now()+864e5;return t.__formatDate(new Date(e))}},\u6628\u65E5:{type:"func",josi:[],pure:!0,fn:function(t){let e=Date.now()-864e5;return t.__formatDate(new Date(e))}},\u4ECA\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()}},\u6765\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()+1}},\u53BB\u5E74:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getFullYear()-1}},\u4ECA\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()+1}},\u6765\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()+2}},\u5148\u6708:{type:"func",josi:[],pure:!0,fn:function(){return new Date().getMonth()}},\u66DC\u65E5:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){let n=e.__str2date(t);return"\u65E5\u6708\u706B\u6C34\u6728\u91D1\u571F".charAt(n.getDay()%7)}},\u66DC\u65E5\u756A\u53F7\u53D6\u5F97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=t.split("/");return new Date(e[0],e[1]-1,e[2]).getDay()}},UNIXTIME\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__str2date(t).getTime()/1e3}},UNIX\u6642\u9593\u5909\u63DB:{type:"func",josi:[["\u306E","\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){return e.__str2date(t).getTime()/1e3}},\u65E5\u6642\u5909\u63DB:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t,e){let n=t*1e3;return e.__formatDateTime(new Date(n),"2022/01/01 00:00:00")}},\u65E5\u6642\u66F8\u5F0F\u5909\u63DB:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t);return e=e.replace(/(YYYY|ccc|WWW|MMM|YY|MM|DD|HH|mm|ss|[MDHmsW])/g,s=>{switch(s){case"YYYY":return r.getFullYear();case"YY":return String(r.getFullYear()).substring(2);case"MM":return n.__zero2(String(r.getMonth()+1));case"DD":return n.__zero2(r.getDate());case"M":return r.getMonth()+1;case"D":return r.getDate();case"HH":return n.__zero2(r.getHours());case"mm":return n.__zero2(r.getMinutes());case"ss":return n.__zero2(r.getSeconds());case"ccc":return n.__zero(r.getMilliseconds(),3);case"H":return r.getHours();case"m":return r.getMinutes();case"s":return r.getSeconds();case"W":return"\u65E5\u6708\u706B\u6C34\u6728\u91D1\u571F".charAt(r.getDay()%7);case"WWW":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][r.getDay()%7];case"MMM":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r.getMonth()]}return s}),e}},\u548C\u66A6\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){let n=e.__str2date(t),r=n.getTime();for(let s of e.__getSysVar("\u5143\u53F7\u30C7\u30FC\u30BF")){let i=String(s.\u5143\u53F7),o=e.__str2date(s.\u6539\u5143\u65E5);if(o.getTime()<=r){let c=n.getFullYear()-o.getFullYear()+1;return c===1&&(c="\u5143"),i+String(c)+"\u5E74"+e.__zero2(n.getMonth()+1)+"\u6708"+e.__zero2(n.getDate())+"\u65E5"}}throw new Error("\u300E\u548C\u66A6\u5909\u63DB\u300F\u306F\u660E\u793A\u4EE5\u524D\u306E\u65E5\u4ED8\u306B\u306F\u5BFE\u5FDC\u3057\u3066\u3044\u307E\u305B\u3093\u3002")}},\u5E74\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t);return n.__str2date(e).getFullYear()-r.getFullYear()}},\u6708\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=n.__str2date(t),s=n.__str2date(e);return s.getFullYear()*12+Number(s.getMonth())-(r.getFullYear()*12+Number(r.getMonth()))}},\u65E5\u6570\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),s=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((s-r)/(3600*24))}},\u6642\u9593\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),s=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((s-r)/3600)}},\u5206\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),s=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil((s-r)/60)}},\u79D2\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"]],pure:!0,fn:function(t,e,n){let r=Math.ceil(n.__str2date(t).getTime()/1e3),s=Math.ceil(n.__str2date(e).getTime()/1e3);return Math.ceil(s-r)}},\u65E5\u6642\u5DEE:{type:"func",josi:[["\u3068","\u304B\u3089"],["\u306E","\u307E\u3067\u306E"],["\u306B\u3088\u308B"]],pure:!0,fn:function(t,e,n,r){switch(n){case"\u5E74":return r.__exec("\u5E74\u6570\u5DEE",[t,e,r]);case"\u6708":return r.__exec("\u6708\u6570\u5DEE",[t,e,r]);case"\u65E5":return r.__exec("\u65E5\u6570\u5DEE",[t,e,r]);case"\u6642\u9593":return r.__exec("\u6642\u9593\u5DEE",[t,e,r]);case"\u5206":return r.__exec("\u5206\u5DEE",[t,e,r]);case"\u79D2":return r.__exec("\u79D2\u5DEE",[t,e,r])}throw new Error("\u300E\u65E5\u6642\u5DEE\u300F\u3067\u4E0D\u660E\u306A\u5358\u4F4D\u3067\u3059\u3002")}},\u6642\u9593\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=e.charAt(0);(r==="-"||r==="+")&&(e=e.substring(1));let s=n.__str2date(t),i=(e+":0:0").split(":"),o=parseInt(i[0])*60*60+parseInt(i[1])*60+parseInt(i[2]);r==="-"&&(o*=-1);let u=new Date(Number(s.getTime())+o*1e3);return n.__formatDateTime(u,t)}},\u65E5\u4ED8\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=1,s=e.charAt(0);(s==="-"||s==="+")&&(e=e.substring(1),s==="-"&&(r*=-1));let i=n.__str2date(t),o=(e+"/0/0").split("/"),u=parseInt(o[0])*r,c=parseInt(o[1])*r,a=parseInt(o[2])*r;return i.setFullYear(Number(i.getFullYear())+u),i.setMonth(Number(i.getMonth())+c),i.setDate(Number(i.getDate())+a),n.__formatDateTime(i,t)}},\u65E5\u6642\u52A0\u7B97:{type:"func",josi:[["\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=(""+e).match(/([+|-]?)(\d+)(Âπ¥|„É∂Êúà|Êó•|ÈÄ±Èñì|ÊôÇÈñì|ÂàÜ|Áßí)$/);if(!r)throw new Error("\u300E\u65E5\u4ED8\u52A0\u7B97\u300F\u306F\u300E(+\uFF5C-)1(\u5E74|\u30F6\u6708|\u65E5|\u6642\u9593|\u5206|\u79D2)\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u307E\u3059\u3002");switch(r[3]){case"\u5E74":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}${r[2]}/0/0`,n]);case"\u30F6\u6708":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/${r[2]}/0`,n]);case"\u9031\u9593":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/0/${parseInt(r[2])*7}`,n]);case"\u65E5":return n.__exec("\u65E5\u4ED8\u52A0\u7B97",[t,`${r[1]}0/0/${r[2]}`,n]);case"\u6642\u9593":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}${r[2]}:0:0`,n]);case"\u5206":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}0:${r[2]}:0`,n]);case"\u79D2":return n.__exec("\u6642\u9593\u52A0\u7B97",[t,`${r[1]}0:0:${r[2]}`,n])}}},\u6642\u9593\u30DF\u30EA\u79D2\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(){return performance&&performance.now?performance.now():Date.now?Date.now():new Date().getTime()}},\u30C7\u30D0\u30C3\u30B0\u8868\u793A:{type:"func",josi:[["\u3068","\u3092","\u306E"]],pure:!0,fn:function(t,e){let r=(String(e.__getSysVar("__line",0))+"::").split(":",2),s=parseInt(String(r[0]).replace("l",""))+1,i=r[1];typeof t=="object"&&(t=JSON.stringify(t)),t=`${i}(${s}): ${t}`,e.__exec("\u8868\u793A",[t,e])},return_none:!0},\u30CF\u30C6\u30CA\u95A2\u6570\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t,e){if(typeof t=="function"){e.__hatena=t;return}if(typeof t=="string"){e.__hatena=e.__getSysVar(t,"\u30C7\u30D0\u30C3\u30B0\u8868\u793A");return}if(t instanceof Array){let n=t.map(r=>{if(r.substring(0,3)==="JS:"){let s=r.substring(3);return e.__evalJS(s,e)}else return e.__getSysVar(r,"\u30C7\u30D0\u30C3\u30B0\u8868\u793A")});e.__hatena=(r,s)=>{let i=r;for(let o of n)i=o(i,s)};return}e.__hatena=e.__getSysVar("\u30C7\u30D0\u30C3\u30B0\u8868\u793A")},return_none:!0},\u30CF\u30C6\u30CA\u95A2\u6570\u5B9F\u884C:{type:"func",josi:[["\u306E","\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__hatena(t,e)},return_none:!0},\u30A8\u30E9\u30FC\u767A\u751F:{type:"func",josi:[["\u306E","\u3067"]],pure:!0,fn:function(t){throw new Error(t)},return_none:!0},__DEBUG:{type:"func",josi:[],pure:!0,fn:function(t){t.isDebug=!0,console.log(t)}},__DEBUG\u5F37\u5236\u5F85\u6A5F:{type:"const",value:0},__DEBUG\u30D6\u30EC\u30A4\u30AF\u30DD\u30A4\u30F3\u30C8\u4E00\u89A7:{type:"const",value:[]},__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0:{type:"const",value:0},__DEBUG_BP_WAIT:{type:"func",josi:[["\u3067"]],pure:!0,asyncFn:!0,fn:function(t,e){return new Promise(n=>{let r=e.__getSysVar("__DEBUG\u30D6\u30EC\u30A4\u30AF\u30DD\u30A4\u30F3\u30C8\u4E00\u89A7"),s=e.__getSysVar("__DEBUG\u5F37\u5236\u5F85\u6A5F");if(e.__setSysVar("__DEBUG\u5F37\u5236\u5F85\u6A5F",0),r.indexOf(t)>=0||s){if(e.__getSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D")!=="\u30E1\u30A4\u30F3")return;console.log(`@__DEBUG_BP_WAIT(${t})`);let i=setInterval(()=>{e.__getSysVar("__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0")===1&&(e.__setSysVar("__DEBUG\u5F85\u6A5F\u30D5\u30E9\u30B0",0),clearInterval(i),n(t))},500)}else n(t)})}},\u30B0\u30ED\u30FC\u30D0\u30EB\u95A2\u6570\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__varslist[1],n=[];for(let r of e.keys())n.push(r);return n}},\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__v0,n=[];for(let r of e.keys())r.startsWith("__")||r.startsWith("!")||r==="meta"||n.push(r);return n}},\u30B7\u30B9\u30C6\u30E0\u95A2\u6570\u5B58\u5728:{type:"func",josi:[["\u304C","\u306E"]],pure:!0,fn:function(t,e){return typeof e.__getSysVar(t)<"u"}},\u30D7\u30E9\u30B0\u30A4\u30F3\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=[];for(let n in t.pluginfiles)e.push(n);return e}},\u30E2\u30B8\u30E5\u30FC\u30EB\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,fn:function(t){let e=[];for(let n in t.__module)e.push(n);return e}},\u52A9\u8A5E\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!1,fn:function(t){return t.josiList}},\u4E88\u7D04\u8A9E\u4E00\u89A7\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!1,fn:function(t){return t.reservedWords}},\u30D7\u30E9\u30B0\u30A4\u30F3\u540D:{type:"const",value:"\u30E1\u30A4\u30F3"},\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){e.__setSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D",t)},return_none:!0},\u540D\u524D\u7A7A\u9593:{type:"const",value:""},\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078"]],pure:!0,fn:function(t,e){e.__namespaceList.push([e.__getSysVar("\u540D\u524D\u7A7A\u9593"),e.__getSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D")]),e.__setSysVar("\u540D\u524D\u7A7A\u9593",t)},return_none:!0},\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7:{type:"func",josi:[],pure:!0,fn:function(t){let e=t.__namespaceList.pop();e&&(t.__setSysVar("\u540D\u524D\u7A7A\u9593",e[0]),t.__setSysVar("\u30D7\u30E9\u30B0\u30A4\u30F3\u540D",e[1]))},return_none:!0},URL\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t){return encodeURIComponent(t)}},URL\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u3078","\u306B"]],pure:!0,fn:function(t){return decodeURIComponent(t)}},URL\u30D1\u30E9\u30E1\u30FC\u30BF\u89E3\u6790:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){let n={};if(typeof t!="string")return n;let r=t.split("?");if(r.length<=1)return n;let s=r[1].split("&");for(let i of s){let u=(i+"=").split("="),c=e.__exec("URL\u30C7\u30B3\u30FC\u30C9",[u[0]]);n[c]=e.__exec("URL\u30C7\u30B3\u30FC\u30C9",[u[1]])}return n}},BASE64\u30A8\u30F3\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u304B\u3089"]],pure:!0,fn:function(t){if(typeof window<"u"&&window.btoa){let e=new TextEncoder().encode(t),n=String.fromCharCode.apply(null,e);return btoa(n)}if(typeof Buffer<"u")return Buffer.from(t).toString("base64");throw new Error("\u300EBASE64\u30A8\u30F3\u30B3\u30FC\u30C9\u300F\u306F\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}},BASE64\u30C7\u30B3\u30FC\u30C9:{type:"func",josi:[["\u3092","\u3078","\u306B"]],pure:!0,fn:function(t){if(typeof window<"u"&&window.atob){let e=atob(t),n=Array.prototype.map.call(e,s=>s.charCodeAt()),r=new Uint8Array(n);return new TextDecoder("UTF-8").decode(r)}if(typeof Buffer<"u")return Buffer.from(t,"base64").toString();throw new Error("\u300EBASE64\u30C7\u30B3\u30FC\u30C9\u300F\u306F\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}}};var ot={meta:{type:"const",value:{pluginName:"plugin_math",description:"\u6570\u5B66\u95A2\u6570\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},SIN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sin(t)}},COS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.cos(t)}},TAN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.tan(t)}},ARCSIN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.asin(t)}},ARCCOS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.acos(t)}},ARCTAN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.atan(t)}},ATAN2:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.atan2(t,e)}},\u5EA7\u6A19\u89D2\u5EA6\u8A08\u7B97:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.atan2(t[1],t[0])/Math.PI*180}},RAD2DEG:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/Math.PI*180}},DEG2RAD:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/180*Math.PI}},\u5EA6\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/Math.PI*180}},\u30E9\u30B8\u30A2\u30F3\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return t/180*Math.PI}},SIGN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return parseFloat(t)===0?0:t>0?1:-1}},\u7B26\u53F7:{type:"func",josi:[["\u306E"]],pure:!1,fn:function(t,e){return e.__exec("SIGN",[t])}},ABS:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.abs(t)}},\u7D76\u5BFE\u5024:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.abs(t)}},EXP:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.exp(t)}},HYPOT:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.hypot(t,e)}},\u659C\u8FBA:{type:"func",josi:[["\u3068"],["\u306E"]],pure:!0,fn:function(t,e){return Math.hypot(t,e)}},LN:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.log(t)}},LOG:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.log(t)}},LOGN:{type:"func",josi:[["\u3067"],["\u306E"]],pure:!0,fn:function(t,e){return t===2?Math.LOG2E*Math.log(e):t===10?Math.LOG10E*Math.log(e):Math.log(e)/Math.log(t)}},FRAC:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t%1}},\u5C0F\u6570\u90E8\u5206:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return t%1}},\u6574\u6570\u90E8\u5206:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.trunc(t)}},\u4E71\u6570:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){if(typeof t=="number")return Math.floor(Math.random()*t);if(typeof t=="object"&&t.\u5148\u982D!==void 0){let e=t.\u5148\u982D,n=t.\u672B\u5C3E;return Math.floor(Math.random()*(n-e+1))+Number(e)}if(Array.isArray(t)){let e=t[0],n=t[1];return Math.floor(Math.random()*(n-e+1))+Number(e)}}},\u4E71\u6570\u7BC4\u56F2:{type:"func",josi:[["\u304B\u3089"],["\u307E\u3067\u306E","\u306E"]],pure:!0,fn:function(t,e){return Math.floor(Math.random()*(e-t+1))+t}},SQRT:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sqrt(t)}},\u5E73\u65B9\u6839:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){return Math.sqrt(t)}},ROUND:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.round(t)}},\u56DB\u6368\u4E94\u5165:{type:"func",josi:[["\u3092","\u306E"]],pure:!0,fn:function(t){return Math.round(t)}},\u5C0F\u6570\u70B9\u5207\u4E0A:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.ceil(t*n)/n}},\u5C0F\u6570\u70B9\u5207\u4E0B:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.floor(t*n)/n}},\u5C0F\u6570\u70B9\u56DB\u6368\u4E94\u5165:{type:"func",josi:[["\u3092"],["\u3067"]],pure:!0,fn:function(t,e){let n=Math.pow(10,e);return Math.round(t*n)/n}},CEIL:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.ceil(t)}},\u5207\u4E0A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.ceil(t)}},FLOOR:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.floor(t)}},\u5207\u6368:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return Math.floor(t)}}};var C={delimiter:",",eol:`\r
`,auto_convert_number:!0};function cn(t){return/^-?\d+(\.\d+)?([eE][-+]?\d+)?$/.test(t)}function Ce(t,e=void 0){e===void 0&&(e=C.delimiter),t=""+t+`
`,t=t.replace(/(\r\n|\r)/g,`
`),t=t.replace(/\s+$/,"")+`
`;let n="^(.*?)([\\"+e+"\\n])",r=new RegExp(n),s=function(c){let a=c;return typeof c=="string"&&C.auto_convert_number&&cn(c)&&(a=parseFloat(c)),a},i=[],o=[],u="";for(;t!=="";){if(u=t.charAt(0),u===e){t=t.substring(1),o.push("");continue}if(u===`
`){o.push(""),i.push(o),o=[],t=t.substring(1);continue}if(t=t.replace(/^\s+/,""),u=t.charAt(0),u===e){console.log("delimiter"),o.push(""),t=t.substring(e.length);continue}if(u==="="&&t.charAt(1)==='"'){t=t.substring(1);continue}if(u!=='"'){let f=r.exec(t);if(!f){o.push(s(t)),i.push(o),o=[];break}f[2]===`
`?(o.push(s(f[1])),i.push(o),o=[]):f[2]===e&&o.push(s(f[1])),t=t.substring(f[0].length);continue}if(t.substring(0,2)==='""'){o.push(""),t=t.substring(2);continue}let c=1,a="";for(;c<t.length;){let f=t.charAt(c),l=t.charAt(c+1);if(f==='"'&&l==='"'){c+=2,a+='"';continue}if(f==='"'){if(c++,l===e){c++,o.push(s(a)),a="";break}if(l===`
`){c++,o.push(s(a)),i.push(o),o=[];break}c++;continue}a+=f,c++}t=t.substr(c)}return o.length>0&&i.push(o),i}function Me(t,e=void 0,n=void 0){e===void 0&&(e=C.delimiter),n===void 0&&(n=C.eol);let r=an(e);if(t===void 0)return"";let s="";for(let i=0;i<t.length;i++){let o=t[i];if(o===void 0){s+=n;continue}for(let u=0;u<o.length;u++)o[u]=r(o[u]);s+=o.join(e)+n}return s=s.replace(/(\r\n|\r|\n)/g,n),s}function an(t){return function(e){e=""+e;let n=!1;return(e.indexOf(`
`)>=0||e.indexOf("\r")>=0)&&(n=!0),e.indexOf(t)>=0&&(n=!0),e.indexOf('"')>=0&&(n=!0,e=e.replace(/"/g,'""')),n&&(e='"'+e+'"'),e}}var fn={meta:{type:"const",value:{pluginName:"plugin_csv",description:"CSV\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},CSV\u53D6\u5F97:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return C.delimiter=",",Ce(t)}},TSV\u53D6\u5F97:{type:"func",josi:[["\u3092","\u306E","\u3067"]],pure:!0,fn:function(t){return C.delimiter="	",Ce(t)}},\u8868CSV\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return C.delimiter=",",Me(t)}},\u8868TSV\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return C.delimiter="	",Me(t)}},CSV\u30AA\u30D7\u30B7\u30E7\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t){for(let e in t){let n=t[e];e==="delimiter"||e==="\u533A\u5207\u6587\u5B57"?C.delimiter=n:e==="eol"?C.eol=n:e==="auto_convert_number"&&(C.auto_convert_number=n)}},return_none:!0}},ut=fn;var ct={meta:{type:"const",value:{pluginName:"plugin_promise",description:"promise\u95A2\u9023\u306E\u547D\u4EE4\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){t.__promise==null&&(t.__promise={setLastPromise:function(e){return t.__setSysVar("\u305D",e),e}})}},\u305D:{type:"const",value:""},\u52D5\u6642:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){return e.__promise.setLastPromise(new Promise((n,r)=>t(n,r)))},return_none:!1},\u6210\u529F\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.then(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(r))))},return_none:!1},\u51E6\u7406\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.then(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(!0,r,n)),r=>(n.__setSysVar("\u5BFE\u8C61",r),t(!1,r,n))))},return_none:!1},\u5931\u6557\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.catch(r=>(n.__setSysVar("\u5BFE\u8C61",r),t(r))))},return_none:!1},\u7D42\u4E86\u6642:{type:"func",josi:[["\u3092"],["\u306E","\u304C","\u306B"]],pure:!0,fn:function(t,e,n){return n.__promise.setLastPromise(e.finally(()=>t()))},return_none:!1},\u675F:{type:"func",josi:[["\u3068","\u3092"]],isVariableJosi:!0,pure:!0,fn:function(...t){return t.pop().__promise.setLastPromise(Promise.all(t))},return_none:!1}};function ln(t,e){let n=t.slice(0,e).split(/\r\n|\n|\r/g);return[n.length,n.pop().length+1]}function hn(t,e,n){let r=t.split(/\r\n|\n|\r/g),s="",i=(Math.log10(e+1)|0)+1;for(let o=e-1;o<=e+1;o++){let u=r[o-1];u&&(s+=o.toString().padEnd(i," "),s+=":  ",s+=u,s+=`
`,o===e&&(s+=" ".repeat(i+n+2),s+=`^
`))}return s}var v=class extends Error{line;column;codeblock;constructor(e,n){let[r,s]=ln(n.toml,n.ptr),i=hn(n.toml,r,s);super(`Invalid TOML document: ${e}

${i}`,n),this.line=r,this.column=s,this.codeblock=i}};function H(t,e=0,n=t.length){let r=t.indexOf(`
`,e);return t[r-1]==="\r"&&r--,r<=n?r:-1}function ne(t,e){for(let n=e;n<t.length;n++){let r=t[n];if(r===`
`)return n;if(r==="\r"&&t[n+1]===`
`)return n+1;if(r<" "&&r!=="	"||r==="\x7F")throw new v("control characters are not allowed in comments",{toml:t,ptr:e})}return t.length}function E(t,e,n,r){let s;for(;(s=t[e])===" "||s==="	"||!n&&(s===`
`||s==="\r"&&t[e+1]===`
`);)e++;return r||s!=="#"?e:E(t,ne(t,e),n)}function Ve(t,e,n,r,s=!1){if(!r)return e=H(t,e),e<0?t.length:e;for(let i=e;i<t.length;i++){let o=t[i];if(o==="#")i=H(t,i);else{if(o===n)return i+1;if(o===r||s&&(o===`
`||o==="\r"&&t[i+1]===`
`))return i}}throw new v("cannot find end of structure",{toml:t,ptr:e})}function be(t,e){let n=t[e],r=n===t[e+1]&&t[e+1]===t[e+2]?t.slice(e,e+3):n;e+=r.length-1;do e=t.indexOf(r,++e);while(e>-1&&n!=="'"&&t[e-1]==="\\"&&(t[e-2]!=="\\"||t[e-3]==="\\"));return e>-1&&(e+=r.length,r.length>1&&(t[e]===n&&e++,t[e]===n&&e++)),e}var pn=/^(\d{4}-\d{2}-\d{2})?[T ]?(?:(\d{2}):\d{2}:\d{2}(?:\.\d+)?)?(Z|[-+]\d{2}:\d{2})?$/i,K=class t extends Date{#t=!1;#n=!1;#e=null;constructor(e){let n=!0,r=!0,s="Z";if(typeof e=="string"){let i=e.match(pn);i?(i[1]||(n=!1,e=`0000-01-01T${e}`),r=!!i[2],r&&e[10]===" "&&(e=e.replace(" ","T")),i[2]&&+i[2]>23?e="":(s=i[3]||null,e=e.toUpperCase(),!s&&r&&(e+="Z"))):e=""}super(e),isNaN(this.getTime())||(this.#t=n,this.#n=r,this.#e=s)}isDateTime(){return this.#t&&this.#n}isLocal(){return!this.#t||!this.#n||!this.#e}isDate(){return this.#t&&!this.#n}isTime(){return this.#n&&!this.#t}isValid(){return this.#t||this.#n}toISOString(){let e=super.toISOString();if(this.isDate())return e.slice(0,10);if(this.isTime())return e.slice(11,23);if(this.#e===null)return e.slice(0,-1);if(this.#e==="Z")return e;let n=+this.#e.slice(1,3)*60+ +this.#e.slice(4,6);return n=this.#e[0]==="-"?n:-n,new Date(this.getTime()-n*6e4).toISOString().slice(0,-1)+this.#e}static wrapAsOffsetDateTime(e,n="Z"){let r=new t(e);return r.#e=n,r}static wrapAsLocalDateTime(e){let n=new t(e);return n.#e=null,n}static wrapAsLocalDate(e){let n=new t(e);return n.#n=!1,n.#e=null,n}static wrapAsLocalTime(e){let n=new t(e);return n.#t=!1,n.#e=null,n}};var dn=/^((0x[0-9a-fA-F](_?[0-9a-fA-F])*)|(([+-]|0[ob])?\d(_?\d)*))$/,yn=/^[+-]?\d(_?\d)*(\.\d(_?\d)*)?([eE][+-]?\d(_?\d)*)?$/,_n=/^[+-]?0[0-9_]/,mn=/^[0-9a-f]{4,8}$/i,at={b:"\b",t:"	",n:`
`,f:"\f",r:"\r",'"':'"',"\\":"\\"};function ke(t,e=0,n=t.length){let r=t[e]==="'",s=t[e++]===t[e]&&t[e]===t[e+1];s&&(n-=2,t[e+=2]==="\r"&&e++,t[e]===`
`&&e++);let i=0,o,u="",c=e;for(;e<n-1;){let a=t[e++];if(a===`
`||a==="\r"&&t[e]===`
`){if(!s)throw new v("newlines are not allowed in strings",{toml:t,ptr:e-1})}else if(a<" "&&a!=="	"||a==="\x7F")throw new v("control characters are not allowed in strings",{toml:t,ptr:e-1});if(o){if(o=!1,a==="u"||a==="U"){let f=t.slice(e,e+=a==="u"?4:8);if(!mn.test(f))throw new v("invalid unicode escape",{toml:t,ptr:i});try{u+=String.fromCodePoint(parseInt(f,16))}catch{throw new v("invalid unicode escape",{toml:t,ptr:i})}}else if(s&&(a===`
`||a===" "||a==="	"||a==="\r")){if(e=E(t,e-1,!0),t[e]!==`
`&&t[e]!=="\r")throw new v("invalid escape: only line-ending whitespace may be escaped",{toml:t,ptr:i});e=E(t,e)}else if(a in at)u+=at[a];else throw new v("unrecognized escape sequence",{toml:t,ptr:i});c=e}else!r&&a==="\\"&&(i=e-1,o=!0,u+=t.slice(c,i))}return u+t.slice(c,n-1)}function ft(t,e,n,r){if(t==="true")return!0;if(t==="false")return!1;if(t==="-inf")return-1/0;if(t==="inf"||t==="+inf")return 1/0;if(t==="nan"||t==="+nan"||t==="-nan")return NaN;if(t==="-0")return r?0n:0;let s=dn.test(t);if(s||yn.test(t)){if(_n.test(t))throw new v("leading zeroes are not allowed",{toml:e,ptr:n});t=t.replace(/_/g,"");let o=+t;if(isNaN(o))throw new v("invalid number",{toml:e,ptr:n});if(s){if((s=!Number.isSafeInteger(o))&&!r)throw new v("integer value cannot be represented losslessly",{toml:e,ptr:n});(s||r===!0)&&(o=BigInt(t))}return o}let i=new K(t);if(!i.isValid())throw new v("invalid value",{toml:e,ptr:n});return i}function gn(t,e,n,r){let s=t.slice(e,n),i=s.indexOf("#");i>-1&&(ne(t,i),s=s.slice(0,i));let o=s.trimEnd();if(!r){let u=s.indexOf(`
`,o.length);if(u>-1)throw new v("newlines are not allowed in inline tables",{toml:t,ptr:e+u})}return[o,i]}function re(t,e,n,r,s){if(r===0)throw new v("document contains excessively nested structures. aborting.",{toml:t,ptr:e});let i=t[e];if(i==="["||i==="{"){let[c,a]=i==="["?ht(t,e,r,s):lt(t,e,r,s),f=n?Ve(t,a,",",n):a;if(a-f&&n==="}"){let l=H(t,a,f);if(l>-1)throw new v("newlines are not allowed in inline tables",{toml:t,ptr:l})}return[c,f]}let o;if(i==='"'||i==="'"){o=be(t,e);let c=ke(t,e,o);if(n){if(o=E(t,o,n!=="]"),t[o]&&t[o]!==","&&t[o]!==n&&t[o]!==`
`&&t[o]!=="\r")throw new v("unexpected character encountered",{toml:t,ptr:o});o+=+(t[o]===",")}return[c,o]}o=Ve(t,e,",",n);let u=gn(t,e,o-+(t[o-1]===","),n==="]");if(!u[0])throw new v("incomplete key-value declaration: no value specified",{toml:t,ptr:e});return n&&u[1]>-1&&(o=E(t,e+u[1]),o+=+(t[o]===",")),[ft(u[0],t,e,s),o]}var bn=/^[a-zA-Z0-9-_]+[ \t]*$/;function ve(t,e,n="="){let r=e-1,s=[],i=t.indexOf(n,e);if(i<0)throw new v("incomplete key-value: cannot find end of key",{toml:t,ptr:e});do{let o=t[e=++r];if(o!==" "&&o!=="	")if(o==='"'||o==="'"){if(o===t[e+1]&&o===t[e+2])throw new v("multiline strings are not allowed in keys",{toml:t,ptr:e});let u=be(t,e);if(u<0)throw new v("unfinished string encountered",{toml:t,ptr:e});r=t.indexOf(".",u);let c=t.slice(u,r<0||r>i?i:r),a=H(c);if(a>-1)throw new v("newlines are not allowed in keys",{toml:t,ptr:e+r+a});if(c.trimStart())throw new v("found extra tokens after the string part",{toml:t,ptr:u});if(i<u&&(i=t.indexOf(n,u),i<0))throw new v("incomplete key-value: cannot find end of key",{toml:t,ptr:e});s.push(ke(t,e,u))}else{r=t.indexOf(".",e);let u=t.slice(e,r<0||r>i?i:r);if(!bn.test(u))throw new v("only letter, numbers, dashes and underscores are allowed in keys",{toml:t,ptr:e});s.push(u.trimEnd())}}while(r+1&&r<i);return[s,E(t,i+1,!0,!0)]}function lt(t,e,n,r){let s={},i=new Set,o,u=0;for(e++;(o=t[e++])!=="}"&&o;){let c={toml:t,ptr:e-1};if(o===`
`)throw new v("newlines are not allowed in inline tables",c);if(o==="#")throw new v("inline tables cannot contain comments",c);if(o===",")throw new v("expected key-value, found comma",c);if(o!==" "&&o!=="	"){let a,f=s,l=!1,[h,p]=ve(t,e-1);for(let g=0;g<h.length;g++){if(g&&(f=l?f[a]:f[a]={}),a=h[g],(l=Object.hasOwn(f,a))&&(typeof f[a]!="object"||i.has(f[a])))throw new v("trying to redefine an already defined value",{toml:t,ptr:e});!l&&a==="__proto__"&&Object.defineProperty(f,a,{enumerable:!0,configurable:!0,writable:!0})}if(l)throw new v("trying to redefine an already defined value",{toml:t,ptr:e});let[y,m]=re(t,p,"}",n-1,r);i.add(y),f[a]=y,e=m,u=t[e-1]===","?e-1:0}}if(u)throw new v("trailing commas are not allowed in inline tables",{toml:t,ptr:u});if(!o)throw new v("unfinished table encountered",{toml:t,ptr:e});return[s,e]}function ht(t,e,n,r){let s=[],i;for(e++;(i=t[e++])!=="]"&&i;){if(i===",")throw new v("expected value, found comma",{toml:t,ptr:e-1});if(i==="#")e=ne(t,e);else if(i!==" "&&i!=="	"&&i!==`
`&&i!=="\r"){let o=re(t,e-1,"]",n-1,r);s.push(o[0]),e=o[1]}}if(!i)throw new v("unfinished array encountered",{toml:t,ptr:e});return[s,e]}function pt(t,e,n,r){let s=e,i=n,o,u=!1,c;for(let a=0;a<t.length;a++){if(a){if(s=u?s[o]:s[o]={},i=(c=i[o]).c,r===0&&(c.t===1||c.t===2))return null;if(c.t===2){let f=s.length-1;s=s[f],i=i[f].c}}if(o=t[a],(u=Object.hasOwn(s,o))&&i[o]?.t===0&&i[o]?.d)return null;u||(o==="__proto__"&&(Object.defineProperty(s,o,{enumerable:!0,configurable:!0,writable:!0}),Object.defineProperty(i,o,{enumerable:!0,configurable:!0,writable:!0})),i[o]={t:a<t.length-1&&r===2?3:r,d:!1,i:0,c:{}})}if(c=i[o],c.t!==r&&!(r===1&&c.t===3)||(r===2&&(c.d||(c.d=!0,s[o]=[]),s[o].push(s={}),c.c[c.i++]=c={t:1,d:!1,i:0,c:{}}),c.d))return null;if(c.d=!0,r===1)s=u?s[o]:s[o]={};else if(r===0&&u)return null;return[o,s,c.c]}function dt(t,{maxDepth:e=1e3,integersAsBigInt:n}={}){let r={},s={},i=r,o=s;for(let u=E(t,0);u<t.length;){if(t[u]==="["){let c=t[++u]==="[",a=ve(t,u+=+c,"]");if(c){if(t[a[1]-1]!=="]")throw new v("expected end of table declaration",{toml:t,ptr:a[1]-1});a[1]++}let f=pt(a[0],r,s,c?2:1);if(!f)throw new v("trying to redefine an already defined table or value",{toml:t,ptr:u});o=f[2],i=f[1],u=a[1]}else{let c=ve(t,u),a=pt(c[0],i,o,0);if(!a)throw new v("trying to redefine an already defined table or value",{toml:t,ptr:u});let f=re(t,c[1],void 0,e,n);a[1][a[0]]=f[0],u=f[1]}if(u=E(t,u,!0),t[u]&&t[u]!==`
`&&t[u]!=="\r")throw new v("each key-value declaration must be followed by an end-of-line",{toml:t,ptr:u});u=E(t,u)}return r}var yt=/^[a-z0-9-_]+$/i;function se(t){let e=typeof t;if(e==="object"){if(Array.isArray(t))return"array";if(t instanceof Date)return"date"}return e}function kn(t){for(let e=0;e<t.length;e++)if(se(t[e])!=="object")return!1;return t.length!=0}function Ie(t){return JSON.stringify(t).replace(/\x7f/g,"\\u007f")}function Pe(t,e,n,r){if(n===0)throw new Error("Could not stringify the object: maximum object depth exceeded");if(e==="number")return isNaN(t)?"nan":t===1/0?"inf":t===-1/0?"-inf":r&&Number.isInteger(t)?t.toFixed(1):t.toString();if(e==="bigint"||e==="boolean")return t.toString();if(e==="string")return Ie(t);if(e==="date"){if(isNaN(t.getTime()))throw new TypeError("cannot serialize invalid date");return t.toISOString()}if(e==="object")return vn(t,n,r);if(e==="array")return wn(t,n,r)}function vn(t,e,n){let r=Object.keys(t);if(r.length===0)return"{}";let s="{ ";for(let i=0;i<r.length;i++){let o=r[i];i&&(s+=", "),s+=yt.test(o)?o:Ie(o),s+=" = ",s+=Pe(t[o],se(t[o]),e-1,n)}return s+" }"}function wn(t,e,n){if(t.length===0)return"[]";let r="[ ";for(let s=0;s<t.length;s++){if(s&&(r+=", "),t[s]===null||t[s]===void 0)throw new TypeError("arrays cannot contain null or undefined values");r+=Pe(t[s],se(t[s]),e-1,n)}return r+" ]"}function Sn(t,e,n,r){if(n===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let s="";for(let i=0;i<t.length;i++)s+=`[[${e}]]
`,s+=Le(t[i],e,n,r),s+=`

`;return s}function Le(t,e,n,r){if(n===0)throw new Error("Could not stringify the object: maximum object depth exceeded");let s="",i="",o=Object.keys(t);for(let u=0;u<o.length;u++){let c=o[u];if(t[c]!==null&&t[c]!==void 0){let a=se(t[c]);if(a==="symbol"||a==="function")throw new TypeError(`cannot serialize values of type '${a}'`);let f=yt.test(c)?c:Ie(c);if(a==="array"&&kn(t[c]))i+=Sn(t[c],e?`${e}.${f}`:f,n-1,r);else if(a==="object"){let l=e?`${e}.${f}`:f;i+=`[${l}]
`,i+=Le(t[c],l,n-1,r),i+=`

`}else s+=f,s+=" = ",s+=Pe(t[c],a,n,r),s+=`
`}}return`${s}
${i}`.trim()}function _t(t,{maxDepth:e=1e3,numbersAsFloat:n=!1}={}){if(se(t)!=="object")throw new TypeError("stringify can only be called with an object");return Le(t,"",e,n)}var De={parse:dt,stringify:_t,TomlDate:K,TomlError:v};var jn={meta:{type:"const",value:{pluginName:"plugin_toml",description:"TOML\u5F62\u5F0F\u306E\u30C7\u30FC\u30BF\u8AAD\u307F\u66F8\u304D\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.7.6",nakoRuntime:["wnako","cnako"],nakoVersion:"3.7.6"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){}},TOML\u53D6\u5F97:{type:"func",josi:[["\u3092","\u306E","\u304B\u3089"]],pure:!0,fn:function(t,e){return De.parse(t)}},TOML\u5909\u63DB:{type:"func",josi:[["\u3092","\u304B\u3089","\u306E"]],pure:!0,fn:function(t,e){return De.stringify(t)}}},mt=jn;var gt={meta:{type:"const",value:{pluginName:"plugin_test",description:"\u30C6\u30B9\u30C8\u3092\u63D0\u4F9B\u3059\u308B\u30D7\u30E9\u30B0\u30A4\u30F3",pluginVersion:"3.6.0",nakoRuntime:["wnako","cnako","phpnako"],nakoVersion:"^3.6.0"}},\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(){}},ASSERT\u7B49:{type:"func",josi:[["\u3068"],["\u304C"]],pure:!0,fn:function(t,e){if(t!==e)throw new Error(`\u4E0D\u4E00\u81F4 [\u5B9F\u969B]${JSON.stringify(t)} [\u671F\u5F85]${JSON.stringify(e)}`);return!0}},\u30C6\u30B9\u30C8\u5B9F\u884C:{type:"func",josi:[["\u3068"],["\u3067"]],pure:!1,fn:function(t,e,n){n.__exec("ASSERT\u7B49",[t,e,n])}},\u30C6\u30B9\u30C8\u7B49:{type:"func",josi:[["\u3068"],["\u304C"]],pure:!1,fn:function(t,e,n){n.__exec("ASSERT\u7B49",[t,e,n])}}};var Je=t=>JSON.parse(JSON.stringify(t)),bt=600;function J(t={}){return typeof t!="object"&&(t={}),t.testOnly=t.testOnly||!1,t.resetEnv=t.resetEnv||!1,t.resetAll=t.resetAll||!1,t.preCode=t.preCode||"",t.nakoGlobal=t.nakoGlobal||null,t}var we=class t{constructor(e=void 0){e===void 0&&(e={useBasicPlugin:!0}),this.__varslist=[this.newVaiables(),this.newVaiables(),this.newVaiables()],this.__locals=this.newVaiables(),this.__self=this,this.__vars=this.__varslist[2],this.__v1=this.__varslist[1],this.__v0=this.__varslist[0],this.version=Te.version,this.coreVersion=Te.version,this.__globals=[],this.__globalObj=null,this.__module={},this.pluginFunclist={},this.funclist=this.newVaiables(),this.moduleExport=this.newVaiables(),this.pluginfiles={},this.commandlist=new Set,this.nakoFuncList=this.newVaiables(),this.eventList=[],this.codeGenerateor={},this.debugOption={useDebug:!1,waitTime:0},this.logger=new te,this.filename="main.nako3",this.dependencies={},this.usedFuncs=new Set,this.numFailures=0,e.useBasicPlugin&&this.addBasicPlugins(),this.prepare=he.getInstance(),this.parser=new le(this.logger),this.lexer=new T(this.logger),this.lexer.setFuncList(this.funclist),this.lexer.setModuleExport(this.moduleExport),this.reservedWords=JSON.parse(JSON.stringify(this.lexer.reservedWords)),this.josiList=JSON.parse(JSON.stringify(this.lexer.josiList))}getModList(){return this.lexer.modList}getLogger(){return this.logger}getNakoFuncList(){return this.nakoFuncList}getNakoFunc(e){return this.nakoFuncList.get(e)}getPluginfiles(){return this.pluginfiles}addBasicPlugins(){this.addPlugin(it),this.addPlugin(ot),this.addPlugin(ct),this.addPlugin(gt),this.addPlugin(ut),this.addPlugin(mt)}replaceLogger(){return this.lexer.logger=this.parser.logger=this.logger=new te}static listRequireStatements(e){let n=[];for(let r=0;r+2<e.length;r++){if(!(e[r].type==="not"&&(e[r+1].type==="string"||e[r+1].type==="string_ex")&&e[r+2].value==="\u53D6\u8FBC"))continue;let s=String(e[r+1].value)+"";if(s.startsWith("\u8CAF\u8535\u5EAB:")&&(s=`https://n3s.nadesi.com/plain/${s.substring(4)}`),s.startsWith("\u62E1\u5F35\u30D7\u30E9\u30B0\u30A4\u30F3:")){let o=s.split(":")[1].match(/^([a-zA-Z0-9_-]+)\.(js|mjs|nako3)(@[0-9.]+)?$/);if(o){let u=o[1],c=o[2],a=o[3]||"@latest";c==="js"||c==="mjs"?(u.startsWith("nadesiko3-")||(u=`nadesiko3-${u}`),s=`https://cdn.jsdelivr.net/npm/${u}${a}/${u}.${c}`):s=`https://n3s.nadesi.com/plain/${u}.${c}`}else throw new Z("\u300E\u53D6\u8FBC\u300F\u306E\u6307\u5B9A\u30A8\u30E9\u30FC\u3002\u300E\u62E1\u5F35\u30D7\u30E9\u30B0\u30A4\u30F3:(\u30D5\u30A1\u30A4\u30EB\u540D).(js|nako3)(@ver)\u300F\u306E\u66F8\u5F0F\u3067\u6307\u5B9A\u3057\u3066\u304F\u3060\u3055\u3044\u3002",e[r].file,e[r].line)}n.push({...e[r],start:r,end:r+3,value:s,firstToken:e[r],lastToken:e[r+2]}),r+=2}return n}_loadDependencies(e,n,r,s){let i={},o=new t({useBasicPlugin:!0}),u=(f,l)=>{let h=s.readJs(f.filePath,f.firstToken);l.push(h.task.then(p=>{let y=p();this.addPluginFromFile(f.filePath,y),i[f.filePath].funclist=y,i[f.filePath].moduleExport={},i[f.filePath].addPluginFile=()=>{this.addPluginFromFile(f.filePath,y)}}))},c=(f,l)=>{let h=s.readNako3(f.filePath,f.firstToken),p=y=>{let m=T.filenameToModName(f.filePath);y=`\u300E${m}\u300F\u306B\u540D\u524D\u7A7A\u9593\u8A2D\u5B9A;\u300E${m}\u300F\u306B\u30D7\u30E9\u30B0\u30A4\u30F3\u540D\u8A2D\u5B9A;`+y+";\u540D\u524D\u7A7A\u9593\u30DD\u30C3\u30D7;";let g=this.rawtokenize(y,0,f.filePath);i[f.filePath].tokens=g;let k=new Map,b=new Map;return T.preDefineFunc(Je(g),this.logger,k,b),i[f.filePath].funclist=k,i[f.filePath].moduleExport=b,a(y,f.filePath,"")};l.push(h.task.then(y=>p(y)))},a=(f,l,h)=>{let p=[],m=t.listRequireStatements(o.rawtokenize(f,0,l,h)).map(g=>({...g,...s.resolvePath(g.value,g.firstToken,l)}));for(let g of m){if(i.hasOwnProperty(g.filePath)){i[g.filePath].alias.add(g.value);continue}if(i[g.filePath]={tokens:[],alias:new Set([g.value]),addPluginFile:()=>{},funclist:{},moduleExport:{}},g.type==="js"||g.type==="mjs")u(g,p);else if(g.type==="nako3")c(g,p);else throw new Z(`\u30D5\u30A1\u30A4\u30EB\u300E${String(g.value)}\u300F\u3092\u8AAD\u307F\u8FBC\u3081\u307E\u305B\u3093\u3002\u30D5\u30A1\u30A4\u30EB\u304C\u5B58\u5728\u3057\u306A\u3044\u304B\u672A\u5BFE\u5FDC\u306E\u62E1\u5F35\u5B50\u3067\u3059\u3002`,g.firstToken.file,g.firstToken.line)}if(p.length>0)return Promise.all(p)};try{let f=a(e,n,r);return f!==void 0&&f.catch(l=>{this.logger.error(l.msg),this.numFailures++}),this.dependencies=i,f}catch(f){throw this.logger.error(String(f)),f}}rawtokenize(e,n,r,s=""){if(!e.startsWith(s))throw new Error("code\u306E\u5148\u982D\u306B\u306FpreCode\u3092\u542B\u3081\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");let i=T.filenameToModName(r),o=this.getModList();o.indexOf(i)<0&&o.unshift(i);let u=this.prepare.convert(e),c=new ye(e.length,u),a=new _e(e,[],[]),f=new me(e),l;try{l=this.lexer.tokenize(u.map(h=>h.text).join(""),n,r)}catch(h){if(!(h instanceof P))throw h;let p=a.map(c.map(h.preprocessedCodeStartOffset),c.map(h.preprocessedCodeEndOffset)),y=p.startOffset===null?h.line:f.map(p.startOffset,!1).line,m=Fe({...p,line:y},s);throw new R(h.msg,m.startOffset,m.endOffset,m.line,r)}return l=st(l),l=rt(l),l=et(l),l=Ke(l),l=l.map(h=>{let p=a.map(c.map(h.preprocessedCodeOffset||0),c.map((h.preprocessedCodeOffset||0)+(h.preprocessedCodeLength||0))),y=h.line,m=0;if(h.type==="eol"&&p.endOffset!==null){let g=f.map(p.endOffset,!1);y=g.line,m=g.column}else if(p.startOffset!==null){let g=f.map(p.startOffset,!1);y=g.line,m=g.column}return{...h,...Fe({line:y,column:m,startOffset:p.startOffset,endOffset:p.endOffset},s),rawJosi:h.josi}}),l}converttoken(e,n,r){return this.lexer.replaceTokens(e,n,r)}reset(e=void 0){if(!e||e.needToClearPlugin)try{this.clearPlugins()}catch{}this.__varslist=[this.__varslist[0],this.newVaiables(),this.newVaiables()],this.__v0=this.__varslist[0],this.__v1=this.__varslist[1],this.__vars=this.__varslist[2],this.__locals=this.newVaiables(),this.funclist=new Map;for(let n of this.__v0.keys()){let r=this.pluginFunclist[n];r&&this.funclist.set(n,JSON.parse(JSON.stringify(r)))}this.lexer.setFuncList(this.funclist),this.moduleExport=new Map,this.lexer.setModuleExport(this.moduleExport),this.logger.clear()}lexCodeToken(e,n,r,s){let i=this.rawtokenize(e,n,r,"");if(s===null)for(let u of i)u.startOffset=void 0,u.endOffset=void 0;else for(let u of i)u.startOffset!==void 0&&(u.startOffset+=s),u.endOffset!==void 0&&(u.endOffset+=s);let o=i.filter(u=>u.type==="line_comment"||u.type==="range_comment").map(u=>({...u}));return i=this.converttoken(i,!1,r),{tokens:i,commentTokens:o}}replaceRequireStatements(e,n=new Set){let r=[];for(let s of t.listRequireStatements(e).reverse()){if(n.has(s.value)){r.push(...e.splice(s.start||0,(s.end||0)-(s.start||0)));continue}let i=Object.keys(this.dependencies).find(u=>this.dependencies[u].alias.has(s.value));if(i===void 0)throw s.firstToken?new R(`\u30D5\u30A1\u30A4\u30EB\u300E${String(s.value)}\u300F\u304C\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093\u3002`,s.firstToken.startOffset||0,s.firstToken.endOffset||0,s.firstToken.line,s.firstToken.file):new Error(`\u30D5\u30A1\u30A4\u30EB\u300E${String(s.value)}\u300F\u304C\u8AAD\u307F\u8FBC\u307E\u308C\u3066\u3044\u307E\u305B\u3093\u3002`);this.dependencies[i].addPluginFile();let o=Je(this.dependencies[i].tokens);n.add(s.value),r.push(...this.replaceRequireStatements(o,n)),r.push(...e.splice(s.start||0,(s.end||0)-(s.start||0),...o))}return r}removeRequireStatements(e){let n=[];for(let r of t.listRequireStatements(e).reverse()){let s=Object.keys(this.dependencies).find(i=>this.dependencies[i].alias.has(r.value));s!==void 0&&this.dependencies[s].addPluginFile(),n.push(...e.splice(r.start||0,(r.end||0)-(r.start||0)))}return n}lex(e,n="main.nako3",r="",s=!1){let i=this.rawtokenize(e,0,n,r),o=s?this.removeRequireStatements(i):this.replaceRequireStatements(i,void 0);for(let c of o)(c.type==="word"||c.type==="not")&&(c.type="require");if(o.length>=3)for(let c=0;c<o.length;c+=3){let a=o[c+1].value;a=T.filenameToModName(a),this.lexer.modList.indexOf(a)<0&&this.lexer.modList.push(a)}let u=i.filter(c=>c.type==="line_comment"||c.type==="range_comment").map(c=>({...c}));i=this.converttoken(i,!0,n);for(let c=0;c<i.length;c++)if(i[c]&&i[c].type==="code"){let a=this.lexCodeToken(i[c].value,i[c].line,n,i[c].startOffset||0);u.push(...a.commentTokens),i.splice(c,1,...a.tokens),c--}return this.logger.trace(`--- lex ---
`+JSON.stringify(i,null,2)),{commentTokens:u,tokens:i,requireTokens:o}}parse(e,n,r=""){this.lexer.setFuncList(this.funclist),this.parser.setFuncList(this.funclist),this.lexer.setModuleExport(this.moduleExport),this.parser.setModuleExport(this.moduleExport);let s=this.lex(e,n,r),i;try{this.parser.genMode="sync",i=this.parser.parse(s.tokens,n)}catch(o){throw typeof o.startOffset!="number"?d.fromNode(o.message,s.tokens[this.parser.getIndex()]):o}return this.usedFuncs=this.parser.usedFuncs,this.deleteUnNakoFuncs(),this.logger.trace(`--- ast ---
`+JSON.stringify(i,null,2)),i}getUsedFuncs(e){return this.usedFuncs=new Set,this._getUsedFuncs(e),this.deleteUnNakoFuncs()}_getUsedFuncs(e){if(e){if((e.type==="func"||e.type==="func_pointer")&&e.name)this.usedFuncs.add(e.name);else if(e.blocks)for(let n of e.blocks)this._getUsedFuncs(n)}}deleteUnNakoFuncs(){for(let e of this.usedFuncs)this.commandlist.has(e)||this.usedFuncs.delete(e);return this.usedFuncs}compile(e,n,r=!1,s=""){let i=J();return i.testOnly=r,i.preCode=s,this.compileFromCode(e,n,i).runtimeEnv}compileFromCode(e,n,r=void 0){n===""&&(n="main.nako3"),r===void 0&&(r=J());try{r.resetEnv&&this.reset(),r.resetAll&&this.clearPlugins(),this.eventList.filter(o=>o.eventName==="beforeParse").map(o=>o.callback(e));let s=this.parse(e,n,r.preCode);this.eventList.filter(o=>o.eventName==="beforeGenerate").map(o=>o.callback(s));let i=this.generateCode(s,new Q(r.testOnly));return this.eventList.filter(o=>o.eventName==="afterGenerate").map(o=>o.callback(i)),i}catch(s){throw this.logger.error(s),s}}generateCode(e,n,r="sync"){if(r==="sync")return Ye(this,e,n);r==="\u975E\u540C\u671F\u30E2\u30FC\u30C9"&&this.logger.error("\u300E!\u975E\u540C\u671F\u30E2\u30FC\u30C9\u300F\u306F\u5EC3\u6B62\u3055\u308C\u307E\u3057\u305F\u3002[\u8A73\u7D30](https://github.com/kujirahand/nadesiko3/issues/1164)");let s=this.codeGenerateor[r];if(!s)throw new Error(`\u30B3\u30FC\u30C9\u30B8\u30A7\u30CD\u30EC\u30FC\u30BF\u306E\u300C${r}\u300D\u306F\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u305B\u3093\u3002`);return s.generate(this,e,n.isTest)}addCodeGenerator(e,n){this.codeGenerateor[e]=n}async _run(e,n,r,s,i=""){let o=J({resetEnv:r,resetAll:r,testOnly:s,preCode:i});return this._runEx(e,n,o)}clearPlugins(){this.__globals.forEach(e=>{e&&(e.__setSysVar("__forceClose",!0),e.reset())}),this.__globals=[]}evalJS(e,n){this.__globalObj=n,this.__globalObj.lastJSCode=e,this.eventList.filter(r=>r.eventName==="beforeRun").map(r=>r.callback(n));try{new Function(n.lastJSCode).apply(n)}catch(r){throw n.numFailures++,this.getLogger().error(r),r}this.eventList.filter(r=>r.eventName==="finish").map(r=>r.callback(n))}runSync(e,n,r=void 0){r=J(r);let s=this.compileFromCode(e,n,r),i=this.getNakoGlobal(r,s.gen,n);return this.evalJS(s.runtimeEnv,i),i}async runAsync(e,n,r=void 0){r=J(r);let s=this.compileFromCode(e,n,r),i=this.getNakoGlobal(r,s.gen,n);return this.evalJS(s.runtimeEnv,i),i}getNakoGlobal(e,n,r){let s=e.nakoGlobal;return s||(this.__globals.length>0&&e.resetAll===!1&&e.resetEnv===!1?s=this.__globals[this.__globals.length-1]:s=new ge(this,n,this.__globals.length+1),s.__varslist[0].set("\u540D\u524D\u7A7A\u9593",T.filenameToModName(r))),this.__globals.indexOf(s)<0&&this.__globals.push(s),s}addListener(e,n){this.eventList.push({eventName:e,callback:n})}test(e,n,r="",s=!1){let i=J();return i.preCode=r,i.testOnly=s,this.runSync(e,n,i)}run(e,n="main.nako3",r=""){let s=J();return s.preCode=r,this.runSync(e,n,s)}compileStandalone(e,n,r){r===void 0&&(r=new Q);let s=this.parse(e,n);return this.generateCode(s,r).standalone}addPlugin(e,n=!0,r=""){let s=this.__varslist[0],i=s.get("__pluginInfo");i||(i={},s.set("__pluginInfo",i));let o=0,u="unknown",c={pluginName:"unknown",nakoVersionResult:!0,nakoVersion:"0.0.0",path:""};if(e.meta&&e.meta.value&&typeof e.meta=="object"){c=e.meta.value||{pluginName:"unknown",nakoVersion:"0.0.0"},u=c.pluginName||"unknown";let h=((c.nakoVersion||"0.0.0")+".0.0").split(".").map(p=>parseInt(p));o=h[1]*100+h[2],c.path=r}if(u==="unknown"&&(u=Object.keys(e).join("-")),i[u]!==void 0)return;if(u=(f=>f.replace(/[^a-zA-z0-9\-_\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF\u3400-\u4DBF\uF900-\uFAFF]/g,"_"))(u),i[u]=c,bt>o){let f=Object.keys(e).join(",");if(u==="unknown"&&(u=f.substring(0,30)+"..."),u!==""){let l=`\u306A\u3067\u3057\u3053\u30D7\u30E9\u30B0\u30A4\u30F3\u300E${u}\u300F\u306F\u53E4\u3044\u5F62\u5F0F\u306A\u306E\u3067\u6B63\u3057\u304F\u52D5\u4F5C\u3057\u306A\u3044\u53EF\u80FD\u6027\u304C\u3042\u308A\u307E\u3059\u3002(\u30E9\u30F3\u30BF\u30A4\u30E0\u306E\u8981\u6C42: ${bt}/\u30D7\u30E9\u30B0\u30A4\u30F3: ${o})`;console.warn(l,"see","https://github.com/kujirahand/nadesiko3/issues/1647"),this.logger.warn(l),c.nakoVersionResult=!1}}if(this.__module[u]=e,this.pluginfiles[u]="*",typeof e.\u521D\u671F\u5316=="object"){let f=e.\u521D\u671F\u5316;delete e.\u521D\u671F\u5316;let l=`!${u}:\u521D\u671F\u5316`;e[l]=f}for(let f in e){let l=e[f];if(this.funclist.set(f,l),n&&(this.pluginFunclist[f]=JSON.parse(JSON.stringify(l))),l.type==="func")s.set(f,l.fn),l.asyncFn&&(l.pure=!0);else if(l.type==="const"||l.type==="var")s.set(f,l.value);else throw console.error("[\u30D7\u30E9\u30B0\u30A4\u30F3\u8FFD\u52A0\u30A8\u30E9\u30FC]",l),new Error("\u30D7\u30E9\u30B0\u30A4\u30F3\u306E\u8FFD\u52A0\u3067\u30A8\u30E9\u30FC\u3002");f==="\u521D\u671F\u5316"||f.substring(0,1)==="!"||this.commandlist.add(f)}}addPluginObject(e,n,r=!0){n.meta===void 0&&(n.meta={type:"const",value:{pluginName:e,nakoVersion:"0.0.0"}}),this.addPlugin(n,r)}addPluginFile(e,n,r,s=!0){this.addPluginFromFile(n,r,s)}addPluginFromFile(e,n,r=!0){this.addPlugin(n,r,e)}addFunc(e,n,r,s=!0,i=!1){let o={josi:n,fn:r,type:"func",return_none:s,asyncFn:i,pure:!0};this.funclist.set(e,o),this.pluginFunclist[e]=Je(o),this.__varslist[0].set(e,r)}setFunc(e,n,r,s=!0,i=!1){this.addFunc(e,n,r,s,i)}getFunc(e){return this.funclist.get(e)}_runEx(e,n,r,s="",i=void 0){return r.preCode=s,i&&(r.nakoGlobal=i),this.runSync(e,n,r)}runEx(e,n,r,s=""){return this._runEx(e,n,r,s)}async runReset(e,n="main.nako3",r=""){let s=J({resetAll:!0,resetEnv:!0,preCode:r});return this.runAsync(e,n,s)}newVaiables(e){return new Map(e)}};var kt={\u6C34\u8272:{type:"const",value:"aqua"},\u7D2B\u8272:{type:"const",value:"fuchsia"},\u7DD1\u8272:{type:"const",value:"lime"},\u9752\u8272:{type:"const",value:"blue"},\u8D64\u8272:{type:"const",value:"red"},\u9EC4\u8272:{type:"const",value:"yellow"},\u9ED2\u8272:{type:"const",value:"black"},\u767D\u8272:{type:"const",value:"white"},\u8336\u8272:{type:"const",value:"maroon"},\u7070\u8272:{type:"const",value:"gray"},\u91D1\u8272:{type:"const",value:"gold"},\u9EC4\u91D1\u8272:{type:"const",value:"gold"},\u9280\u8272:{type:"const",value:"silver"},\u767D\u91D1\u8272:{type:"const",value:"silver"},\u30AA\u30EA\u30FC\u30D6\u8272:{type:"const",value:"olive"},\u30D9\u30FC\u30B8\u30E5\u8272:{type:"const",value:"beige"},\u30A2\u30EA\u30B9\u30D6\u30EB\u30FC\u8272:{type:"const",value:"aliceblue"},RGB:{type:"func",josi:[["\u3068"],["\u3068"],["\u3067","\u306E"]],pure:!0,fn:function(t,e,n){let r=s=>{let i="00"+s.toString(16);return i.substr(i.length-2,2)};return"#"+r(t)+r(e)+r(n)},return_none:!1},\u8272\u6DF7:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t){let e=n=>{let r="00"+n.toString(16);return r.substr(r.length-2,2)};if(!t)throw new Error("\u300E\u8272\u6DF7\u305C\u308B\u300F\u306E\u5F15\u6570\u306B\u306F\u914D\u5217\u3092\u6307\u5B9A\u3057\u307E\u3059");if(t.length<3)throw new Error("\u300E\u8272\u6DF7\u305C\u308B\u300F\u306E\u5F15\u6570\u306B\u306F[RR,GG,BB]\u5F62\u5F0F\u306E\u914D\u5217\u3092\u6307\u5B9A\u3057\u307E\u3059");return"#"+e(t[0])+e(t[1])+e(t[2])},return_none:!1}};var vt={HTTP\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u53D7\u4FE1:{type:"func",josi:[["\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3067"],["\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e,n){n.__exec("AJAX\u9001\u4FE1\u6642",[t,e,n])},return_none:!0},AJAX\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,asyncFn:!0,fn:async function(t,e){return e.__exec("AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97",[t,e])}},AJAX\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e,n){let r=n.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");r===""&&(r={method:"GET"}),fetch(e,r).then(s=>s.status!==200?n.__getSysVar("AJAX:ONERROR")(s.status):s.text()).then(s=>{n.__setSysVar("\u5BFE\u8C61",s),t(s,n)}).catch(s=>{n.__getSysVar("AJAX:ONERROR")(s)})},return_none:!0},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3:{type:"const",value:""},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3\u8A2D\u5B9A:{type:"func",josi:[["\u306B","\u3078","\u3068"]],pure:!0,fn:function(t,e){e.__setSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3",t)},return_none:!0},AJAX\u30AA\u30D7\u30B7\u30E7\u30F3POST\u8A2D\u5B9A:{type:"func",josi:[["\u3092","\u3067"]],pure:!0,fn:function(t,e){let n=e.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[t,e]),r={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n};e.__setSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3",r)},return_none:!0},AJAX\u5931\u6557\u6642:{type:"func",josi:[["\u306E"]],pure:!0,fn:function(t,e){e.__setSysVar("AJAX:ONERROR",t)}},AJAX\u30C6\u30AD\u30B9\u30C8\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089","\u3092"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).text()},return_none:!1},AJAX_JSON\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).json()},return_none:!1},AJAX\u30D0\u30A4\u30CA\u30EA\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"]],pure:!0,asyncFn:!0,fn:async function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),await(await fetch(t,n)).blob()},return_none:!1},GET\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e,n){n.__exec("AJAX\u9001\u4FE1\u6642",[t,e,n])},return_none:!0},POST\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n,r){let s=r.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[n,r]);fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}).then(o=>o.text()).then(o=>{r.__setSysVar("\u5BFE\u8C61",o),t(o)}).catch(o=>{r.__getSysVar("AJAX:ONERROR")(o)})}},POST\u30D5\u30A9\u30FC\u30E0\u9001\u4FE1\u6642:{type:"func",josi:[["\u306E"],["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n,r){let s=new FormData;for(let o in n)s.set(o,n[o]);fetch(e,{method:"POST",body:s}).then(o=>o.text()).then(o=>{r.__setSysVar("\u5BFE\u8C61",o),t(o)}).catch(o=>{r.__getSysVar("AJAX:ONERROR")(o)})}},POST\u30C7\u30FC\u30BF\u751F\u6210:{type:"func",josi:[["\u306E","\u3092"]],pure:!0,fn:function(t,e){let n=[];for(let r in t){let s=t[r],i=encodeURIComponent(r)+"="+encodeURIComponent(s);n.push(i)}return n.join("&")}},POST\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,asyncFn:!0,fn:function(t,e,n){return new Promise((r,s)=>{let i=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(u=>u.text()).then(u=>{r(u)}).catch(u=>{s(new Error(u.message))})})}},POST\u30D5\u30A9\u30FC\u30E0\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,asyncFn:!0,fn:function(t,e,n){return new Promise((r,s)=>{let i=new FormData;for(let u in e)i.set(u,e[u]);fetch(t,{method:"POST",body:i}).then(u=>u.text()).then(u=>{r(u)}).catch(u=>{s(new Error(u.message))})})}},AJAX\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e){let n=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");return n===""&&(n={method:"GET"}),fetch(t,n)},return_none:!1},HTTP\u4FDD\u969C\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e){return e.__exec("AJAX\u4FDD\u969C\u9001\u4FE1",[t,e])},return_none:!1},POST\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);return fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r})},return_none:!1},POST\u30D5\u30A9\u30FC\u30E0\u4FDD\u969C\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){let r=new FormData;for(let i in e)r.set(i,e[i]);return fetch(t,{method:"POST",body:r})},return_none:!1},AJAX\u5185\u5BB9\u53D6\u5F97:{type:"func",josi:[["\u304B\u3089"],["\u3067"]],pure:!0,fn:function(t,e,n){return e=e.toString().toUpperCase(),e==="TEXT"||e==="\u30C6\u30AD\u30B9\u30C8"?t.text():e==="JSON"?t.json():e==="BLOB"?t.blob():e==="ARRAY"||e==="\u914D\u5217"?t.arrayBuffer():e==="BODY"||e==="\u672C\u4F53"?t.body:t.body()},return_none:!1},BLOB\u4F5C\u6210:{type:"func",josi:[["\u3092","\u304B\u3089"],["\u3067"]],pure:!0,fn:function(t,e){return t instanceof Array||(t=[t]),new Blob(t,e)}},AJAX\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"]],pure:!0,fn:function(t,e){if(!e.resolve)throw new Error("\u300EAJAX\u9010\u6B21\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");e.resolveCount++;let n=e.resolve,r=e.reject,s=e.__getSysVar("AJAX\u30AA\u30D7\u30B7\u30E7\u30F3");s===""&&(s={method:"GET"}),fetch(t,s).then(i=>i.text()).then(i=>{e.__setSysVar("\u5BFE\u8C61",i),n()}).catch(i=>{r(i.message)})},return_none:!0},HTTP\u9010\u6B21\u53D6\u5F97:{type:"func",josi:[["\u306E","\u304B\u3089","\u3092"]],pure:!0,fn:function(t,e){if(!e.resolve)throw new Error("\u300EHTTP\u9010\u6B21\u53D6\u5F97\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");e.__exec("AJAX\u9010\u6B21\u9001\u4FE1",[t,e])},return_none:!0},POST\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!n.resolve)throw new Error("\u300EPOST\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");n.resolveCount++;let r=n.resolve,s=n.reject,i=n.__exec("POST\u30C7\u30FC\u30BF\u751F\u6210",[e,n]);fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(u=>u.text()).then(u=>{n.__setSysVar("\u5BFE\u8C61",u),r(u)}).catch(u=>{s(u.message)})},return_none:!0},POST\u30D5\u30A9\u30FC\u30E0\u9010\u6B21\u9001\u4FE1:{type:"func",josi:[["\u307E\u3067","\u3078","\u306B"],["\u3092"]],pure:!0,fn:function(t,e,n){if(!n.resolve)throw new Error("\u300EPOST\u30D5\u30A9\u30FC\u30E0\u9010\u6B21\u9001\u4FE1\u300F\u306F\u300E\u9010\u6B21\u5B9F\u884C\u300F\u69CB\u6587\u5185\u3067\u5229\u7528\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059\u3002");n.resolveCount++;let r=n.resolve,s=n.reject,i=new FormData;for(let u in e)i.set(u,e[u]);fetch(t,{method:"POST",body:i}).then(u=>u.text()).then(u=>{n.__setSysVar("\u5BFE\u8C61",u),r(u)}).catch(u=>{s(u.message)})},return_none:!0}};var wt={HTML\u5909\u63DB:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t){return String(t).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u8A2D\u5B9A:{type:"func",josi:[["\u3092"]],pure:!0,asyncFn:!0,fn:async function(t){if(navigator.clipboard){await navigator.clipboard.writeText(t);return}let e=document.createElement("div"),n=document.createElement("pre");n.style.webkitUserSelect="auto",n.style.userSelect="auto",e.appendChild(n).textContent=t,e.style.position="fixed",e.right="200%",document.body.appendChild(e),document.getSelection().selectAllChildren(e),document.execCommand("copy"),document.body.removeChild(e)},return_none:!0},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){if(navigator.clipboard)typeof t=="string"&&(t=e.__findFunc(t,"\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97\u6642")),navigator.clipboard.readText().then(r=>{e.__setSysVar("\u5BFE\u8C61",r),t(e)});else throw new Error("Clipbard API\u304C\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}},\u30AF\u30EA\u30C3\u30D7\u30DC\u30FC\u30C9\u53D6\u5F97:{type:"func",josi:[],pure:!0,asyncFn:!0,fn:async function(t){if(navigator.clipboard)return await navigator.clipboard.readText();throw new Error("Clipbard API\u304C\u5229\u7528\u3067\u304D\u307E\u305B\u3093\u3002")}}};var St={WS\u63A5\u7D9A\u5B8C\u4E86\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONOPEN",t)},return_none:!0},WS\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONMESSAGE",t)},return_none:!0},WS\u30A8\u30E9\u30FC\u767A\u751F\u6642:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){e.__setSysVar("WS:ONERROR",t)},return_none:!0},WS\u63A5\u7D9A:{type:"func",josi:[["\u306B","\u3078","\u306E"]],pure:!0,fn:function(t,e){let n=new WebSocket(t);return n.onopen=()=>{let r=e.__getSysVar("WS:ONOPEN");r&&r(e)},n.onerror=r=>{let s=e.__getSysVar("WS:ONERROR");s&&s(r,e),console.log("WS\u30A8\u30E9\u30FC",r)},n.onmessage=r=>{e.__setSysVar("\u5BFE\u8C61",r.data);let s=e.__getSysVar("WS:ONMESSAGE");s&&s(e)},e.__setSysVar("WS:SOCKET",n),n}},WS\u9001\u4FE1:{type:"func",josi:[["\u3092","\u3068"]],pure:!0,fn:function(t,e){e.__getSysVar("WS:SOCKET").send(t)}},WS\u5207\u65AD:{type:"func",josi:[],pure:!0,fn:function(t){t.__getSysVar("WS:SOCKET").close()}}};var xn=[kt,vt,wt,St],jt={\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){typeof self>"u"&&(self={}),typeof navigator>"u"&&(navigator={}),t.__setSysVar("AJAX:ONERROR",e=>{console.log(e)}),t.__v0.SELF=self,t.__v0.NAVIGATOR=navigator}}};xn.forEach(t=>{let e={};Object.assign(e,t),typeof e.\u521D\u671F\u5316<"u"&&delete e.\u521D\u671F\u5316,Object.assign(jt,e)});var xt=jt;var $n={\u521D\u671F\u5316:{type:"func",josi:[],pure:!0,fn:function(t){t.__v0.SELF=self||{},t.__v0.\u4F9D\u983C\u4E3B=self||{}}},\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8:{type:"const",value:""},\u53D7\u4FE1\u30C7\u30FC\u30BF:{type:"const",value:""},SELF:{type:"const",value:""},\u4F9D\u983C\u4E3B:{type:"const",value:""},NAKO\u30EF\u30FC\u30AB\u30FC\u30C7\u30FC\u30BF\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3067"]],pure:!1,fn:function(t,e){t=e.__findVar(t,null),e.__setSysVar("PluginWorker:ondata",(n,r)=>(e.__v0.\u53D7\u4FE1\u30C7\u30FC\u30BF=n,e.__v0.\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8=r,t(r,e)))},return_none:!0},\u30EF\u30FC\u30AB\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8\u53D7\u4FE1\u6642:{type:"func",josi:[["\u3067"]],pure:!1,fn:function(t,e){t=e.__findVar(t,null),self.onmessage=n=>(e.__v0.\u53D7\u4FE1\u30C7\u30FC\u30BF=n.data,e.__v0.\u5BFE\u8C61\u30A4\u30D9\u30F3\u30C8=n,t(n,e))},return_none:!0},NAKO\u30EF\u30FC\u30AB\u30FC\u30C7\u30FC\u30BF\u9001\u4FE1:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){postMessage({type:"data",data:t})},return_none:!0},\u30EF\u30FC\u30AB\u30FC\u30E1\u30C3\u30BB\u30FC\u30B8\u9001\u4FE1:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){postMessage(t)},return_none:!0},\u8868\u793A:{type:"func",josi:[["\u3092"]],pure:!0,fn:function(t,e){postMessage({type:"output",data:t})},return_none:!0},\u7D42\u4E86:{type:"func",josi:[],pure:!0,fn:function(t){close()},return_none:!0}},$t=$n;var Re=class extends we{constructor(){super(),this.__setSysVar("\u30CA\u30C7\u30B7\u30B3\u7A2E\u985E","wwnako3"),this.__setSysVar("PluginWorker:ondata",(e,n)=>{throw new Error("\u300ENAKO\u30EF\u30FC\u30AB\u30FC\u30C7\u30FC\u30BF\u53D7\u4FE1\u6642\u300F\u304C\u547C\u3070\u308C\u3066\u3044\u307E\u305B\u3093\u3002")})}};if(typeof navigator=="object"&&self&&self instanceof WorkerGlobalScope){let t=navigator.nako3=new Re,e=t;t.addPluginObject("PluginBrowserInWorker",xt),t.addPluginObject("PluginWorker",$t),t.getLogger().addListener("error",function(n){self.postMessage({type:"error",data:n})},!1),self.onmessage=n=>{let r=n.data||{type:"",data:""},s=r.type||"",i=r.data||"";switch(s){case"reset":t.reset();break;case"close":self.close();break;case"run":e=e.runEx(i,"_webworker.nako3",{resetEnv:!1,resetLog:!1});break;case"trans":i.forEach(o=>{if(o.type==="func")t.nakoFuncList[o.name]=o.content.meta,t.funclist[o.name]=o.content.func,t.__varslist[1].set(o.name,()=>{});else if(o.type==="val")t.__varslist[2].set(o.name,o.content);else if(o.type==="env")if(o.name==="modlist")for(let u of o.content)t.lexer.modList.indexOf(u.name)<0&&t.lexer.modList.push(u.name),u.export!=null&&!t.moduleExport.hasOwnProperty(u.name)&&(t.moduleExport[u.name]=u.export);else o.name==="constPools"?t.constPools=o.content:o.name==="constPoolsTemplate"?t.constPoolsTemplate=o.content:o.name==="chk"&&(t.chk=o.content)});break;case"data":e.__getSysVar("PluginWorker:ondata")&&e.__getSysVar("PluginWorker:ondata").apply(e,[i,n]);break}}}})();
/*! Bundled license information:

smol-toml/dist/error.js:
smol-toml/dist/util.js:
smol-toml/dist/date.js:
smol-toml/dist/primitive.js:
smol-toml/dist/extract.js:
smol-toml/dist/struct.js:
smol-toml/dist/parse.js:
smol-toml/dist/stringify.js:
smol-toml/dist/index.js:
  (*!
   * Copyright (c) Squirrel Chat et al., All rights reserved.
   * SPDX-License-Identifier: BSD-3-Clause
   *
   * Redistribution and use in source and binary forms, with or without
   * modification, are permitted provided that the following conditions are met:
   *
   * 1. Redistributions of source code must retain the above copyright notice, this
   *    list of conditions and the following disclaimer.
   * 2. Redistributions in binary form must reproduce the above copyright notice,
   *    this list of conditions and the following disclaimer in the
   *    documentation and/or other materials provided with the distribution.
   * 3. Neither the name of the copyright holder nor the names of its contributors
   *    may be used to endorse or promote products derived from this software without
   *    specific prior written permission.
   *
   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
   * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
   * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
   * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
   * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
   * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
   * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
   * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
   * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
   *)
*/
//# sourceMappingURL=wnako3webworker.js.map
